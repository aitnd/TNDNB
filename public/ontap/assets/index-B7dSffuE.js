function DA(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in n)){const l=Object.getOwnPropertyDescriptor(r,a);l&&Object.defineProperty(n,a,l.get?l:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function u0(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function MA(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var a=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:function(){return n[r]}})}),t}var Gg={exports:{}},Fc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ub;function PA(){if(Ub)return Fc;Ub=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var m in a)m!=="key"&&(l[m]=a[m])}else l=a;return a=l.ref,{$$typeof:n,type:r,key:c,ref:a!==void 0?a:null,props:l}}return Fc.Fragment=e,Fc.jsx=t,Fc.jsxs=t,Fc}var zb;function VA(){return zb||(zb=1,Gg.exports=PA()),Gg.exports}var h=VA(),Kg={exports:{}},Pe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bb;function LA(){if(Bb)return Pe;Bb=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),w=Symbol.for("react.activity"),E=Symbol.iterator;function S(U){return U===null||typeof U!="object"?null:(U=E&&U[E]||U["@@iterator"],typeof U=="function"?U:null)}var N={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,k={};function V(U,ne,W){this.props=U,this.context=ne,this.refs=k,this.updater=W||N}V.prototype.isReactComponent={},V.prototype.setState=function(U,ne){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,ne,"setState")},V.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function F(){}F.prototype=V.prototype;function $(U,ne,W){this.props=U,this.context=ne,this.refs=k,this.updater=W||N}var te=$.prototype=new F;te.constructor=$,M(te,V.prototype),te.isPureReactComponent=!0;var ue=Array.isArray;function le(){}var I={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function j(U,ne,W){var oe=W.ref;return{$$typeof:n,type:U,key:ne,ref:oe!==void 0?oe:null,props:W}}function R(U,ne){return j(U.type,ne,U.props)}function D(U){return typeof U=="object"&&U!==null&&U.$$typeof===n}function L(U){var ne={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(W){return ne[W]})}var O=/\/+/g;function Fe(U,ne){return typeof U=="object"&&U!==null&&U.key!=null?L(""+U.key):ne.toString(36)}function et(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(le,le):(U.status="pending",U.then(function(ne){U.status==="pending"&&(U.status="fulfilled",U.value=ne)},function(ne){U.status==="pending"&&(U.status="rejected",U.reason=ne)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function q(U,ne,W,oe,fe){var Te=typeof U;(Te==="undefined"||Te==="boolean")&&(U=null);var Me=!1;if(U===null)Me=!0;else switch(Te){case"bigint":case"string":case"number":Me=!0;break;case"object":switch(U.$$typeof){case n:case e:Me=!0;break;case _:return Me=U._init,q(Me(U._payload),ne,W,oe,fe)}}if(Me)return fe=fe(U),Me=oe===""?"."+Fe(U,0):oe,ue(fe)?(W="",Me!=null&&(W=Me.replace(O,"$&/")+"/"),q(fe,ne,W,"",function(je){return je})):fe!=null&&(D(fe)&&(fe=R(fe,W+(fe.key==null||U&&U.key===fe.key?"":(""+fe.key).replace(O,"$&/")+"/")+Me)),ne.push(fe)),1;Me=0;var tt=oe===""?".":oe+":";if(ue(U))for(var Je=0;Je<U.length;Je++)oe=U[Je],Te=tt+Fe(oe,Je),Me+=q(oe,ne,W,Te,fe);else if(Je=S(U),typeof Je=="function")for(U=Je.call(U),Je=0;!(oe=U.next()).done;)oe=oe.value,Te=tt+Fe(oe,Je++),Me+=q(oe,ne,W,Te,fe);else if(Te==="object"){if(typeof U.then=="function")return q(et(U),ne,W,oe,fe);throw ne=String(U),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.")}return Me}function ce(U,ne,W){if(U==null)return U;var oe=[],fe=0;return q(U,oe,"","",function(Te){return ne.call(W,Te,fe++)}),oe}function _e(U){if(U._status===-1){var ne=U._result;ne=ne(),ne.then(function(W){(U._status===0||U._status===-1)&&(U._status=1,U._result=W)},function(W){(U._status===0||U._status===-1)&&(U._status=2,U._result=W)}),U._status===-1&&(U._status=0,U._result=ne)}if(U._status===1)return U._result.default;throw U._result}var De=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ne=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(ne))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},qe={map:ce,forEach:function(U,ne,W){ce(U,function(){ne.apply(this,arguments)},W)},count:function(U){var ne=0;return ce(U,function(){ne++}),ne},toArray:function(U){return ce(U,function(ne){return ne})||[]},only:function(U){if(!D(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return Pe.Activity=w,Pe.Children=qe,Pe.Component=V,Pe.Fragment=t,Pe.Profiler=a,Pe.PureComponent=$,Pe.StrictMode=r,Pe.Suspense=g,Pe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,Pe.__COMPILER_RUNTIME={__proto__:null,c:function(U){return I.H.useMemoCache(U)}},Pe.cache=function(U){return function(){return U.apply(null,arguments)}},Pe.cacheSignal=function(){return null},Pe.cloneElement=function(U,ne,W){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var oe=M({},U.props),fe=U.key;if(ne!=null)for(Te in ne.key!==void 0&&(fe=""+ne.key),ne)!C.call(ne,Te)||Te==="key"||Te==="__self"||Te==="__source"||Te==="ref"&&ne.ref===void 0||(oe[Te]=ne[Te]);var Te=arguments.length-2;if(Te===1)oe.children=W;else if(1<Te){for(var Me=Array(Te),tt=0;tt<Te;tt++)Me[tt]=arguments[tt+2];oe.children=Me}return j(U.type,fe,oe)},Pe.createContext=function(U){return U={$$typeof:c,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:l,_context:U},U},Pe.createElement=function(U,ne,W){var oe,fe={},Te=null;if(ne!=null)for(oe in ne.key!==void 0&&(Te=""+ne.key),ne)C.call(ne,oe)&&oe!=="key"&&oe!=="__self"&&oe!=="__source"&&(fe[oe]=ne[oe]);var Me=arguments.length-2;if(Me===1)fe.children=W;else if(1<Me){for(var tt=Array(Me),Je=0;Je<Me;Je++)tt[Je]=arguments[Je+2];fe.children=tt}if(U&&U.defaultProps)for(oe in Me=U.defaultProps,Me)fe[oe]===void 0&&(fe[oe]=Me[oe]);return j(U,Te,fe)},Pe.createRef=function(){return{current:null}},Pe.forwardRef=function(U){return{$$typeof:m,render:U}},Pe.isValidElement=D,Pe.lazy=function(U){return{$$typeof:_,_payload:{_status:-1,_result:U},_init:_e}},Pe.memo=function(U,ne){return{$$typeof:y,type:U,compare:ne===void 0?null:ne}},Pe.startTransition=function(U){var ne=I.T,W={};I.T=W;try{var oe=U(),fe=I.S;fe!==null&&fe(W,oe),typeof oe=="object"&&oe!==null&&typeof oe.then=="function"&&oe.then(le,De)}catch(Te){De(Te)}finally{ne!==null&&W.types!==null&&(ne.types=W.types),I.T=ne}},Pe.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},Pe.use=function(U){return I.H.use(U)},Pe.useActionState=function(U,ne,W){return I.H.useActionState(U,ne,W)},Pe.useCallback=function(U,ne){return I.H.useCallback(U,ne)},Pe.useContext=function(U){return I.H.useContext(U)},Pe.useDebugValue=function(){},Pe.useDeferredValue=function(U,ne){return I.H.useDeferredValue(U,ne)},Pe.useEffect=function(U,ne){return I.H.useEffect(U,ne)},Pe.useEffectEvent=function(U){return I.H.useEffectEvent(U)},Pe.useId=function(){return I.H.useId()},Pe.useImperativeHandle=function(U,ne,W){return I.H.useImperativeHandle(U,ne,W)},Pe.useInsertionEffect=function(U,ne){return I.H.useInsertionEffect(U,ne)},Pe.useLayoutEffect=function(U,ne){return I.H.useLayoutEffect(U,ne)},Pe.useMemo=function(U,ne){return I.H.useMemo(U,ne)},Pe.useOptimistic=function(U,ne){return I.H.useOptimistic(U,ne)},Pe.useReducer=function(U,ne,W){return I.H.useReducer(U,ne,W)},Pe.useRef=function(U){return I.H.useRef(U)},Pe.useState=function(U){return I.H.useState(U)},Pe.useSyncExternalStore=function(U,ne,W){return I.H.useSyncExternalStore(U,ne,W)},Pe.useTransition=function(){return I.H.useTransition()},Pe.version="19.2.0",Pe}var qb;function h0(){return qb||(qb=1,Kg.exports=LA()),Kg.exports}var Y=h0();const Ki=u0(Y);var Qg={exports:{}},Gc={},Yg={exports:{}},Xg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hb;function UA(){return Hb||(Hb=1,(function(n){function e(q,ce){var _e=q.length;q.push(ce);e:for(;0<_e;){var De=_e-1>>>1,qe=q[De];if(0<a(qe,ce))q[De]=ce,q[_e]=qe,_e=De;else break e}}function t(q){return q.length===0?null:q[0]}function r(q){if(q.length===0)return null;var ce=q[0],_e=q.pop();if(_e!==ce){q[0]=_e;e:for(var De=0,qe=q.length,U=qe>>>1;De<U;){var ne=2*(De+1)-1,W=q[ne],oe=ne+1,fe=q[oe];if(0>a(W,_e))oe<qe&&0>a(fe,W)?(q[De]=fe,q[oe]=_e,De=oe):(q[De]=W,q[ne]=_e,De=ne);else if(oe<qe&&0>a(fe,_e))q[De]=fe,q[oe]=_e,De=oe;else break e}}return ce}function a(q,ce){var _e=q.sortIndex-ce.sortIndex;return _e!==0?_e:q.id-ce.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var c=Date,m=c.now();n.unstable_now=function(){return c.now()-m}}var g=[],y=[],_=1,w=null,E=3,S=!1,N=!1,M=!1,k=!1,V=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,$=typeof setImmediate<"u"?setImmediate:null;function te(q){for(var ce=t(y);ce!==null;){if(ce.callback===null)r(y);else if(ce.startTime<=q)r(y),ce.sortIndex=ce.expirationTime,e(g,ce);else break;ce=t(y)}}function ue(q){if(M=!1,te(q),!N)if(t(g)!==null)N=!0,le||(le=!0,L());else{var ce=t(y);ce!==null&&et(ue,ce.startTime-q)}}var le=!1,I=-1,C=5,j=-1;function R(){return k?!0:!(n.unstable_now()-j<C)}function D(){if(k=!1,le){var q=n.unstable_now();j=q;var ce=!0;try{e:{N=!1,M&&(M=!1,F(I),I=-1),S=!0;var _e=E;try{t:{for(te(q),w=t(g);w!==null&&!(w.expirationTime>q&&R());){var De=w.callback;if(typeof De=="function"){w.callback=null,E=w.priorityLevel;var qe=De(w.expirationTime<=q);if(q=n.unstable_now(),typeof qe=="function"){w.callback=qe,te(q),ce=!0;break t}w===t(g)&&r(g),te(q)}else r(g);w=t(g)}if(w!==null)ce=!0;else{var U=t(y);U!==null&&et(ue,U.startTime-q),ce=!1}}break e}finally{w=null,E=_e,S=!1}ce=void 0}}finally{ce?L():le=!1}}}var L;if(typeof $=="function")L=function(){$(D)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,Fe=O.port2;O.port1.onmessage=D,L=function(){Fe.postMessage(null)}}else L=function(){V(D,0)};function et(q,ce){I=V(function(){q(n.unstable_now())},ce)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(q){q.callback=null},n.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<q?Math.floor(1e3/q):5},n.unstable_getCurrentPriorityLevel=function(){return E},n.unstable_next=function(q){switch(E){case 1:case 2:case 3:var ce=3;break;default:ce=E}var _e=E;E=ce;try{return q()}finally{E=_e}},n.unstable_requestPaint=function(){k=!0},n.unstable_runWithPriority=function(q,ce){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var _e=E;E=q;try{return ce()}finally{E=_e}},n.unstable_scheduleCallback=function(q,ce,_e){var De=n.unstable_now();switch(typeof _e=="object"&&_e!==null?(_e=_e.delay,_e=typeof _e=="number"&&0<_e?De+_e:De):_e=De,q){case 1:var qe=-1;break;case 2:qe=250;break;case 5:qe=1073741823;break;case 4:qe=1e4;break;default:qe=5e3}return qe=_e+qe,q={id:_++,callback:ce,priorityLevel:q,startTime:_e,expirationTime:qe,sortIndex:-1},_e>De?(q.sortIndex=_e,e(y,q),t(g)===null&&q===t(y)&&(M?(F(I),I=-1):M=!0,et(ue,_e-De))):(q.sortIndex=qe,e(g,q),N||S||(N=!0,le||(le=!0,L()))),q},n.unstable_shouldYield=R,n.unstable_wrapCallback=function(q){var ce=E;return function(){var _e=E;E=ce;try{return q.apply(this,arguments)}finally{E=_e}}}})(Xg)),Xg}var $b;function zA(){return $b||($b=1,Yg.exports=UA()),Yg.exports}var Wg={exports:{}},wn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fb;function BA(){if(Fb)return wn;Fb=1;var n=h0();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)y+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(g,y,_){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:w==null?null:""+w,children:g,containerInfo:y,implementation:_}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return wn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,wn.createPortal=function(g,y){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return l(g,y,null,_)},wn.flushSync=function(g){var y=c.T,_=r.p;try{if(c.T=null,r.p=2,g)return g()}finally{c.T=y,r.p=_,r.d.f()}},wn.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,r.d.C(g,y))},wn.prefetchDNS=function(g){typeof g=="string"&&r.d.D(g)},wn.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var _=y.as,w=m(_,y.crossOrigin),E=typeof y.integrity=="string"?y.integrity:void 0,S=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;_==="style"?r.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:w,integrity:E,fetchPriority:S}):_==="script"&&r.d.X(g,{crossOrigin:w,integrity:E,fetchPriority:S,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},wn.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var _=m(y.as,y.crossOrigin);r.d.M(g,{crossOrigin:_,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&r.d.M(g)},wn.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var _=y.as,w=m(_,y.crossOrigin);r.d.L(g,_,{crossOrigin:w,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},wn.preloadModule=function(g,y){if(typeof g=="string")if(y){var _=m(y.as,y.crossOrigin);r.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:_,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else r.d.m(g)},wn.requestFormReset=function(g){r.d.r(g)},wn.unstable_batchedUpdates=function(g,y){return g(y)},wn.useFormState=function(g,y,_){return c.H.useFormState(g,y,_)},wn.useFormStatus=function(){return c.H.useHostTransitionStatus()},wn.version="19.2.0",wn}var Gb;function qA(){if(Gb)return Wg.exports;Gb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Wg.exports=BA(),Wg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kb;function HA(){if(Kb)return Gc;Kb=1;var n=zA(),e=h0(),t=qA();function r(s){var i="https://react.dev/errors/"+s;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var i=s,o=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(o=i.return),s=i.return;while(s)}return i.tag===3?o:null}function c(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function m(s){if(s.tag===31){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function g(s){if(l(s)!==s)throw Error(r(188))}function y(s){var i=s.alternate;if(!i){if(i=l(s),i===null)throw Error(r(188));return i!==s?null:s}for(var o=s,u=i;;){var f=o.return;if(f===null)break;var p=f.alternate;if(p===null){if(u=f.return,u!==null){o=u;continue}break}if(f.child===p.child){for(p=f.child;p;){if(p===o)return g(f),s;if(p===u)return g(f),i;p=p.sibling}throw Error(r(188))}if(o.return!==u.return)o=f,u=p;else{for(var b=!1,T=f.child;T;){if(T===o){b=!0,o=f,u=p;break}if(T===u){b=!0,u=f,o=p;break}T=T.sibling}if(!b){for(T=p.child;T;){if(T===o){b=!0,o=p,u=f;break}if(T===u){b=!0,u=p,o=f;break}T=T.sibling}if(!b)throw Error(r(189))}}if(o.alternate!==u)throw Error(r(190))}if(o.tag!==3)throw Error(r(188));return o.stateNode.current===o?s:i}function _(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s;for(s=s.child;s!==null;){if(i=_(s),i!==null)return i;s=s.sibling}return null}var w=Object.assign,E=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),N=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),V=Symbol.for("react.profiler"),F=Symbol.for("react.consumer"),$=Symbol.for("react.context"),te=Symbol.for("react.forward_ref"),ue=Symbol.for("react.suspense"),le=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),R=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function L(s){return s===null||typeof s!="object"?null:(s=D&&s[D]||s["@@iterator"],typeof s=="function"?s:null)}var O=Symbol.for("react.client.reference");function Fe(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===O?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case M:return"Fragment";case V:return"Profiler";case k:return"StrictMode";case ue:return"Suspense";case le:return"SuspenseList";case j:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case N:return"Portal";case $:return s.displayName||"Context";case F:return(s._context.displayName||"Context")+".Consumer";case te:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case I:return i=s.displayName||null,i!==null?i:Fe(s.type)||"Memo";case C:i=s._payload,s=s._init;try{return Fe(s(i))}catch{}}return null}var et=Array.isArray,q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_e={pending:!1,data:null,method:null,action:null},De=[],qe=-1;function U(s){return{current:s}}function ne(s){0>qe||(s.current=De[qe],De[qe]=null,qe--)}function W(s,i){qe++,De[qe]=s.current,s.current=i}var oe=U(null),fe=U(null),Te=U(null),Me=U(null);function tt(s,i){switch(W(Te,i),W(fe,s),W(oe,null),i.nodeType){case 9:case 11:s=(s=i.documentElement)&&(s=s.namespaceURI)?lb(s):0;break;default:if(s=i.tagName,i=i.namespaceURI)i=lb(i),s=cb(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ne(oe),W(oe,s)}function Je(){ne(oe),ne(fe),ne(Te)}function je(s){s.memoizedState!==null&&W(Me,s);var i=oe.current,o=cb(i,s.type);i!==o&&(W(fe,s),W(oe,o))}function Ft(s){fe.current===s&&(ne(oe),ne(fe)),Me.current===s&&(ne(Me),Bc._currentValue=_e)}var Ar,Nr;function nt(s){if(Ar===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);Ar=i&&i[1]||"",Nr=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ar+s+Nr}var Qs=!1;function Rr(s,i){if(!s||Qs)return"";Qs=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(i){var ie=function(){throw Error()};if(Object.defineProperty(ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ie,[])}catch(Z){var X=Z}Reflect.construct(s,[],ie)}else{try{ie.call()}catch(Z){X=Z}s.call(ie.prototype)}}else{try{throw Error()}catch(Z){X=Z}(ie=s())&&typeof ie.catch=="function"&&ie.catch(function(){})}}catch(Z){if(Z&&X&&typeof Z.stack=="string")return[Z.stack,X.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=u.DetermineComponentFrameRoot(),b=p[0],T=p[1];if(b&&T){var P=b.split(`
`),Q=T.split(`
`);for(f=u=0;u<P.length&&!P[u].includes("DetermineComponentFrameRoot");)u++;for(;f<Q.length&&!Q[f].includes("DetermineComponentFrameRoot");)f++;if(u===P.length||f===Q.length)for(u=P.length-1,f=Q.length-1;1<=u&&0<=f&&P[u]!==Q[f];)f--;for(;1<=u&&0<=f;u--,f--)if(P[u]!==Q[f]){if(u!==1||f!==1)do if(u--,f--,0>f||P[u]!==Q[f]){var ee=`
`+P[u].replace(" at new "," at ");return s.displayName&&ee.includes("<anonymous>")&&(ee=ee.replace("<anonymous>",s.displayName)),ee}while(1<=u&&0<=f);break}}}finally{Qs=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?nt(o):""}function Ys(s,i){switch(s.tag){case 26:case 27:case 5:return nt(s.type);case 16:return nt("Lazy");case 13:return s.child!==i&&i!==null?nt("Suspense Fallback"):nt("Suspense");case 19:return nt("SuspenseList");case 0:case 15:return Rr(s.type,!1);case 11:return Rr(s.type.render,!1);case 1:return Rr(s.type,!0);case 31:return nt("Activity");default:return""}}function oi(s){try{var i="",o=null;do i+=Ys(s,o),o=s,s=s.return;while(s);return i}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var Ct=Object.prototype.hasOwnProperty,Ot=n.unstable_scheduleCallback,Es=n.unstable_cancelCallback,da=n.unstable_shouldYield,fo=n.unstable_requestPaint,dn=n.unstable_now,os=n.unstable_getCurrentPriorityLevel,Ts=n.unstable_ImmediatePriority,fa=n.unstable_UserBlockingPriority,Ss=n.unstable_NormalPriority,mo=n.unstable_LowPriority,ma=n.unstable_IdlePriority,ga=n.log,As=n.unstable_setDisableYieldValue,Hn=null,Vt=null;function On(s){if(typeof ga=="function"&&As(s),Vt&&typeof Vt.setStrictMode=="function")try{Vt.setStrictMode(Hn,s)}catch{}}var At=Math.clz32?Math.clz32:ya,pa=Math.log,Xs=Math.LN2;function ya(s){return s>>>=0,s===0?32:31-(pa(s)/Xs|0)|0}var $n=256,Ns=262144,Dt=4194304;function ls(s){var i=s&42;if(i!==0)return i;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function cs(s,i,o){var u=s.pendingLanes;if(u===0)return 0;var f=0,p=s.suspendedLanes,b=s.pingedLanes;s=s.warmLanes;var T=u&134217727;return T!==0?(u=T&~p,u!==0?f=ls(u):(b&=T,b!==0?f=ls(b):o||(o=T&~s,o!==0&&(f=ls(o))))):(T=u&~p,T!==0?f=ls(T):b!==0?f=ls(b):o||(o=u&~s,o!==0&&(f=ls(o)))),f===0?0:i!==0&&i!==f&&(i&p)===0&&(p=f&-f,o=i&-i,p>=o||p===32&&(o&4194048)!==0)?i:f}function Fn(s,i){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&i)===0}function Gl(s,i){switch(s){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function go(){var s=Dt;return Dt<<=1,(Dt&62914560)===0&&(Dt=4194304),s}function us(s){for(var i=[],o=0;31>o;o++)i.push(s);return i}function Cr(s,i){s.pendingLanes|=i,i!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Kl(s,i,o,u,f,p){var b=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var T=s.entanglements,P=s.expirationTimes,Q=s.hiddenUpdates;for(o=b&~o;0<o;){var ee=31-At(o),ie=1<<ee;T[ee]=0,P[ee]=-1;var X=Q[ee];if(X!==null)for(Q[ee]=null,ee=0;ee<X.length;ee++){var Z=X[ee];Z!==null&&(Z.lane&=-536870913)}o&=~ie}u!==0&&Ws(s,u,0),p!==0&&f===0&&s.tag!==0&&(s.suspendedLanes|=p&~(b&~i))}function Ws(s,i,o){s.pendingLanes|=i,s.suspendedLanes&=~i;var u=31-At(i);s.entangledLanes|=i,s.entanglements[u]=s.entanglements[u]|1073741824|o&261930}function Ir(s,i){var o=s.entangledLanes|=i;for(s=s.entanglements;o;){var u=31-At(o),f=1<<u;f&i|s[u]&i&&(s[u]|=i),o&=~f}}function va(s,i){var o=i&-i;return o=(o&42)!==0?1:jr(o),(o&(s.suspendedLanes|i))!==0?0:o}function jr(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function z(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function pe(){var s=ce.p;return s!==0?s:(s=window.event,s===void 0?32:kb(s.type))}function Ie(s,i){var o=ce.p;try{return ce.p=s,i()}finally{ce.p=o}}var Le=Math.random().toString(36).slice(2),Ce="__reactFiber$"+Le,st="__reactProps$"+Le,lt="__reactContainer$"+Le,Cn="__reactEvents$"+Le,Rs="__reactListeners$"+Le,$u="__reactHandles$"+Le,Fu="__reactResources$"+Le,Js="__reactMarker$"+Le;function po(s){delete s[Ce],delete s[st],delete s[Cn],delete s[Rs],delete s[$u]}function Zs(s){var i=s[Ce];if(i)return i;for(var o=s.parentNode;o;){if(i=o[lt]||o[Ce]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(s=pb(s);s!==null;){if(o=s[Ce])return o;s=pb(s)}return i}s=o,o=s.parentNode}return null}function hs(s){if(s=s[Ce]||s[lt]){var i=s.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return s}return null}function Gn(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s.stateNode;throw Error(r(33))}function er(s){var i=s[Fu];return i||(i=s[Fu]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function Gt(s){s[Js]=!0}var Ql=new Set,Yl={};function tr(s,i){nr(s,i),nr(s+"Capture",i)}function nr(s,i){for(Yl[s]=i,s=0;s<i.length;s++)Ql.add(i[s])}var Xl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Wl={},Jl={};function Gu(s){return Ct.call(Jl,s)?!0:Ct.call(Wl,s)?!1:Xl.test(s)?Jl[s]=!0:(Wl[s]=!0,!1)}function yo(s,i,o){if(Gu(i))if(o===null)s.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(i);return;case"boolean":var u=i.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(i);return}}s.setAttribute(i,""+o)}}function Kn(s,i,o){if(o===null)s.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(i);return}s.setAttribute(i,""+o)}}function Kt(s,i,o,u){if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(i,o,""+u)}}function an(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function li(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Zl(s,i,o){var u=Object.getOwnPropertyDescriptor(s.constructor.prototype,i);if(!s.hasOwnProperty(i)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var f=u.get,p=u.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return f.call(this)},set:function(b){o=""+b,p.call(this,b)}}),Object.defineProperty(s,i,{enumerable:u.enumerable}),{getValue:function(){return o},setValue:function(b){o=""+b},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function ht(s){if(!s._valueTracker){var i=li(s)?"checked":"value";s._valueTracker=Zl(s,i,""+s[i])}}function _a(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var o=i.getValue(),u="";return s&&(u=li(s)?s.checked?"true":"false":s.value),s=u,s!==o?(i.setValue(s),!0):!1}function sr(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var ba=/[\n"\\]/g;function Dn(s){return s.replace(ba,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function vo(s,i,o,u,f,p,b,T){s.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?s.type=b:s.removeAttribute("type"),i!=null?b==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+an(i)):s.value!==""+an(i)&&(s.value=""+an(i)):b!=="submit"&&b!=="reset"||s.removeAttribute("value"),i!=null?ec(s,b,an(i)):o!=null?ec(s,b,an(o)):u!=null&&s.removeAttribute("value"),f==null&&p!=null&&(s.defaultChecked=!!p),f!=null&&(s.checked=f&&typeof f!="function"&&typeof f!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?s.name=""+an(T):s.removeAttribute("name")}function Ku(s,i,o,u,f,p,b,T){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(s.type=p),i!=null||o!=null){if(!(p!=="submit"&&p!=="reset"||i!=null)){ht(s);return}o=o!=null?""+an(o):"",i=i!=null?""+an(i):o,T||i===s.value||(s.value=i),s.defaultValue=i}u=u??f,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=T?s.checked:!!u,s.defaultChecked=!!u,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(s.name=b),ht(s)}function ec(s,i,o){i==="number"&&sr(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function ci(s,i,o,u){if(s=s.options,i){i={};for(var f=0;f<o.length;f++)i["$"+o[f]]=!0;for(o=0;o<s.length;o++)f=i.hasOwnProperty("$"+s[o].value),s[o].selected!==f&&(s[o].selected=f),f&&u&&(s[o].defaultSelected=!0)}else{for(o=""+an(o),i=null,f=0;f<s.length;f++){if(s[f].value===o){s[f].selected=!0,u&&(s[f].defaultSelected=!0);return}i!==null||s[f].disabled||(i=s[f])}i!==null&&(i.selected=!0)}}function Qu(s,i,o){if(i!=null&&(i=""+an(i),i!==s.value&&(s.value=i),o==null)){s.defaultValue!==i&&(s.defaultValue=i);return}s.defaultValue=o!=null?""+an(o):""}function ui(s,i,o,u){if(i==null){if(u!=null){if(o!=null)throw Error(r(92));if(et(u)){if(1<u.length)throw Error(r(93));u=u[0]}o=u}o==null&&(o=""),i=o}o=an(i),s.defaultValue=o,u=s.textContent,u===o&&u!==""&&u!==null&&(s.value=u),ht(s)}function Mn(s,i){if(i){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=i;return}}s.textContent=i}var Yu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function tc(s,i,o){var u=i.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="":u?s.setProperty(i,o):typeof o!="number"||o===0||Yu.has(i)?i==="float"?s.cssFloat=o:s[i]=(""+o).trim():s[i]=o+"px"}function nc(s,i,o){if(i!=null&&typeof i!="object")throw Error(r(62));if(s=s.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||i!=null&&i.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var f in i)u=i[f],i.hasOwnProperty(f)&&o[f]!==u&&tc(s,f,u)}else for(var p in i)i.hasOwnProperty(p)&&tc(s,p,i[p])}function _o(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function bo(s){return hi.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Cs(){}var sc=null;function ds(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var di=null,rr=null;function wa(s){var i=hs(s);if(i&&(s=i.stateNode)){var o=s[st]||null;e:switch(s=i.stateNode,i.type){case"input":if(vo(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),i=o.name,o.type==="radio"&&i!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Dn(""+i)+'"][type="radio"]'),i=0;i<o.length;i++){var u=o[i];if(u!==s&&u.form===s.form){var f=u[st]||null;if(!f)throw Error(r(90));vo(u,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(i=0;i<o.length;i++)u=o[i],u.form===s.form&&_a(u)}break e;case"textarea":Qu(s,o.value,o.defaultValue);break e;case"select":i=o.value,i!=null&&ci(s,!!o.multiple,i,!1)}}}var wo=!1;function fi(s,i,o){if(wo)return s(i,o);wo=!0;try{var u=s(i);return u}finally{if(wo=!1,(di!==null||rr!==null)&&(Hh(),di&&(i=di,s=rr,rr=di=null,wa(i),s)))for(i=0;i<s.length;i++)wa(s[i])}}function Is(s,i){var o=s.stateNode;if(o===null)return null;var u=o[st]||null;if(u===null)return null;o=u[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(r(231,i,typeof o));return o}var fs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xa=!1;if(fs)try{var gt={};Object.defineProperty(gt,"passive",{get:function(){xa=!0}}),window.addEventListener("test",gt,gt),window.removeEventListener("test",gt,gt)}catch{xa=!1}var ir=null,rc=null,Ea=null;function ic(){if(Ea)return Ea;var s,i=rc,o=i.length,u,f="value"in ir?ir.value:ir.textContent,p=f.length;for(s=0;s<o&&i[s]===f[s];s++);var b=o-s;for(u=1;u<=b&&i[o-u]===f[p-u];u++);return Ea=f.slice(s,1<u?1-u:void 0)}function Ta(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function kr(){return!0}function js(){return!1}function fn(s){function i(o,u,f,p,b){this._reactName=o,this._targetInst=f,this.type=u,this.nativeEvent=p,this.target=b,this.currentTarget=null;for(var T in s)s.hasOwnProperty(T)&&(o=s[T],this[T]=o?o(p):p[T]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?kr:js,this.isPropagationStopped=js,this}return w(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=kr)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=kr)},persist:function(){},isPersistent:kr}),i}var Or={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ar=fn(Or),mi=w({},Or,{view:0,detail:0}),ac=fn(mi),gi,xo,or,Eo=w({},mi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pi,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==or&&(or&&s.type==="mousemove"?(gi=s.screenX-or.screenX,xo=s.screenY-or.screenY):xo=gi=0,or=s),gi)},movementY:function(s){return"movementY"in s?s.movementY:xo}}),oc=fn(Eo),Sa=w({},Eo,{dataTransfer:0}),Wu=fn(Sa),Ju=w({},mi,{relatedTarget:0}),Aa=fn(Ju),lc=w({},Or,{animationName:0,elapsedTime:0,pseudoElement:0}),Zu=fn(lc),To=w({},Or,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),eh=fn(To),th=w({},Or,{data:0}),lr=fn(th),nh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ih(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=rh[s])?!!i[s]:!1}function pi(){return ih}var In=w({},mi,{key:function(s){if(s.key){var i=nh[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Ta(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?sh[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pi,charCode:function(s){return s.type==="keypress"?Ta(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ta(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),ah=fn(In),oh=w({},Eo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Dr=fn(oh),d=w({},mi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pi}),v=fn(d),x=w({},Or,{propertyName:0,elapsedTime:0,pseudoElement:0}),A=fn(x),G=w({},Eo,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),J=fn(G),he=w({},Or,{newState:0,oldState:0}),Ue=fn(he),Lt=[9,13,27,32],at=fs&&"CompositionEvent"in window,Nt=null;fs&&"documentMode"in document&&(Nt=document.documentMode);var ms=fs&&"TextEvent"in window&&!Nt,cr=fs&&(!at||Nt&&8<Nt&&11>=Nt),ks=" ",Os=!1;function Na(s,i){switch(s){case"keyup":return Lt.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function So(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Ao=!1;function rS(s,i){switch(s){case"compositionend":return So(i);case"keypress":return i.which!==32?null:(Os=!0,ks);case"textInput":return s=i.data,s===ks&&Os?null:s;default:return null}}function iS(s,i){if(Ao)return s==="compositionend"||!at&&Na(s,i)?(s=ic(),Ea=rc=ir=null,Ao=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return cr&&i.locale!=="ko"?null:i.data;default:return null}}var aS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _y(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!aS[s.type]:i==="textarea"}function by(s,i,o,u){di?rr?rr.push(u):rr=[u]:di=u,i=Xh(i,"onChange"),0<i.length&&(o=new ar("onChange","change",null,o,u),s.push({event:o,listeners:i}))}var cc=null,uc=null;function oS(s){nb(s,0)}function lh(s){var i=Gn(s);if(_a(i))return s}function wy(s,i){if(s==="change")return i}var xy=!1;if(fs){var Zf;if(fs){var em="oninput"in document;if(!em){var Ey=document.createElement("div");Ey.setAttribute("oninput","return;"),em=typeof Ey.oninput=="function"}Zf=em}else Zf=!1;xy=Zf&&(!document.documentMode||9<document.documentMode)}function Ty(){cc&&(cc.detachEvent("onpropertychange",Sy),uc=cc=null)}function Sy(s){if(s.propertyName==="value"&&lh(uc)){var i=[];by(i,uc,s,ds(s)),fi(oS,i)}}function lS(s,i,o){s==="focusin"?(Ty(),cc=i,uc=o,cc.attachEvent("onpropertychange",Sy)):s==="focusout"&&Ty()}function cS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return lh(uc)}function uS(s,i){if(s==="click")return lh(i)}function hS(s,i){if(s==="input"||s==="change")return lh(i)}function dS(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Qn=typeof Object.is=="function"?Object.is:dS;function hc(s,i){if(Qn(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var o=Object.keys(s),u=Object.keys(i);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var f=o[u];if(!Ct.call(i,f)||!Qn(s[f],i[f]))return!1}return!0}function Ay(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Ny(s,i){var o=Ay(s);s=0;for(var u;o;){if(o.nodeType===3){if(u=s+o.textContent.length,s<=i&&u>=i)return{node:o,offset:i-s};s=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Ay(o)}}function Ry(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?Ry(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function Cy(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var i=sr(s.document);i instanceof s.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)s=i.contentWindow;else break;i=sr(s.document)}return i}function tm(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}var fS=fs&&"documentMode"in document&&11>=document.documentMode,No=null,nm=null,dc=null,sm=!1;function Iy(s,i,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;sm||No==null||No!==sr(u)||(u=No,"selectionStart"in u&&tm(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),dc&&hc(dc,u)||(dc=u,u=Xh(nm,"onSelect"),0<u.length&&(i=new ar("onSelect","select",null,i,o),s.push({event:i,listeners:u}),i.target=No)))}function Ra(s,i){var o={};return o[s.toLowerCase()]=i.toLowerCase(),o["Webkit"+s]="webkit"+i,o["Moz"+s]="moz"+i,o}var Ro={animationend:Ra("Animation","AnimationEnd"),animationiteration:Ra("Animation","AnimationIteration"),animationstart:Ra("Animation","AnimationStart"),transitionrun:Ra("Transition","TransitionRun"),transitionstart:Ra("Transition","TransitionStart"),transitioncancel:Ra("Transition","TransitionCancel"),transitionend:Ra("Transition","TransitionEnd")},rm={},jy={};fs&&(jy=document.createElement("div").style,"AnimationEvent"in window||(delete Ro.animationend.animation,delete Ro.animationiteration.animation,delete Ro.animationstart.animation),"TransitionEvent"in window||delete Ro.transitionend.transition);function Ca(s){if(rm[s])return rm[s];if(!Ro[s])return s;var i=Ro[s],o;for(o in i)if(i.hasOwnProperty(o)&&o in jy)return rm[s]=i[o];return s}var ky=Ca("animationend"),Oy=Ca("animationiteration"),Dy=Ca("animationstart"),mS=Ca("transitionrun"),gS=Ca("transitionstart"),pS=Ca("transitioncancel"),My=Ca("transitionend"),Py=new Map,im="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");im.push("scrollEnd");function Ds(s,i){Py.set(s,i),tr(i,[s])}var ch=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},gs=[],Co=0,am=0;function uh(){for(var s=Co,i=am=Co=0;i<s;){var o=gs[i];gs[i++]=null;var u=gs[i];gs[i++]=null;var f=gs[i];gs[i++]=null;var p=gs[i];if(gs[i++]=null,u!==null&&f!==null){var b=u.pending;b===null?f.next=f:(f.next=b.next,b.next=f),u.pending=f}p!==0&&Vy(o,f,p)}}function hh(s,i,o,u){gs[Co++]=s,gs[Co++]=i,gs[Co++]=o,gs[Co++]=u,am|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function om(s,i,o,u){return hh(s,i,o,u),dh(s)}function Ia(s,i){return hh(s,null,null,i),dh(s)}function Vy(s,i,o){s.lanes|=o;var u=s.alternate;u!==null&&(u.lanes|=o);for(var f=!1,p=s.return;p!==null;)p.childLanes|=o,u=p.alternate,u!==null&&(u.childLanes|=o),p.tag===22&&(s=p.stateNode,s===null||s._visibility&1||(f=!0)),s=p,p=p.return;return s.tag===3?(p=s.stateNode,f&&i!==null&&(f=31-At(o),s=p.hiddenUpdates,u=s[f],u===null?s[f]=[i]:u.push(i),i.lane=o|536870912),p):null}function dh(s){if(50<Dc)throw Dc=0,pg=null,Error(r(185));for(var i=s.return;i!==null;)s=i,i=s.return;return s.tag===3?s.stateNode:null}var Io={};function yS(s,i,o,u){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yn(s,i,o,u){return new yS(s,i,o,u)}function lm(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Mr(s,i){var o=s.alternate;return o===null?(o=Yn(s.tag,i,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=i,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,i=s.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function Ly(s,i){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,i=o.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),s}function fh(s,i,o,u,f,p){var b=0;if(u=s,typeof s=="function")lm(s)&&(b=1);else if(typeof s=="string")b=xA(s,o,oe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case j:return s=Yn(31,o,i,f),s.elementType=j,s.lanes=p,s;case M:return ja(o.children,f,p,i);case k:b=8,f|=24;break;case V:return s=Yn(12,o,i,f|2),s.elementType=V,s.lanes=p,s;case ue:return s=Yn(13,o,i,f),s.elementType=ue,s.lanes=p,s;case le:return s=Yn(19,o,i,f),s.elementType=le,s.lanes=p,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case $:b=10;break e;case F:b=9;break e;case te:b=11;break e;case I:b=14;break e;case C:b=16,u=null;break e}b=29,o=Error(r(130,s===null?"null":typeof s,"")),u=null}return i=Yn(b,o,i,f),i.elementType=s,i.type=u,i.lanes=p,i}function ja(s,i,o,u){return s=Yn(7,s,u,i),s.lanes=o,s}function cm(s,i,o){return s=Yn(6,s,null,i),s.lanes=o,s}function Uy(s){var i=Yn(18,null,null,0);return i.stateNode=s,i}function um(s,i,o){return i=Yn(4,s.children!==null?s.children:[],s.key,i),i.lanes=o,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}var zy=new WeakMap;function ps(s,i){if(typeof s=="object"&&s!==null){var o=zy.get(s);return o!==void 0?o:(i={value:s,source:i,stack:oi(i)},zy.set(s,i),i)}return{value:s,source:i,stack:oi(i)}}var jo=[],ko=0,mh=null,fc=0,ys=[],vs=0,yi=null,ur=1,hr="";function Pr(s,i){jo[ko++]=fc,jo[ko++]=mh,mh=s,fc=i}function By(s,i,o){ys[vs++]=ur,ys[vs++]=hr,ys[vs++]=yi,yi=s;var u=ur;s=hr;var f=32-At(u)-1;u&=~(1<<f),o+=1;var p=32-At(i)+f;if(30<p){var b=f-f%5;p=(u&(1<<b)-1).toString(32),u>>=b,f-=b,ur=1<<32-At(i)+f|o<<f|u,hr=p+s}else ur=1<<p|o<<f|u,hr=s}function hm(s){s.return!==null&&(Pr(s,1),By(s,1,0))}function dm(s){for(;s===mh;)mh=jo[--ko],jo[ko]=null,fc=jo[--ko],jo[ko]=null;for(;s===yi;)yi=ys[--vs],ys[vs]=null,hr=ys[--vs],ys[vs]=null,ur=ys[--vs],ys[vs]=null}function qy(s,i){ys[vs++]=ur,ys[vs++]=hr,ys[vs++]=yi,ur=i.id,hr=i.overflow,yi=s}var mn=null,Tt=null,We=!1,vi=null,_s=!1,fm=Error(r(519));function _i(s){var i=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw mc(ps(i,s)),fm}function Hy(s){var i=s.stateNode,o=s.type,u=s.memoizedProps;switch(i[Ce]=s,i[st]=u,o){case"dialog":$e("cancel",i),$e("close",i);break;case"iframe":case"object":case"embed":$e("load",i);break;case"video":case"audio":for(o=0;o<Pc.length;o++)$e(Pc[o],i);break;case"source":$e("error",i);break;case"img":case"image":case"link":$e("error",i),$e("load",i);break;case"details":$e("toggle",i);break;case"input":$e("invalid",i),Ku(i,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":$e("invalid",i);break;case"textarea":$e("invalid",i),ui(i,u.value,u.defaultValue,u.children)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||i.textContent===""+o||u.suppressHydrationWarning===!0||ab(i.textContent,o)?(u.popover!=null&&($e("beforetoggle",i),$e("toggle",i)),u.onScroll!=null&&$e("scroll",i),u.onScrollEnd!=null&&$e("scrollend",i),u.onClick!=null&&(i.onclick=Cs),i=!0):i=!1,i||_i(s,!0)}function $y(s){for(mn=s.return;mn;)switch(mn.tag){case 5:case 31:case 13:_s=!1;return;case 27:case 3:_s=!0;return;default:mn=mn.return}}function Oo(s){if(s!==mn)return!1;if(!We)return $y(s),We=!0,!1;var i=s.tag,o;if((o=i!==3&&i!==27)&&((o=i===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||jg(s.type,s.memoizedProps)),o=!o),o&&Tt&&_i(s),$y(s),i===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Tt=gb(s)}else if(i===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Tt=gb(s)}else i===27?(i=Tt,Oi(s.type)?(s=Pg,Pg=null,Tt=s):Tt=i):Tt=mn?ws(s.stateNode.nextSibling):null;return!0}function ka(){Tt=mn=null,We=!1}function mm(){var s=vi;return s!==null&&(Un===null?Un=s:Un.push.apply(Un,s),vi=null),s}function mc(s){vi===null?vi=[s]:vi.push(s)}var gm=U(null),Oa=null,Vr=null;function bi(s,i,o){W(gm,i._currentValue),i._currentValue=o}function Lr(s){s._currentValue=gm.current,ne(gm)}function pm(s,i,o){for(;s!==null;){var u=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,u!==null&&(u.childLanes|=i)):u!==null&&(u.childLanes&i)!==i&&(u.childLanes|=i),s===o)break;s=s.return}}function ym(s,i,o,u){var f=s.child;for(f!==null&&(f.return=s);f!==null;){var p=f.dependencies;if(p!==null){var b=f.child;p=p.firstContext;e:for(;p!==null;){var T=p;p=f;for(var P=0;P<i.length;P++)if(T.context===i[P]){p.lanes|=o,T=p.alternate,T!==null&&(T.lanes|=o),pm(p.return,o,s),u||(b=null);break e}p=T.next}}else if(f.tag===18){if(b=f.return,b===null)throw Error(r(341));b.lanes|=o,p=b.alternate,p!==null&&(p.lanes|=o),pm(b,o,s),b=null}else b=f.child;if(b!==null)b.return=f;else for(b=f;b!==null;){if(b===s){b=null;break}if(f=b.sibling,f!==null){f.return=b.return,b=f;break}b=b.return}f=b}}function Do(s,i,o,u){s=null;for(var f=i,p=!1;f!==null;){if(!p){if((f.flags&524288)!==0)p=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var b=f.alternate;if(b===null)throw Error(r(387));if(b=b.memoizedProps,b!==null){var T=f.type;Qn(f.pendingProps.value,b.value)||(s!==null?s.push(T):s=[T])}}else if(f===Me.current){if(b=f.alternate,b===null)throw Error(r(387));b.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(s!==null?s.push(Bc):s=[Bc])}f=f.return}s!==null&&ym(i,s,o,u),i.flags|=262144}function gh(s){for(s=s.firstContext;s!==null;){if(!Qn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Da(s){Oa=s,Vr=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function gn(s){return Fy(Oa,s)}function ph(s,i){return Oa===null&&Da(s),Fy(s,i)}function Fy(s,i){var o=i._currentValue;if(i={context:i,memoizedValue:o,next:null},Vr===null){if(s===null)throw Error(r(308));Vr=i,s.dependencies={lanes:0,firstContext:i},s.flags|=524288}else Vr=Vr.next=i;return o}var vS=typeof AbortController<"u"?AbortController:function(){var s=[],i=this.signal={aborted:!1,addEventListener:function(o,u){s.push(u)}};this.abort=function(){i.aborted=!0,s.forEach(function(o){return o()})}},_S=n.unstable_scheduleCallback,bS=n.unstable_NormalPriority,Qt={$$typeof:$,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function vm(){return{controller:new vS,data:new Map,refCount:0}}function gc(s){s.refCount--,s.refCount===0&&_S(bS,function(){s.controller.abort()})}var pc=null,_m=0,Mo=0,Po=null;function wS(s,i){if(pc===null){var o=pc=[];_m=0,Mo=xg(),Po={status:"pending",value:void 0,then:function(u){o.push(u)}}}return _m++,i.then(Gy,Gy),i}function Gy(){if(--_m===0&&pc!==null){Po!==null&&(Po.status="fulfilled");var s=pc;pc=null,Mo=0,Po=null;for(var i=0;i<s.length;i++)(0,s[i])()}}function xS(s,i){var o=[],u={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return s.then(function(){u.status="fulfilled",u.value=i;for(var f=0;f<o.length;f++)(0,o[f])(i)},function(f){for(u.status="rejected",u.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),u}var Ky=q.S;q.S=function(s,i){I_=dn(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&wS(s,i),Ky!==null&&Ky(s,i)};var Ma=U(null);function bm(){var s=Ma.current;return s!==null?s:bt.pooledCache}function yh(s,i){i===null?W(Ma,Ma.current):W(Ma,i.pool)}function Qy(){var s=bm();return s===null?null:{parent:Qt._currentValue,pool:s}}var Vo=Error(r(460)),wm=Error(r(474)),vh=Error(r(542)),_h={then:function(){}};function Yy(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Xy(s,i,o){switch(o=s[o],o===void 0?s.push(i):o!==i&&(i.then(Cs,Cs),i=o),i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,Jy(s),s;default:if(typeof i.status=="string")i.then(Cs,Cs);else{if(s=bt,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=i,s.status="pending",s.then(function(u){if(i.status==="pending"){var f=i;f.status="fulfilled",f.value=u}},function(u){if(i.status==="pending"){var f=i;f.status="rejected",f.reason=u}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,Jy(s),s}throw Va=i,Vo}}function Pa(s){try{var i=s._init;return i(s._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Va=o,Vo):o}}var Va=null;function Wy(){if(Va===null)throw Error(r(459));var s=Va;return Va=null,s}function Jy(s){if(s===Vo||s===vh)throw Error(r(483))}var Lo=null,yc=0;function bh(s){var i=yc;return yc+=1,Lo===null&&(Lo=[]),Xy(Lo,s,i)}function vc(s,i){i=i.props.ref,s.ref=i!==void 0?i:null}function wh(s,i){throw i.$$typeof===E?Error(r(525)):(s=Object.prototype.toString.call(i),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)))}function Zy(s){function i(H,B){if(s){var K=H.deletions;K===null?(H.deletions=[B],H.flags|=16):K.push(B)}}function o(H,B){if(!s)return null;for(;B!==null;)i(H,B),B=B.sibling;return null}function u(H){for(var B=new Map;H!==null;)H.key!==null?B.set(H.key,H):B.set(H.index,H),H=H.sibling;return B}function f(H,B){return H=Mr(H,B),H.index=0,H.sibling=null,H}function p(H,B,K){return H.index=K,s?(K=H.alternate,K!==null?(K=K.index,K<B?(H.flags|=67108866,B):K):(H.flags|=67108866,B)):(H.flags|=1048576,B)}function b(H){return s&&H.alternate===null&&(H.flags|=67108866),H}function T(H,B,K,se){return B===null||B.tag!==6?(B=cm(K,H.mode,se),B.return=H,B):(B=f(B,K),B.return=H,B)}function P(H,B,K,se){var Ee=K.type;return Ee===M?ee(H,B,K.props.children,se,K.key):B!==null&&(B.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===C&&Pa(Ee)===B.type)?(B=f(B,K.props),vc(B,K),B.return=H,B):(B=fh(K.type,K.key,K.props,null,H.mode,se),vc(B,K),B.return=H,B)}function Q(H,B,K,se){return B===null||B.tag!==4||B.stateNode.containerInfo!==K.containerInfo||B.stateNode.implementation!==K.implementation?(B=um(K,H.mode,se),B.return=H,B):(B=f(B,K.children||[]),B.return=H,B)}function ee(H,B,K,se,Ee){return B===null||B.tag!==7?(B=ja(K,H.mode,se,Ee),B.return=H,B):(B=f(B,K),B.return=H,B)}function ie(H,B,K){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=cm(""+B,H.mode,K),B.return=H,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case S:return K=fh(B.type,B.key,B.props,null,H.mode,K),vc(K,B),K.return=H,K;case N:return B=um(B,H.mode,K),B.return=H,B;case C:return B=Pa(B),ie(H,B,K)}if(et(B)||L(B))return B=ja(B,H.mode,K,null),B.return=H,B;if(typeof B.then=="function")return ie(H,bh(B),K);if(B.$$typeof===$)return ie(H,ph(H,B),K);wh(H,B)}return null}function X(H,B,K,se){var Ee=B!==null?B.key:null;if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return Ee!==null?null:T(H,B,""+K,se);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case S:return K.key===Ee?P(H,B,K,se):null;case N:return K.key===Ee?Q(H,B,K,se):null;case C:return K=Pa(K),X(H,B,K,se)}if(et(K)||L(K))return Ee!==null?null:ee(H,B,K,se,null);if(typeof K.then=="function")return X(H,B,bh(K),se);if(K.$$typeof===$)return X(H,B,ph(H,K),se);wh(H,K)}return null}function Z(H,B,K,se,Ee){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return H=H.get(K)||null,T(B,H,""+se,Ee);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case S:return H=H.get(se.key===null?K:se.key)||null,P(B,H,se,Ee);case N:return H=H.get(se.key===null?K:se.key)||null,Q(B,H,se,Ee);case C:return se=Pa(se),Z(H,B,K,se,Ee)}if(et(se)||L(se))return H=H.get(K)||null,ee(B,H,se,Ee,null);if(typeof se.then=="function")return Z(H,B,K,bh(se),Ee);if(se.$$typeof===$)return Z(H,B,K,ph(B,se),Ee);wh(B,se)}return null}function ye(H,B,K,se){for(var Ee=null,rt=null,be=B,Be=B=0,Ke=null;be!==null&&Be<K.length;Be++){be.index>Be?(Ke=be,be=null):Ke=be.sibling;var it=X(H,be,K[Be],se);if(it===null){be===null&&(be=Ke);break}s&&be&&it.alternate===null&&i(H,be),B=p(it,B,Be),rt===null?Ee=it:rt.sibling=it,rt=it,be=Ke}if(Be===K.length)return o(H,be),We&&Pr(H,Be),Ee;if(be===null){for(;Be<K.length;Be++)be=ie(H,K[Be],se),be!==null&&(B=p(be,B,Be),rt===null?Ee=be:rt.sibling=be,rt=be);return We&&Pr(H,Be),Ee}for(be=u(be);Be<K.length;Be++)Ke=Z(be,H,Be,K[Be],se),Ke!==null&&(s&&Ke.alternate!==null&&be.delete(Ke.key===null?Be:Ke.key),B=p(Ke,B,Be),rt===null?Ee=Ke:rt.sibling=Ke,rt=Ke);return s&&be.forEach(function(Li){return i(H,Li)}),We&&Pr(H,Be),Ee}function Se(H,B,K,se){if(K==null)throw Error(r(151));for(var Ee=null,rt=null,be=B,Be=B=0,Ke=null,it=K.next();be!==null&&!it.done;Be++,it=K.next()){be.index>Be?(Ke=be,be=null):Ke=be.sibling;var Li=X(H,be,it.value,se);if(Li===null){be===null&&(be=Ke);break}s&&be&&Li.alternate===null&&i(H,be),B=p(Li,B,Be),rt===null?Ee=Li:rt.sibling=Li,rt=Li,be=Ke}if(it.done)return o(H,be),We&&Pr(H,Be),Ee;if(be===null){for(;!it.done;Be++,it=K.next())it=ie(H,it.value,se),it!==null&&(B=p(it,B,Be),rt===null?Ee=it:rt.sibling=it,rt=it);return We&&Pr(H,Be),Ee}for(be=u(be);!it.done;Be++,it=K.next())it=Z(be,H,Be,it.value,se),it!==null&&(s&&it.alternate!==null&&be.delete(it.key===null?Be:it.key),B=p(it,B,Be),rt===null?Ee=it:rt.sibling=it,rt=it);return s&&be.forEach(function(OA){return i(H,OA)}),We&&Pr(H,Be),Ee}function vt(H,B,K,se){if(typeof K=="object"&&K!==null&&K.type===M&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case S:e:{for(var Ee=K.key;B!==null;){if(B.key===Ee){if(Ee=K.type,Ee===M){if(B.tag===7){o(H,B.sibling),se=f(B,K.props.children),se.return=H,H=se;break e}}else if(B.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===C&&Pa(Ee)===B.type){o(H,B.sibling),se=f(B,K.props),vc(se,K),se.return=H,H=se;break e}o(H,B);break}else i(H,B);B=B.sibling}K.type===M?(se=ja(K.props.children,H.mode,se,K.key),se.return=H,H=se):(se=fh(K.type,K.key,K.props,null,H.mode,se),vc(se,K),se.return=H,H=se)}return b(H);case N:e:{for(Ee=K.key;B!==null;){if(B.key===Ee)if(B.tag===4&&B.stateNode.containerInfo===K.containerInfo&&B.stateNode.implementation===K.implementation){o(H,B.sibling),se=f(B,K.children||[]),se.return=H,H=se;break e}else{o(H,B);break}else i(H,B);B=B.sibling}se=um(K,H.mode,se),se.return=H,H=se}return b(H);case C:return K=Pa(K),vt(H,B,K,se)}if(et(K))return ye(H,B,K,se);if(L(K)){if(Ee=L(K),typeof Ee!="function")throw Error(r(150));return K=Ee.call(K),Se(H,B,K,se)}if(typeof K.then=="function")return vt(H,B,bh(K),se);if(K.$$typeof===$)return vt(H,B,ph(H,K),se);wh(H,K)}return typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint"?(K=""+K,B!==null&&B.tag===6?(o(H,B.sibling),se=f(B,K),se.return=H,H=se):(o(H,B),se=cm(K,H.mode,se),se.return=H,H=se),b(H)):o(H,B)}return function(H,B,K,se){try{yc=0;var Ee=vt(H,B,K,se);return Lo=null,Ee}catch(be){if(be===Vo||be===vh)throw be;var rt=Yn(29,be,null,H.mode);return rt.lanes=se,rt.return=H,rt}finally{}}}var La=Zy(!0),ev=Zy(!1),wi=!1;function xm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Em(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function xi(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ei(s,i,o){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(ot&2)!==0){var f=u.pending;return f===null?i.next=i:(i.next=f.next,f.next=i),u.pending=i,i=dh(s),Vy(s,null,o),i}return hh(s,u,i,o),dh(s)}function _c(s,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194048)!==0)){var u=i.lanes;u&=s.pendingLanes,o|=u,i.lanes=o,Ir(s,o)}}function Tm(s,i){var o=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var f=null,p=null;if(o=o.firstBaseUpdate,o!==null){do{var b={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};p===null?f=p=b:p=p.next=b,o=o.next}while(o!==null);p===null?f=p=i:p=p.next=i}else f=p=i;o={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:p,shared:u.shared,callbacks:u.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=i:s.next=i,o.lastBaseUpdate=i}var Sm=!1;function bc(){if(Sm){var s=Po;if(s!==null)throw s}}function wc(s,i,o,u){Sm=!1;var f=s.updateQueue;wi=!1;var p=f.firstBaseUpdate,b=f.lastBaseUpdate,T=f.shared.pending;if(T!==null){f.shared.pending=null;var P=T,Q=P.next;P.next=null,b===null?p=Q:b.next=Q,b=P;var ee=s.alternate;ee!==null&&(ee=ee.updateQueue,T=ee.lastBaseUpdate,T!==b&&(T===null?ee.firstBaseUpdate=Q:T.next=Q,ee.lastBaseUpdate=P))}if(p!==null){var ie=f.baseState;b=0,ee=Q=P=null,T=p;do{var X=T.lane&-536870913,Z=X!==T.lane;if(Z?(Ge&X)===X:(u&X)===X){X!==0&&X===Mo&&(Sm=!0),ee!==null&&(ee=ee.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});e:{var ye=s,Se=T;X=i;var vt=o;switch(Se.tag){case 1:if(ye=Se.payload,typeof ye=="function"){ie=ye.call(vt,ie,X);break e}ie=ye;break e;case 3:ye.flags=ye.flags&-65537|128;case 0:if(ye=Se.payload,X=typeof ye=="function"?ye.call(vt,ie,X):ye,X==null)break e;ie=w({},ie,X);break e;case 2:wi=!0}}X=T.callback,X!==null&&(s.flags|=64,Z&&(s.flags|=8192),Z=f.callbacks,Z===null?f.callbacks=[X]:Z.push(X))}else Z={lane:X,tag:T.tag,payload:T.payload,callback:T.callback,next:null},ee===null?(Q=ee=Z,P=ie):ee=ee.next=Z,b|=X;if(T=T.next,T===null){if(T=f.shared.pending,T===null)break;Z=T,T=Z.next,Z.next=null,f.lastBaseUpdate=Z,f.shared.pending=null}}while(!0);ee===null&&(P=ie),f.baseState=P,f.firstBaseUpdate=Q,f.lastBaseUpdate=ee,p===null&&(f.shared.lanes=0),Ri|=b,s.lanes=b,s.memoizedState=ie}}function tv(s,i){if(typeof s!="function")throw Error(r(191,s));s.call(i)}function nv(s,i){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)tv(o[s],i)}var Uo=U(null),xh=U(0);function sv(s,i){s=Kr,W(xh,s),W(Uo,i),Kr=s|i.baseLanes}function Am(){W(xh,Kr),W(Uo,Uo.current)}function Nm(){Kr=xh.current,ne(Uo),ne(xh)}var Xn=U(null),bs=null;function Ti(s){var i=s.alternate;W(Ut,Ut.current&1),W(Xn,s),bs===null&&(i===null||Uo.current!==null||i.memoizedState!==null)&&(bs=s)}function Rm(s){W(Ut,Ut.current),W(Xn,s),bs===null&&(bs=s)}function rv(s){s.tag===22?(W(Ut,Ut.current),W(Xn,s),bs===null&&(bs=s)):Si()}function Si(){W(Ut,Ut.current),W(Xn,Xn.current)}function Wn(s){ne(Xn),bs===s&&(bs=null),ne(Ut)}var Ut=U(0);function Eh(s){for(var i=s;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Dg(o)||Mg(o)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Ur=0,ze=null,pt=null,Yt=null,Th=!1,zo=!1,Ua=!1,Sh=0,xc=0,Bo=null,ES=0;function Mt(){throw Error(r(321))}function Cm(s,i){if(i===null)return!1;for(var o=0;o<i.length&&o<s.length;o++)if(!Qn(s[o],i[o]))return!1;return!0}function Im(s,i,o,u,f,p){return Ur=p,ze=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,q.H=s===null||s.memoizedState===null?Bv:Fm,Ua=!1,p=o(u,f),Ua=!1,zo&&(p=av(i,o,u,f)),iv(s),p}function iv(s){q.H=Sc;var i=pt!==null&&pt.next!==null;if(Ur=0,Yt=pt=ze=null,Th=!1,xc=0,Bo=null,i)throw Error(r(300));s===null||Xt||(s=s.dependencies,s!==null&&gh(s)&&(Xt=!0))}function av(s,i,o,u){ze=s;var f=0;do{if(zo&&(Bo=null),xc=0,zo=!1,25<=f)throw Error(r(301));if(f+=1,Yt=pt=null,s.updateQueue!=null){var p=s.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}q.H=qv,p=i(o,u)}while(zo);return p}function TS(){var s=q.H,i=s.useState()[0];return i=typeof i.then=="function"?Ec(i):i,s=s.useState()[0],(pt!==null?pt.memoizedState:null)!==s&&(ze.flags|=1024),i}function jm(){var s=Sh!==0;return Sh=0,s}function km(s,i,o){i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~o}function Om(s){if(Th){for(s=s.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}Th=!1}Ur=0,Yt=pt=ze=null,zo=!1,xc=Sh=0,Bo=null}function jn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yt===null?ze.memoizedState=Yt=s:Yt=Yt.next=s,Yt}function zt(){if(pt===null){var s=ze.alternate;s=s!==null?s.memoizedState:null}else s=pt.next;var i=Yt===null?ze.memoizedState:Yt.next;if(i!==null)Yt=i,pt=s;else{if(s===null)throw ze.alternate===null?Error(r(467)):Error(r(310));pt=s,s={memoizedState:pt.memoizedState,baseState:pt.baseState,baseQueue:pt.baseQueue,queue:pt.queue,next:null},Yt===null?ze.memoizedState=Yt=s:Yt=Yt.next=s}return Yt}function Ah(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ec(s){var i=xc;return xc+=1,Bo===null&&(Bo=[]),s=Xy(Bo,s,i),i=ze,(Yt===null?i.memoizedState:Yt.next)===null&&(i=i.alternate,q.H=i===null||i.memoizedState===null?Bv:Fm),s}function Nh(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Ec(s);if(s.$$typeof===$)return gn(s)}throw Error(r(438,String(s)))}function Dm(s){var i=null,o=ze.updateQueue;if(o!==null&&(i=o.memoCache),i==null){var u=ze.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(i={data:u.data.map(function(f){return f.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),o===null&&(o=Ah(),ze.updateQueue=o),o.memoCache=i,o=i.data[i.index],o===void 0)for(o=i.data[i.index]=Array(s),u=0;u<s;u++)o[u]=R;return i.index++,o}function zr(s,i){return typeof i=="function"?i(s):i}function Rh(s){var i=zt();return Mm(i,pt,s)}function Mm(s,i,o){var u=s.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=o;var f=s.baseQueue,p=u.pending;if(p!==null){if(f!==null){var b=f.next;f.next=p.next,p.next=b}i.baseQueue=f=p,u.pending=null}if(p=s.baseState,f===null)s.memoizedState=p;else{i=f.next;var T=b=null,P=null,Q=i,ee=!1;do{var ie=Q.lane&-536870913;if(ie!==Q.lane?(Ge&ie)===ie:(Ur&ie)===ie){var X=Q.revertLane;if(X===0)P!==null&&(P=P.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),ie===Mo&&(ee=!0);else if((Ur&X)===X){Q=Q.next,X===Mo&&(ee=!0);continue}else ie={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},P===null?(T=P=ie,b=p):P=P.next=ie,ze.lanes|=X,Ri|=X;ie=Q.action,Ua&&o(p,ie),p=Q.hasEagerState?Q.eagerState:o(p,ie)}else X={lane:ie,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},P===null?(T=P=X,b=p):P=P.next=X,ze.lanes|=ie,Ri|=ie;Q=Q.next}while(Q!==null&&Q!==i);if(P===null?b=p:P.next=T,!Qn(p,s.memoizedState)&&(Xt=!0,ee&&(o=Po,o!==null)))throw o;s.memoizedState=p,s.baseState=b,s.baseQueue=P,u.lastRenderedState=p}return f===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function Pm(s){var i=zt(),o=i.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=s;var u=o.dispatch,f=o.pending,p=i.memoizedState;if(f!==null){o.pending=null;var b=f=f.next;do p=s(p,b.action),b=b.next;while(b!==f);Qn(p,i.memoizedState)||(Xt=!0),i.memoizedState=p,i.baseQueue===null&&(i.baseState=p),o.lastRenderedState=p}return[p,u]}function ov(s,i,o){var u=ze,f=zt(),p=We;if(p){if(o===void 0)throw Error(r(407));o=o()}else o=i();var b=!Qn((pt||f).memoizedState,o);if(b&&(f.memoizedState=o,Xt=!0),f=f.queue,Um(uv.bind(null,u,f,s),[s]),f.getSnapshot!==i||b||Yt!==null&&Yt.memoizedState.tag&1){if(u.flags|=2048,qo(9,{destroy:void 0},cv.bind(null,u,f,o,i),null),bt===null)throw Error(r(349));p||(Ur&127)!==0||lv(u,i,o)}return o}function lv(s,i,o){s.flags|=16384,s={getSnapshot:i,value:o},i=ze.updateQueue,i===null?(i=Ah(),ze.updateQueue=i,i.stores=[s]):(o=i.stores,o===null?i.stores=[s]:o.push(s))}function cv(s,i,o,u){i.value=o,i.getSnapshot=u,hv(i)&&dv(s)}function uv(s,i,o){return o(function(){hv(i)&&dv(s)})}function hv(s){var i=s.getSnapshot;s=s.value;try{var o=i();return!Qn(s,o)}catch{return!0}}function dv(s){var i=Ia(s,2);i!==null&&zn(i,s,2)}function Vm(s){var i=jn();if(typeof s=="function"){var o=s;if(s=o(),Ua){On(!0);try{o()}finally{On(!1)}}}return i.memoizedState=i.baseState=s,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:zr,lastRenderedState:s},i}function fv(s,i,o,u){return s.baseState=o,Mm(s,pt,typeof u=="function"?u:zr)}function SS(s,i,o,u,f){if(jh(s))throw Error(r(485));if(s=i.action,s!==null){var p={payload:f,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){p.listeners.push(b)}};q.T!==null?o(!0):p.isTransition=!1,u(p),o=i.pending,o===null?(p.next=i.pending=p,mv(i,p)):(p.next=o.next,i.pending=o.next=p)}}function mv(s,i){var o=i.action,u=i.payload,f=s.state;if(i.isTransition){var p=q.T,b={};q.T=b;try{var T=o(f,u),P=q.S;P!==null&&P(b,T),gv(s,i,T)}catch(Q){Lm(s,i,Q)}finally{p!==null&&b.types!==null&&(p.types=b.types),q.T=p}}else try{p=o(f,u),gv(s,i,p)}catch(Q){Lm(s,i,Q)}}function gv(s,i,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){pv(s,i,u)},function(u){return Lm(s,i,u)}):pv(s,i,o)}function pv(s,i,o){i.status="fulfilled",i.value=o,yv(i),s.state=o,i=s.pending,i!==null&&(o=i.next,o===i?s.pending=null:(o=o.next,i.next=o,mv(s,o)))}function Lm(s,i,o){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do i.status="rejected",i.reason=o,yv(i),i=i.next;while(i!==u)}s.action=null}function yv(s){s=s.listeners;for(var i=0;i<s.length;i++)(0,s[i])()}function vv(s,i){return i}function _v(s,i){if(We){var o=bt.formState;if(o!==null){e:{var u=ze;if(We){if(Tt){t:{for(var f=Tt,p=_s;f.nodeType!==8;){if(!p){f=null;break t}if(f=ws(f.nextSibling),f===null){f=null;break t}}p=f.data,f=p==="F!"||p==="F"?f:null}if(f){Tt=ws(f.nextSibling),u=f.data==="F!";break e}}_i(u)}u=!1}u&&(i=o[0])}}return o=jn(),o.memoizedState=o.baseState=i,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vv,lastRenderedState:i},o.queue=u,o=Lv.bind(null,ze,u),u.dispatch=o,u=Vm(!1),p=$m.bind(null,ze,!1,u.queue),u=jn(),f={state:i,dispatch:null,action:s,pending:null},u.queue=f,o=SS.bind(null,ze,f,p,o),f.dispatch=o,u.memoizedState=s,[i,o,!1]}function bv(s){var i=zt();return wv(i,pt,s)}function wv(s,i,o){if(i=Mm(s,i,vv)[0],s=Rh(zr)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var u=Ec(i)}catch(b){throw b===Vo?vh:b}else u=i;i=zt();var f=i.queue,p=f.dispatch;return o!==i.memoizedState&&(ze.flags|=2048,qo(9,{destroy:void 0},AS.bind(null,f,o),null)),[u,p,s]}function AS(s,i){s.action=i}function xv(s){var i=zt(),o=pt;if(o!==null)return wv(i,o,s);zt(),i=i.memoizedState,o=zt();var u=o.queue.dispatch;return o.memoizedState=s,[i,u,!1]}function qo(s,i,o,u){return s={tag:s,create:o,deps:u,inst:i,next:null},i=ze.updateQueue,i===null&&(i=Ah(),ze.updateQueue=i),o=i.lastEffect,o===null?i.lastEffect=s.next=s:(u=o.next,o.next=s,s.next=u,i.lastEffect=s),s}function Ev(){return zt().memoizedState}function Ch(s,i,o,u){var f=jn();ze.flags|=s,f.memoizedState=qo(1|i,{destroy:void 0},o,u===void 0?null:u)}function Ih(s,i,o,u){var f=zt();u=u===void 0?null:u;var p=f.memoizedState.inst;pt!==null&&u!==null&&Cm(u,pt.memoizedState.deps)?f.memoizedState=qo(i,p,o,u):(ze.flags|=s,f.memoizedState=qo(1|i,p,o,u))}function Tv(s,i){Ch(8390656,8,s,i)}function Um(s,i){Ih(2048,8,s,i)}function NS(s){ze.flags|=4;var i=ze.updateQueue;if(i===null)i=Ah(),ze.updateQueue=i,i.events=[s];else{var o=i.events;o===null?i.events=[s]:o.push(s)}}function Sv(s){var i=zt().memoizedState;return NS({ref:i,nextImpl:s}),function(){if((ot&2)!==0)throw Error(r(440));return i.impl.apply(void 0,arguments)}}function Av(s,i){return Ih(4,2,s,i)}function Nv(s,i){return Ih(4,4,s,i)}function Rv(s,i){if(typeof i=="function"){s=s();var o=i(s);return function(){typeof o=="function"?o():i(null)}}if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function Cv(s,i,o){o=o!=null?o.concat([s]):null,Ih(4,4,Rv.bind(null,i,s),o)}function zm(){}function Iv(s,i){var o=zt();i=i===void 0?null:i;var u=o.memoizedState;return i!==null&&Cm(i,u[1])?u[0]:(o.memoizedState=[s,i],s)}function jv(s,i){var o=zt();i=i===void 0?null:i;var u=o.memoizedState;if(i!==null&&Cm(i,u[1]))return u[0];if(u=s(),Ua){On(!0);try{s()}finally{On(!1)}}return o.memoizedState=[u,i],u}function Bm(s,i,o){return o===void 0||(Ur&1073741824)!==0&&(Ge&261930)===0?s.memoizedState=i:(s.memoizedState=o,s=k_(),ze.lanes|=s,Ri|=s,o)}function kv(s,i,o,u){return Qn(o,i)?o:Uo.current!==null?(s=Bm(s,o,u),Qn(s,i)||(Xt=!0),s):(Ur&42)===0||(Ur&1073741824)!==0&&(Ge&261930)===0?(Xt=!0,s.memoizedState=o):(s=k_(),ze.lanes|=s,Ri|=s,i)}function Ov(s,i,o,u,f){var p=ce.p;ce.p=p!==0&&8>p?p:8;var b=q.T,T={};q.T=T,$m(s,!1,i,o);try{var P=f(),Q=q.S;if(Q!==null&&Q(T,P),P!==null&&typeof P=="object"&&typeof P.then=="function"){var ee=xS(P,u);Tc(s,i,ee,es(s))}else Tc(s,i,u,es(s))}catch(ie){Tc(s,i,{then:function(){},status:"rejected",reason:ie},es())}finally{ce.p=p,b!==null&&T.types!==null&&(b.types=T.types),q.T=b}}function RS(){}function qm(s,i,o,u){if(s.tag!==5)throw Error(r(476));var f=Dv(s).queue;Ov(s,f,i,_e,o===null?RS:function(){return Mv(s),o(u)})}function Dv(s){var i=s.memoizedState;if(i!==null)return i;i={memoizedState:_e,baseState:_e,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zr,lastRenderedState:_e},next:null};var o={};return i.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zr,lastRenderedState:o},next:null},s.memoizedState=i,s=s.alternate,s!==null&&(s.memoizedState=i),i}function Mv(s){var i=Dv(s);i.next===null&&(i=s.alternate.memoizedState),Tc(s,i.next.queue,{},es())}function Hm(){return gn(Bc)}function Pv(){return zt().memoizedState}function Vv(){return zt().memoizedState}function CS(s){for(var i=s.return;i!==null;){switch(i.tag){case 24:case 3:var o=es();s=xi(o);var u=Ei(i,s,o);u!==null&&(zn(u,i,o),_c(u,i,o)),i={cache:vm()},s.payload=i;return}i=i.return}}function IS(s,i,o){var u=es();o={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},jh(s)?Uv(i,o):(o=om(s,i,o,u),o!==null&&(zn(o,s,u),zv(o,i,u)))}function Lv(s,i,o){var u=es();Tc(s,i,o,u)}function Tc(s,i,o,u){var f={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(jh(s))Uv(i,f);else{var p=s.alternate;if(s.lanes===0&&(p===null||p.lanes===0)&&(p=i.lastRenderedReducer,p!==null))try{var b=i.lastRenderedState,T=p(b,o);if(f.hasEagerState=!0,f.eagerState=T,Qn(T,b))return hh(s,i,f,0),bt===null&&uh(),!1}catch{}finally{}if(o=om(s,i,f,u),o!==null)return zn(o,s,u),zv(o,i,u),!0}return!1}function $m(s,i,o,u){if(u={lane:2,revertLane:xg(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},jh(s)){if(i)throw Error(r(479))}else i=om(s,o,u,2),i!==null&&zn(i,s,2)}function jh(s){var i=s.alternate;return s===ze||i!==null&&i===ze}function Uv(s,i){zo=Th=!0;var o=s.pending;o===null?i.next=i:(i.next=o.next,o.next=i),s.pending=i}function zv(s,i,o){if((o&4194048)!==0){var u=i.lanes;u&=s.pendingLanes,o|=u,i.lanes=o,Ir(s,o)}}var Sc={readContext:gn,use:Nh,useCallback:Mt,useContext:Mt,useEffect:Mt,useImperativeHandle:Mt,useLayoutEffect:Mt,useInsertionEffect:Mt,useMemo:Mt,useReducer:Mt,useRef:Mt,useState:Mt,useDebugValue:Mt,useDeferredValue:Mt,useTransition:Mt,useSyncExternalStore:Mt,useId:Mt,useHostTransitionStatus:Mt,useFormState:Mt,useActionState:Mt,useOptimistic:Mt,useMemoCache:Mt,useCacheRefresh:Mt};Sc.useEffectEvent=Mt;var Bv={readContext:gn,use:Nh,useCallback:function(s,i){return jn().memoizedState=[s,i===void 0?null:i],s},useContext:gn,useEffect:Tv,useImperativeHandle:function(s,i,o){o=o!=null?o.concat([s]):null,Ch(4194308,4,Rv.bind(null,i,s),o)},useLayoutEffect:function(s,i){return Ch(4194308,4,s,i)},useInsertionEffect:function(s,i){Ch(4,2,s,i)},useMemo:function(s,i){var o=jn();i=i===void 0?null:i;var u=s();if(Ua){On(!0);try{s()}finally{On(!1)}}return o.memoizedState=[u,i],u},useReducer:function(s,i,o){var u=jn();if(o!==void 0){var f=o(i);if(Ua){On(!0);try{o(i)}finally{On(!1)}}}else f=i;return u.memoizedState=u.baseState=f,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:f},u.queue=s,s=s.dispatch=IS.bind(null,ze,s),[u.memoizedState,s]},useRef:function(s){var i=jn();return s={current:s},i.memoizedState=s},useState:function(s){s=Vm(s);var i=s.queue,o=Lv.bind(null,ze,i);return i.dispatch=o,[s.memoizedState,o]},useDebugValue:zm,useDeferredValue:function(s,i){var o=jn();return Bm(o,s,i)},useTransition:function(){var s=Vm(!1);return s=Ov.bind(null,ze,s.queue,!0,!1),jn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,i,o){var u=ze,f=jn();if(We){if(o===void 0)throw Error(r(407));o=o()}else{if(o=i(),bt===null)throw Error(r(349));(Ge&127)!==0||lv(u,i,o)}f.memoizedState=o;var p={value:o,getSnapshot:i};return f.queue=p,Tv(uv.bind(null,u,p,s),[s]),u.flags|=2048,qo(9,{destroy:void 0},cv.bind(null,u,p,o,i),null),o},useId:function(){var s=jn(),i=bt.identifierPrefix;if(We){var o=hr,u=ur;o=(u&~(1<<32-At(u)-1)).toString(32)+o,i="_"+i+"R_"+o,o=Sh++,0<o&&(i+="H"+o.toString(32)),i+="_"}else o=ES++,i="_"+i+"r_"+o.toString(32)+"_";return s.memoizedState=i},useHostTransitionStatus:Hm,useFormState:_v,useActionState:_v,useOptimistic:function(s){var i=jn();i.memoizedState=i.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=o,i=$m.bind(null,ze,!0,o),o.dispatch=i,[s,i]},useMemoCache:Dm,useCacheRefresh:function(){return jn().memoizedState=CS.bind(null,ze)},useEffectEvent:function(s){var i=jn(),o={impl:s};return i.memoizedState=o,function(){if((ot&2)!==0)throw Error(r(440));return o.impl.apply(void 0,arguments)}}},Fm={readContext:gn,use:Nh,useCallback:Iv,useContext:gn,useEffect:Um,useImperativeHandle:Cv,useInsertionEffect:Av,useLayoutEffect:Nv,useMemo:jv,useReducer:Rh,useRef:Ev,useState:function(){return Rh(zr)},useDebugValue:zm,useDeferredValue:function(s,i){var o=zt();return kv(o,pt.memoizedState,s,i)},useTransition:function(){var s=Rh(zr)[0],i=zt().memoizedState;return[typeof s=="boolean"?s:Ec(s),i]},useSyncExternalStore:ov,useId:Pv,useHostTransitionStatus:Hm,useFormState:bv,useActionState:bv,useOptimistic:function(s,i){var o=zt();return fv(o,pt,s,i)},useMemoCache:Dm,useCacheRefresh:Vv};Fm.useEffectEvent=Sv;var qv={readContext:gn,use:Nh,useCallback:Iv,useContext:gn,useEffect:Um,useImperativeHandle:Cv,useInsertionEffect:Av,useLayoutEffect:Nv,useMemo:jv,useReducer:Pm,useRef:Ev,useState:function(){return Pm(zr)},useDebugValue:zm,useDeferredValue:function(s,i){var o=zt();return pt===null?Bm(o,s,i):kv(o,pt.memoizedState,s,i)},useTransition:function(){var s=Pm(zr)[0],i=zt().memoizedState;return[typeof s=="boolean"?s:Ec(s),i]},useSyncExternalStore:ov,useId:Pv,useHostTransitionStatus:Hm,useFormState:xv,useActionState:xv,useOptimistic:function(s,i){var o=zt();return pt!==null?fv(o,pt,s,i):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:Dm,useCacheRefresh:Vv};qv.useEffectEvent=Sv;function Gm(s,i,o,u){i=s.memoizedState,o=o(u,i),o=o==null?i:w({},i,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var Km={enqueueSetState:function(s,i,o){s=s._reactInternals;var u=es(),f=xi(u);f.payload=i,o!=null&&(f.callback=o),i=Ei(s,f,u),i!==null&&(zn(i,s,u),_c(i,s,u))},enqueueReplaceState:function(s,i,o){s=s._reactInternals;var u=es(),f=xi(u);f.tag=1,f.payload=i,o!=null&&(f.callback=o),i=Ei(s,f,u),i!==null&&(zn(i,s,u),_c(i,s,u))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var o=es(),u=xi(o);u.tag=2,i!=null&&(u.callback=i),i=Ei(s,u,o),i!==null&&(zn(i,s,o),_c(i,s,o))}};function Hv(s,i,o,u,f,p,b){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,p,b):i.prototype&&i.prototype.isPureReactComponent?!hc(o,u)||!hc(f,p):!0}function $v(s,i,o,u){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,u),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,u),i.state!==s&&Km.enqueueReplaceState(i,i.state,null)}function za(s,i){var o=i;if("ref"in i){o={};for(var u in i)u!=="ref"&&(o[u]=i[u])}if(s=s.defaultProps){o===i&&(o=w({},o));for(var f in s)o[f]===void 0&&(o[f]=s[f])}return o}function Fv(s){ch(s)}function Gv(s){console.error(s)}function Kv(s){ch(s)}function kh(s,i){try{var o=s.onUncaughtError;o(i.value,{componentStack:i.stack})}catch(u){setTimeout(function(){throw u})}}function Qv(s,i,o){try{var u=s.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Qm(s,i,o){return o=xi(o),o.tag=3,o.payload={element:null},o.callback=function(){kh(s,i)},o}function Yv(s){return s=xi(s),s.tag=3,s}function Xv(s,i,o,u){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var p=u.value;s.payload=function(){return f(p)},s.callback=function(){Qv(i,o,u)}}var b=o.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(s.callback=function(){Qv(i,o,u),typeof f!="function"&&(Ci===null?Ci=new Set([this]):Ci.add(this));var T=u.stack;this.componentDidCatch(u.value,{componentStack:T!==null?T:""})})}function jS(s,i,o,u,f){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(i=o.alternate,i!==null&&Do(i,o,f,!0),o=Xn.current,o!==null){switch(o.tag){case 31:case 13:return bs===null?$h():o.alternate===null&&Pt===0&&(Pt=3),o.flags&=-257,o.flags|=65536,o.lanes=f,u===_h?o.flags|=16384:(i=o.updateQueue,i===null?o.updateQueue=new Set([u]):i.add(u),_g(s,u,f)),!1;case 22:return o.flags|=65536,u===_h?o.flags|=16384:(i=o.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=i):(o=i.retryQueue,o===null?i.retryQueue=new Set([u]):o.add(u)),_g(s,u,f)),!1}throw Error(r(435,o.tag))}return _g(s,u,f),$h(),!1}if(We)return i=Xn.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=f,u!==fm&&(s=Error(r(422),{cause:u}),mc(ps(s,o)))):(u!==fm&&(i=Error(r(423),{cause:u}),mc(ps(i,o))),s=s.current.alternate,s.flags|=65536,f&=-f,s.lanes|=f,u=ps(u,o),f=Qm(s.stateNode,u,f),Tm(s,f),Pt!==4&&(Pt=2)),!1;var p=Error(r(520),{cause:u});if(p=ps(p,o),Oc===null?Oc=[p]:Oc.push(p),Pt!==4&&(Pt=2),i===null)return!0;u=ps(u,o),o=i;do{switch(o.tag){case 3:return o.flags|=65536,s=f&-f,o.lanes|=s,s=Qm(o.stateNode,u,s),Tm(o,s),!1;case 1:if(i=o.type,p=o.stateNode,(o.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Ci===null||!Ci.has(p))))return o.flags|=65536,f&=-f,o.lanes|=f,f=Yv(f),Xv(f,s,o,u),Tm(o,f),!1}o=o.return}while(o!==null);return!1}var Ym=Error(r(461)),Xt=!1;function pn(s,i,o,u){i.child=s===null?ev(i,null,o,u):La(i,s.child,o,u)}function Wv(s,i,o,u,f){o=o.render;var p=i.ref;if("ref"in u){var b={};for(var T in u)T!=="ref"&&(b[T]=u[T])}else b=u;return Da(i),u=Im(s,i,o,b,p,f),T=jm(),s!==null&&!Xt?(km(s,i,f),Br(s,i,f)):(We&&T&&hm(i),i.flags|=1,pn(s,i,u,f),i.child)}function Jv(s,i,o,u,f){if(s===null){var p=o.type;return typeof p=="function"&&!lm(p)&&p.defaultProps===void 0&&o.compare===null?(i.tag=15,i.type=p,Zv(s,i,p,u,f)):(s=fh(o.type,null,u,i,i.mode,f),s.ref=i.ref,s.return=i,i.child=s)}if(p=s.child,!sg(s,f)){var b=p.memoizedProps;if(o=o.compare,o=o!==null?o:hc,o(b,u)&&s.ref===i.ref)return Br(s,i,f)}return i.flags|=1,s=Mr(p,u),s.ref=i.ref,s.return=i,i.child=s}function Zv(s,i,o,u,f){if(s!==null){var p=s.memoizedProps;if(hc(p,u)&&s.ref===i.ref)if(Xt=!1,i.pendingProps=u=p,sg(s,f))(s.flags&131072)!==0&&(Xt=!0);else return i.lanes=s.lanes,Br(s,i,f)}return Xm(s,i,o,u,f)}function e_(s,i,o,u){var f=u.children,p=s!==null?s.memoizedState:null;if(s===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((i.flags&128)!==0){if(p=p!==null?p.baseLanes|o:o,s!==null){for(u=i.child=s.child,f=0;u!==null;)f=f|u.lanes|u.childLanes,u=u.sibling;u=f&~p}else u=0,i.child=null;return t_(s,i,p,o,u)}if((o&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},s!==null&&yh(i,p!==null?p.cachePool:null),p!==null?sv(i,p):Am(),rv(i);else return u=i.lanes=536870912,t_(s,i,p!==null?p.baseLanes|o:o,o,u)}else p!==null?(yh(i,p.cachePool),sv(i,p),Si(),i.memoizedState=null):(s!==null&&yh(i,null),Am(),Si());return pn(s,i,f,o),i.child}function Ac(s,i){return s!==null&&s.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function t_(s,i,o,u,f){var p=bm();return p=p===null?null:{parent:Qt._currentValue,pool:p},i.memoizedState={baseLanes:o,cachePool:p},s!==null&&yh(i,null),Am(),rv(i),s!==null&&Do(s,i,u,!0),i.childLanes=f,null}function Oh(s,i){return i=Mh({mode:i.mode,children:i.children},s.mode),i.ref=s.ref,s.child=i,i.return=s,i}function n_(s,i,o){return La(i,s.child,null,o),s=Oh(i,i.pendingProps),s.flags|=2,Wn(i),i.memoizedState=null,s}function kS(s,i,o){var u=i.pendingProps,f=(i.flags&128)!==0;if(i.flags&=-129,s===null){if(We){if(u.mode==="hidden")return s=Oh(i,u),i.lanes=536870912,Ac(null,s);if(Rm(i),(s=Tt)?(s=mb(s,_s),s=s!==null&&s.data==="&"?s:null,s!==null&&(i.memoizedState={dehydrated:s,treeContext:yi!==null?{id:ur,overflow:hr}:null,retryLane:536870912,hydrationErrors:null},o=Uy(s),o.return=i,i.child=o,mn=i,Tt=null)):s=null,s===null)throw _i(i);return i.lanes=536870912,null}return Oh(i,u)}var p=s.memoizedState;if(p!==null){var b=p.dehydrated;if(Rm(i),f)if(i.flags&256)i.flags&=-257,i=n_(s,i,o);else if(i.memoizedState!==null)i.child=s.child,i.flags|=128,i=null;else throw Error(r(558));else if(Xt||Do(s,i,o,!1),f=(o&s.childLanes)!==0,Xt||f){if(u=bt,u!==null&&(b=va(u,o),b!==0&&b!==p.retryLane))throw p.retryLane=b,Ia(s,b),zn(u,s,b),Ym;$h(),i=n_(s,i,o)}else s=p.treeContext,Tt=ws(b.nextSibling),mn=i,We=!0,vi=null,_s=!1,s!==null&&qy(i,s),i=Oh(i,u),i.flags|=4096;return i}return s=Mr(s.child,{mode:u.mode,children:u.children}),s.ref=i.ref,i.child=s,s.return=i,s}function Dh(s,i){var o=i.ref;if(o===null)s!==null&&s.ref!==null&&(i.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(r(284));(s===null||s.ref!==o)&&(i.flags|=4194816)}}function Xm(s,i,o,u,f){return Da(i),o=Im(s,i,o,u,void 0,f),u=jm(),s!==null&&!Xt?(km(s,i,f),Br(s,i,f)):(We&&u&&hm(i),i.flags|=1,pn(s,i,o,f),i.child)}function s_(s,i,o,u,f,p){return Da(i),i.updateQueue=null,o=av(i,u,o,f),iv(s),u=jm(),s!==null&&!Xt?(km(s,i,p),Br(s,i,p)):(We&&u&&hm(i),i.flags|=1,pn(s,i,o,p),i.child)}function r_(s,i,o,u,f){if(Da(i),i.stateNode===null){var p=Io,b=o.contextType;typeof b=="object"&&b!==null&&(p=gn(b)),p=new o(u,p),i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=Km,i.stateNode=p,p._reactInternals=i,p=i.stateNode,p.props=u,p.state=i.memoizedState,p.refs={},xm(i),b=o.contextType,p.context=typeof b=="object"&&b!==null?gn(b):Io,p.state=i.memoizedState,b=o.getDerivedStateFromProps,typeof b=="function"&&(Gm(i,o,b,u),p.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(b=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),b!==p.state&&Km.enqueueReplaceState(p,p.state,null),wc(i,u,p,f),bc(),p.state=i.memoizedState),typeof p.componentDidMount=="function"&&(i.flags|=4194308),u=!0}else if(s===null){p=i.stateNode;var T=i.memoizedProps,P=za(o,T);p.props=P;var Q=p.context,ee=o.contextType;b=Io,typeof ee=="object"&&ee!==null&&(b=gn(ee));var ie=o.getDerivedStateFromProps;ee=typeof ie=="function"||typeof p.getSnapshotBeforeUpdate=="function",T=i.pendingProps!==T,ee||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(T||Q!==b)&&$v(i,p,u,b),wi=!1;var X=i.memoizedState;p.state=X,wc(i,u,p,f),bc(),Q=i.memoizedState,T||X!==Q||wi?(typeof ie=="function"&&(Gm(i,o,ie,u),Q=i.memoizedState),(P=wi||Hv(i,o,P,u,X,Q,b))?(ee||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(i.flags|=4194308)):(typeof p.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=u,i.memoizedState=Q),p.props=u,p.state=Q,p.context=b,u=P):(typeof p.componentDidMount=="function"&&(i.flags|=4194308),u=!1)}else{p=i.stateNode,Em(s,i),b=i.memoizedProps,ee=za(o,b),p.props=ee,ie=i.pendingProps,X=p.context,Q=o.contextType,P=Io,typeof Q=="object"&&Q!==null&&(P=gn(Q)),T=o.getDerivedStateFromProps,(Q=typeof T=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(b!==ie||X!==P)&&$v(i,p,u,P),wi=!1,X=i.memoizedState,p.state=X,wc(i,u,p,f),bc();var Z=i.memoizedState;b!==ie||X!==Z||wi||s!==null&&s.dependencies!==null&&gh(s.dependencies)?(typeof T=="function"&&(Gm(i,o,T,u),Z=i.memoizedState),(ee=wi||Hv(i,o,ee,u,X,Z,P)||s!==null&&s.dependencies!==null&&gh(s.dependencies))?(Q||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(u,Z,P),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(u,Z,P)),typeof p.componentDidUpdate=="function"&&(i.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof p.componentDidUpdate!="function"||b===s.memoizedProps&&X===s.memoizedState||(i.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||b===s.memoizedProps&&X===s.memoizedState||(i.flags|=1024),i.memoizedProps=u,i.memoizedState=Z),p.props=u,p.state=Z,p.context=P,u=ee):(typeof p.componentDidUpdate!="function"||b===s.memoizedProps&&X===s.memoizedState||(i.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||b===s.memoizedProps&&X===s.memoizedState||(i.flags|=1024),u=!1)}return p=u,Dh(s,i),u=(i.flags&128)!==0,p||u?(p=i.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:p.render(),i.flags|=1,s!==null&&u?(i.child=La(i,s.child,null,f),i.child=La(i,null,o,f)):pn(s,i,o,f),i.memoizedState=p.state,s=i.child):s=Br(s,i,f),s}function i_(s,i,o,u){return ka(),i.flags|=256,pn(s,i,o,u),i.child}var Wm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Jm(s){return{baseLanes:s,cachePool:Qy()}}function Zm(s,i,o){return s=s!==null?s.childLanes&~o:0,i&&(s|=Zn),s}function a_(s,i,o){var u=i.pendingProps,f=!1,p=(i.flags&128)!==0,b;if((b=p)||(b=s!==null&&s.memoizedState===null?!1:(Ut.current&2)!==0),b&&(f=!0,i.flags&=-129),b=(i.flags&32)!==0,i.flags&=-33,s===null){if(We){if(f?Ti(i):Si(),(s=Tt)?(s=mb(s,_s),s=s!==null&&s.data!=="&"?s:null,s!==null&&(i.memoizedState={dehydrated:s,treeContext:yi!==null?{id:ur,overflow:hr}:null,retryLane:536870912,hydrationErrors:null},o=Uy(s),o.return=i,i.child=o,mn=i,Tt=null)):s=null,s===null)throw _i(i);return Mg(s)?i.lanes=32:i.lanes=536870912,null}var T=u.children;return u=u.fallback,f?(Si(),f=i.mode,T=Mh({mode:"hidden",children:T},f),u=ja(u,f,o,null),T.return=i,u.return=i,T.sibling=u,i.child=T,u=i.child,u.memoizedState=Jm(o),u.childLanes=Zm(s,b,o),i.memoizedState=Wm,Ac(null,u)):(Ti(i),eg(i,T))}var P=s.memoizedState;if(P!==null&&(T=P.dehydrated,T!==null)){if(p)i.flags&256?(Ti(i),i.flags&=-257,i=tg(s,i,o)):i.memoizedState!==null?(Si(),i.child=s.child,i.flags|=128,i=null):(Si(),T=u.fallback,f=i.mode,u=Mh({mode:"visible",children:u.children},f),T=ja(T,f,o,null),T.flags|=2,u.return=i,T.return=i,u.sibling=T,i.child=u,La(i,s.child,null,o),u=i.child,u.memoizedState=Jm(o),u.childLanes=Zm(s,b,o),i.memoizedState=Wm,i=Ac(null,u));else if(Ti(i),Mg(T)){if(b=T.nextSibling&&T.nextSibling.dataset,b)var Q=b.dgst;b=Q,u=Error(r(419)),u.stack="",u.digest=b,mc({value:u,source:null,stack:null}),i=tg(s,i,o)}else if(Xt||Do(s,i,o,!1),b=(o&s.childLanes)!==0,Xt||b){if(b=bt,b!==null&&(u=va(b,o),u!==0&&u!==P.retryLane))throw P.retryLane=u,Ia(s,u),zn(b,s,u),Ym;Dg(T)||$h(),i=tg(s,i,o)}else Dg(T)?(i.flags|=192,i.child=s.child,i=null):(s=P.treeContext,Tt=ws(T.nextSibling),mn=i,We=!0,vi=null,_s=!1,s!==null&&qy(i,s),i=eg(i,u.children),i.flags|=4096);return i}return f?(Si(),T=u.fallback,f=i.mode,P=s.child,Q=P.sibling,u=Mr(P,{mode:"hidden",children:u.children}),u.subtreeFlags=P.subtreeFlags&65011712,Q!==null?T=Mr(Q,T):(T=ja(T,f,o,null),T.flags|=2),T.return=i,u.return=i,u.sibling=T,i.child=u,Ac(null,u),u=i.child,T=s.child.memoizedState,T===null?T=Jm(o):(f=T.cachePool,f!==null?(P=Qt._currentValue,f=f.parent!==P?{parent:P,pool:P}:f):f=Qy(),T={baseLanes:T.baseLanes|o,cachePool:f}),u.memoizedState=T,u.childLanes=Zm(s,b,o),i.memoizedState=Wm,Ac(s.child,u)):(Ti(i),o=s.child,s=o.sibling,o=Mr(o,{mode:"visible",children:u.children}),o.return=i,o.sibling=null,s!==null&&(b=i.deletions,b===null?(i.deletions=[s],i.flags|=16):b.push(s)),i.child=o,i.memoizedState=null,o)}function eg(s,i){return i=Mh({mode:"visible",children:i},s.mode),i.return=s,s.child=i}function Mh(s,i){return s=Yn(22,s,null,i),s.lanes=0,s}function tg(s,i,o){return La(i,s.child,null,o),s=eg(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function o_(s,i,o){s.lanes|=i;var u=s.alternate;u!==null&&(u.lanes|=i),pm(s.return,i,o)}function ng(s,i,o,u,f,p){var b=s.memoizedState;b===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:f,treeForkCount:p}:(b.isBackwards=i,b.rendering=null,b.renderingStartTime=0,b.last=u,b.tail=o,b.tailMode=f,b.treeForkCount=p)}function l_(s,i,o){var u=i.pendingProps,f=u.revealOrder,p=u.tail;u=u.children;var b=Ut.current,T=(b&2)!==0;if(T?(b=b&1|2,i.flags|=128):b&=1,W(Ut,b),pn(s,i,u,o),u=We?fc:0,!T&&s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&o_(s,o,i);else if(s.tag===19)o_(s,o,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(f){case"forwards":for(o=i.child,f=null;o!==null;)s=o.alternate,s!==null&&Eh(s)===null&&(f=o),o=o.sibling;o=f,o===null?(f=i.child,i.child=null):(f=o.sibling,o.sibling=null),ng(i,!1,f,o,p,u);break;case"backwards":case"unstable_legacy-backwards":for(o=null,f=i.child,i.child=null;f!==null;){if(s=f.alternate,s!==null&&Eh(s)===null){i.child=f;break}s=f.sibling,f.sibling=o,o=f,f=s}ng(i,!0,o,null,p,u);break;case"together":ng(i,!1,null,null,void 0,u);break;default:i.memoizedState=null}return i.child}function Br(s,i,o){if(s!==null&&(i.dependencies=s.dependencies),Ri|=i.lanes,(o&i.childLanes)===0)if(s!==null){if(Do(s,i,o,!1),(o&i.childLanes)===0)return null}else return null;if(s!==null&&i.child!==s.child)throw Error(r(153));if(i.child!==null){for(s=i.child,o=Mr(s,s.pendingProps),i.child=o,o.return=i;s.sibling!==null;)s=s.sibling,o=o.sibling=Mr(s,s.pendingProps),o.return=i;o.sibling=null}return i.child}function sg(s,i){return(s.lanes&i)!==0?!0:(s=s.dependencies,!!(s!==null&&gh(s)))}function OS(s,i,o){switch(i.tag){case 3:tt(i,i.stateNode.containerInfo),bi(i,Qt,s.memoizedState.cache),ka();break;case 27:case 5:je(i);break;case 4:tt(i,i.stateNode.containerInfo);break;case 10:bi(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,Rm(i),null;break;case 13:var u=i.memoizedState;if(u!==null)return u.dehydrated!==null?(Ti(i),i.flags|=128,null):(o&i.child.childLanes)!==0?a_(s,i,o):(Ti(i),s=Br(s,i,o),s!==null?s.sibling:null);Ti(i);break;case 19:var f=(s.flags&128)!==0;if(u=(o&i.childLanes)!==0,u||(Do(s,i,o,!1),u=(o&i.childLanes)!==0),f){if(u)return l_(s,i,o);i.flags|=128}if(f=i.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),W(Ut,Ut.current),u)break;return null;case 22:return i.lanes=0,e_(s,i,o,i.pendingProps);case 24:bi(i,Qt,s.memoizedState.cache)}return Br(s,i,o)}function c_(s,i,o){if(s!==null)if(s.memoizedProps!==i.pendingProps)Xt=!0;else{if(!sg(s,o)&&(i.flags&128)===0)return Xt=!1,OS(s,i,o);Xt=(s.flags&131072)!==0}else Xt=!1,We&&(i.flags&1048576)!==0&&By(i,fc,i.index);switch(i.lanes=0,i.tag){case 16:e:{var u=i.pendingProps;if(s=Pa(i.elementType),i.type=s,typeof s=="function")lm(s)?(u=za(s,u),i.tag=1,i=r_(null,i,s,u,o)):(i.tag=0,i=Xm(null,i,s,u,o));else{if(s!=null){var f=s.$$typeof;if(f===te){i.tag=11,i=Wv(null,i,s,u,o);break e}else if(f===I){i.tag=14,i=Jv(null,i,s,u,o);break e}}throw i=Fe(s)||s,Error(r(306,i,""))}}return i;case 0:return Xm(s,i,i.type,i.pendingProps,o);case 1:return u=i.type,f=za(u,i.pendingProps),r_(s,i,u,f,o);case 3:e:{if(tt(i,i.stateNode.containerInfo),s===null)throw Error(r(387));u=i.pendingProps;var p=i.memoizedState;f=p.element,Em(s,i),wc(i,u,null,o);var b=i.memoizedState;if(u=b.cache,bi(i,Qt,u),u!==p.cache&&ym(i,[Qt],o,!0),bc(),u=b.element,p.isDehydrated)if(p={element:u,isDehydrated:!1,cache:b.cache},i.updateQueue.baseState=p,i.memoizedState=p,i.flags&256){i=i_(s,i,u,o);break e}else if(u!==f){f=ps(Error(r(424)),i),mc(f),i=i_(s,i,u,o);break e}else{switch(s=i.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Tt=ws(s.firstChild),mn=i,We=!0,vi=null,_s=!0,o=ev(i,null,u,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(ka(),u===f){i=Br(s,i,o);break e}pn(s,i,u,o)}i=i.child}return i;case 26:return Dh(s,i),s===null?(o=bb(i.type,null,i.pendingProps,null))?i.memoizedState=o:We||(o=i.type,s=i.pendingProps,u=Wh(Te.current).createElement(o),u[Ce]=i,u[st]=s,yn(u,o,s),Gt(u),i.stateNode=u):i.memoizedState=bb(i.type,s.memoizedProps,i.pendingProps,s.memoizedState),null;case 27:return je(i),s===null&&We&&(u=i.stateNode=yb(i.type,i.pendingProps,Te.current),mn=i,_s=!0,f=Tt,Oi(i.type)?(Pg=f,Tt=ws(u.firstChild)):Tt=f),pn(s,i,i.pendingProps.children,o),Dh(s,i),s===null&&(i.flags|=4194304),i.child;case 5:return s===null&&We&&((f=u=Tt)&&(u=cA(u,i.type,i.pendingProps,_s),u!==null?(i.stateNode=u,mn=i,Tt=ws(u.firstChild),_s=!1,f=!0):f=!1),f||_i(i)),je(i),f=i.type,p=i.pendingProps,b=s!==null?s.memoizedProps:null,u=p.children,jg(f,p)?u=null:b!==null&&jg(f,b)&&(i.flags|=32),i.memoizedState!==null&&(f=Im(s,i,TS,null,null,o),Bc._currentValue=f),Dh(s,i),pn(s,i,u,o),i.child;case 6:return s===null&&We&&((s=o=Tt)&&(o=uA(o,i.pendingProps,_s),o!==null?(i.stateNode=o,mn=i,Tt=null,s=!0):s=!1),s||_i(i)),null;case 13:return a_(s,i,o);case 4:return tt(i,i.stateNode.containerInfo),u=i.pendingProps,s===null?i.child=La(i,null,u,o):pn(s,i,u,o),i.child;case 11:return Wv(s,i,i.type,i.pendingProps,o);case 7:return pn(s,i,i.pendingProps,o),i.child;case 8:return pn(s,i,i.pendingProps.children,o),i.child;case 12:return pn(s,i,i.pendingProps.children,o),i.child;case 10:return u=i.pendingProps,bi(i,i.type,u.value),pn(s,i,u.children,o),i.child;case 9:return f=i.type._context,u=i.pendingProps.children,Da(i),f=gn(f),u=u(f),i.flags|=1,pn(s,i,u,o),i.child;case 14:return Jv(s,i,i.type,i.pendingProps,o);case 15:return Zv(s,i,i.type,i.pendingProps,o);case 19:return l_(s,i,o);case 31:return kS(s,i,o);case 22:return e_(s,i,o,i.pendingProps);case 24:return Da(i),u=gn(Qt),s===null?(f=bm(),f===null&&(f=bt,p=vm(),f.pooledCache=p,p.refCount++,p!==null&&(f.pooledCacheLanes|=o),f=p),i.memoizedState={parent:u,cache:f},xm(i),bi(i,Qt,f)):((s.lanes&o)!==0&&(Em(s,i),wc(i,null,null,o),bc()),f=s.memoizedState,p=i.memoizedState,f.parent!==u?(f={parent:u,cache:u},i.memoizedState=f,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=f),bi(i,Qt,u)):(u=p.cache,bi(i,Qt,u),u!==f.cache&&ym(i,[Qt],o,!0))),pn(s,i,i.pendingProps.children,o),i.child;case 29:throw i.pendingProps}throw Error(r(156,i.tag))}function qr(s){s.flags|=4}function rg(s,i,o,u,f){if((i=(s.mode&32)!==0)&&(i=!1),i){if(s.flags|=16777216,(f&335544128)===f)if(s.stateNode.complete)s.flags|=8192;else if(P_())s.flags|=8192;else throw Va=_h,wm}else s.flags&=-16777217}function u_(s,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Sb(i))if(P_())s.flags|=8192;else throw Va=_h,wm}function Ph(s,i){i!==null&&(s.flags|=4),s.flags&16384&&(i=s.tag!==22?go():536870912,s.lanes|=i,Go|=i)}function Nc(s,i){if(!We)switch(s.tailMode){case"hidden":i=s.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function St(s){var i=s.alternate!==null&&s.alternate.child===s.child,o=0,u=0;if(i)for(var f=s.child;f!==null;)o|=f.lanes|f.childLanes,u|=f.subtreeFlags&65011712,u|=f.flags&65011712,f.return=s,f=f.sibling;else for(f=s.child;f!==null;)o|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=s,f=f.sibling;return s.subtreeFlags|=u,s.childLanes=o,i}function DS(s,i,o){var u=i.pendingProps;switch(dm(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return St(i),null;case 1:return St(i),null;case 3:return o=i.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),Lr(Qt),Je(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(Oo(i)?qr(i):s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,mm())),St(i),null;case 26:var f=i.type,p=i.memoizedState;return s===null?(qr(i),p!==null?(St(i),u_(i,p)):(St(i),rg(i,f,null,u,o))):p?p!==s.memoizedState?(qr(i),St(i),u_(i,p)):(St(i),i.flags&=-16777217):(s=s.memoizedProps,s!==u&&qr(i),St(i),rg(i,f,s,u,o)),null;case 27:if(Ft(i),o=Te.current,f=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==u&&qr(i);else{if(!u){if(i.stateNode===null)throw Error(r(166));return St(i),null}s=oe.current,Oo(i)?Hy(i):(s=yb(f,u,o),i.stateNode=s,qr(i))}return St(i),null;case 5:if(Ft(i),f=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==u&&qr(i);else{if(!u){if(i.stateNode===null)throw Error(r(166));return St(i),null}if(p=oe.current,Oo(i))Hy(i);else{var b=Wh(Te.current);switch(p){case 1:p=b.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:p=b.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":p=b.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":p=b.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":p=b.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof u.is=="string"?b.createElement("select",{is:u.is}):b.createElement("select"),u.multiple?p.multiple=!0:u.size&&(p.size=u.size);break;default:p=typeof u.is=="string"?b.createElement(f,{is:u.is}):b.createElement(f)}}p[Ce]=i,p[st]=u;e:for(b=i.child;b!==null;){if(b.tag===5||b.tag===6)p.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===i)break e;for(;b.sibling===null;){if(b.return===null||b.return===i)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}i.stateNode=p;e:switch(yn(p,f,u),f){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&qr(i)}}return St(i),rg(i,i.type,s===null?null:s.memoizedProps,i.pendingProps,o),null;case 6:if(s&&i.stateNode!=null)s.memoizedProps!==u&&qr(i);else{if(typeof u!="string"&&i.stateNode===null)throw Error(r(166));if(s=Te.current,Oo(i)){if(s=i.stateNode,o=i.memoizedProps,u=null,f=mn,f!==null)switch(f.tag){case 27:case 5:u=f.memoizedProps}s[Ce]=i,s=!!(s.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||ab(s.nodeValue,o)),s||_i(i,!0)}else s=Wh(s).createTextNode(u),s[Ce]=i,i.stateNode=s}return St(i),null;case 31:if(o=i.memoizedState,s===null||s.memoizedState!==null){if(u=Oo(i),o!==null){if(s===null){if(!u)throw Error(r(318));if(s=i.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(557));s[Ce]=i}else ka(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;St(i),s=!1}else o=mm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),s=!0;if(!s)return i.flags&256?(Wn(i),i):(Wn(i),null);if((i.flags&128)!==0)throw Error(r(558))}return St(i),null;case 13:if(u=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(f=Oo(i),u!==null&&u.dehydrated!==null){if(s===null){if(!f)throw Error(r(318));if(f=i.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(r(317));f[Ce]=i}else ka(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;St(i),f=!1}else f=mm(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=f),f=!0;if(!f)return i.flags&256?(Wn(i),i):(Wn(i),null)}return Wn(i),(i.flags&128)!==0?(i.lanes=o,i):(o=u!==null,s=s!==null&&s.memoizedState!==null,o&&(u=i.child,f=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(f=u.alternate.memoizedState.cachePool.pool),p=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(p=u.memoizedState.cachePool.pool),p!==f&&(u.flags|=2048)),o!==s&&o&&(i.child.flags|=8192),Ph(i,i.updateQueue),St(i),null);case 4:return Je(),s===null&&Ag(i.stateNode.containerInfo),St(i),null;case 10:return Lr(i.type),St(i),null;case 19:if(ne(Ut),u=i.memoizedState,u===null)return St(i),null;if(f=(i.flags&128)!==0,p=u.rendering,p===null)if(f)Nc(u,!1);else{if(Pt!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(p=Eh(s),p!==null){for(i.flags|=128,Nc(u,!1),s=p.updateQueue,i.updateQueue=s,Ph(i,s),i.subtreeFlags=0,s=o,o=i.child;o!==null;)Ly(o,s),o=o.sibling;return W(Ut,Ut.current&1|2),We&&Pr(i,u.treeForkCount),i.child}s=s.sibling}u.tail!==null&&dn()>Bh&&(i.flags|=128,f=!0,Nc(u,!1),i.lanes=4194304)}else{if(!f)if(s=Eh(p),s!==null){if(i.flags|=128,f=!0,s=s.updateQueue,i.updateQueue=s,Ph(i,s),Nc(u,!0),u.tail===null&&u.tailMode==="hidden"&&!p.alternate&&!We)return St(i),null}else 2*dn()-u.renderingStartTime>Bh&&o!==536870912&&(i.flags|=128,f=!0,Nc(u,!1),i.lanes=4194304);u.isBackwards?(p.sibling=i.child,i.child=p):(s=u.last,s!==null?s.sibling=p:i.child=p,u.last=p)}return u.tail!==null?(s=u.tail,u.rendering=s,u.tail=s.sibling,u.renderingStartTime=dn(),s.sibling=null,o=Ut.current,W(Ut,f?o&1|2:o&1),We&&Pr(i,u.treeForkCount),s):(St(i),null);case 22:case 23:return Wn(i),Nm(),u=i.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(i.flags|=8192):u&&(i.flags|=8192),u?(o&536870912)!==0&&(i.flags&128)===0&&(St(i),i.subtreeFlags&6&&(i.flags|=8192)):St(i),o=i.updateQueue,o!==null&&Ph(i,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),u=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),u!==o&&(i.flags|=2048),s!==null&&ne(Ma),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),i.memoizedState.cache!==o&&(i.flags|=2048),Lr(Qt),St(i),null;case 25:return null;case 30:return null}throw Error(r(156,i.tag))}function MS(s,i){switch(dm(i),i.tag){case 1:return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return Lr(Qt),Je(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 26:case 27:case 5:return Ft(i),null;case 31:if(i.memoizedState!==null){if(Wn(i),i.alternate===null)throw Error(r(340));ka()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 13:if(Wn(i),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(r(340));ka()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return ne(Ut),null;case 4:return Je(),null;case 10:return Lr(i.type),null;case 22:case 23:return Wn(i),Nm(),s!==null&&ne(Ma),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 24:return Lr(Qt),null;case 25:return null;default:return null}}function h_(s,i){switch(dm(i),i.tag){case 3:Lr(Qt),Je();break;case 26:case 27:case 5:Ft(i);break;case 4:Je();break;case 31:i.memoizedState!==null&&Wn(i);break;case 13:Wn(i);break;case 19:ne(Ut);break;case 10:Lr(i.type);break;case 22:case 23:Wn(i),Nm(),s!==null&&ne(Ma);break;case 24:Lr(Qt)}}function Rc(s,i){try{var o=i.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var f=u.next;o=f;do{if((o.tag&s)===s){u=void 0;var p=o.create,b=o.inst;u=p(),b.destroy=u}o=o.next}while(o!==f)}}catch(T){ft(i,i.return,T)}}function Ai(s,i,o){try{var u=i.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var p=f.next;u=p;do{if((u.tag&s)===s){var b=u.inst,T=b.destroy;if(T!==void 0){b.destroy=void 0,f=i;var P=o,Q=T;try{Q()}catch(ee){ft(f,P,ee)}}}u=u.next}while(u!==p)}}catch(ee){ft(i,i.return,ee)}}function d_(s){var i=s.updateQueue;if(i!==null){var o=s.stateNode;try{nv(i,o)}catch(u){ft(s,s.return,u)}}}function f_(s,i,o){o.props=za(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(u){ft(s,i,u)}}function Cc(s,i){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof o=="function"?s.refCleanup=o(u):o.current=u}}catch(f){ft(s,i,f)}}function dr(s,i){var o=s.ref,u=s.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(f){ft(s,i,f)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){ft(s,i,f)}else o.current=null}function m_(s){var i=s.type,o=s.memoizedProps,u=s.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(f){ft(s,s.return,f)}}function ig(s,i,o){try{var u=s.stateNode;sA(u,s.type,o,i),u[st]=i}catch(f){ft(s,s.return,f)}}function g_(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Oi(s.type)||s.tag===4}function ag(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||g_(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Oi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function og(s,i,o){var u=s.tag;if(u===5||u===6)s=s.stateNode,i?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,i):(i=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,i.appendChild(s),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=Cs));else if(u!==4&&(u===27&&Oi(s.type)&&(o=s.stateNode,i=null),s=s.child,s!==null))for(og(s,i,o),s=s.sibling;s!==null;)og(s,i,o),s=s.sibling}function Vh(s,i,o){var u=s.tag;if(u===5||u===6)s=s.stateNode,i?o.insertBefore(s,i):o.appendChild(s);else if(u!==4&&(u===27&&Oi(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(Vh(s,i,o),s=s.sibling;s!==null;)Vh(s,i,o),s=s.sibling}function p_(s){var i=s.stateNode,o=s.memoizedProps;try{for(var u=s.type,f=i.attributes;f.length;)i.removeAttributeNode(f[0]);yn(i,u,o),i[Ce]=s,i[st]=o}catch(p){ft(s,s.return,p)}}var Hr=!1,Wt=!1,lg=!1,y_=typeof WeakSet=="function"?WeakSet:Set,on=null;function PS(s,i){if(s=s.containerInfo,Cg=rd,s=Cy(s),tm(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var f=u.anchorOffset,p=u.focusNode;u=u.focusOffset;try{o.nodeType,p.nodeType}catch{o=null;break e}var b=0,T=-1,P=-1,Q=0,ee=0,ie=s,X=null;t:for(;;){for(var Z;ie!==o||f!==0&&ie.nodeType!==3||(T=b+f),ie!==p||u!==0&&ie.nodeType!==3||(P=b+u),ie.nodeType===3&&(b+=ie.nodeValue.length),(Z=ie.firstChild)!==null;)X=ie,ie=Z;for(;;){if(ie===s)break t;if(X===o&&++Q===f&&(T=b),X===p&&++ee===u&&(P=b),(Z=ie.nextSibling)!==null)break;ie=X,X=ie.parentNode}ie=Z}o=T===-1||P===-1?null:{start:T,end:P}}else o=null}o=o||{start:0,end:0}}else o=null;for(Ig={focusedElem:s,selectionRange:o},rd=!1,on=i;on!==null;)if(i=on,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,on=s;else for(;on!==null;){switch(i=on,p=i.alternate,s=i.flags,i.tag){case 0:if((s&4)!==0&&(s=i.updateQueue,s=s!==null?s.events:null,s!==null))for(o=0;o<s.length;o++)f=s[o],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&p!==null){s=void 0,o=i,f=p.memoizedProps,p=p.memoizedState,u=o.stateNode;try{var ye=za(o.type,f);s=u.getSnapshotBeforeUpdate(ye,p),u.__reactInternalSnapshotBeforeUpdate=s}catch(Se){ft(o,o.return,Se)}}break;case 3:if((s&1024)!==0){if(s=i.stateNode.containerInfo,o=s.nodeType,o===9)Og(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Og(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=i.sibling,s!==null){s.return=i.return,on=s;break}on=i.return}}function v_(s,i,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:Fr(s,o),u&4&&Rc(5,o);break;case 1:if(Fr(s,o),u&4)if(s=o.stateNode,i===null)try{s.componentDidMount()}catch(b){ft(o,o.return,b)}else{var f=za(o.type,i.memoizedProps);i=i.memoizedState;try{s.componentDidUpdate(f,i,s.__reactInternalSnapshotBeforeUpdate)}catch(b){ft(o,o.return,b)}}u&64&&d_(o),u&512&&Cc(o,o.return);break;case 3:if(Fr(s,o),u&64&&(s=o.updateQueue,s!==null)){if(i=null,o.child!==null)switch(o.child.tag){case 27:case 5:i=o.child.stateNode;break;case 1:i=o.child.stateNode}try{nv(s,i)}catch(b){ft(o,o.return,b)}}break;case 27:i===null&&u&4&&p_(o);case 26:case 5:Fr(s,o),i===null&&u&4&&m_(o),u&512&&Cc(o,o.return);break;case 12:Fr(s,o);break;case 31:Fr(s,o),u&4&&w_(s,o);break;case 13:Fr(s,o),u&4&&x_(s,o),u&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=FS.bind(null,o),hA(s,o))));break;case 22:if(u=o.memoizedState!==null||Hr,!u){i=i!==null&&i.memoizedState!==null||Wt,f=Hr;var p=Wt;Hr=u,(Wt=i)&&!p?Gr(s,o,(o.subtreeFlags&8772)!==0):Fr(s,o),Hr=f,Wt=p}break;case 30:break;default:Fr(s,o)}}function __(s){var i=s.alternate;i!==null&&(s.alternate=null,__(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&po(i)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Rt=null,Pn=!1;function $r(s,i,o){for(o=o.child;o!==null;)b_(s,i,o),o=o.sibling}function b_(s,i,o){if(Vt&&typeof Vt.onCommitFiberUnmount=="function")try{Vt.onCommitFiberUnmount(Hn,o)}catch{}switch(o.tag){case 26:Wt||dr(o,i),$r(s,i,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Wt||dr(o,i);var u=Rt,f=Pn;Oi(o.type)&&(Rt=o.stateNode,Pn=!1),$r(s,i,o),Lc(o.stateNode),Rt=u,Pn=f;break;case 5:Wt||dr(o,i);case 6:if(u=Rt,f=Pn,Rt=null,$r(s,i,o),Rt=u,Pn=f,Rt!==null)if(Pn)try{(Rt.nodeType===9?Rt.body:Rt.nodeName==="HTML"?Rt.ownerDocument.body:Rt).removeChild(o.stateNode)}catch(p){ft(o,i,p)}else try{Rt.removeChild(o.stateNode)}catch(p){ft(o,i,p)}break;case 18:Rt!==null&&(Pn?(s=Rt,db(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),el(s)):db(Rt,o.stateNode));break;case 4:u=Rt,f=Pn,Rt=o.stateNode.containerInfo,Pn=!0,$r(s,i,o),Rt=u,Pn=f;break;case 0:case 11:case 14:case 15:Ai(2,o,i),Wt||Ai(4,o,i),$r(s,i,o);break;case 1:Wt||(dr(o,i),u=o.stateNode,typeof u.componentWillUnmount=="function"&&f_(o,i,u)),$r(s,i,o);break;case 21:$r(s,i,o);break;case 22:Wt=(u=Wt)||o.memoizedState!==null,$r(s,i,o),Wt=u;break;default:$r(s,i,o)}}function w_(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{el(s)}catch(o){ft(i,i.return,o)}}}function x_(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{el(s)}catch(o){ft(i,i.return,o)}}function VS(s){switch(s.tag){case 31:case 13:case 19:var i=s.stateNode;return i===null&&(i=s.stateNode=new y_),i;case 22:return s=s.stateNode,i=s._retryCache,i===null&&(i=s._retryCache=new y_),i;default:throw Error(r(435,s.tag))}}function Lh(s,i){var o=VS(s);i.forEach(function(u){if(!o.has(u)){o.add(u);var f=GS.bind(null,s,u);u.then(f,f)}})}function Vn(s,i){var o=i.deletions;if(o!==null)for(var u=0;u<o.length;u++){var f=o[u],p=s,b=i,T=b;e:for(;T!==null;){switch(T.tag){case 27:if(Oi(T.type)){Rt=T.stateNode,Pn=!1;break e}break;case 5:Rt=T.stateNode,Pn=!1;break e;case 3:case 4:Rt=T.stateNode.containerInfo,Pn=!0;break e}T=T.return}if(Rt===null)throw Error(r(160));b_(p,b,f),Rt=null,Pn=!1,p=f.alternate,p!==null&&(p.return=null),f.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)E_(i,s),i=i.sibling}var Ms=null;function E_(s,i){var o=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Vn(i,s),Ln(s),u&4&&(Ai(3,s,s.return),Rc(3,s),Ai(5,s,s.return));break;case 1:Vn(i,s),Ln(s),u&512&&(Wt||o===null||dr(o,o.return)),u&64&&Hr&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var f=Ms;if(Vn(i,s),Ln(s),u&512&&(Wt||o===null||dr(o,o.return)),u&4){var p=o!==null?o.memoizedState:null;if(u=s.memoizedState,o===null)if(u===null)if(s.stateNode===null){e:{u=s.type,o=s.memoizedProps,f=f.ownerDocument||f;t:switch(u){case"title":p=f.getElementsByTagName("title")[0],(!p||p[Js]||p[Ce]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=f.createElement(u),f.head.insertBefore(p,f.querySelector("head > title"))),yn(p,u,o),p[Ce]=s,Gt(p),u=p;break e;case"link":var b=Eb("link","href",f).get(u+(o.href||""));if(b){for(var T=0;T<b.length;T++)if(p=b[T],p.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&p.getAttribute("rel")===(o.rel==null?null:o.rel)&&p.getAttribute("title")===(o.title==null?null:o.title)&&p.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){b.splice(T,1);break t}}p=f.createElement(u),yn(p,u,o),f.head.appendChild(p);break;case"meta":if(b=Eb("meta","content",f).get(u+(o.content||""))){for(T=0;T<b.length;T++)if(p=b[T],p.getAttribute("content")===(o.content==null?null:""+o.content)&&p.getAttribute("name")===(o.name==null?null:o.name)&&p.getAttribute("property")===(o.property==null?null:o.property)&&p.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&p.getAttribute("charset")===(o.charSet==null?null:o.charSet)){b.splice(T,1);break t}}p=f.createElement(u),yn(p,u,o),f.head.appendChild(p);break;default:throw Error(r(468,u))}p[Ce]=s,Gt(p),u=p}s.stateNode=u}else Tb(f,s.type,s.stateNode);else s.stateNode=xb(f,u,s.memoizedProps);else p!==u?(p===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):p.count--,u===null?Tb(f,s.type,s.stateNode):xb(f,u,s.memoizedProps)):u===null&&s.stateNode!==null&&ig(s,s.memoizedProps,o.memoizedProps)}break;case 27:Vn(i,s),Ln(s),u&512&&(Wt||o===null||dr(o,o.return)),o!==null&&u&4&&ig(s,s.memoizedProps,o.memoizedProps);break;case 5:if(Vn(i,s),Ln(s),u&512&&(Wt||o===null||dr(o,o.return)),s.flags&32){f=s.stateNode;try{Mn(f,"")}catch(ye){ft(s,s.return,ye)}}u&4&&s.stateNode!=null&&(f=s.memoizedProps,ig(s,f,o!==null?o.memoizedProps:f)),u&1024&&(lg=!0);break;case 6:if(Vn(i,s),Ln(s),u&4){if(s.stateNode===null)throw Error(r(162));u=s.memoizedProps,o=s.stateNode;try{o.nodeValue=u}catch(ye){ft(s,s.return,ye)}}break;case 3:if(ed=null,f=Ms,Ms=Jh(i.containerInfo),Vn(i,s),Ms=f,Ln(s),u&4&&o!==null&&o.memoizedState.isDehydrated)try{el(i.containerInfo)}catch(ye){ft(s,s.return,ye)}lg&&(lg=!1,T_(s));break;case 4:u=Ms,Ms=Jh(s.stateNode.containerInfo),Vn(i,s),Ln(s),Ms=u;break;case 12:Vn(i,s),Ln(s);break;case 31:Vn(i,s),Ln(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Lh(s,u)));break;case 13:Vn(i,s),Ln(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(zh=dn()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Lh(s,u)));break;case 22:f=s.memoizedState!==null;var P=o!==null&&o.memoizedState!==null,Q=Hr,ee=Wt;if(Hr=Q||f,Wt=ee||P,Vn(i,s),Wt=ee,Hr=Q,Ln(s),u&8192)e:for(i=s.stateNode,i._visibility=f?i._visibility&-2:i._visibility|1,f&&(o===null||P||Hr||Wt||Ba(s)),o=null,i=s;;){if(i.tag===5||i.tag===26){if(o===null){P=o=i;try{if(p=P.stateNode,f)b=p.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{T=P.stateNode;var ie=P.memoizedProps.style,X=ie!=null&&ie.hasOwnProperty("display")?ie.display:null;T.style.display=X==null||typeof X=="boolean"?"":(""+X).trim()}}catch(ye){ft(P,P.return,ye)}}}else if(i.tag===6){if(o===null){P=i;try{P.stateNode.nodeValue=f?"":P.memoizedProps}catch(ye){ft(P,P.return,ye)}}}else if(i.tag===18){if(o===null){P=i;try{var Z=P.stateNode;f?fb(Z,!0):fb(P.stateNode,!1)}catch(ye){ft(P,P.return,ye)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===s)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;o===i&&(o=null),i=i.return}o===i&&(o=null),i.sibling.return=i.return,i=i.sibling}u&4&&(u=s.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,Lh(s,o))));break;case 19:Vn(i,s),Ln(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Lh(s,u)));break;case 30:break;case 21:break;default:Vn(i,s),Ln(s)}}function Ln(s){var i=s.flags;if(i&2){try{for(var o,u=s.return;u!==null;){if(g_(u)){o=u;break}u=u.return}if(o==null)throw Error(r(160));switch(o.tag){case 27:var f=o.stateNode,p=ag(s);Vh(s,p,f);break;case 5:var b=o.stateNode;o.flags&32&&(Mn(b,""),o.flags&=-33);var T=ag(s);Vh(s,T,b);break;case 3:case 4:var P=o.stateNode.containerInfo,Q=ag(s);og(s,Q,P);break;default:throw Error(r(161))}}catch(ee){ft(s,s.return,ee)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function T_(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var i=s;T_(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),s=s.sibling}}function Fr(s,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)v_(s,i.alternate,i),i=i.sibling}function Ba(s){for(s=s.child;s!==null;){var i=s;switch(i.tag){case 0:case 11:case 14:case 15:Ai(4,i,i.return),Ba(i);break;case 1:dr(i,i.return);var o=i.stateNode;typeof o.componentWillUnmount=="function"&&f_(i,i.return,o),Ba(i);break;case 27:Lc(i.stateNode);case 26:case 5:dr(i,i.return),Ba(i);break;case 22:i.memoizedState===null&&Ba(i);break;case 30:Ba(i);break;default:Ba(i)}s=s.sibling}}function Gr(s,i,o){for(o=o&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var u=i.alternate,f=s,p=i,b=p.flags;switch(p.tag){case 0:case 11:case 15:Gr(f,p,o),Rc(4,p);break;case 1:if(Gr(f,p,o),u=p,f=u.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(Q){ft(u,u.return,Q)}if(u=p,f=u.updateQueue,f!==null){var T=u.stateNode;try{var P=f.shared.hiddenCallbacks;if(P!==null)for(f.shared.hiddenCallbacks=null,f=0;f<P.length;f++)tv(P[f],T)}catch(Q){ft(u,u.return,Q)}}o&&b&64&&d_(p),Cc(p,p.return);break;case 27:p_(p);case 26:case 5:Gr(f,p,o),o&&u===null&&b&4&&m_(p),Cc(p,p.return);break;case 12:Gr(f,p,o);break;case 31:Gr(f,p,o),o&&b&4&&w_(f,p);break;case 13:Gr(f,p,o),o&&b&4&&x_(f,p);break;case 22:p.memoizedState===null&&Gr(f,p,o),Cc(p,p.return);break;case 30:break;default:Gr(f,p,o)}i=i.sibling}}function cg(s,i){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&gc(o))}function ug(s,i){s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&gc(s))}function Ps(s,i,o,u){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)S_(s,i,o,u),i=i.sibling}function S_(s,i,o,u){var f=i.flags;switch(i.tag){case 0:case 11:case 15:Ps(s,i,o,u),f&2048&&Rc(9,i);break;case 1:Ps(s,i,o,u);break;case 3:Ps(s,i,o,u),f&2048&&(s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&gc(s)));break;case 12:if(f&2048){Ps(s,i,o,u),s=i.stateNode;try{var p=i.memoizedProps,b=p.id,T=p.onPostCommit;typeof T=="function"&&T(b,i.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(P){ft(i,i.return,P)}}else Ps(s,i,o,u);break;case 31:Ps(s,i,o,u);break;case 13:Ps(s,i,o,u);break;case 23:break;case 22:p=i.stateNode,b=i.alternate,i.memoizedState!==null?p._visibility&2?Ps(s,i,o,u):Ic(s,i):p._visibility&2?Ps(s,i,o,u):(p._visibility|=2,Ho(s,i,o,u,(i.subtreeFlags&10256)!==0||!1)),f&2048&&cg(b,i);break;case 24:Ps(s,i,o,u),f&2048&&ug(i.alternate,i);break;default:Ps(s,i,o,u)}}function Ho(s,i,o,u,f){for(f=f&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var p=s,b=i,T=o,P=u,Q=b.flags;switch(b.tag){case 0:case 11:case 15:Ho(p,b,T,P,f),Rc(8,b);break;case 23:break;case 22:var ee=b.stateNode;b.memoizedState!==null?ee._visibility&2?Ho(p,b,T,P,f):Ic(p,b):(ee._visibility|=2,Ho(p,b,T,P,f)),f&&Q&2048&&cg(b.alternate,b);break;case 24:Ho(p,b,T,P,f),f&&Q&2048&&ug(b.alternate,b);break;default:Ho(p,b,T,P,f)}i=i.sibling}}function Ic(s,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var o=s,u=i,f=u.flags;switch(u.tag){case 22:Ic(o,u),f&2048&&cg(u.alternate,u);break;case 24:Ic(o,u),f&2048&&ug(u.alternate,u);break;default:Ic(o,u)}i=i.sibling}}var jc=8192;function $o(s,i,o){if(s.subtreeFlags&jc)for(s=s.child;s!==null;)A_(s,i,o),s=s.sibling}function A_(s,i,o){switch(s.tag){case 26:$o(s,i,o),s.flags&jc&&s.memoizedState!==null&&EA(o,Ms,s.memoizedState,s.memoizedProps);break;case 5:$o(s,i,o);break;case 3:case 4:var u=Ms;Ms=Jh(s.stateNode.containerInfo),$o(s,i,o),Ms=u;break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=jc,jc=16777216,$o(s,i,o),jc=u):$o(s,i,o));break;default:$o(s,i,o)}}function N_(s){var i=s.alternate;if(i!==null&&(s=i.child,s!==null)){i.child=null;do i=s.sibling,s.sibling=null,s=i;while(s!==null)}}function kc(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var u=i[o];on=u,C_(u,s)}N_(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)R_(s),s=s.sibling}function R_(s){switch(s.tag){case 0:case 11:case 15:kc(s),s.flags&2048&&Ai(9,s,s.return);break;case 3:kc(s);break;case 12:kc(s);break;case 22:var i=s.stateNode;s.memoizedState!==null&&i._visibility&2&&(s.return===null||s.return.tag!==13)?(i._visibility&=-3,Uh(s)):kc(s);break;default:kc(s)}}function Uh(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var u=i[o];on=u,C_(u,s)}N_(s)}for(s=s.child;s!==null;){switch(i=s,i.tag){case 0:case 11:case 15:Ai(8,i,i.return),Uh(i);break;case 22:o=i.stateNode,o._visibility&2&&(o._visibility&=-3,Uh(i));break;default:Uh(i)}s=s.sibling}}function C_(s,i){for(;on!==null;){var o=on;switch(o.tag){case 0:case 11:case 15:Ai(8,o,i);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:gc(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,on=u;else e:for(o=s;on!==null;){u=on;var f=u.sibling,p=u.return;if(__(u),u===o){on=null;break e}if(f!==null){f.return=p,on=f;break e}on=p}}}var LS={getCacheForType:function(s){var i=gn(Qt),o=i.data.get(s);return o===void 0&&(o=s(),i.data.set(s,o)),o},cacheSignal:function(){return gn(Qt).controller.signal}},US=typeof WeakMap=="function"?WeakMap:Map,ot=0,bt=null,He=null,Ge=0,dt=0,Jn=null,Ni=!1,Fo=!1,hg=!1,Kr=0,Pt=0,Ri=0,qa=0,dg=0,Zn=0,Go=0,Oc=null,Un=null,fg=!1,zh=0,I_=0,Bh=1/0,qh=null,Ci=null,nn=0,Ii=null,Ko=null,Qr=0,mg=0,gg=null,j_=null,Dc=0,pg=null;function es(){return(ot&2)!==0&&Ge!==0?Ge&-Ge:q.T!==null?xg():pe()}function k_(){if(Zn===0)if((Ge&536870912)===0||We){var s=Ns;Ns<<=1,(Ns&3932160)===0&&(Ns=262144),Zn=s}else Zn=536870912;return s=Xn.current,s!==null&&(s.flags|=32),Zn}function zn(s,i,o){(s===bt&&(dt===2||dt===9)||s.cancelPendingCommit!==null)&&(Qo(s,0),ji(s,Ge,Zn,!1)),Cr(s,o),((ot&2)===0||s!==bt)&&(s===bt&&((ot&2)===0&&(qa|=o),Pt===4&&ji(s,Ge,Zn,!1)),fr(s))}function O_(s,i,o){if((ot&6)!==0)throw Error(r(327));var u=!o&&(i&127)===0&&(i&s.expiredLanes)===0||Fn(s,i),f=u?qS(s,i):vg(s,i,!0),p=u;do{if(f===0){Fo&&!u&&ji(s,i,0,!1);break}else{if(o=s.current.alternate,p&&!zS(o)){f=vg(s,i,!1),p=!1;continue}if(f===2){if(p=i,s.errorRecoveryDisabledLanes&p)var b=0;else b=s.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){i=b;e:{var T=s;f=Oc;var P=T.current.memoizedState.isDehydrated;if(P&&(Qo(T,b).flags|=256),b=vg(T,b,!1),b!==2){if(hg&&!P){T.errorRecoveryDisabledLanes|=p,qa|=p,f=4;break e}p=Un,Un=f,p!==null&&(Un===null?Un=p:Un.push.apply(Un,p))}f=b}if(p=!1,f!==2)continue}}if(f===1){Qo(s,0),ji(s,i,0,!0);break}e:{switch(u=s,p=f,p){case 0:case 1:throw Error(r(345));case 4:if((i&4194048)!==i)break;case 6:ji(u,i,Zn,!Ni);break e;case 2:Un=null;break;case 3:case 5:break;default:throw Error(r(329))}if((i&62914560)===i&&(f=zh+300-dn(),10<f)){if(ji(u,i,Zn,!Ni),cs(u,0,!0)!==0)break e;Qr=i,u.timeoutHandle=ub(D_.bind(null,u,o,Un,qh,fg,i,Zn,qa,Go,Ni,p,"Throttled",-0,0),f);break e}D_(u,o,Un,qh,fg,i,Zn,qa,Go,Ni,p,null,-0,0)}}break}while(!0);fr(s)}function D_(s,i,o,u,f,p,b,T,P,Q,ee,ie,X,Z){if(s.timeoutHandle=-1,ie=i.subtreeFlags,ie&8192||(ie&16785408)===16785408){ie={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Cs},A_(i,p,ie);var ye=(p&62914560)===p?zh-dn():(p&4194048)===p?I_-dn():0;if(ye=TA(ie,ye),ye!==null){Qr=p,s.cancelPendingCommit=ye(q_.bind(null,s,i,p,o,u,f,b,T,P,ee,ie,null,X,Z)),ji(s,p,b,!Q);return}}q_(s,i,p,o,u,f,b,T,P)}function zS(s){for(var i=s;;){var o=i.tag;if((o===0||o===11||o===15)&&i.flags&16384&&(o=i.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var f=o[u],p=f.getSnapshot;f=f.value;try{if(!Qn(p(),f))return!1}catch{return!1}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ji(s,i,o,u){i&=~dg,i&=~qa,s.suspendedLanes|=i,s.pingedLanes&=~i,u&&(s.warmLanes|=i),u=s.expirationTimes;for(var f=i;0<f;){var p=31-At(f),b=1<<p;u[p]=-1,f&=~b}o!==0&&Ws(s,o,i)}function Hh(){return(ot&6)===0?(Mc(0),!1):!0}function yg(){if(He!==null){if(dt===0)var s=He.return;else s=He,Vr=Oa=null,Om(s),Lo=null,yc=0,s=He;for(;s!==null;)h_(s.alternate,s),s=s.return;He=null}}function Qo(s,i){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,aA(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),Qr=0,yg(),bt=s,He=o=Mr(s.current,null),Ge=i,dt=0,Jn=null,Ni=!1,Fo=Fn(s,i),hg=!1,Go=Zn=dg=qa=Ri=Pt=0,Un=Oc=null,fg=!1,(i&8)!==0&&(i|=i&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=i;0<u;){var f=31-At(u),p=1<<f;i|=s[f],u&=~p}return Kr=i,uh(),o}function M_(s,i){ze=null,q.H=Sc,i===Vo||i===vh?(i=Wy(),dt=3):i===wm?(i=Wy(),dt=4):dt=i===Ym?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Jn=i,He===null&&(Pt=1,kh(s,ps(i,s.current)))}function P_(){var s=Xn.current;return s===null?!0:(Ge&4194048)===Ge?bs===null:(Ge&62914560)===Ge||(Ge&536870912)!==0?s===bs:!1}function V_(){var s=q.H;return q.H=Sc,s===null?Sc:s}function L_(){var s=q.A;return q.A=LS,s}function $h(){Pt=4,Ni||(Ge&4194048)!==Ge&&Xn.current!==null||(Fo=!0),(Ri&134217727)===0&&(qa&134217727)===0||bt===null||ji(bt,Ge,Zn,!1)}function vg(s,i,o){var u=ot;ot|=2;var f=V_(),p=L_();(bt!==s||Ge!==i)&&(qh=null,Qo(s,i)),i=!1;var b=Pt;e:do try{if(dt!==0&&He!==null){var T=He,P=Jn;switch(dt){case 8:yg(),b=6;break e;case 3:case 2:case 9:case 6:Xn.current===null&&(i=!0);var Q=dt;if(dt=0,Jn=null,Yo(s,T,P,Q),o&&Fo){b=0;break e}break;default:Q=dt,dt=0,Jn=null,Yo(s,T,P,Q)}}BS(),b=Pt;break}catch(ee){M_(s,ee)}while(!0);return i&&s.shellSuspendCounter++,Vr=Oa=null,ot=u,q.H=f,q.A=p,He===null&&(bt=null,Ge=0,uh()),b}function BS(){for(;He!==null;)U_(He)}function qS(s,i){var o=ot;ot|=2;var u=V_(),f=L_();bt!==s||Ge!==i?(qh=null,Bh=dn()+500,Qo(s,i)):Fo=Fn(s,i);e:do try{if(dt!==0&&He!==null){i=He;var p=Jn;t:switch(dt){case 1:dt=0,Jn=null,Yo(s,i,p,1);break;case 2:case 9:if(Yy(p)){dt=0,Jn=null,z_(i);break}i=function(){dt!==2&&dt!==9||bt!==s||(dt=7),fr(s)},p.then(i,i);break e;case 3:dt=7;break e;case 4:dt=5;break e;case 7:Yy(p)?(dt=0,Jn=null,z_(i)):(dt=0,Jn=null,Yo(s,i,p,7));break;case 5:var b=null;switch(He.tag){case 26:b=He.memoizedState;case 5:case 27:var T=He;if(b?Sb(b):T.stateNode.complete){dt=0,Jn=null;var P=T.sibling;if(P!==null)He=P;else{var Q=T.return;Q!==null?(He=Q,Fh(Q)):He=null}break t}}dt=0,Jn=null,Yo(s,i,p,5);break;case 6:dt=0,Jn=null,Yo(s,i,p,6);break;case 8:yg(),Pt=6;break e;default:throw Error(r(462))}}HS();break}catch(ee){M_(s,ee)}while(!0);return Vr=Oa=null,q.H=u,q.A=f,ot=o,He!==null?0:(bt=null,Ge=0,uh(),Pt)}function HS(){for(;He!==null&&!da();)U_(He)}function U_(s){var i=c_(s.alternate,s,Kr);s.memoizedProps=s.pendingProps,i===null?Fh(s):He=i}function z_(s){var i=s,o=i.alternate;switch(i.tag){case 15:case 0:i=s_(o,i,i.pendingProps,i.type,void 0,Ge);break;case 11:i=s_(o,i,i.pendingProps,i.type.render,i.ref,Ge);break;case 5:Om(i);default:h_(o,i),i=He=Ly(i,Kr),i=c_(o,i,Kr)}s.memoizedProps=s.pendingProps,i===null?Fh(s):He=i}function Yo(s,i,o,u){Vr=Oa=null,Om(i),Lo=null,yc=0;var f=i.return;try{if(jS(s,f,i,o,Ge)){Pt=1,kh(s,ps(o,s.current)),He=null;return}}catch(p){if(f!==null)throw He=f,p;Pt=1,kh(s,ps(o,s.current)),He=null;return}i.flags&32768?(We||u===1?s=!0:Fo||(Ge&536870912)!==0?s=!1:(Ni=s=!0,(u===2||u===9||u===3||u===6)&&(u=Xn.current,u!==null&&u.tag===13&&(u.flags|=16384))),B_(i,s)):Fh(i)}function Fh(s){var i=s;do{if((i.flags&32768)!==0){B_(i,Ni);return}s=i.return;var o=DS(i.alternate,i,Kr);if(o!==null){He=o;return}if(i=i.sibling,i!==null){He=i;return}He=i=s}while(i!==null);Pt===0&&(Pt=5)}function B_(s,i){do{var o=MS(s.alternate,s);if(o!==null){o.flags&=32767,He=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!i&&(s=s.sibling,s!==null)){He=s;return}He=s=o}while(s!==null);Pt=6,He=null}function q_(s,i,o,u,f,p,b,T,P){s.cancelPendingCommit=null;do Gh();while(nn!==0);if((ot&6)!==0)throw Error(r(327));if(i!==null){if(i===s.current)throw Error(r(177));if(p=i.lanes|i.childLanes,p|=am,Kl(s,o,p,b,T,P),s===bt&&(He=bt=null,Ge=0),Ko=i,Ii=s,Qr=o,mg=p,gg=f,j_=u,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,KS(Ss,function(){return K_(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||u){u=q.T,q.T=null,f=ce.p,ce.p=2,b=ot,ot|=4;try{PS(s,i,o)}finally{ot=b,ce.p=f,q.T=u}}nn=1,H_(),$_(),F_()}}function H_(){if(nn===1){nn=0;var s=Ii,i=Ko,o=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||o){o=q.T,q.T=null;var u=ce.p;ce.p=2;var f=ot;ot|=4;try{E_(i,s);var p=Ig,b=Cy(s.containerInfo),T=p.focusedElem,P=p.selectionRange;if(b!==T&&T&&T.ownerDocument&&Ry(T.ownerDocument.documentElement,T)){if(P!==null&&tm(T)){var Q=P.start,ee=P.end;if(ee===void 0&&(ee=Q),"selectionStart"in T)T.selectionStart=Q,T.selectionEnd=Math.min(ee,T.value.length);else{var ie=T.ownerDocument||document,X=ie&&ie.defaultView||window;if(X.getSelection){var Z=X.getSelection(),ye=T.textContent.length,Se=Math.min(P.start,ye),vt=P.end===void 0?Se:Math.min(P.end,ye);!Z.extend&&Se>vt&&(b=vt,vt=Se,Se=b);var H=Ny(T,Se),B=Ny(T,vt);if(H&&B&&(Z.rangeCount!==1||Z.anchorNode!==H.node||Z.anchorOffset!==H.offset||Z.focusNode!==B.node||Z.focusOffset!==B.offset)){var K=ie.createRange();K.setStart(H.node,H.offset),Z.removeAllRanges(),Se>vt?(Z.addRange(K),Z.extend(B.node,B.offset)):(K.setEnd(B.node,B.offset),Z.addRange(K))}}}}for(ie=[],Z=T;Z=Z.parentNode;)Z.nodeType===1&&ie.push({element:Z,left:Z.scrollLeft,top:Z.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<ie.length;T++){var se=ie[T];se.element.scrollLeft=se.left,se.element.scrollTop=se.top}}rd=!!Cg,Ig=Cg=null}finally{ot=f,ce.p=u,q.T=o}}s.current=i,nn=2}}function $_(){if(nn===2){nn=0;var s=Ii,i=Ko,o=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||o){o=q.T,q.T=null;var u=ce.p;ce.p=2;var f=ot;ot|=4;try{v_(s,i.alternate,i)}finally{ot=f,ce.p=u,q.T=o}}nn=3}}function F_(){if(nn===4||nn===3){nn=0,fo();var s=Ii,i=Ko,o=Qr,u=j_;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?nn=5:(nn=0,Ko=Ii=null,G_(s,s.pendingLanes));var f=s.pendingLanes;if(f===0&&(Ci=null),z(o),i=i.stateNode,Vt&&typeof Vt.onCommitFiberRoot=="function")try{Vt.onCommitFiberRoot(Hn,i,void 0,(i.current.flags&128)===128)}catch{}if(u!==null){i=q.T,f=ce.p,ce.p=2,q.T=null;try{for(var p=s.onRecoverableError,b=0;b<u.length;b++){var T=u[b];p(T.value,{componentStack:T.stack})}}finally{q.T=i,ce.p=f}}(Qr&3)!==0&&Gh(),fr(s),f=s.pendingLanes,(o&261930)!==0&&(f&42)!==0?s===pg?Dc++:(Dc=0,pg=s):Dc=0,Mc(0)}}function G_(s,i){(s.pooledCacheLanes&=i)===0&&(i=s.pooledCache,i!=null&&(s.pooledCache=null,gc(i)))}function Gh(){return H_(),$_(),F_(),K_()}function K_(){if(nn!==5)return!1;var s=Ii,i=mg;mg=0;var o=z(Qr),u=q.T,f=ce.p;try{ce.p=32>o?32:o,q.T=null,o=gg,gg=null;var p=Ii,b=Qr;if(nn=0,Ko=Ii=null,Qr=0,(ot&6)!==0)throw Error(r(331));var T=ot;if(ot|=4,R_(p.current),S_(p,p.current,b,o),ot=T,Mc(0,!1),Vt&&typeof Vt.onPostCommitFiberRoot=="function")try{Vt.onPostCommitFiberRoot(Hn,p)}catch{}return!0}finally{ce.p=f,q.T=u,G_(s,i)}}function Q_(s,i,o){i=ps(o,i),i=Qm(s.stateNode,i,2),s=Ei(s,i,2),s!==null&&(Cr(s,2),fr(s))}function ft(s,i,o){if(s.tag===3)Q_(s,s,o);else for(;i!==null;){if(i.tag===3){Q_(i,s,o);break}else if(i.tag===1){var u=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Ci===null||!Ci.has(u))){s=ps(o,s),o=Yv(2),u=Ei(i,o,2),u!==null&&(Xv(o,u,i,s),Cr(u,2),fr(u));break}}i=i.return}}function _g(s,i,o){var u=s.pingCache;if(u===null){u=s.pingCache=new US;var f=new Set;u.set(i,f)}else f=u.get(i),f===void 0&&(f=new Set,u.set(i,f));f.has(o)||(hg=!0,f.add(o),s=$S.bind(null,s,i,o),i.then(s,s))}function $S(s,i,o){var u=s.pingCache;u!==null&&u.delete(i),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,bt===s&&(Ge&o)===o&&(Pt===4||Pt===3&&(Ge&62914560)===Ge&&300>dn()-zh?(ot&2)===0&&Qo(s,0):dg|=o,Go===Ge&&(Go=0)),fr(s)}function Y_(s,i){i===0&&(i=go()),s=Ia(s,i),s!==null&&(Cr(s,i),fr(s))}function FS(s){var i=s.memoizedState,o=0;i!==null&&(o=i.retryLane),Y_(s,o)}function GS(s,i){var o=0;switch(s.tag){case 31:case 13:var u=s.stateNode,f=s.memoizedState;f!==null&&(o=f.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(r(314))}u!==null&&u.delete(i),Y_(s,o)}function KS(s,i){return Ot(s,i)}var Kh=null,Xo=null,bg=!1,Qh=!1,wg=!1,ki=0;function fr(s){s!==Xo&&s.next===null&&(Xo===null?Kh=Xo=s:Xo=Xo.next=s),Qh=!0,bg||(bg=!0,YS())}function Mc(s,i){if(!wg&&Qh){wg=!0;do for(var o=!1,u=Kh;u!==null;){if(s!==0){var f=u.pendingLanes;if(f===0)var p=0;else{var b=u.suspendedLanes,T=u.pingedLanes;p=(1<<31-At(42|s)+1)-1,p&=f&~(b&~T),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(o=!0,Z_(u,p))}else p=Ge,p=cs(u,u===bt?p:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(p&3)===0||Fn(u,p)||(o=!0,Z_(u,p));u=u.next}while(o);wg=!1}}function QS(){X_()}function X_(){Qh=bg=!1;var s=0;ki!==0&&iA()&&(s=ki);for(var i=dn(),o=null,u=Kh;u!==null;){var f=u.next,p=W_(u,i);p===0?(u.next=null,o===null?Kh=f:o.next=f,f===null&&(Xo=o)):(o=u,(s!==0||(p&3)!==0)&&(Qh=!0)),u=f}nn!==0&&nn!==5||Mc(s),ki!==0&&(ki=0)}function W_(s,i){for(var o=s.suspendedLanes,u=s.pingedLanes,f=s.expirationTimes,p=s.pendingLanes&-62914561;0<p;){var b=31-At(p),T=1<<b,P=f[b];P===-1?((T&o)===0||(T&u)!==0)&&(f[b]=Gl(T,i)):P<=i&&(s.expiredLanes|=T),p&=~T}if(i=bt,o=Ge,o=cs(s,s===i?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,o===0||s===i&&(dt===2||dt===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&Es(u),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||Fn(s,o)){if(i=o&-o,i===s.callbackPriority)return i;switch(u!==null&&Es(u),z(o)){case 2:case 8:o=fa;break;case 32:o=Ss;break;case 268435456:o=ma;break;default:o=Ss}return u=J_.bind(null,s),o=Ot(o,u),s.callbackPriority=i,s.callbackNode=o,i}return u!==null&&u!==null&&Es(u),s.callbackPriority=2,s.callbackNode=null,2}function J_(s,i){if(nn!==0&&nn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(Gh()&&s.callbackNode!==o)return null;var u=Ge;return u=cs(s,s===bt?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:(O_(s,u,i),W_(s,dn()),s.callbackNode!=null&&s.callbackNode===o?J_.bind(null,s):null)}function Z_(s,i){if(Gh())return null;O_(s,i,!0)}function YS(){oA(function(){(ot&6)!==0?Ot(Ts,QS):X_()})}function xg(){if(ki===0){var s=Mo;s===0&&(s=$n,$n<<=1,($n&261888)===0&&($n=256)),ki=s}return ki}function eb(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:bo(""+s)}function tb(s,i){var o=i.ownerDocument.createElement("input");return o.name=i.name,o.value=i.value,s.id&&o.setAttribute("form",s.id),i.parentNode.insertBefore(o,i),s=new FormData(s),o.parentNode.removeChild(o),s}function XS(s,i,o,u,f){if(i==="submit"&&o&&o.stateNode===f){var p=eb((f[st]||null).action),b=u.submitter;b&&(i=(i=b[st]||null)?eb(i.formAction):b.getAttribute("formAction"),i!==null&&(p=i,b=null));var T=new ar("action","action",null,u,f);s.push({event:T,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(ki!==0){var P=b?tb(f,b):new FormData(f);qm(o,{pending:!0,data:P,method:f.method,action:p},null,P)}}else typeof p=="function"&&(T.preventDefault(),P=b?tb(f,b):new FormData(f),qm(o,{pending:!0,data:P,method:f.method,action:p},p,P))},currentTarget:f}]})}}for(var Eg=0;Eg<im.length;Eg++){var Tg=im[Eg],WS=Tg.toLowerCase(),JS=Tg[0].toUpperCase()+Tg.slice(1);Ds(WS,"on"+JS)}Ds(ky,"onAnimationEnd"),Ds(Oy,"onAnimationIteration"),Ds(Dy,"onAnimationStart"),Ds("dblclick","onDoubleClick"),Ds("focusin","onFocus"),Ds("focusout","onBlur"),Ds(mS,"onTransitionRun"),Ds(gS,"onTransitionStart"),Ds(pS,"onTransitionCancel"),Ds(My,"onTransitionEnd"),nr("onMouseEnter",["mouseout","mouseover"]),nr("onMouseLeave",["mouseout","mouseover"]),nr("onPointerEnter",["pointerout","pointerover"]),nr("onPointerLeave",["pointerout","pointerover"]),tr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),tr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),tr("onBeforeInput",["compositionend","keypress","textInput","paste"]),tr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),tr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),tr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ZS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Pc));function nb(s,i){i=(i&4)!==0;for(var o=0;o<s.length;o++){var u=s[o],f=u.event;u=u.listeners;e:{var p=void 0;if(i)for(var b=u.length-1;0<=b;b--){var T=u[b],P=T.instance,Q=T.currentTarget;if(T=T.listener,P!==p&&f.isPropagationStopped())break e;p=T,f.currentTarget=Q;try{p(f)}catch(ee){ch(ee)}f.currentTarget=null,p=P}else for(b=0;b<u.length;b++){if(T=u[b],P=T.instance,Q=T.currentTarget,T=T.listener,P!==p&&f.isPropagationStopped())break e;p=T,f.currentTarget=Q;try{p(f)}catch(ee){ch(ee)}f.currentTarget=null,p=P}}}}function $e(s,i){var o=i[Cn];o===void 0&&(o=i[Cn]=new Set);var u=s+"__bubble";o.has(u)||(sb(i,s,2,!1),o.add(u))}function Sg(s,i,o){var u=0;i&&(u|=4),sb(o,s,u,i)}var Yh="_reactListening"+Math.random().toString(36).slice(2);function Ag(s){if(!s[Yh]){s[Yh]=!0,Ql.forEach(function(o){o!=="selectionchange"&&(ZS.has(o)||Sg(o,!1,s),Sg(o,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[Yh]||(i[Yh]=!0,Sg("selectionchange",!1,i))}}function sb(s,i,o,u){switch(kb(i)){case 2:var f=NA;break;case 8:f=RA;break;default:f=Bg}o=f.bind(null,i,o,s),f=void 0,!xa||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(f=!0),u?f!==void 0?s.addEventListener(i,o,{capture:!0,passive:f}):s.addEventListener(i,o,!0):f!==void 0?s.addEventListener(i,o,{passive:f}):s.addEventListener(i,o,!1)}function Ng(s,i,o,u,f){var p=u;if((i&1)===0&&(i&2)===0&&u!==null)e:for(;;){if(u===null)return;var b=u.tag;if(b===3||b===4){var T=u.stateNode.containerInfo;if(T===f)break;if(b===4)for(b=u.return;b!==null;){var P=b.tag;if((P===3||P===4)&&b.stateNode.containerInfo===f)return;b=b.return}for(;T!==null;){if(b=Zs(T),b===null)return;if(P=b.tag,P===5||P===6||P===26||P===27){u=p=b;continue e}T=T.parentNode}}u=u.return}fi(function(){var Q=p,ee=ds(o),ie=[];e:{var X=Py.get(s);if(X!==void 0){var Z=ar,ye=s;switch(s){case"keypress":if(Ta(o)===0)break e;case"keydown":case"keyup":Z=ah;break;case"focusin":ye="focus",Z=Aa;break;case"focusout":ye="blur",Z=Aa;break;case"beforeblur":case"afterblur":Z=Aa;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Z=oc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Z=Wu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Z=v;break;case ky:case Oy:case Dy:Z=Zu;break;case My:Z=A;break;case"scroll":case"scrollend":Z=ac;break;case"wheel":Z=J;break;case"copy":case"cut":case"paste":Z=eh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Z=Dr;break;case"toggle":case"beforetoggle":Z=Ue}var Se=(i&4)!==0,vt=!Se&&(s==="scroll"||s==="scrollend"),H=Se?X!==null?X+"Capture":null:X;Se=[];for(var B=Q,K;B!==null;){var se=B;if(K=se.stateNode,se=se.tag,se!==5&&se!==26&&se!==27||K===null||H===null||(se=Is(B,H),se!=null&&Se.push(Vc(B,se,K))),vt)break;B=B.return}0<Se.length&&(X=new Z(X,ye,null,o,ee),ie.push({event:X,listeners:Se}))}}if((i&7)===0){e:{if(X=s==="mouseover"||s==="pointerover",Z=s==="mouseout"||s==="pointerout",X&&o!==sc&&(ye=o.relatedTarget||o.fromElement)&&(Zs(ye)||ye[lt]))break e;if((Z||X)&&(X=ee.window===ee?ee:(X=ee.ownerDocument)?X.defaultView||X.parentWindow:window,Z?(ye=o.relatedTarget||o.toElement,Z=Q,ye=ye?Zs(ye):null,ye!==null&&(vt=l(ye),Se=ye.tag,ye!==vt||Se!==5&&Se!==27&&Se!==6)&&(ye=null)):(Z=null,ye=Q),Z!==ye)){if(Se=oc,se="onMouseLeave",H="onMouseEnter",B="mouse",(s==="pointerout"||s==="pointerover")&&(Se=Dr,se="onPointerLeave",H="onPointerEnter",B="pointer"),vt=Z==null?X:Gn(Z),K=ye==null?X:Gn(ye),X=new Se(se,B+"leave",Z,o,ee),X.target=vt,X.relatedTarget=K,se=null,Zs(ee)===Q&&(Se=new Se(H,B+"enter",ye,o,ee),Se.target=K,Se.relatedTarget=vt,se=Se),vt=se,Z&&ye)t:{for(Se=eA,H=Z,B=ye,K=0,se=H;se;se=Se(se))K++;se=0;for(var Ee=B;Ee;Ee=Se(Ee))se++;for(;0<K-se;)H=Se(H),K--;for(;0<se-K;)B=Se(B),se--;for(;K--;){if(H===B||B!==null&&H===B.alternate){Se=H;break t}H=Se(H),B=Se(B)}Se=null}else Se=null;Z!==null&&rb(ie,X,Z,Se,!1),ye!==null&&vt!==null&&rb(ie,vt,ye,Se,!0)}}e:{if(X=Q?Gn(Q):window,Z=X.nodeName&&X.nodeName.toLowerCase(),Z==="select"||Z==="input"&&X.type==="file")var rt=wy;else if(_y(X))if(xy)rt=hS;else{rt=cS;var be=lS}else Z=X.nodeName,!Z||Z.toLowerCase()!=="input"||X.type!=="checkbox"&&X.type!=="radio"?Q&&_o(Q.elementType)&&(rt=wy):rt=uS;if(rt&&(rt=rt(s,Q))){by(ie,rt,o,ee);break e}be&&be(s,X,Q),s==="focusout"&&Q&&X.type==="number"&&Q.memoizedProps.value!=null&&ec(X,"number",X.value)}switch(be=Q?Gn(Q):window,s){case"focusin":(_y(be)||be.contentEditable==="true")&&(No=be,nm=Q,dc=null);break;case"focusout":dc=nm=No=null;break;case"mousedown":sm=!0;break;case"contextmenu":case"mouseup":case"dragend":sm=!1,Iy(ie,o,ee);break;case"selectionchange":if(fS)break;case"keydown":case"keyup":Iy(ie,o,ee)}var Be;if(at)e:{switch(s){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else Ao?Na(s,o)&&(Ke="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(Ke="onCompositionStart");Ke&&(cr&&o.locale!=="ko"&&(Ao||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&Ao&&(Be=ic()):(ir=ee,rc="value"in ir?ir.value:ir.textContent,Ao=!0)),be=Xh(Q,Ke),0<be.length&&(Ke=new lr(Ke,s,null,o,ee),ie.push({event:Ke,listeners:be}),Be?Ke.data=Be:(Be=So(o),Be!==null&&(Ke.data=Be)))),(Be=ms?rS(s,o):iS(s,o))&&(Ke=Xh(Q,"onBeforeInput"),0<Ke.length&&(be=new lr("onBeforeInput","beforeinput",null,o,ee),ie.push({event:be,listeners:Ke}),be.data=Be)),XS(ie,s,Q,o,ee)}nb(ie,i)})}function Vc(s,i,o){return{instance:s,listener:i,currentTarget:o}}function Xh(s,i){for(var o=i+"Capture",u=[];s!==null;){var f=s,p=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||p===null||(f=Is(s,o),f!=null&&u.unshift(Vc(s,f,p)),f=Is(s,i),f!=null&&u.push(Vc(s,f,p))),s.tag===3)return u;s=s.return}return[]}function eA(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function rb(s,i,o,u,f){for(var p=i._reactName,b=[];o!==null&&o!==u;){var T=o,P=T.alternate,Q=T.stateNode;if(T=T.tag,P!==null&&P===u)break;T!==5&&T!==26&&T!==27||Q===null||(P=Q,f?(Q=Is(o,p),Q!=null&&b.unshift(Vc(o,Q,P))):f||(Q=Is(o,p),Q!=null&&b.push(Vc(o,Q,P)))),o=o.return}b.length!==0&&s.push({event:i,listeners:b})}var tA=/\r\n?/g,nA=/\u0000|\uFFFD/g;function ib(s){return(typeof s=="string"?s:""+s).replace(tA,`
`).replace(nA,"")}function ab(s,i){return i=ib(i),ib(s)===i}function yt(s,i,o,u,f,p){switch(o){case"children":typeof u=="string"?i==="body"||i==="textarea"&&u===""||Mn(s,u):(typeof u=="number"||typeof u=="bigint")&&i!=="body"&&Mn(s,""+u);break;case"className":Kn(s,"class",u);break;case"tabIndex":Kn(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Kn(s,o,u);break;case"style":nc(s,u,p);break;case"data":if(i!=="object"){Kn(s,"data",u);break}case"src":case"href":if(u===""&&(i!=="a"||o!=="href")){s.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(o);break}u=bo(""+u),s.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(o==="formAction"?(i!=="input"&&yt(s,i,"name",f.name,f,null),yt(s,i,"formEncType",f.formEncType,f,null),yt(s,i,"formMethod",f.formMethod,f,null),yt(s,i,"formTarget",f.formTarget,f,null)):(yt(s,i,"encType",f.encType,f,null),yt(s,i,"method",f.method,f,null),yt(s,i,"target",f.target,f,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(o);break}u=bo(""+u),s.setAttribute(o,u);break;case"onClick":u!=null&&(s.onclick=Cs);break;case"onScroll":u!=null&&$e("scroll",s);break;case"onScrollEnd":u!=null&&$e("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(r(61));if(o=u.__html,o!=null){if(f.children!=null)throw Error(r(60));s.innerHTML=o}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}o=bo(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(o,""+u):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":u===!0?s.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(o,u):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(o,u):s.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(o):s.setAttribute(o,u);break;case"popover":$e("beforetoggle",s),$e("toggle",s),yo(s,"popover",u);break;case"xlinkActuate":Kt(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Kt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Kt(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Kt(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Kt(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Kt(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Kt(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Kt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Kt(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":yo(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Xu.get(o)||o,yo(s,o,u))}}function Rg(s,i,o,u,f,p){switch(o){case"style":nc(s,u,p);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(r(61));if(o=u.__html,o!=null){if(f.children!=null)throw Error(r(60));s.innerHTML=o}}break;case"children":typeof u=="string"?Mn(s,u):(typeof u=="number"||typeof u=="bigint")&&Mn(s,""+u);break;case"onScroll":u!=null&&$e("scroll",s);break;case"onScrollEnd":u!=null&&$e("scrollend",s);break;case"onClick":u!=null&&(s.onclick=Cs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Yl.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),i=o.slice(2,f?o.length-7:void 0),p=s[st]||null,p=p!=null?p[o]:null,typeof p=="function"&&s.removeEventListener(i,p,f),typeof u=="function")){typeof p!="function"&&p!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(i,u,f);break e}o in s?s[o]=u:u===!0?s.setAttribute(o,""):yo(s,o,u)}}}function yn(s,i,o){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$e("error",s),$e("load",s);var u=!1,f=!1,p;for(p in o)if(o.hasOwnProperty(p)){var b=o[p];if(b!=null)switch(p){case"src":u=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:yt(s,i,p,b,o,null)}}f&&yt(s,i,"srcSet",o.srcSet,o,null),u&&yt(s,i,"src",o.src,o,null);return;case"input":$e("invalid",s);var T=p=b=f=null,P=null,Q=null;for(u in o)if(o.hasOwnProperty(u)){var ee=o[u];if(ee!=null)switch(u){case"name":f=ee;break;case"type":b=ee;break;case"checked":P=ee;break;case"defaultChecked":Q=ee;break;case"value":p=ee;break;case"defaultValue":T=ee;break;case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(r(137,i));break;default:yt(s,i,u,ee,o,null)}}Ku(s,p,T,P,Q,b,f,!1);return;case"select":$e("invalid",s),u=b=p=null;for(f in o)if(o.hasOwnProperty(f)&&(T=o[f],T!=null))switch(f){case"value":p=T;break;case"defaultValue":b=T;break;case"multiple":u=T;default:yt(s,i,f,T,o,null)}i=p,o=b,s.multiple=!!u,i!=null?ci(s,!!u,i,!1):o!=null&&ci(s,!!u,o,!0);return;case"textarea":$e("invalid",s),p=f=u=null;for(b in o)if(o.hasOwnProperty(b)&&(T=o[b],T!=null))switch(b){case"value":u=T;break;case"defaultValue":f=T;break;case"children":p=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(r(91));break;default:yt(s,i,b,T,o,null)}ui(s,u,f,p);return;case"option":for(P in o)if(o.hasOwnProperty(P)&&(u=o[P],u!=null))switch(P){case"selected":s.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:yt(s,i,P,u,o,null)}return;case"dialog":$e("beforetoggle",s),$e("toggle",s),$e("cancel",s),$e("close",s);break;case"iframe":case"object":$e("load",s);break;case"video":case"audio":for(u=0;u<Pc.length;u++)$e(Pc[u],s);break;case"image":$e("error",s),$e("load",s);break;case"details":$e("toggle",s);break;case"embed":case"source":case"link":$e("error",s),$e("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in o)if(o.hasOwnProperty(Q)&&(u=o[Q],u!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:yt(s,i,Q,u,o,null)}return;default:if(_o(i)){for(ee in o)o.hasOwnProperty(ee)&&(u=o[ee],u!==void 0&&Rg(s,i,ee,u,o,void 0));return}}for(T in o)o.hasOwnProperty(T)&&(u=o[T],u!=null&&yt(s,i,T,u,o,null))}function sA(s,i,o,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,p=null,b=null,T=null,P=null,Q=null,ee=null;for(Z in o){var ie=o[Z];if(o.hasOwnProperty(Z)&&ie!=null)switch(Z){case"checked":break;case"value":break;case"defaultValue":P=ie;default:u.hasOwnProperty(Z)||yt(s,i,Z,null,u,ie)}}for(var X in u){var Z=u[X];if(ie=o[X],u.hasOwnProperty(X)&&(Z!=null||ie!=null))switch(X){case"type":p=Z;break;case"name":f=Z;break;case"checked":Q=Z;break;case"defaultChecked":ee=Z;break;case"value":b=Z;break;case"defaultValue":T=Z;break;case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(r(137,i));break;default:Z!==ie&&yt(s,i,X,Z,u,ie)}}vo(s,b,T,P,Q,ee,p,f);return;case"select":Z=b=T=X=null;for(p in o)if(P=o[p],o.hasOwnProperty(p)&&P!=null)switch(p){case"value":break;case"multiple":Z=P;default:u.hasOwnProperty(p)||yt(s,i,p,null,u,P)}for(f in u)if(p=u[f],P=o[f],u.hasOwnProperty(f)&&(p!=null||P!=null))switch(f){case"value":X=p;break;case"defaultValue":T=p;break;case"multiple":b=p;default:p!==P&&yt(s,i,f,p,u,P)}i=T,o=b,u=Z,X!=null?ci(s,!!o,X,!1):!!u!=!!o&&(i!=null?ci(s,!!o,i,!0):ci(s,!!o,o?[]:"",!1));return;case"textarea":Z=X=null;for(T in o)if(f=o[T],o.hasOwnProperty(T)&&f!=null&&!u.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:yt(s,i,T,null,u,f)}for(b in u)if(f=u[b],p=o[b],u.hasOwnProperty(b)&&(f!=null||p!=null))switch(b){case"value":X=f;break;case"defaultValue":Z=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(r(91));break;default:f!==p&&yt(s,i,b,f,u,p)}Qu(s,X,Z);return;case"option":for(var ye in o)if(X=o[ye],o.hasOwnProperty(ye)&&X!=null&&!u.hasOwnProperty(ye))switch(ye){case"selected":s.selected=!1;break;default:yt(s,i,ye,null,u,X)}for(P in u)if(X=u[P],Z=o[P],u.hasOwnProperty(P)&&X!==Z&&(X!=null||Z!=null))switch(P){case"selected":s.selected=X&&typeof X!="function"&&typeof X!="symbol";break;default:yt(s,i,P,X,u,Z)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Se in o)X=o[Se],o.hasOwnProperty(Se)&&X!=null&&!u.hasOwnProperty(Se)&&yt(s,i,Se,null,u,X);for(Q in u)if(X=u[Q],Z=o[Q],u.hasOwnProperty(Q)&&X!==Z&&(X!=null||Z!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(r(137,i));break;default:yt(s,i,Q,X,u,Z)}return;default:if(_o(i)){for(var vt in o)X=o[vt],o.hasOwnProperty(vt)&&X!==void 0&&!u.hasOwnProperty(vt)&&Rg(s,i,vt,void 0,u,X);for(ee in u)X=u[ee],Z=o[ee],!u.hasOwnProperty(ee)||X===Z||X===void 0&&Z===void 0||Rg(s,i,ee,X,u,Z);return}}for(var H in o)X=o[H],o.hasOwnProperty(H)&&X!=null&&!u.hasOwnProperty(H)&&yt(s,i,H,null,u,X);for(ie in u)X=u[ie],Z=o[ie],!u.hasOwnProperty(ie)||X===Z||X==null&&Z==null||yt(s,i,ie,X,u,Z)}function ob(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function rA(){if(typeof performance.getEntriesByType=="function"){for(var s=0,i=0,o=performance.getEntriesByType("resource"),u=0;u<o.length;u++){var f=o[u],p=f.transferSize,b=f.initiatorType,T=f.duration;if(p&&T&&ob(b)){for(b=0,T=f.responseEnd,u+=1;u<o.length;u++){var P=o[u],Q=P.startTime;if(Q>T)break;var ee=P.transferSize,ie=P.initiatorType;ee&&ob(ie)&&(P=P.responseEnd,b+=ee*(P<T?1:(T-Q)/(P-Q)))}if(--u,i+=8*(p+b)/(f.duration/1e3),s++,10<s)break}}if(0<s)return i/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Cg=null,Ig=null;function Wh(s){return s.nodeType===9?s:s.ownerDocument}function lb(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function cb(s,i){if(s===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&i==="foreignObject"?0:s}function jg(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var kg=null;function iA(){var s=window.event;return s&&s.type==="popstate"?s===kg?!1:(kg=s,!0):(kg=null,!1)}var ub=typeof setTimeout=="function"?setTimeout:void 0,aA=typeof clearTimeout=="function"?clearTimeout:void 0,hb=typeof Promise=="function"?Promise:void 0,oA=typeof queueMicrotask=="function"?queueMicrotask:typeof hb<"u"?function(s){return hb.resolve(null).then(s).catch(lA)}:ub;function lA(s){setTimeout(function(){throw s})}function Oi(s){return s==="head"}function db(s,i){var o=i,u=0;do{var f=o.nextSibling;if(s.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"||o==="/&"){if(u===0){s.removeChild(f),el(i);return}u--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")u++;else if(o==="html")Lc(s.ownerDocument.documentElement);else if(o==="head"){o=s.ownerDocument.head,Lc(o);for(var p=o.firstChild;p;){var b=p.nextSibling,T=p.nodeName;p[Js]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&p.rel.toLowerCase()==="stylesheet"||o.removeChild(p),p=b}}else o==="body"&&Lc(s.ownerDocument.body);o=f}while(o);el(i)}function fb(s,i){var o=s;s=0;do{var u=o.nextSibling;if(o.nodeType===1?i?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(i?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),u&&u.nodeType===8)if(o=u.data,o==="/$"){if(s===0)break;s--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||s++;o=u}while(o)}function Og(s){var i=s.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var o=i;switch(i=i.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Og(o),po(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function cA(s,i,o,u){for(;s.nodeType===1;){var f=o;if(s.nodeName.toLowerCase()!==i.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[Js])switch(i){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(p=s.getAttribute("rel"),p==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(p!==f.rel||s.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||s.getAttribute("title")!==(f.title==null?null:f.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(p=s.getAttribute("src"),(p!==(f.src==null?null:f.src)||s.getAttribute("type")!==(f.type==null?null:f.type)||s.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&p&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(i==="input"&&s.type==="hidden"){var p=f.name==null?null:""+f.name;if(f.type==="hidden"&&s.getAttribute("name")===p)return s}else return s;if(s=ws(s.nextSibling),s===null)break}return null}function uA(s,i,o){if(i==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=ws(s.nextSibling),s===null))return null;return s}function mb(s,i){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!i||(s=ws(s.nextSibling),s===null))return null;return s}function Dg(s){return s.data==="$?"||s.data==="$~"}function Mg(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function hA(s,i){var o=s.ownerDocument;if(s.data==="$~")s._reactRetry=i;else if(s.data!=="$?"||o.readyState!=="loading")i();else{var u=function(){i(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function ws(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return s}var Pg=null;function gb(s){s=s.nextSibling;for(var i=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"||o==="/&"){if(i===0)return ws(s.nextSibling);i--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||i++}s=s.nextSibling}return null}function pb(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(i===0)return s;i--}else o!=="/$"&&o!=="/&"||i++}s=s.previousSibling}return null}function yb(s,i,o){switch(i=Wh(o),s){case"html":if(s=i.documentElement,!s)throw Error(r(452));return s;case"head":if(s=i.head,!s)throw Error(r(453));return s;case"body":if(s=i.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Lc(s){for(var i=s.attributes;i.length;)s.removeAttributeNode(i[0]);po(s)}var xs=new Map,vb=new Set;function Jh(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Yr=ce.d;ce.d={f:dA,r:fA,D:mA,C:gA,L:pA,m:yA,X:_A,S:vA,M:bA};function dA(){var s=Yr.f(),i=Hh();return s||i}function fA(s){var i=hs(s);i!==null&&i.tag===5&&i.type==="form"?Mv(i):Yr.r(s)}var Wo=typeof document>"u"?null:document;function _b(s,i,o){var u=Wo;if(u&&typeof i=="string"&&i){var f=Dn(i);f='link[rel="'+s+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),vb.has(f)||(vb.add(f),s={rel:s,crossOrigin:o,href:i},u.querySelector(f)===null&&(i=u.createElement("link"),yn(i,"link",s),Gt(i),u.head.appendChild(i)))}}function mA(s){Yr.D(s),_b("dns-prefetch",s,null)}function gA(s,i){Yr.C(s,i),_b("preconnect",s,i)}function pA(s,i,o){Yr.L(s,i,o);var u=Wo;if(u&&s&&i){var f='link[rel="preload"][as="'+Dn(i)+'"]';i==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+Dn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+Dn(o.imageSizes)+'"]')):f+='[href="'+Dn(s)+'"]';var p=f;switch(i){case"style":p=Jo(s);break;case"script":p=Zo(s)}xs.has(p)||(s=w({rel:"preload",href:i==="image"&&o&&o.imageSrcSet?void 0:s,as:i},o),xs.set(p,s),u.querySelector(f)!==null||i==="style"&&u.querySelector(Uc(p))||i==="script"&&u.querySelector(zc(p))||(i=u.createElement("link"),yn(i,"link",s),Gt(i),u.head.appendChild(i)))}}function yA(s,i){Yr.m(s,i);var o=Wo;if(o&&s){var u=i&&typeof i.as=="string"?i.as:"script",f='link[rel="modulepreload"][as="'+Dn(u)+'"][href="'+Dn(s)+'"]',p=f;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=Zo(s)}if(!xs.has(p)&&(s=w({rel:"modulepreload",href:s},i),xs.set(p,s),o.querySelector(f)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(zc(p)))return}u=o.createElement("link"),yn(u,"link",s),Gt(u),o.head.appendChild(u)}}}function vA(s,i,o){Yr.S(s,i,o);var u=Wo;if(u&&s){var f=er(u).hoistableStyles,p=Jo(s);i=i||"default";var b=f.get(p);if(!b){var T={loading:0,preload:null};if(b=u.querySelector(Uc(p)))T.loading=5;else{s=w({rel:"stylesheet",href:s,"data-precedence":i},o),(o=xs.get(p))&&Vg(s,o);var P=b=u.createElement("link");Gt(P),yn(P,"link",s),P._p=new Promise(function(Q,ee){P.onload=Q,P.onerror=ee}),P.addEventListener("load",function(){T.loading|=1}),P.addEventListener("error",function(){T.loading|=2}),T.loading|=4,Zh(b,i,u)}b={type:"stylesheet",instance:b,count:1,state:T},f.set(p,b)}}}function _A(s,i){Yr.X(s,i);var o=Wo;if(o&&s){var u=er(o).hoistableScripts,f=Zo(s),p=u.get(f);p||(p=o.querySelector(zc(f)),p||(s=w({src:s,async:!0},i),(i=xs.get(f))&&Lg(s,i),p=o.createElement("script"),Gt(p),yn(p,"link",s),o.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(f,p))}}function bA(s,i){Yr.M(s,i);var o=Wo;if(o&&s){var u=er(o).hoistableScripts,f=Zo(s),p=u.get(f);p||(p=o.querySelector(zc(f)),p||(s=w({src:s,async:!0,type:"module"},i),(i=xs.get(f))&&Lg(s,i),p=o.createElement("script"),Gt(p),yn(p,"link",s),o.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(f,p))}}function bb(s,i,o,u){var f=(f=Te.current)?Jh(f):null;if(!f)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(i=Jo(o.href),o=er(f).hoistableStyles,u=o.get(i),u||(u={type:"style",instance:null,count:0,state:null},o.set(i,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=Jo(o.href);var p=er(f).hoistableStyles,b=p.get(s);if(b||(f=f.ownerDocument||f,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(s,b),(p=f.querySelector(Uc(s)))&&!p._p&&(b.instance=p,b.state.loading=5),xs.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},xs.set(s,o),p||wA(f,s,o,b.state))),i&&u===null)throw Error(r(528,""));return b}if(i&&u!==null)throw Error(r(529,""));return null;case"script":return i=o.async,o=o.src,typeof o=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Zo(o),o=er(f).hoistableScripts,u=o.get(i),u||(u={type:"script",instance:null,count:0,state:null},o.set(i,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Jo(s){return'href="'+Dn(s)+'"'}function Uc(s){return'link[rel="stylesheet"]['+s+"]"}function wb(s){return w({},s,{"data-precedence":s.precedence,precedence:null})}function wA(s,i,o,u){s.querySelector('link[rel="preload"][as="style"]['+i+"]")?u.loading=1:(i=s.createElement("link"),u.preload=i,i.addEventListener("load",function(){return u.loading|=1}),i.addEventListener("error",function(){return u.loading|=2}),yn(i,"link",o),Gt(i),s.head.appendChild(i))}function Zo(s){return'[src="'+Dn(s)+'"]'}function zc(s){return"script[async]"+s}function xb(s,i,o){if(i.count++,i.instance===null)switch(i.type){case"style":var u=s.querySelector('style[data-href~="'+Dn(o.href)+'"]');if(u)return i.instance=u,Gt(u),u;var f=w({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),Gt(u),yn(u,"style",f),Zh(u,o.precedence,s),i.instance=u;case"stylesheet":f=Jo(o.href);var p=s.querySelector(Uc(f));if(p)return i.state.loading|=4,i.instance=p,Gt(p),p;u=wb(o),(f=xs.get(f))&&Vg(u,f),p=(s.ownerDocument||s).createElement("link"),Gt(p);var b=p;return b._p=new Promise(function(T,P){b.onload=T,b.onerror=P}),yn(p,"link",u),i.state.loading|=4,Zh(p,o.precedence,s),i.instance=p;case"script":return p=Zo(o.src),(f=s.querySelector(zc(p)))?(i.instance=f,Gt(f),f):(u=o,(f=xs.get(p))&&(u=w({},o),Lg(u,f)),s=s.ownerDocument||s,f=s.createElement("script"),Gt(f),yn(f,"link",u),s.head.appendChild(f),i.instance=f);case"void":return null;default:throw Error(r(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(u=i.instance,i.state.loading|=4,Zh(u,o.precedence,s));return i.instance}function Zh(s,i,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=u.length?u[u.length-1]:null,p=f,b=0;b<u.length;b++){var T=u[b];if(T.dataset.precedence===i)p=T;else if(p!==f)break}p?p.parentNode.insertBefore(s,p.nextSibling):(i=o.nodeType===9?o.head:o,i.insertBefore(s,i.firstChild))}function Vg(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.title==null&&(s.title=i.title)}function Lg(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.integrity==null&&(s.integrity=i.integrity)}var ed=null;function Eb(s,i,o){if(ed===null){var u=new Map,f=ed=new Map;f.set(o,u)}else f=ed,u=f.get(o),u||(u=new Map,f.set(o,u));if(u.has(s))return u;for(u.set(s,null),o=o.getElementsByTagName(s),f=0;f<o.length;f++){var p=o[f];if(!(p[Js]||p[Ce]||s==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var b=p.getAttribute(i)||"";b=s+b;var T=u.get(b);T?T.push(p):u.set(b,[p])}}return u}function Tb(s,i,o){s=s.ownerDocument||s,s.head.insertBefore(o,i==="title"?s.querySelector("head > title"):null)}function xA(s,i,o){if(o===1||i.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return s=i.disabled,typeof i.precedence=="string"&&s==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Sb(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function EA(s,i,o,u){if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var f=Jo(u.href),p=i.querySelector(Uc(f));if(p){i=p._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(s.count++,s=td.bind(s),i.then(s,s)),o.state.loading|=4,o.instance=p,Gt(p);return}p=i.ownerDocument||i,u=wb(u),(f=xs.get(f))&&Vg(u,f),p=p.createElement("link"),Gt(p);var b=p;b._p=new Promise(function(T,P){b.onload=T,b.onerror=P}),yn(p,"link",u),o.instance=p}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(s.count++,o=td.bind(s),i.addEventListener("load",o),i.addEventListener("error",o))}}var Ug=0;function TA(s,i){return s.stylesheets&&s.count===0&&sd(s,s.stylesheets),0<s.count||0<s.imgCount?function(o){var u=setTimeout(function(){if(s.stylesheets&&sd(s,s.stylesheets),s.unsuspend){var p=s.unsuspend;s.unsuspend=null,p()}},6e4+i);0<s.imgBytes&&Ug===0&&(Ug=62500*rA());var f=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&sd(s,s.stylesheets),s.unsuspend)){var p=s.unsuspend;s.unsuspend=null,p()}},(s.imgBytes>Ug?50:800)+i);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(u),clearTimeout(f)}}:null}function td(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)sd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var nd=null;function sd(s,i){s.stylesheets=null,s.unsuspend!==null&&(s.count++,nd=new Map,i.forEach(SA,s),nd=null,td.call(s))}function SA(s,i){if(!(i.state.loading&4)){var o=nd.get(s);if(o)var u=o.get(null);else{o=new Map,nd.set(s,o);for(var f=s.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<f.length;p++){var b=f[p];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(o.set(b.dataset.precedence,b),u=b)}u&&o.set(null,u)}f=i.instance,b=f.getAttribute("data-precedence"),p=o.get(b)||u,p===u&&o.set(null,f),o.set(b,f),this.count++,u=td.bind(this),f.addEventListener("load",u),f.addEventListener("error",u),p?p.parentNode.insertBefore(f,p.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(f,s.firstChild)),i.state.loading|=4}}var Bc={$$typeof:$,Provider:null,Consumer:null,_currentValue:_e,_currentValue2:_e,_threadCount:0};function AA(s,i,o,u,f,p,b,T,P){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=us(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=us(0),this.hiddenUpdates=us(null),this.identifierPrefix=u,this.onUncaughtError=f,this.onCaughtError=p,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function Ab(s,i,o,u,f,p,b,T,P,Q,ee,ie){return s=new AA(s,i,o,b,P,Q,ee,ie,T),i=1,p===!0&&(i|=24),p=Yn(3,null,null,i),s.current=p,p.stateNode=s,i=vm(),i.refCount++,s.pooledCache=i,i.refCount++,p.memoizedState={element:u,isDehydrated:o,cache:i},xm(p),s}function Nb(s){return s?(s=Io,s):Io}function Rb(s,i,o,u,f,p){f=Nb(f),u.context===null?u.context=f:u.pendingContext=f,u=xi(i),u.payload={element:o},p=p===void 0?null:p,p!==null&&(u.callback=p),o=Ei(s,u,i),o!==null&&(zn(o,s,i),_c(o,s,i))}function Cb(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<i?o:i}}function zg(s,i){Cb(s,i),(s=s.alternate)&&Cb(s,i)}function Ib(s){if(s.tag===13||s.tag===31){var i=Ia(s,67108864);i!==null&&zn(i,s,67108864),zg(s,67108864)}}function jb(s){if(s.tag===13||s.tag===31){var i=es();i=jr(i);var o=Ia(s,i);o!==null&&zn(o,s,i),zg(s,i)}}var rd=!0;function NA(s,i,o,u){var f=q.T;q.T=null;var p=ce.p;try{ce.p=2,Bg(s,i,o,u)}finally{ce.p=p,q.T=f}}function RA(s,i,o,u){var f=q.T;q.T=null;var p=ce.p;try{ce.p=8,Bg(s,i,o,u)}finally{ce.p=p,q.T=f}}function Bg(s,i,o,u){if(rd){var f=qg(u);if(f===null)Ng(s,i,u,id,o),Ob(s,u);else if(IA(f,s,i,o,u))u.stopPropagation();else if(Ob(s,u),i&4&&-1<CA.indexOf(s)){for(;f!==null;){var p=hs(f);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var b=ls(p.pendingLanes);if(b!==0){var T=p;for(T.pendingLanes|=2,T.entangledLanes|=2;b;){var P=1<<31-At(b);T.entanglements[1]|=P,b&=~P}fr(p),(ot&6)===0&&(Bh=dn()+500,Mc(0))}}break;case 31:case 13:T=Ia(p,2),T!==null&&zn(T,p,2),Hh(),zg(p,2)}if(p=qg(u),p===null&&Ng(s,i,u,id,o),p===f)break;f=p}f!==null&&u.stopPropagation()}else Ng(s,i,u,null,o)}}function qg(s){return s=ds(s),Hg(s)}var id=null;function Hg(s){if(id=null,s=Zs(s),s!==null){var i=l(s);if(i===null)s=null;else{var o=i.tag;if(o===13){if(s=c(i),s!==null)return s;s=null}else if(o===31){if(s=m(i),s!==null)return s;s=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null)}}return id=s,null}function kb(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(os()){case Ts:return 2;case fa:return 8;case Ss:case mo:return 32;case ma:return 268435456;default:return 32}default:return 32}}var $g=!1,Di=null,Mi=null,Pi=null,qc=new Map,Hc=new Map,Vi=[],CA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ob(s,i){switch(s){case"focusin":case"focusout":Di=null;break;case"dragenter":case"dragleave":Mi=null;break;case"mouseover":case"mouseout":Pi=null;break;case"pointerover":case"pointerout":qc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hc.delete(i.pointerId)}}function $c(s,i,o,u,f,p){return s===null||s.nativeEvent!==p?(s={blockedOn:i,domEventName:o,eventSystemFlags:u,nativeEvent:p,targetContainers:[f]},i!==null&&(i=hs(i),i!==null&&Ib(i)),s):(s.eventSystemFlags|=u,i=s.targetContainers,f!==null&&i.indexOf(f)===-1&&i.push(f),s)}function IA(s,i,o,u,f){switch(i){case"focusin":return Di=$c(Di,s,i,o,u,f),!0;case"dragenter":return Mi=$c(Mi,s,i,o,u,f),!0;case"mouseover":return Pi=$c(Pi,s,i,o,u,f),!0;case"pointerover":var p=f.pointerId;return qc.set(p,$c(qc.get(p)||null,s,i,o,u,f)),!0;case"gotpointercapture":return p=f.pointerId,Hc.set(p,$c(Hc.get(p)||null,s,i,o,u,f)),!0}return!1}function Db(s){var i=Zs(s.target);if(i!==null){var o=l(i);if(o!==null){if(i=o.tag,i===13){if(i=c(o),i!==null){s.blockedOn=i,Ie(s.priority,function(){jb(o)});return}}else if(i===31){if(i=m(o),i!==null){s.blockedOn=i,Ie(s.priority,function(){jb(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ad(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var o=qg(s.nativeEvent);if(o===null){o=s.nativeEvent;var u=new o.constructor(o.type,o);sc=u,o.target.dispatchEvent(u),sc=null}else return i=hs(o),i!==null&&Ib(i),s.blockedOn=o,!1;i.shift()}return!0}function Mb(s,i,o){ad(s)&&o.delete(i)}function jA(){$g=!1,Di!==null&&ad(Di)&&(Di=null),Mi!==null&&ad(Mi)&&(Mi=null),Pi!==null&&ad(Pi)&&(Pi=null),qc.forEach(Mb),Hc.forEach(Mb)}function od(s,i){s.blockedOn===i&&(s.blockedOn=null,$g||($g=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,jA)))}var ld=null;function Pb(s){ld!==s&&(ld=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){ld===s&&(ld=null);for(var i=0;i<s.length;i+=3){var o=s[i],u=s[i+1],f=s[i+2];if(typeof u!="function"){if(Hg(u||o)===null)continue;break}var p=hs(o);p!==null&&(s.splice(i,3),i-=3,qm(p,{pending:!0,data:f,method:o.method,action:u},u,f))}}))}function el(s){function i(P){return od(P,s)}Di!==null&&od(Di,s),Mi!==null&&od(Mi,s),Pi!==null&&od(Pi,s),qc.forEach(i),Hc.forEach(i);for(var o=0;o<Vi.length;o++){var u=Vi[o];u.blockedOn===s&&(u.blockedOn=null)}for(;0<Vi.length&&(o=Vi[0],o.blockedOn===null);)Db(o),o.blockedOn===null&&Vi.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var f=o[u],p=o[u+1],b=f[st]||null;if(typeof p=="function")b||Pb(o);else if(b){var T=null;if(p&&p.hasAttribute("formAction")){if(f=p,b=p[st]||null)T=b.formAction;else if(Hg(f)!==null)continue}else T=b.action;typeof T=="function"?o[u+1]=T:(o.splice(u,3),u-=3),Pb(o)}}}function Vb(){function s(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(b){return f=b})},focusReset:"manual",scroll:"manual"})}function i(){f!==null&&(f(),f=null),u||setTimeout(o,20)}function o(){if(!u&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,f=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(o,100),function(){u=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),f!==null&&(f(),f=null)}}}function Fg(s){this._internalRoot=s}cd.prototype.render=Fg.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(r(409));var o=i.current,u=es();Rb(o,u,s,i,null,null)},cd.prototype.unmount=Fg.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;Rb(s.current,2,null,s,null,null),Hh(),i[lt]=null}};function cd(s){this._internalRoot=s}cd.prototype.unstable_scheduleHydration=function(s){if(s){var i=pe();s={blockedOn:null,target:s,priority:i};for(var o=0;o<Vi.length&&i!==0&&i<Vi[o].priority;o++);Vi.splice(o,0,s),o===0&&Db(s)}};var Lb=e.version;if(Lb!=="19.2.0")throw Error(r(527,Lb,"19.2.0"));ce.findDOMNode=function(s){var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=y(i),s=s!==null?_(s):null,s=s===null?null:s.stateNode,s};var kA={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ud=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ud.isDisabled&&ud.supportsFiber)try{Hn=ud.inject(kA),Vt=ud}catch{}}return Gc.createRoot=function(s,i){if(!a(s))throw Error(r(299));var o=!1,u="",f=Fv,p=Gv,b=Kv;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(u=i.identifierPrefix),i.onUncaughtError!==void 0&&(f=i.onUncaughtError),i.onCaughtError!==void 0&&(p=i.onCaughtError),i.onRecoverableError!==void 0&&(b=i.onRecoverableError)),i=Ab(s,1,!1,null,null,o,u,null,f,p,b,Vb),s[lt]=i.current,Ag(s),new Fg(i)},Gc.hydrateRoot=function(s,i,o){if(!a(s))throw Error(r(299));var u=!1,f="",p=Fv,b=Gv,T=Kv,P=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(p=o.onUncaughtError),o.onCaughtError!==void 0&&(b=o.onCaughtError),o.onRecoverableError!==void 0&&(T=o.onRecoverableError),o.formState!==void 0&&(P=o.formState)),i=Ab(s,1,!0,i,o??null,u,f,P,p,b,T,Vb),i.context=Nb(null),o=i.current,u=es(),u=jr(u),f=xi(u),f.callback=null,Ei(o,f,u),o=u,i.current.lanes=o,Cr(i,o),fr(i),s[lt]=i.current,Ag(s),new cd(i)},Gc.version="19.2.0",Gc}var Qb;function $A(){if(Qb)return Qg.exports;Qb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Qg.exports=HA(),Qg.exports}var FA=$A();const GA=u0(FA),KA="modulepreload",QA=function(n){return"/ontap/"+n},Yb={},Ls=function(e,t,r){let a=Promise.resolve();if(t&&t.length>0){let c=function(y){return Promise.all(y.map(_=>Promise.resolve(_).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),g=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));a=c(t.map(y=>{if(y=QA(y),y in Yb)return;Yb[y]=!0;const _=y.endsWith(".css"),w=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${w}`))return;const E=document.createElement("link");if(E.rel=_?"stylesheet":KA,_||(E.as="script"),E.crossOrigin="",E.href=y,g&&E.setAttribute("nonce",g),document.head.appendChild(E),_)return new Promise((S,N)=>{E.addEventListener("load",S),E.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${y}`)))})}))}function l(c){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=c,window.dispatchEvent(m),!m.defaultPrevented)throw c}return a.then(c=>{for(const m of c||[])m.status==="rejected"&&l(m.reason);return e().catch(l)})},mx=Y.createContext(void 0),gx=({children:n})=>{const[e,t]=Y.useState("light");Y.useEffect(()=>{let l=localStorage.getItem("theme");(!l||l==="noel")&&(l="light",localStorage.setItem("theme","light")),t(l),document.documentElement.setAttribute("data-theme",l)},[]);const r=a=>{t(a),document.documentElement.setAttribute("data-theme",a),localStorage.setItem("theme",a)};return h.jsx(mx.Provider,{value:{theme:e,setTheme:r},children:n})},Rn=()=>{const n=Y.useContext(mx);if(n===void 0)throw new Error("useTheme must be used within a ThemeProvider");return n},YA=n=>h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm.25 4.5a.75.75 0 00-1.5 0v5.337a2.25 2.25 0 00-1.5 2.063v.75a.75.75 0 001.5 0v-.75a.75.75 0 01.75-.75h.75a.75.75 0 01.75.75v.75a.75.75 0 001.5 0v-.75a2.25 2.25 0 00-1.5-2.063V6.75z"}),h.jsx("path",{d:"M6.163 15.25a.75.75 0 011.06-1.06l1.25 1.25a.75.75 0 01-1.06 1.06l-1.25-1.25zm10.617 0a.75.75 0 011.06 1.06l-1.25 1.25a.75.75 0 01-1.06 1.06l1.25-1.25z"})]}),d0=n=>{const{theme:e}=Rn();return e==="noel"?h.jsx("img",{src:"/assets/img/ball.png",alt:"Check",...n,className:`${n.className} object-contain`}):h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:h.jsx("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z",clipRule:"evenodd"})})},f0=n=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:h.jsx("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-1.72 6.97a.75.75 0 10-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 101.06 1.06L12 13.06l1.72 1.72a.75.75 0 101.06-1.06L13.06 12l1.72-1.72a.75.75 0 10-1.06-1.06L12 10.94l-1.72-1.72z",clipRule:"evenodd"})}),Ml=n=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:h.jsx("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-4.28 9.22a.75.75 0 000 1.06l3 3a.75.75 0 101.06-1.06L10.81 12l1.47-1.47a.75.75 0 10-1.06-1.06l-3 3z",clipRule:"evenodd"})}),XA=n=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:h.jsx("path",{fillRule:"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-3 3a.75.75 0 01-1.06-1.06L14.44 12l-2.22-2.22a.75.75 0 011.06-1.06l3 3z",clipRule:"evenodd"})}),WA=n=>{const{theme:e}=Rn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/J0JwWn5p/Mattahan-Buuf-One-of-those-ugly-pens-you-just-find-lying-around-128.png",alt:"Pen Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/celebrate.png",alt:"Santa",...n,className:`${n.className} object-contain`}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{d:"M12.75 12.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0z"}),h.jsx("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zM9 12a3 3 0 116 0 3 3 0 01-6 0zm-2.121 4.212a.75.75 0 01.688-1.228 5.253 5.253 0 018.866 0 .75.75 0 11-.688 1.228 3.753 3.753 0 00-7.49 0z",clipRule:"evenodd"})]})},JA=n=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:h.jsx("path",{fillRule:"evenodd",d:"M4.755 10.059a7.5 7.5 0 0112.548-3.364l1.903 1.903h-4.5a.75.75 0 000 1.5h6a.75.75 0 00.75-.75V4.5a.75.75 0 00-1.5 0v2.253a9 9 0 00-15.06 4.042.75.75 0 00.75.75h1.5a.75.75 0 00.75-.75zM19.245 13.941a7.5 7.5 0 01-12.548 3.364l-1.903-1.903h4.5a.75.75 0 000-1.5h-6a.75.75 0 00-.75.75v6a.75.75 0 001.5 0v-2.253a9 9 0 0015.06-4.042.75.75 0 00-.75-.75h-1.5a.75.75 0 00-.75.75z",clipRule:"evenodd"})}),Sl=n=>{const{theme:e}=Rn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/xjbVmxDW/Oxygen-Icons-org-Oxygen-Categories-applications-education-university-256.png",alt:"Graduation Cap Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/home.png",alt:"Home Icon",...n,className:`${n.className} object-contain`}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{d:"M12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2zm0 2a8 8 0 100 16 8 8 0 000-16zm0 3a5 5 0 110 10 5 5 0 010-10zm0 2a3 3 0 100 6 3 3 0 000-6z"}),h.jsx("path",{d:"M12 3v2m0 14v2M3 12h2m14 0h-2m-8-8L6.414 5.414m11.172 11.172L16.243 15.12m0-9.706l-1.121 1.121M5.414 17.586L6.536 16.464"})]})},xp=n=>{const{theme:e}=Rn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/66GxZjxN/school-114359.png",alt:"School Bag Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/bell.png",alt:"Bell Icon",...n,className:`${n.className} object-contain`}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{d:"M12 2a1 1 0 011 1v7.683a4.502 4.502 0 012.722 2.054 3 3 0 01-1.33 3.963 3.003 3.003 0 01-4.783-3.963A4.502 4.502 0 0111 10.683V3a1 1 0 011-1zm-3.5 10a1.5 1.5 0 100 3 1.5 1.5 0 000-3zm7 0a1.5 1.5 0 100 3 1.5 1.5 0 000-3z"}),h.jsx("path",{d:"M12 22a8.956 8.956 0 01-6-2.583V18h12v1.417A8.956 8.956 0 0112 22z"})]})},ZA=n=>{const{theme:e}=Rn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/h47RmyWN/Mattahan-Buuf-They-reply-technosorcery-128.png",alt:"Wrench Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/gift4.png",alt:"Gift Icon",...n,className:`${n.className} object-contain`}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{fillRule:"evenodd",d:"M9.528 1.718a.75.75 0 01.162.819A8.97 8.97 0 009 6a9 9 0 009 9 8.97 8.97 0 003.463-.69.75.75 0 01.981.981A10.503 10.503 0 0112 21a10.5 10.5 0 01-10.5-10.5c0-4.368 2.667-8.162 6.43-9.742a.75.75 0 01.819.162z",clipRule:"evenodd"}),h.jsx("path",{d:"M12.75 9a.75.75 0 00-1.5 0v2.25H9a.75.75 0 000 1.5h2.25V15a.75.75 0 001.5 0v-2.25H15a.75.75 0 000-1.5h-2.25V9z"})]})},eN=n=>{const{theme:e}=Rn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/zvWm1BFk/book-512x512-35977.png",alt:"Book Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/hat.png",alt:"Hat Icon",...n,className:`${n.className} object-contain`}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{d:"M12 2L3 8v2h18V8l-9-6zm-1.5 10a1.5 1.5 0 100 3 1.5 1.5 0 000-3zm3 0a1.5 1.5 0 100 3 1.5 1.5 0 000-3z"}),h.jsx("path",{d:"M4 14v6h16v-6H4zm6 2h4v2h-4v-2z"})]})},Xb=n=>{const{theme:e}=Rn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/2yvpf67d/Mattahan-Buuf-A-Proper-Journal-Icon-128.png",alt:"Journal Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/gift5.png",alt:"Gift Icon",...n,className:`${n.className} object-contain`}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{fillRule:"evenodd",d:"M12 2a10 10 0 100 20 10 10 0 000-20zM4 12a8 8 0 1116 0 8 8 0 01-16 0z",clipRule:"evenodd"}),h.jsx("path",{d:"M16.95 7.05l-1.414 1.414-2.122-2.122 1.414-1.414 2.122 2.122zm-9.9 9.9l1.414-1.414 2.122 2.122-1.414 1.414-2.122-2.122zm9.9 0l-1.414-1.414-2.122 2.122 1.414 1.414 2.122-2.122zm-9.9-9.9l1.414 1.414-2.122 2.122L5.636 9.172l2.122-2.122z"})]})},Wb=n=>{const{theme:e}=Rn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/2yvpf67d/Mattahan-Buuf-A-Proper-Journal-Icon-128.png",alt:"Journal Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/star-gold.png",alt:"Star Icon",...n,className:`${n.className} object-contain`}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{fillRule:"evenodd",d:"M8.25 2.25A.75.75 0 019 3v.257a3.75 3.75 0 013 0V3a.75.75 0 011.5 0v.257a3.75 3.75 0 013 0V3a.75.75 0 01.75.75h-.008v.016c.361.32.622.754.74 1.232A23.953 23.953 0 0112 6c-2.305 0-4.52-.42-6.502-1.195a2.5 2.5 0 01.74-1.232H6a.75.75 0 01.75-.75h1.5zm-2.784 4.542a25.474 25.474 0 0013.068 0 .75.75 0 01.443.923 23.92 23.92 0 01-13.954 0 .75.75 0 01.443-.923zM8.25 10.5a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5a.75.75 0 01.75-.75zm3.75 0a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5a.75.75 0 01.75-.75zm3.75 0a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5a.75.75 0 01.75-.75z",clipRule:"evenodd"}),h.jsx("path",{d:"M4.145 9.421a.75.75 0 01.558-.923 25.483 25.483 0 0114.594 0 .75.75 0 01.558.923l-.36.99a25.01 25.01 0 01-14.832 0l-.36-.99z"}),h.jsx("path",{fillRule:"evenodd",d:"M3 15.75A2.25 2.25 0 015.25 13.5h13.5A2.25 2.25 0 0121 15.75v3A2.25 2.25 0 0118.75 21H5.25A2.25 2.25 0 013 18.75v-3z",clipRule:"evenodd"})]})},px=n=>{const{theme:e}=Rn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/xjbVmxDW/Oxygen-Icons-org-Oxygen-Categories-applications-education-university-256.png",alt:"Graduation Cap Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/star-gold.png",alt:"Gold Star Icon",...n,className:`${n.className} object-contain`}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{fillRule:"evenodd",d:"M11.25 4.5A.75.75 0 0112 5.25v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 0111.25 4.5zM12.75 6a.75.75 0 00-1.5 0v1.5a.75.75 0 001.5 0V6zM11.25 7.5A.75.75 0 0112 8.25v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 0111.25 7.5zM12.75 9a.75.75 0 00-1.5 0v1.5a.75.75 0 001.5 0V9z",clipRule:"evenodd"}),h.jsx("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zM6.262 6.072a8.25 8.25 0 1011.476 11.476A8.25 8.25 0 006.262 6.072zM12 18.75a.75.75 0 01-.75-.75V15a.75.75 0 011.5 0v3a.75.75 0 01-.75.75z",clipRule:"evenodd"}),h.jsx("path",{d:"M14.25 12a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"})]})},m0=n=>{const{theme:e}=Rn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/FFJXSWXv/study-learning-knowledge-education-book-notebook-icon-256768.png",alt:"Book and Glasses Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/gift1.png",alt:"Gift Icon",...n,className:`${n.className} object-contain`}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{d:"M11.25 4.533A9.708 9.708 0 006 3.75c-1.052 0-2.062.18-3 .512V17.25a8.987 8.987 0 013.75-.82V9.75a.75.75 0 011.5 0v7.5a.75.75 0 01-1.5 0V15a6.726 6.726 0 00-3-.585V18.75C3.393 18.932 3.69 19.1 4 19.29c2.023.784 4.18 1.093 6.364 1.294a.75.75 0 00.872-.725V4.534z"}),h.jsx("path",{d:"M12.75 4.533V19.86a.75.75 0 00.872.725 49.33 49.33 0 006.364-1.294c.31-.19.607-.358.914-.54V5.25c-1.084-.308-2.18-.46-3.25-.46-1.637 0-3.235.32-4.75.922V4.534z"})]})},tN=n=>{const{theme:e}=Rn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/kG8rd4vv/Limpa-Curriculum-Vitae-Education-256.png",alt:"Blackboard Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/gift2.png",alt:"Gift Icon",...n,className:`${n.className} object-contain`}):h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:h.jsx("path",{fillRule:"evenodd",d:"M2.25 6a3 3 0 013-3h13.5a3 3 0 013 3v12a3 3 0 01-3-3H5.25a3 3 0 01-3-3V6zm3.75 3a.75.75 0 01.75-.75h10.5a.75.75 0 010 1.5H7.5a.75.75 0 01-.75-.75zM7.5 12a.75.75 0 000 1.5h6a.75.75 0 000-1.5h-6z",clipRule:"evenodd"})})},nN=[{name:"light",label:"Sng",color:"bg-white"},{name:"dark",label:"Ti",color:"bg-slate-900"},{name:"noel",label:"Ging Sinh",color:"bg-[#8B0000]"},{name:"modern",label:"Hin i",color:"bg-indigo-600"},{name:"classic",label:"C in",color:"bg-[#6F6049]"},{name:"sunrise",label:"Bnh Minh",color:"bg-orange-500"},{name:"tri-an",label:"Tri n",color:"bg-red-400"}],sN=()=>{const[n,e]=Y.useState(!1),{theme:t,setTheme:r}=Rn(),a=l=>{r(l),e(!1)};return h.jsxs("div",{className:"relative",children:[n&&h.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-40 rounded-lg border border-border bg-card p-2 shadow-2xl flex flex-col gap-1 animate-slide-in-right",children:nN.map(l=>h.jsxs("button",{onClick:()=>a(l.name),className:`w-full text-left px-3 py-2 text-sm font-semibold rounded-md flex items-center gap-3 transition-colors ${t===l.name?"bg-primary/20 text-primary":"text-card-foreground hover:bg-secondary"}`,children:[h.jsx("span",{className:`w-4 h-4 rounded-full ${l.color} border border-white/20`}),l.label]},l.name))}),h.jsx("button",{onClick:()=>e(!n),className:"flex h-10 w-10 items-center justify-center rounded-lg bg-secondary text-secondary-foreground shadow-sm transition-colors hover:bg-muted focus:outline-none focus:ring-2 focus:ring-ring","aria-label":"Change theme",children:h.jsx(YA,{className:"h-6 w-6"})})]})},rN=()=>{const n=["gift1.png","bell.png","star-gold.png","ball.png","gift2.png","gift3.png","gift4.png","gift5.png"],{theme:e}=Rn();return e!=="noel"?null:h.jsxs(h.Fragment,{children:[h.jsx("style",{dangerouslySetInnerHTML:{__html:`
        /* === PHN 5: HIU NG TUYT & QU RI === */
        .snowflakes {
            position: fixed; top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 9999;
        }
        
        .snowflake {
            color: #fff;
            font-size: 1.2em;
            font-family: Arial, sans-serif;
            text-shadow: 0 0 3px rgba(255,255,255,0.8); /* Tuyt pht sng nh */
            position: fixed;
            top: -10%;
            z-index: 9999;
            user-select: none;
            cursor: default;
            animation-name: snowflakes-fall, snowflakes-shake;
            animation-timing-function: linear, ease-in-out;
            animation-iteration-count: infinite, infinite;
            animation-play-state: running, running;
        }

        .snowflake-img img {
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3));
            width: 30px; 
            height: auto;
            opacity: 0.9;
        }

        @keyframes snowflakes-fall {
            0% { top: -10%; }
            100% { top: 100%; }
        }
        @keyframes snowflakes-shake {
            0% { transform: translateX(0px) rotate(0deg); }
            50% { transform: translateX(80px) rotate(180deg); }
            100% { transform: translateX(0px) rotate(360deg); }
        }

        /* Cu hnh ri ngu nhin */
        .snowflake:nth-of-type(1) { left: 1%; animation-duration: 12s, 4s; animation-delay: 0s, 0s; }
        .snowflake:nth-of-type(2) { left: 5%; animation-duration: 15s, 6s; animation-delay: 1s, 1s; }
        .snowflake:nth-of-type(3) { left: 10%; animation-duration: 10s, 3s; animation-delay: 2s, 0.5s; }
        .snowflake:nth-of-type(4) { left: 15%; animation-duration: 18s, 5s; animation-delay: 4s, 2s; }
        .snowflake:nth-of-type(5) { left: 20%; animation-duration: 11s, 4s; animation-delay: 2s, 2s; }
        .snowflake:nth-of-type(6) { left: 25%; animation-duration: 14s, 7s; animation-delay: 6s, 3s; }
        .snowflake:nth-of-type(7) { left: 30%; animation-duration: 16s, 5s; animation-delay: 3s, 2s; }
        .snowflake:nth-of-type(8) { left: 35%; animation-duration: 13s, 4s; animation-delay: 1s, 1s; }
        .snowflake:nth-of-type(9) { left: 40%; animation-duration: 17s, 6s; animation-delay: 0s, 0s; }
        .snowflake:nth-of-type(10) { left: 45%; animation-duration: 9s, 3s; animation-delay: 5s, 1.5s; }
        .snowflake:nth-of-type(11) { left: 50%; animation-duration: 14s, 5s; animation-delay: 2s, 3s; }
        .snowflake:nth-of-type(12) { left: 55%; animation-duration: 11s, 4s; animation-delay: 4s, 1s; }
        .snowflake:nth-of-type(13) { left: 60%; animation-duration: 19s, 7s; animation-delay: 1s, 2s; }
        .snowflake:nth-of-type(14) { left: 65%; animation-duration: 12s, 3s; animation-delay: 3s, 0s; }
        .snowflake:nth-of-type(15) { left: 70%; animation-duration: 15s, 6s; animation-delay: 5s, 4s; }
        .snowflake:nth-of-type(16) { left: 75%; animation-duration: 10s, 4s; animation-delay: 0s, 2s; }
        .snowflake:nth-of-type(17) { left: 80%; animation-duration: 16s, 5s; animation-delay: 2s, 1s; }
        .snowflake:nth-of-type(18) { left: 85%; animation-duration: 13s, 4s; animation-delay: 4s, 3s; }
        .snowflake:nth-of-type(19) { left: 90%; animation-duration: 18s, 6s; animation-delay: 1s, 2s; }
        .snowflake:nth-of-type(20) { left: 95%; animation-duration: 11s, 3s; animation-delay: 3s, 0s; }
        
        .snowflake:nth-of-type(21) { left: 2%; animation-duration: 13s, 5s; animation-delay: 5s, 1s; }
        .snowflake:nth-of-type(22) { left: 8%; animation-duration: 10s, 3s; animation-delay: 2s, 4s; }
        .snowflake:nth-of-type(23) { left: 12%; animation-duration: 16s, 6s; animation-delay: 1s, 2s; }
        .snowflake:nth-of-type(24) { left: 18%; animation-duration: 12s, 4s; animation-delay: 6s, 0s; }
        .snowflake:nth-of-type(25) { left: 22%; animation-duration: 14s, 5s; animation-delay: 0s, 3s; }
        .snowflake:nth-of-type(26) { left: 28%; animation-duration: 11s, 3s; animation-delay: 4s, 2s; }
        .snowflake:nth-of-type(27) { left: 32%; animation-duration: 19s, 7s; animation-delay: 2s, 1s; }
        .snowflake:nth-of-type(28) { left: 38%; animation-duration: 15s, 6s; animation-delay: 5s, 5s; }
        .snowflake:nth-of-type(29) { left: 42%; animation-duration: 12s, 4s; animation-delay: 1s, 0s; }
        .snowflake:nth-of-type(30) { left: 48%; animation-duration: 17s, 5s; animation-delay: 3s, 2s; }
        .snowflake:nth-of-type(31) { left: 52%; animation-duration: 9s, 3s; animation-delay: 0s, 3s; }
        .snowflake:nth-of-type(32) { left: 58%; animation-duration: 14s, 6s; animation-delay: 4s, 1s; }
        .snowflake:nth-of-type(33) { left: 62%; animation-duration: 11s, 4s; animation-delay: 2s, 4s; }
        .snowflake:nth-of-type(34) { left: 68%; animation-duration: 16s, 5s; animation-delay: 6s, 0s; }
        .snowflake:nth-of-type(35) { left: 72%; animation-duration: 13s, 3s; animation-delay: 1s, 2s; }
        .snowflake:nth-of-type(36) { left: 78%; animation-duration: 18s, 7s; animation-delay: 5s, 1s; }
        .snowflake:nth-of-type(37) { left: 82%; animation-duration: 10s, 4s; animation-delay: 2s, 3s; }
        .snowflake:nth-of-type(38) { left: 88%; animation-duration: 15s, 6s; animation-delay: 4s, 0s; }
        .snowflake:nth-of-type(39) { left: 92%; animation-duration: 12s, 5s; animation-delay: 0s, 2s; }
        .snowflake:nth-of-type(40) { left: 98%; animation-duration: 17s, 4s; animation-delay: 3s, 5s; }

        .snowflake:nth-child(odd) { animation-direction: normal; }
        .snowflake:nth-child(even) { animation-direction: alternate; }

        @media (max-width: 768px) {
            .snowflake { font-size: 1em; }
            .snowflake-img img { width: 20px; }
        }
      `}}),h.jsxs("div",{className:"snowflakes","aria-hidden":"true",children:[Array.from({length:100}).map((t,r)=>h.jsxs("div",{className:"snowflake",children:[["","",""][r%3]," "]},`snow-${r}`)),Array.from({length:8}).map((t,r)=>{const a=n[r%n.length];return h.jsx("div",{className:"snowflake snowflake-img",children:h.jsx("img",{src:`/assets/img/${a}`,alt:"",style:{width:"25px",height:"auto"}})},`img-${r}`)})]})]})},iN=()=>{};var Jb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yx=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let a=n.charCodeAt(r);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},aN=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const a=n[t++];if(a<128)e[r++]=String.fromCharCode(a);else if(a>191&&a<224){const l=n[t++];e[r++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=n[t++],c=n[t++],m=n[t++],g=((a&7)<<18|(l&63)<<12|(c&63)<<6|m&63)-65536;e[r++]=String.fromCharCode(55296+(g>>10)),e[r++]=String.fromCharCode(56320+(g&1023))}else{const l=n[t++],c=n[t++];e[r++]=String.fromCharCode((a&15)<<12|(l&63)<<6|c&63)}}return e.join("")},vx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<n.length;a+=3){const l=n[a],c=a+1<n.length,m=c?n[a+1]:0,g=a+2<n.length,y=g?n[a+2]:0,_=l>>2,w=(l&3)<<4|m>>4;let E=(m&15)<<2|y>>6,S=y&63;g||(S=64,c||(E=64)),r.push(t[_],t[w],t[E],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(yx(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):aN(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<n.length;){const l=t[n.charAt(a++)],m=a<n.length?t[n.charAt(a)]:0;++a;const y=a<n.length?t[n.charAt(a)]:64;++a;const w=a<n.length?t[n.charAt(a)]:64;if(++a,l==null||m==null||y==null||w==null)throw new oN;const E=l<<2|m>>4;if(r.push(E),y!==64){const S=m<<4&240|y>>2;if(r.push(S),w!==64){const N=y<<6&192|w;r.push(N)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class oN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const lN=function(n){const e=yx(n);return vx.encodeByteArray(e,!0)},Ld=function(n){return lN(n).replace(/\./g,"")},_x=function(n){try{return vx.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uN=()=>cN().__FIREBASE_DEFAULTS__,hN=()=>{if(typeof process>"u"||typeof Jb>"u")return;const n=Jb.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},dN=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&_x(n[1]);return e&&JSON.parse(e)},yf=()=>{try{return iN()||uN()||hN()||dN()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},bx=n=>{var e,t;return(t=(e=yf())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},wx=n=>{const e=bx(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},xx=()=>{var n;return(n=yf())==null?void 0:n.config},Ex=n=>{var e;return(e=yf())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fN=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ro(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function g0(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tx(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",a=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${r}`,aud:r,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Ld(JSON.stringify(t)),Ld(JSON.stringify(c)),""].join(".")}const eu={};function mN(){const n={prod:[],emulator:[]};for(const e of Object.keys(eu))eu[e]?n.emulator.push(e):n.prod.push(e);return n}function gN(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Zb=!1;function p0(n,e){if(typeof window>"u"||typeof document>"u"||!ro(window.location.host)||eu[n]===e||eu[n]||Zb)return;eu[n]=e;function t(E){return`__firebase__banner__${E}`}const r="__firebase__banner",l=mN().prod.length>0;function c(){const E=document.getElementById(r);E&&E.remove()}function m(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function g(E,S){E.setAttribute("width","24"),E.setAttribute("id",S),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function y(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{Zb=!0,c()},E}function _(E,S){E.setAttribute("id",S),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function w(){const E=gN(r),S=t("text"),N=document.getElementById(S)||document.createElement("span"),M=t("learnmore"),k=document.getElementById(M)||document.createElement("a"),V=t("preprendIcon"),F=document.getElementById(V)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const $=E.element;m($),_(k,M);const te=y();g(F,V),$.append(F,N,k,te),document.body.appendChild($)}l?(N.innerText="Preview backend disconnected.",F.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(F.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,N.innerText="Preview backend running in this workspace."),N.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",w):w()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function pN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Nn())}function yN(){var e;const n=(e=yf())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function vN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function _N(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function bN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function wN(){const n=Nn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function xN(){return!yN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function EN(){try{return typeof indexedDB=="object"}catch{return!1}}function TN(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)==null?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SN="FirebaseError";class Tr extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=SN,Object.setPrototypeOf(this,Tr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Cu.prototype.create)}}class Cu{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],c=l?AN(l,r):"Error",m=`${this.serviceName}: ${c} (${a}).`;return new Tr(a,m,r)}}function AN(n,e){return n.replace(NN,(t,r)=>{const a=e[r];return a!=null?String(a):`<${r}?>`})}const NN=/\{\$([^}]+)}/g;function RN(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ni(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const a of t){if(!r.includes(a))return!1;const l=n[a],c=e[a];if(e1(l)&&e1(c)){if(!ni(l,c))return!1}else if(l!==c)return!1}for(const a of r)if(!t.includes(a))return!1;return!0}function e1(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iu(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Kc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[a,l]=r.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function Qc(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function CN(n,e){const t=new IN(n,e);return t.subscribe.bind(t)}class IN{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let a;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");jN(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:r},a.next===void 0&&(a.next=Jg),a.error===void 0&&(a.error=Jg),a.complete===void 0&&(a.complete=Jg);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function jN(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Jg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $t(n){return n&&n._delegate?n._delegate:n}class Zi{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new fN;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&r.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(a){if(r)return null;throw a}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(DN(e))try{this.getOrInitializeService({instanceIdentifier:Fa})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});r.resolve(l)}catch{}}}}clearInstance(e=Fa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Fa){return this.instances.has(e)}getOptions(e=Fa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[l,c]of this.instancesDeferred.entries()){const m=this.normalizeInstanceIdentifier(l);r===m&&c.resolve(a)}return a}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),a=this.onInitCallbacks.get(r)??new Set;a.add(e),this.onInitCallbacks.set(r,a);const l=this.instances.get(r);return l&&e(l,r),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const a of r)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:ON(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Fa){return this.component?this.component.multipleInstances?e:Fa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ON(n){return n===Fa?void 0:n}function DN(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new kN(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qe;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Qe||(Qe={}));const PN={debug:Qe.DEBUG,verbose:Qe.VERBOSE,info:Qe.INFO,warn:Qe.WARN,error:Qe.ERROR,silent:Qe.SILENT},VN=Qe.INFO,LN={[Qe.DEBUG]:"log",[Qe.VERBOSE]:"log",[Qe.INFO]:"info",[Qe.WARN]:"warn",[Qe.ERROR]:"error"},UN=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),a=LN[e];if(a)console[a](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class y0{constructor(e){this.name=e,this._logLevel=VN,this._logHandler=UN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Qe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?PN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Qe.DEBUG,...e),this._logHandler(this,Qe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Qe.VERBOSE,...e),this._logHandler(this,Qe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Qe.INFO,...e),this._logHandler(this,Qe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Qe.WARN,...e),this._logHandler(this,Qe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Qe.ERROR,...e),this._logHandler(this,Qe.ERROR,...e)}}const zN=(n,e)=>e.some(t=>n instanceof t);let t1,n1;function BN(){return t1||(t1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function qN(){return n1||(n1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Sx=new WeakMap,Ep=new WeakMap,Ax=new WeakMap,Zg=new WeakMap,v0=new WeakMap;function HN(n){const e=new Promise((t,r)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",c)},l=()=>{t(Qi(n.result)),a()},c=()=>{r(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&Sx.set(t,n)}).catch(()=>{}),v0.set(e,n),e}function $N(n){if(Ep.has(n))return;const e=new Promise((t,r)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",c),n.removeEventListener("abort",c)},l=()=>{t(),a()},c=()=>{r(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",c),n.addEventListener("abort",c)});Ep.set(n,e)}let Tp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ep.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Ax.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Qi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function FN(n){Tp=n(Tp)}function GN(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(ep(this),e,...t);return Ax.set(r,e.sort?e.sort():[e]),Qi(r)}:qN().includes(n)?function(...e){return n.apply(ep(this),e),Qi(Sx.get(this))}:function(...e){return Qi(n.apply(ep(this),e))}}function KN(n){return typeof n=="function"?GN(n):(n instanceof IDBTransaction&&$N(n),zN(n,BN())?new Proxy(n,Tp):n)}function Qi(n){if(n instanceof IDBRequest)return HN(n);if(Zg.has(n))return Zg.get(n);const e=KN(n);return e!==n&&(Zg.set(n,e),v0.set(e,n)),e}const ep=n=>v0.get(n);function QN(n,e,{blocked:t,upgrade:r,blocking:a,terminated:l}={}){const c=indexedDB.open(n,e),m=Qi(c);return r&&c.addEventListener("upgradeneeded",g=>{r(Qi(c.result),g.oldVersion,g.newVersion,Qi(c.transaction),g)}),t&&c.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),m.then(g=>{l&&g.addEventListener("close",()=>l()),a&&g.addEventListener("versionchange",y=>a(y.oldVersion,y.newVersion,y))}).catch(()=>{}),m}const YN=["get","getKey","getAll","getAllKeys","count"],XN=["put","add","delete","clear"],tp=new Map;function s1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(tp.get(e))return tp.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,a=XN.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(a||YN.includes(t)))return;const l=async function(c,...m){const g=this.transaction(c,a?"readwrite":"readonly");let y=g.store;return r&&(y=y.index(m.shift())),(await Promise.all([y[t](...m),a&&g.done]))[0]};return tp.set(e,l),l}FN(n=>({...n,get:(e,t,r)=>s1(e,t)||n.get(e,t,r),has:(e,t)=>!!s1(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(JN(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function JN(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Sp="@firebase/app",r1="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const si=new y0("@firebase/app"),ZN="@firebase/app-compat",e4="@firebase/analytics-compat",t4="@firebase/analytics",n4="@firebase/app-check-compat",s4="@firebase/app-check",r4="@firebase/auth",i4="@firebase/auth-compat",a4="@firebase/database",o4="@firebase/data-connect",l4="@firebase/database-compat",c4="@firebase/functions",u4="@firebase/functions-compat",h4="@firebase/installations",d4="@firebase/installations-compat",f4="@firebase/messaging",m4="@firebase/messaging-compat",g4="@firebase/performance",p4="@firebase/performance-compat",y4="@firebase/remote-config",v4="@firebase/remote-config-compat",_4="@firebase/storage",b4="@firebase/storage-compat",w4="@firebase/firestore",x4="@firebase/ai",E4="@firebase/firestore-compat",T4="firebase",S4="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ap="[DEFAULT]",A4={[Sp]:"fire-core",[ZN]:"fire-core-compat",[t4]:"fire-analytics",[e4]:"fire-analytics-compat",[s4]:"fire-app-check",[n4]:"fire-app-check-compat",[r4]:"fire-auth",[i4]:"fire-auth-compat",[a4]:"fire-rtdb",[o4]:"fire-data-connect",[l4]:"fire-rtdb-compat",[c4]:"fire-fn",[u4]:"fire-fn-compat",[h4]:"fire-iid",[d4]:"fire-iid-compat",[f4]:"fire-fcm",[m4]:"fire-fcm-compat",[g4]:"fire-perf",[p4]:"fire-perf-compat",[y4]:"fire-rc",[v4]:"fire-rc-compat",[_4]:"fire-gcs",[b4]:"fire-gcs-compat",[w4]:"fire-fst",[E4]:"fire-fst-compat",[x4]:"fire-vertex","fire-js":"fire-js",[T4]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hu=new Map,N4=new Map,Np=new Map;function i1(n,e){try{n.container.addComponent(e)}catch(t){si.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ja(n){const e=n.name;if(Np.has(e))return si.debug(`There were multiple attempts to register component ${e}.`),!1;Np.set(e,n);for(const t of hu.values())i1(t,n);for(const t of N4.values())i1(t,n);return!0}function vf(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ns(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R4={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Yi=new Cu("app","Firebase",R4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C4{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Zi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Yi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const io=S4;function Nx(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Ap,automaticDataCollectionEnabled:!0,...e},a=r.name;if(typeof a!="string"||!a)throw Yi.create("bad-app-name",{appName:String(a)});if(t||(t=xx()),!t)throw Yi.create("no-options");const l=hu.get(a);if(l){if(ni(t,l.options)&&ni(r,l.config))return l;throw Yi.create("duplicate-app",{appName:a})}const c=new MN(a);for(const g of Np.values())c.addComponent(g);const m=new C4(t,r,c);return hu.set(a,m),m}function _f(n=Ap){const e=hu.get(n);if(!e&&n===Ap&&xx())return Nx();if(!e)throw Yi.create("no-app",{appName:n});return e}function I4(){return Array.from(hu.values())}function yr(n,e,t){let r=A4[n]??n;t&&(r+=`-${t}`);const a=r.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const c=[`Unable to register library "${r}" with version "${e}":`];a&&c.push(`library name "${r}" contains illegal characters (whitespace or "/")`),a&&l&&c.push("and"),l&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),si.warn(c.join(" "));return}Ja(new Zi(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j4="firebase-heartbeat-database",k4=1,du="firebase-heartbeat-store";let np=null;function Rx(){return np||(np=QN(j4,k4,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(du)}catch(t){console.warn(t)}}}}).catch(n=>{throw Yi.create("idb-open",{originalErrorMessage:n.message})})),np}async function O4(n){try{const t=(await Rx()).transaction(du),r=await t.objectStore(du).get(Cx(n));return await t.done,r}catch(e){if(e instanceof Tr)si.warn(e.message);else{const t=Yi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});si.warn(t.message)}}}async function a1(n,e){try{const r=(await Rx()).transaction(du,"readwrite");await r.objectStore(du).put(e,Cx(n)),await r.done}catch(t){if(t instanceof Tr)si.warn(t.message);else{const r=Yi.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});si.warn(r.message)}}}function Cx(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D4=1024,M4=30;class P4{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new L4(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=o1();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(c=>c.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>M4){const c=U4(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){si.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=o1(),{heartbeatsToSend:r,unsentEntries:a}=V4(this._heartbeatsCache.heartbeats),l=Ld(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return si.warn(t),""}}}function o1(){return new Date().toISOString().substring(0,10)}function V4(n,e=D4){const t=[];let r=n.slice();for(const a of n){const l=t.find(c=>c.agent===a.agent);if(l){if(l.dates.push(a.date),l1(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),l1(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class L4{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return EN()?TN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await O4(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return a1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return a1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function l1(n){return Ld(JSON.stringify({version:2,heartbeats:n})).length}function U4(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z4(n){Ja(new Zi("platform-logger",e=>new WN(e),"PRIVATE")),Ja(new Zi("heartbeat",e=>new P4(e),"PRIVATE")),yr(Sp,r1,n),yr(Sp,r1,"esm2020"),yr("fire-js","")}z4("");var c1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Xi,Ix;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,C){function j(){}j.prototype=C.prototype,I.F=C.prototype,I.prototype=new j,I.prototype.constructor=I,I.D=function(R,D,L){for(var O=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)O[Fe-2]=arguments[Fe];return C.prototype[D].apply(R,O)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(I,C,j){j||(j=0);const R=Array(16);if(typeof C=="string")for(var D=0;D<16;++D)R[D]=C.charCodeAt(j++)|C.charCodeAt(j++)<<8|C.charCodeAt(j++)<<16|C.charCodeAt(j++)<<24;else for(D=0;D<16;++D)R[D]=C[j++]|C[j++]<<8|C[j++]<<16|C[j++]<<24;C=I.g[0],j=I.g[1],D=I.g[2];let L=I.g[3],O;O=C+(L^j&(D^L))+R[0]+3614090360&4294967295,C=j+(O<<7&4294967295|O>>>25),O=L+(D^C&(j^D))+R[1]+3905402710&4294967295,L=C+(O<<12&4294967295|O>>>20),O=D+(j^L&(C^j))+R[2]+606105819&4294967295,D=L+(O<<17&4294967295|O>>>15),O=j+(C^D&(L^C))+R[3]+3250441966&4294967295,j=D+(O<<22&4294967295|O>>>10),O=C+(L^j&(D^L))+R[4]+4118548399&4294967295,C=j+(O<<7&4294967295|O>>>25),O=L+(D^C&(j^D))+R[5]+1200080426&4294967295,L=C+(O<<12&4294967295|O>>>20),O=D+(j^L&(C^j))+R[6]+2821735955&4294967295,D=L+(O<<17&4294967295|O>>>15),O=j+(C^D&(L^C))+R[7]+4249261313&4294967295,j=D+(O<<22&4294967295|O>>>10),O=C+(L^j&(D^L))+R[8]+1770035416&4294967295,C=j+(O<<7&4294967295|O>>>25),O=L+(D^C&(j^D))+R[9]+2336552879&4294967295,L=C+(O<<12&4294967295|O>>>20),O=D+(j^L&(C^j))+R[10]+4294925233&4294967295,D=L+(O<<17&4294967295|O>>>15),O=j+(C^D&(L^C))+R[11]+2304563134&4294967295,j=D+(O<<22&4294967295|O>>>10),O=C+(L^j&(D^L))+R[12]+1804603682&4294967295,C=j+(O<<7&4294967295|O>>>25),O=L+(D^C&(j^D))+R[13]+4254626195&4294967295,L=C+(O<<12&4294967295|O>>>20),O=D+(j^L&(C^j))+R[14]+2792965006&4294967295,D=L+(O<<17&4294967295|O>>>15),O=j+(C^D&(L^C))+R[15]+1236535329&4294967295,j=D+(O<<22&4294967295|O>>>10),O=C+(D^L&(j^D))+R[1]+4129170786&4294967295,C=j+(O<<5&4294967295|O>>>27),O=L+(j^D&(C^j))+R[6]+3225465664&4294967295,L=C+(O<<9&4294967295|O>>>23),O=D+(C^j&(L^C))+R[11]+643717713&4294967295,D=L+(O<<14&4294967295|O>>>18),O=j+(L^C&(D^L))+R[0]+3921069994&4294967295,j=D+(O<<20&4294967295|O>>>12),O=C+(D^L&(j^D))+R[5]+3593408605&4294967295,C=j+(O<<5&4294967295|O>>>27),O=L+(j^D&(C^j))+R[10]+38016083&4294967295,L=C+(O<<9&4294967295|O>>>23),O=D+(C^j&(L^C))+R[15]+3634488961&4294967295,D=L+(O<<14&4294967295|O>>>18),O=j+(L^C&(D^L))+R[4]+3889429448&4294967295,j=D+(O<<20&4294967295|O>>>12),O=C+(D^L&(j^D))+R[9]+568446438&4294967295,C=j+(O<<5&4294967295|O>>>27),O=L+(j^D&(C^j))+R[14]+3275163606&4294967295,L=C+(O<<9&4294967295|O>>>23),O=D+(C^j&(L^C))+R[3]+4107603335&4294967295,D=L+(O<<14&4294967295|O>>>18),O=j+(L^C&(D^L))+R[8]+1163531501&4294967295,j=D+(O<<20&4294967295|O>>>12),O=C+(D^L&(j^D))+R[13]+2850285829&4294967295,C=j+(O<<5&4294967295|O>>>27),O=L+(j^D&(C^j))+R[2]+4243563512&4294967295,L=C+(O<<9&4294967295|O>>>23),O=D+(C^j&(L^C))+R[7]+1735328473&4294967295,D=L+(O<<14&4294967295|O>>>18),O=j+(L^C&(D^L))+R[12]+2368359562&4294967295,j=D+(O<<20&4294967295|O>>>12),O=C+(j^D^L)+R[5]+4294588738&4294967295,C=j+(O<<4&4294967295|O>>>28),O=L+(C^j^D)+R[8]+2272392833&4294967295,L=C+(O<<11&4294967295|O>>>21),O=D+(L^C^j)+R[11]+1839030562&4294967295,D=L+(O<<16&4294967295|O>>>16),O=j+(D^L^C)+R[14]+4259657740&4294967295,j=D+(O<<23&4294967295|O>>>9),O=C+(j^D^L)+R[1]+2763975236&4294967295,C=j+(O<<4&4294967295|O>>>28),O=L+(C^j^D)+R[4]+1272893353&4294967295,L=C+(O<<11&4294967295|O>>>21),O=D+(L^C^j)+R[7]+4139469664&4294967295,D=L+(O<<16&4294967295|O>>>16),O=j+(D^L^C)+R[10]+3200236656&4294967295,j=D+(O<<23&4294967295|O>>>9),O=C+(j^D^L)+R[13]+681279174&4294967295,C=j+(O<<4&4294967295|O>>>28),O=L+(C^j^D)+R[0]+3936430074&4294967295,L=C+(O<<11&4294967295|O>>>21),O=D+(L^C^j)+R[3]+3572445317&4294967295,D=L+(O<<16&4294967295|O>>>16),O=j+(D^L^C)+R[6]+76029189&4294967295,j=D+(O<<23&4294967295|O>>>9),O=C+(j^D^L)+R[9]+3654602809&4294967295,C=j+(O<<4&4294967295|O>>>28),O=L+(C^j^D)+R[12]+3873151461&4294967295,L=C+(O<<11&4294967295|O>>>21),O=D+(L^C^j)+R[15]+530742520&4294967295,D=L+(O<<16&4294967295|O>>>16),O=j+(D^L^C)+R[2]+3299628645&4294967295,j=D+(O<<23&4294967295|O>>>9),O=C+(D^(j|~L))+R[0]+4096336452&4294967295,C=j+(O<<6&4294967295|O>>>26),O=L+(j^(C|~D))+R[7]+1126891415&4294967295,L=C+(O<<10&4294967295|O>>>22),O=D+(C^(L|~j))+R[14]+2878612391&4294967295,D=L+(O<<15&4294967295|O>>>17),O=j+(L^(D|~C))+R[5]+4237533241&4294967295,j=D+(O<<21&4294967295|O>>>11),O=C+(D^(j|~L))+R[12]+1700485571&4294967295,C=j+(O<<6&4294967295|O>>>26),O=L+(j^(C|~D))+R[3]+2399980690&4294967295,L=C+(O<<10&4294967295|O>>>22),O=D+(C^(L|~j))+R[10]+4293915773&4294967295,D=L+(O<<15&4294967295|O>>>17),O=j+(L^(D|~C))+R[1]+2240044497&4294967295,j=D+(O<<21&4294967295|O>>>11),O=C+(D^(j|~L))+R[8]+1873313359&4294967295,C=j+(O<<6&4294967295|O>>>26),O=L+(j^(C|~D))+R[15]+4264355552&4294967295,L=C+(O<<10&4294967295|O>>>22),O=D+(C^(L|~j))+R[6]+2734768916&4294967295,D=L+(O<<15&4294967295|O>>>17),O=j+(L^(D|~C))+R[13]+1309151649&4294967295,j=D+(O<<21&4294967295|O>>>11),O=C+(D^(j|~L))+R[4]+4149444226&4294967295,C=j+(O<<6&4294967295|O>>>26),O=L+(j^(C|~D))+R[11]+3174756917&4294967295,L=C+(O<<10&4294967295|O>>>22),O=D+(C^(L|~j))+R[2]+718787259&4294967295,D=L+(O<<15&4294967295|O>>>17),O=j+(L^(D|~C))+R[9]+3951481745&4294967295,I.g[0]=I.g[0]+C&4294967295,I.g[1]=I.g[1]+(D+(O<<21&4294967295|O>>>11))&4294967295,I.g[2]=I.g[2]+D&4294967295,I.g[3]=I.g[3]+L&4294967295}r.prototype.v=function(I,C){C===void 0&&(C=I.length);const j=C-this.blockSize,R=this.C;let D=this.h,L=0;for(;L<C;){if(D==0)for(;L<=j;)a(this,I,L),L+=this.blockSize;if(typeof I=="string"){for(;L<C;)if(R[D++]=I.charCodeAt(L++),D==this.blockSize){a(this,R),D=0;break}}else for(;L<C;)if(R[D++]=I[L++],D==this.blockSize){a(this,R),D=0;break}}this.h=D,this.o+=C},r.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var C=1;C<I.length-8;++C)I[C]=0;C=this.o*8;for(var j=I.length-8;j<I.length;++j)I[j]=C&255,C/=256;for(this.v(I),I=Array(16),C=0,j=0;j<4;++j)for(let R=0;R<32;R+=8)I[C++]=this.g[j]>>>R&255;return I};function l(I,C){var j=m;return Object.prototype.hasOwnProperty.call(j,I)?j[I]:j[I]=C(I)}function c(I,C){this.h=C;const j=[];let R=!0;for(let D=I.length-1;D>=0;D--){const L=I[D]|0;R&&L==C||(j[D]=L,R=!1)}this.g=j}var m={};function g(I){return-128<=I&&I<128?l(I,function(C){return new c([C|0],C<0?-1:0)}):new c([I|0],I<0?-1:0)}function y(I){if(isNaN(I)||!isFinite(I))return w;if(I<0)return k(y(-I));const C=[];let j=1;for(let R=0;I>=j;R++)C[R]=I/j|0,j*=4294967296;return new c(C,0)}function _(I,C){if(I.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(I.charAt(0)=="-")return k(_(I.substring(1),C));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const j=y(Math.pow(C,8));let R=w;for(let L=0;L<I.length;L+=8){var D=Math.min(8,I.length-L);const O=parseInt(I.substring(L,L+D),C);D<8?(D=y(Math.pow(C,D)),R=R.j(D).add(y(O))):(R=R.j(j),R=R.add(y(O)))}return R}var w=g(0),E=g(1),S=g(16777216);n=c.prototype,n.m=function(){if(M(this))return-k(this).m();let I=0,C=1;for(let j=0;j<this.g.length;j++){const R=this.i(j);I+=(R>=0?R:4294967296+R)*C,C*=4294967296}return I},n.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(N(this))return"0";if(M(this))return"-"+k(this).toString(I);const C=y(Math.pow(I,6));var j=this;let R="";for(;;){const D=te(j,C).g;j=V(j,D.j(C));let L=((j.g.length>0?j.g[0]:j.h)>>>0).toString(I);if(j=D,N(j))return L+R;for(;L.length<6;)L="0"+L;R=L+R}},n.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function N(I){if(I.h!=0)return!1;for(let C=0;C<I.g.length;C++)if(I.g[C]!=0)return!1;return!0}function M(I){return I.h==-1}n.l=function(I){return I=V(this,I),M(I)?-1:N(I)?0:1};function k(I){const C=I.g.length,j=[];for(let R=0;R<C;R++)j[R]=~I.g[R];return new c(j,~I.h).add(E)}n.abs=function(){return M(this)?k(this):this},n.add=function(I){const C=Math.max(this.g.length,I.g.length),j=[];let R=0;for(let D=0;D<=C;D++){let L=R+(this.i(D)&65535)+(I.i(D)&65535),O=(L>>>16)+(this.i(D)>>>16)+(I.i(D)>>>16);R=O>>>16,L&=65535,O&=65535,j[D]=O<<16|L}return new c(j,j[j.length-1]&-2147483648?-1:0)};function V(I,C){return I.add(k(C))}n.j=function(I){if(N(this)||N(I))return w;if(M(this))return M(I)?k(this).j(k(I)):k(k(this).j(I));if(M(I))return k(this.j(k(I)));if(this.l(S)<0&&I.l(S)<0)return y(this.m()*I.m());const C=this.g.length+I.g.length,j=[];for(var R=0;R<2*C;R++)j[R]=0;for(R=0;R<this.g.length;R++)for(let D=0;D<I.g.length;D++){const L=this.i(R)>>>16,O=this.i(R)&65535,Fe=I.i(D)>>>16,et=I.i(D)&65535;j[2*R+2*D]+=O*et,F(j,2*R+2*D),j[2*R+2*D+1]+=L*et,F(j,2*R+2*D+1),j[2*R+2*D+1]+=O*Fe,F(j,2*R+2*D+1),j[2*R+2*D+2]+=L*Fe,F(j,2*R+2*D+2)}for(I=0;I<C;I++)j[I]=j[2*I+1]<<16|j[2*I];for(I=C;I<2*C;I++)j[I]=0;return new c(j,0)};function F(I,C){for(;(I[C]&65535)!=I[C];)I[C+1]+=I[C]>>>16,I[C]&=65535,C++}function $(I,C){this.g=I,this.h=C}function te(I,C){if(N(C))throw Error("division by zero");if(N(I))return new $(w,w);if(M(I))return C=te(k(I),C),new $(k(C.g),k(C.h));if(M(C))return C=te(I,k(C)),new $(k(C.g),C.h);if(I.g.length>30){if(M(I)||M(C))throw Error("slowDivide_ only works with positive integers.");for(var j=E,R=C;R.l(I)<=0;)j=ue(j),R=ue(R);var D=le(j,1),L=le(R,1);for(R=le(R,2),j=le(j,2);!N(R);){var O=L.add(R);O.l(I)<=0&&(D=D.add(j),L=O),R=le(R,1),j=le(j,1)}return C=V(I,D.j(C)),new $(D,C)}for(D=w;I.l(C)>=0;){for(j=Math.max(1,Math.floor(I.m()/C.m())),R=Math.ceil(Math.log(j)/Math.LN2),R=R<=48?1:Math.pow(2,R-48),L=y(j),O=L.j(C);M(O)||O.l(I)>0;)j-=R,L=y(j),O=L.j(C);N(L)&&(L=E),D=D.add(L),I=V(I,O)}return new $(D,I)}n.B=function(I){return te(this,I).h},n.and=function(I){const C=Math.max(this.g.length,I.g.length),j=[];for(let R=0;R<C;R++)j[R]=this.i(R)&I.i(R);return new c(j,this.h&I.h)},n.or=function(I){const C=Math.max(this.g.length,I.g.length),j=[];for(let R=0;R<C;R++)j[R]=this.i(R)|I.i(R);return new c(j,this.h|I.h)},n.xor=function(I){const C=Math.max(this.g.length,I.g.length),j=[];for(let R=0;R<C;R++)j[R]=this.i(R)^I.i(R);return new c(j,this.h^I.h)};function ue(I){const C=I.g.length+1,j=[];for(let R=0;R<C;R++)j[R]=I.i(R)<<1|I.i(R-1)>>>31;return new c(j,I.h)}function le(I,C){const j=C>>5;C%=32;const R=I.g.length-j,D=[];for(let L=0;L<R;L++)D[L]=C>0?I.i(L+j)>>>C|I.i(L+j+1)<<32-C:I.i(L+j);return new c(D,I.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Ix=r,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=y,c.fromString=_,Xi=c}).apply(typeof c1<"u"?c1:typeof self<"u"?self:typeof window<"u"?window:{});var hd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var jx,Yc,kx,Cd,Rp,Ox,Dx,Mx;(function(){var n,e=Object.defineProperty;function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof hd=="object"&&hd];for(var v=0;v<d.length;++v){var x=d[v];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var r=t(this);function a(d,v){if(v)e:{var x=r;d=d.split(".");for(var A=0;A<d.length-1;A++){var G=d[A];if(!(G in x))break e;x=x[G]}d=d[d.length-1],A=x[d],v=v(A),v!=A&&v!=null&&e(x,d,{configurable:!0,writable:!0,value:v})}}a("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(d){return d||function(v){var x=[],A;for(A in v)Object.prototype.hasOwnProperty.call(v,A)&&x.push([A,v[A]]);return x}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},c=this||self;function m(d){var v=typeof d;return v=="object"&&d!=null||v=="function"}function g(d,v,x){return d.call.apply(d.bind,arguments)}function y(d,v,x){return y=g,y.apply(null,arguments)}function _(d,v){var x=Array.prototype.slice.call(arguments,1);return function(){var A=x.slice();return A.push.apply(A,arguments),d.apply(this,A)}}function w(d,v){function x(){}x.prototype=v.prototype,d.Z=v.prototype,d.prototype=new x,d.prototype.constructor=d,d.Ob=function(A,G,J){for(var he=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)he[Ue-2]=arguments[Ue];return v.prototype[G].apply(A,he)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function S(d){const v=d.length;if(v>0){const x=Array(v);for(let A=0;A<v;A++)x[A]=d[A];return x}return[]}function N(d,v){for(let A=1;A<arguments.length;A++){const G=arguments[A];var x=typeof G;if(x=x!="object"?x:G?Array.isArray(G)?"array":x:"null",x=="array"||x=="object"&&typeof G.length=="number"){x=d.length||0;const J=G.length||0;d.length=x+J;for(let he=0;he<J;he++)d[x+he]=G[he]}else d.push(G)}}class M{constructor(v,x){this.i=v,this.j=x,this.h=0,this.g=null}get(){let v;return this.h>0?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function k(d){c.setTimeout(()=>{throw d},0)}function V(){var d=I;let v=null;return d.g&&(v=d.g,d.g=d.g.next,d.g||(d.h=null),v.next=null),v}class F{constructor(){this.h=this.g=null}add(v,x){const A=$.get();A.set(v,x),this.h?this.h.next=A:this.g=A,this.h=A}}var $=new M(()=>new te,d=>d.reset());class te{constructor(){this.next=this.g=this.h=null}set(v,x){this.h=v,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let ue,le=!1,I=new F,C=()=>{const d=Promise.resolve(void 0);ue=()=>{d.then(j)}};function j(){for(var d;d=V();){try{d.h.call(d.g)}catch(x){k(x)}var v=$;v.j(d),v.h<100&&(v.h++,d.next=v.g,v.g=d)}le=!1}function R(){this.u=this.u,this.C=this.C}R.prototype.u=!1,R.prototype.dispose=function(){this.u||(this.u=!0,this.N())},R.prototype[Symbol.dispose]=function(){this.dispose()},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(d,v){this.type=d,this.g=this.target=v,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var L=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var d=!1,v=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const x=()=>{};c.addEventListener("test",x,v),c.removeEventListener("test",x,v)}catch{}return d})();function O(d){return/^[\s\xa0]*$/.test(d)}function Fe(d,v){D.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,v)}w(Fe,D),Fe.prototype.init=function(d,v){const x=this.type=d.type,A=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=v,v=d.relatedTarget,v||(x=="mouseover"?v=d.fromElement:x=="mouseout"&&(v=d.toElement)),this.relatedTarget=v,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&Fe.Z.h.call(this)},Fe.prototype.h=function(){Fe.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var et="closure_listenable_"+(Math.random()*1e6|0),q=0;function ce(d,v,x,A,G){this.listener=d,this.proxy=null,this.src=v,this.type=x,this.capture=!!A,this.ha=G,this.key=++q,this.da=this.fa=!1}function _e(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function De(d,v,x){for(const A in d)v.call(x,d[A],A,d)}function qe(d,v){for(const x in d)v.call(void 0,d[x],x,d)}function U(d){const v={};for(const x in d)v[x]=d[x];return v}const ne="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function W(d,v){let x,A;for(let G=1;G<arguments.length;G++){A=arguments[G];for(x in A)d[x]=A[x];for(let J=0;J<ne.length;J++)x=ne[J],Object.prototype.hasOwnProperty.call(A,x)&&(d[x]=A[x])}}function oe(d){this.src=d,this.g={},this.h=0}oe.prototype.add=function(d,v,x,A,G){const J=d.toString();d=this.g[J],d||(d=this.g[J]=[],this.h++);const he=Te(d,v,A,G);return he>-1?(v=d[he],x||(v.fa=!1)):(v=new ce(v,this.src,J,!!A,G),v.fa=x,d.push(v)),v};function fe(d,v){const x=v.type;if(x in d.g){var A=d.g[x],G=Array.prototype.indexOf.call(A,v,void 0),J;(J=G>=0)&&Array.prototype.splice.call(A,G,1),J&&(_e(v),d.g[x].length==0&&(delete d.g[x],d.h--))}}function Te(d,v,x,A){for(let G=0;G<d.length;++G){const J=d[G];if(!J.da&&J.listener==v&&J.capture==!!x&&J.ha==A)return G}return-1}var Me="closure_lm_"+(Math.random()*1e6|0),tt={};function Je(d,v,x,A,G){if(Array.isArray(v)){for(let J=0;J<v.length;J++)Je(d,v[J],x,A,G);return null}return x=oi(x),d&&d[et]?d.J(v,x,m(A)?!!A.capture:!1,G):je(d,v,x,!1,A,G)}function je(d,v,x,A,G,J){if(!v)throw Error("Invalid event type");const he=m(G)?!!G.capture:!!G;let Ue=Rr(d);if(Ue||(d[Me]=Ue=new oe(d)),x=Ue.add(v,x,A,he,J),x.proxy)return x;if(A=Ft(),x.proxy=A,A.src=d,A.listener=x,d.addEventListener)L||(G=he),G===void 0&&(G=!1),d.addEventListener(v.toString(),A,G);else if(d.attachEvent)d.attachEvent(nt(v.toString()),A);else if(d.addListener&&d.removeListener)d.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return x}function Ft(){function d(x){return v.call(d.src,d.listener,x)}const v=Qs;return d}function Ar(d,v,x,A,G){if(Array.isArray(v))for(var J=0;J<v.length;J++)Ar(d,v[J],x,A,G);else A=m(A)?!!A.capture:!!A,x=oi(x),d&&d[et]?(d=d.i,J=String(v).toString(),J in d.g&&(v=d.g[J],x=Te(v,x,A,G),x>-1&&(_e(v[x]),Array.prototype.splice.call(v,x,1),v.length==0&&(delete d.g[J],d.h--)))):d&&(d=Rr(d))&&(v=d.g[v.toString()],d=-1,v&&(d=Te(v,x,A,G)),(x=d>-1?v[d]:null)&&Nr(x))}function Nr(d){if(typeof d!="number"&&d&&!d.da){var v=d.src;if(v&&v[et])fe(v.i,d);else{var x=d.type,A=d.proxy;v.removeEventListener?v.removeEventListener(x,A,d.capture):v.detachEvent?v.detachEvent(nt(x),A):v.addListener&&v.removeListener&&v.removeListener(A),(x=Rr(v))?(fe(x,d),x.h==0&&(x.src=null,v[Me]=null)):_e(d)}}}function nt(d){return d in tt?tt[d]:tt[d]="on"+d}function Qs(d,v){if(d.da)d=!0;else{v=new Fe(v,this);const x=d.listener,A=d.ha||d.src;d.fa&&Nr(d),d=x.call(A,v)}return d}function Rr(d){return d=d[Me],d instanceof oe?d:null}var Ys="__closure_events_fn_"+(Math.random()*1e9>>>0);function oi(d){return typeof d=="function"?d:(d[Ys]||(d[Ys]=function(v){return d.handleEvent(v)}),d[Ys])}function Ct(){R.call(this),this.i=new oe(this),this.M=this,this.G=null}w(Ct,R),Ct.prototype[et]=!0,Ct.prototype.removeEventListener=function(d,v,x,A){Ar(this,d,v,x,A)};function Ot(d,v){var x,A=d.G;if(A)for(x=[];A;A=A.G)x.push(A);if(d=d.M,A=v.type||v,typeof v=="string")v=new D(v,d);else if(v instanceof D)v.target=v.target||d;else{var G=v;v=new D(A,d),W(v,G)}G=!0;let J,he;if(x)for(he=x.length-1;he>=0;he--)J=v.g=x[he],G=Es(J,A,!0,v)&&G;if(J=v.g=d,G=Es(J,A,!0,v)&&G,G=Es(J,A,!1,v)&&G,x)for(he=0;he<x.length;he++)J=v.g=x[he],G=Es(J,A,!1,v)&&G}Ct.prototype.N=function(){if(Ct.Z.N.call(this),this.i){var d=this.i;for(const v in d.g){const x=d.g[v];for(let A=0;A<x.length;A++)_e(x[A]);delete d.g[v],d.h--}}this.G=null},Ct.prototype.J=function(d,v,x,A){return this.i.add(String(d),v,!1,x,A)},Ct.prototype.K=function(d,v,x,A){return this.i.add(String(d),v,!0,x,A)};function Es(d,v,x,A){if(v=d.i.g[String(v)],!v)return!0;v=v.concat();let G=!0;for(let J=0;J<v.length;++J){const he=v[J];if(he&&!he.da&&he.capture==x){const Ue=he.listener,Lt=he.ha||he.src;he.fa&&fe(d.i,he),G=Ue.call(Lt,A)!==!1&&G}}return G&&!A.defaultPrevented}function da(d,v){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=y(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(v)>2147483647?-1:c.setTimeout(d,v||0)}function fo(d){d.g=da(()=>{d.g=null,d.i&&(d.i=!1,fo(d))},d.l);const v=d.h;d.h=null,d.m.apply(null,v)}class dn extends R{constructor(v,x){super(),this.m=v,this.l=x,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:fo(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function os(d){R.call(this),this.h=d,this.g={}}w(os,R);var Ts=[];function fa(d){De(d.g,function(v,x){this.g.hasOwnProperty(x)&&Nr(v)},d),d.g={}}os.prototype.N=function(){os.Z.N.call(this),fa(this)},os.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ss=c.JSON.stringify,mo=c.JSON.parse,ma=class{stringify(d){return c.JSON.stringify(d,void 0)}parse(d){return c.JSON.parse(d,void 0)}};function ga(){}function As(){}var Hn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Vt(){D.call(this,"d")}w(Vt,D);function On(){D.call(this,"c")}w(On,D);var At={},pa=null;function Xs(){return pa=pa||new Ct}At.Ia="serverreachability";function ya(d){D.call(this,At.Ia,d)}w(ya,D);function $n(d){const v=Xs();Ot(v,new ya(v))}At.STAT_EVENT="statevent";function Ns(d,v){D.call(this,At.STAT_EVENT,d),this.stat=v}w(Ns,D);function Dt(d){const v=Xs();Ot(v,new Ns(v,d))}At.Ja="timingevent";function ls(d,v){D.call(this,At.Ja,d),this.size=v}w(ls,D);function cs(d,v){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){d()},v)}function Fn(){this.g=!0}Fn.prototype.ua=function(){this.g=!1};function Gl(d,v,x,A,G,J){d.info(function(){if(d.g)if(J){var he="",Ue=J.split("&");for(let at=0;at<Ue.length;at++){var Lt=Ue[at].split("=");if(Lt.length>1){const Nt=Lt[0];Lt=Lt[1];const ms=Nt.split("_");he=ms.length>=2&&ms[1]=="type"?he+(Nt+"="+Lt+"&"):he+(Nt+"=redacted&")}}}else he=null;else he=J;return"XMLHTTP REQ ("+A+") [attempt "+G+"]: "+v+`
`+x+`
`+he})}function go(d,v,x,A,G,J,he){d.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+G+"]: "+v+`
`+x+`
`+J+" "+he})}function us(d,v,x,A){d.info(function(){return"XMLHTTP TEXT ("+v+"): "+Kl(d,x)+(A?" "+A:"")})}function Cr(d,v){d.info(function(){return"TIMEOUT: "+v})}Fn.prototype.info=function(){};function Kl(d,v){if(!d.g)return v;if(!v)return null;try{const J=JSON.parse(v);if(J){for(d=0;d<J.length;d++)if(Array.isArray(J[d])){var x=J[d];if(!(x.length<2)){var A=x[1];if(Array.isArray(A)&&!(A.length<1)){var G=A[0];if(G!="noop"&&G!="stop"&&G!="close")for(let he=1;he<A.length;he++)A[he]=""}}}}return Ss(J)}catch{return v}}var Ws={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ir={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},va;function jr(){}w(jr,ga),jr.prototype.g=function(){return new XMLHttpRequest},va=new jr;function z(d){return encodeURIComponent(String(d))}function pe(d){var v=1;d=d.split(":");const x=[];for(;v>0&&d.length;)x.push(d.shift()),v--;return d.length&&x.push(d.join(":")),x}function Ie(d,v,x,A){this.j=d,this.i=v,this.l=x,this.S=A||1,this.V=new os(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Le}function Le(){this.i=null,this.g="",this.h=!1}var Ce={},st={};function lt(d,v,x){d.M=1,d.A=_a(Kt(v)),d.u=x,d.R=!0,Cn(d,null)}function Cn(d,v){d.F=Date.now(),Js(d),d.B=Kt(d.A);var x=d.B,A=d.S;Array.isArray(A)||(A=[String(A)]),_o(x.i,"t",A),d.C=0,x=d.j.L,d.h=new Le,d.g=rh(d.j,x?v:null,!d.u),d.P>0&&(d.O=new dn(y(d.Y,d,d.g),d.P)),v=d.V,x=d.g,A=d.ba;var G="readystatechange";Array.isArray(G)||(G&&(Ts[0]=G.toString()),G=Ts);for(let J=0;J<G.length;J++){const he=Je(x,G[J],A||v.handleEvent,!1,v.h||v);if(!he)break;v.g[he.key]=he}v=d.J?U(d.J):{},d.u?(d.v||(d.v="POST"),v["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,v)):(d.v="GET",d.g.ea(d.B,d.v,null,v)),$n(),Gl(d.i,d.v,d.B,d.l,d.S,d.u)}Ie.prototype.ba=function(d){d=d.target;const v=this.O;v&&js(d)==3?v.j():this.Y(d)},Ie.prototype.Y=function(d){try{if(d==this.g)e:{const Ue=js(this.g),Lt=this.g.ya(),at=this.g.ca();if(!(Ue<3)&&(Ue!=3||this.g&&(this.h.h||this.g.la()||fn(this.g)))){this.K||Ue!=4||Lt==7||(Lt==8||at<=0?$n(3):$n(2)),Zs(this);var v=this.g.ca();this.X=v;var x=Rs(this);if(this.o=v==200,go(this.i,this.v,this.B,this.l,this.S,Ue,v),this.o){if(this.U&&!this.L){t:{if(this.g){var A,G=this.g;if((A=G.g?G.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(A)){var J=A;break t}}J=null}if(d=J)us(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,er(this,d);else{this.o=!1,this.m=3,Dt(12),Gn(this),hs(this);break e}}if(this.R){d=!0;let Nt;for(;!this.K&&this.C<x.length;)if(Nt=Fu(this,x),Nt==st){Ue==4&&(this.m=4,Dt(14),d=!1),us(this.i,this.l,null,"[Incomplete Response]");break}else if(Nt==Ce){this.m=4,Dt(15),us(this.i,this.l,x,"[Invalid Chunk]"),d=!1;break}else us(this.i,this.l,Nt,null),er(this,Nt);if($u(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ue!=4||x.length!=0||this.h.h||(this.m=1,Dt(16),d=!1),this.o=this.o&&d,!d)us(this.i,this.l,x,"[Invalid Chunked Response]"),Gn(this),hs(this);else if(x.length>0&&!this.W){this.W=!0;var he=this.j;he.g==this&&he.aa&&!he.P&&(he.j.info("Great, no buffering proxy detected. Bytes received: "+x.length),lc(he),he.P=!0,Dt(11))}}else us(this.i,this.l,x,null),er(this,x);Ue==4&&Gn(this),this.o&&!this.K&&(Ue==4?eh(this.j,this):(this.o=!1,Js(this)))}else Or(this.g),v==400&&x.indexOf("Unknown SID")>0?(this.m=3,Dt(12)):(this.m=0,Dt(13)),Gn(this),hs(this)}}}catch{}finally{}};function Rs(d){if(!$u(d))return d.g.la();const v=fn(d.g);if(v==="")return"";let x="";const A=v.length,G=js(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return Gn(d),hs(d),"";d.h.i=new c.TextDecoder}for(let J=0;J<A;J++)d.h.h=!0,x+=d.h.i.decode(v[J],{stream:!(G&&J==A-1)});return v.length=0,d.h.g+=x,d.C=0,d.h.g}function $u(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function Fu(d,v){var x=d.C,A=v.indexOf(`
`,x);return A==-1?st:(x=Number(v.substring(x,A)),isNaN(x)?Ce:(A+=1,A+x>v.length?st:(v=v.slice(A,A+x),d.C=A+x,v)))}Ie.prototype.cancel=function(){this.K=!0,Gn(this)};function Js(d){d.T=Date.now()+d.H,po(d,d.H)}function po(d,v){if(d.D!=null)throw Error("WatchDog timer not null");d.D=cs(y(d.aa,d),v)}function Zs(d){d.D&&(c.clearTimeout(d.D),d.D=null)}Ie.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(Cr(this.i,this.B),this.M!=2&&($n(),Dt(17)),Gn(this),this.m=2,hs(this)):po(this,this.T-d)};function hs(d){d.j.I==0||d.K||eh(d.j,d)}function Gn(d){Zs(d);var v=d.O;v&&typeof v.dispose=="function"&&v.dispose(),d.O=null,fa(d.V),d.g&&(v=d.g,d.g=null,v.abort(),v.dispose())}function er(d,v){try{var x=d.j;if(x.I!=0&&(x.g==d||nr(x.h,d))){if(!d.L&&nr(x.h,d)&&x.I==3){try{var A=x.Ba.g.parse(v)}catch{A=null}if(Array.isArray(A)&&A.length==3){var G=A;if(G[0]==0){e:if(!x.v){if(x.g)if(x.g.F+3e3<d.F)To(x),gi(x);else break e;Aa(x),Dt(18)}}else x.xa=G[1],0<x.xa-x.K&&G[2]<37500&&x.F&&x.A==0&&!x.C&&(x.C=cs(y(x.Va,x),6e3));tr(x.h)<=1&&x.ta&&(x.ta=void 0)}else lr(x,11)}else if((d.L||x.g==d)&&To(x),!O(v))for(G=x.Ba.g.parse(v),v=0;v<G.length;v++){let at=G[v];const Nt=at[0];if(!(Nt<=x.K))if(x.K=Nt,at=at[1],x.I==2)if(at[0]=="c"){x.M=at[1],x.ba=at[2];const ms=at[3];ms!=null&&(x.ka=ms,x.j.info("VER="+x.ka));const cr=at[4];cr!=null&&(x.za=cr,x.j.info("SVER="+x.za));const ks=at[5];ks!=null&&typeof ks=="number"&&ks>0&&(A=1.5*ks,x.O=A,x.j.info("backChannelRequestTimeoutMs_="+A)),A=x;const Os=d.g;if(Os){const Na=Os.g?Os.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Na){var J=A.h;J.g||Na.indexOf("spdy")==-1&&Na.indexOf("quic")==-1&&Na.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(Xl(J,J.h),J.h=null))}if(A.G){const So=Os.g?Os.g.getResponseHeader("X-HTTP-Session-Id"):null;So&&(A.wa=So,ht(A.J,A.G,So))}}x.I=3,x.l&&x.l.ra(),x.aa&&(x.T=Date.now()-d.F,x.j.info("Handshake RTT: "+x.T+"ms")),A=x;var he=d;if(A.na=sh(A,A.L?A.ba:null,A.W),he.L){Wl(A.h,he);var Ue=he,Lt=A.O;Lt&&(Ue.H=Lt),Ue.D&&(Zs(Ue),Js(Ue)),A.g=he}else Ju(A);x.i.length>0&&or(x)}else at[0]!="stop"&&at[0]!="close"||lr(x,7);else x.I==3&&(at[0]=="stop"||at[0]=="close"?at[0]=="stop"?lr(x,7):ac(x):at[0]!="noop"&&x.l&&x.l.qa(at),x.A=0)}}$n(4)}catch{}}var Gt=class{constructor(d,v){this.g=d,this.map=v}};function Ql(d){this.l=d||10,c.PerformanceNavigationTiming?(d=c.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Yl(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function tr(d){return d.h?1:d.g?d.g.size:0}function nr(d,v){return d.h?d.h==v:d.g?d.g.has(v):!1}function Xl(d,v){d.g?d.g.add(v):d.h=v}function Wl(d,v){d.h&&d.h==v?d.h=null:d.g&&d.g.has(v)&&d.g.delete(v)}Ql.prototype.cancel=function(){if(this.i=Jl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function Jl(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let v=d.i;for(const x of d.g.values())v=v.concat(x.G);return v}return S(d.i)}var Gu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yo(d,v){if(d){d=d.split("&");for(let x=0;x<d.length;x++){const A=d[x].indexOf("=");let G,J=null;A>=0?(G=d[x].substring(0,A),J=d[x].substring(A+1)):G=d[x],v(G,J?decodeURIComponent(J.replace(/\+/g," ")):"")}}}function Kn(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let v;d instanceof Kn?(this.l=d.l,an(this,d.j),this.o=d.o,this.g=d.g,li(this,d.u),this.h=d.h,Zl(this,Xu(d.i)),this.m=d.m):d&&(v=String(d).match(Gu))?(this.l=!1,an(this,v[1]||"",!0),this.o=sr(v[2]||""),this.g=sr(v[3]||"",!0),li(this,v[4]),this.h=sr(v[5]||"",!0),Zl(this,v[6]||"",!0),this.m=sr(v[7]||"")):(this.l=!1,this.i=new ui(null,this.l))}Kn.prototype.toString=function(){const d=[];var v=this.j;v&&d.push(ba(v,vo,!0),":");var x=this.g;return(x||v=="file")&&(d.push("//"),(v=this.o)&&d.push(ba(v,vo,!0),"@"),d.push(z(x).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.u,x!=null&&d.push(":",String(x))),(x=this.h)&&(this.g&&x.charAt(0)!="/"&&d.push("/"),d.push(ba(x,x.charAt(0)=="/"?ec:Ku,!0))),(x=this.i.toString())&&d.push("?",x),(x=this.m)&&d.push("#",ba(x,Qu)),d.join("")},Kn.prototype.resolve=function(d){const v=Kt(this);let x=!!d.j;x?an(v,d.j):x=!!d.o,x?v.o=d.o:x=!!d.g,x?v.g=d.g:x=d.u!=null;var A=d.h;if(x)li(v,d.u);else if(x=!!d.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var G=v.h.lastIndexOf("/");G!=-1&&(A=v.h.slice(0,G+1)+A)}if(G=A,G==".."||G==".")A="";else if(G.indexOf("./")!=-1||G.indexOf("/.")!=-1){A=G.lastIndexOf("/",0)==0,G=G.split("/");const J=[];for(let he=0;he<G.length;){const Ue=G[he++];Ue=="."?A&&he==G.length&&J.push(""):Ue==".."?((J.length>1||J.length==1&&J[0]!="")&&J.pop(),A&&he==G.length&&J.push("")):(J.push(Ue),A=!0)}A=J.join("/")}else A=G}return x?v.h=A:x=d.i.toString()!=="",x?Zl(v,Xu(d.i)):x=!!d.m,x&&(v.m=d.m),v};function Kt(d){return new Kn(d)}function an(d,v,x){d.j=x?sr(v,!0):v,d.j&&(d.j=d.j.replace(/:$/,""))}function li(d,v){if(v){if(v=Number(v),isNaN(v)||v<0)throw Error("Bad port number "+v);d.u=v}else d.u=null}function Zl(d,v,x){v instanceof ui?(d.i=v,bo(d.i,d.l)):(x||(v=ba(v,ci)),d.i=new ui(v,d.l))}function ht(d,v,x){d.i.set(v,x)}function _a(d){return ht(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function sr(d,v){return d?v?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function ba(d,v,x){return typeof d=="string"?(d=encodeURI(d).replace(v,Dn),x&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function Dn(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var vo=/[#\/\?@]/g,Ku=/[#\?:]/g,ec=/[#\?]/g,ci=/[#\?@]/g,Qu=/#/g;function ui(d,v){this.h=this.g=null,this.i=d||null,this.j=!!v}function Mn(d){d.g||(d.g=new Map,d.h=0,d.i&&yo(d.i,function(v,x){d.add(decodeURIComponent(v.replace(/\+/g," ")),x)}))}n=ui.prototype,n.add=function(d,v){Mn(this),this.i=null,d=hi(this,d);let x=this.g.get(d);return x||this.g.set(d,x=[]),x.push(v),this.h+=1,this};function Yu(d,v){Mn(d),v=hi(d,v),d.g.has(v)&&(d.i=null,d.h-=d.g.get(v).length,d.g.delete(v))}function tc(d,v){return Mn(d),v=hi(d,v),d.g.has(v)}n.forEach=function(d,v){Mn(this),this.g.forEach(function(x,A){x.forEach(function(G){d.call(v,G,A,this)},this)},this)};function nc(d,v){Mn(d);let x=[];if(typeof v=="string")tc(d,v)&&(x=x.concat(d.g.get(hi(d,v))));else for(d=Array.from(d.g.values()),v=0;v<d.length;v++)x=x.concat(d[v]);return x}n.set=function(d,v){return Mn(this),this.i=null,d=hi(this,d),tc(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[v]),this.h+=1,this},n.get=function(d,v){return d?(d=nc(this,d),d.length>0?String(d[0]):v):v};function _o(d,v,x){Yu(d,v),x.length>0&&(d.i=null,d.g.set(hi(d,v),S(x)),d.h+=x.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],v=Array.from(this.g.keys());for(let A=0;A<v.length;A++){var x=v[A];const G=z(x);x=nc(this,x);for(let J=0;J<x.length;J++){let he=G;x[J]!==""&&(he+="="+z(x[J])),d.push(he)}}return this.i=d.join("&")};function Xu(d){const v=new ui;return v.i=d.i,d.g&&(v.g=new Map(d.g),v.h=d.h),v}function hi(d,v){return v=String(v),d.j&&(v=v.toLowerCase()),v}function bo(d,v){v&&!d.j&&(Mn(d),d.i=null,d.g.forEach(function(x,A){const G=A.toLowerCase();A!=G&&(Yu(this,A),_o(this,G,x))},d)),d.j=v}function Cs(d,v){const x=new Fn;if(c.Image){const A=new Image;A.onload=_(ds,x,"TestLoadImage: loaded",!0,v,A),A.onerror=_(ds,x,"TestLoadImage: error",!1,v,A),A.onabort=_(ds,x,"TestLoadImage: abort",!1,v,A),A.ontimeout=_(ds,x,"TestLoadImage: timeout",!1,v,A),c.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=d}else v(!1)}function sc(d,v){const x=new Fn,A=new AbortController,G=setTimeout(()=>{A.abort(),ds(x,"TestPingServer: timeout",!1,v)},1e4);fetch(d,{signal:A.signal}).then(J=>{clearTimeout(G),J.ok?ds(x,"TestPingServer: ok",!0,v):ds(x,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(G),ds(x,"TestPingServer: error",!1,v)})}function ds(d,v,x,A,G){try{G&&(G.onload=null,G.onerror=null,G.onabort=null,G.ontimeout=null),A(x)}catch{}}function di(){this.g=new ma}function rr(d){this.i=d.Sb||null,this.h=d.ab||!1}w(rr,ga),rr.prototype.g=function(){return new wa(this.i,this.h)};function wa(d,v){Ct.call(this),this.H=d,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}w(wa,Ct),n=wa.prototype,n.open=function(d,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=v,this.readyState=1,Is(this)},n.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const v={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(v.body=d),(this.H||c).fetch(new Request(this.D,v)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,fi(this)),this.readyState=0},n.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Is(this)),this.g&&(this.readyState=3,Is(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;wo(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function wo(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}n.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var v=d.value?d.value:new Uint8Array(0);(v=this.B.decode(v,{stream:!d.done}))&&(this.response=this.responseText+=v)}d.done?fi(this):Is(this),this.readyState==3&&wo(this)}},n.Oa=function(d){this.g&&(this.response=this.responseText=d,fi(this))},n.Na=function(d){this.g&&(this.response=d,fi(this))},n.ga=function(){this.g&&fi(this)};function fi(d){d.readyState=4,d.l=null,d.j=null,d.B=null,Is(d)}n.setRequestHeader=function(d,v){this.A.append(d,v)},n.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],v=this.h.entries();for(var x=v.next();!x.done;)x=x.value,d.push(x[0]+": "+x[1]),x=v.next();return d.join(`\r
`)};function Is(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(wa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function fs(d){let v="";return De(d,function(x,A){v+=A,v+=":",v+=x,v+=`\r
`}),v}function xa(d,v,x){e:{for(A in x){var A=!1;break e}A=!0}A||(x=fs(x),typeof d=="string"?x!=null&&z(x):ht(d,v,x))}function gt(d){Ct.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}w(gt,Ct);var ir=/^https?$/i,rc=["POST","PUT"];n=gt.prototype,n.Fa=function(d){this.H=d},n.ea=function(d,v,x,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);v=v?v.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():va.g(),this.g.onreadystatechange=E(y(this.Ca,this));try{this.B=!0,this.g.open(v,String(d),!0),this.B=!1}catch(J){Ea(this,J);return}if(d=x||"",x=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var G in A)x.set(G,A[G]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const J of A.keys())x.set(J,A.get(J));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(x.keys()).find(J=>J.toLowerCase()=="content-type"),G=c.FormData&&d instanceof c.FormData,!(Array.prototype.indexOf.call(rc,v,void 0)>=0)||A||G||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,he]of x)this.g.setRequestHeader(J,he);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(J){Ea(this,J)}};function Ea(d,v){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=v,d.o=5,ic(d),kr(d)}function ic(d){d.A||(d.A=!0,Ot(d,"complete"),Ot(d,"error"))}n.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,Ot(this,"complete"),Ot(this,"abort"),kr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),kr(this,!0)),gt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Ta(this):this.Xa())},n.Xa=function(){Ta(this)};function Ta(d){if(d.h&&typeof l<"u"){if(d.v&&js(d)==4)setTimeout(d.Ca.bind(d),0);else if(Ot(d,"readystatechange"),js(d)==4){d.h=!1;try{const J=d.ca();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var x;if(!(x=v)){var A;if(A=J===0){let he=String(d.D).match(Gu)[1]||null;!he&&c.self&&c.self.location&&(he=c.self.location.protocol.slice(0,-1)),A=!ir.test(he?he.toLowerCase():"")}x=A}if(x)Ot(d,"complete"),Ot(d,"success");else{d.o=6;try{var G=js(d)>2?d.g.statusText:""}catch{G=""}d.l=G+" ["+d.ca()+"]",ic(d)}}finally{kr(d)}}}}function kr(d,v){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const x=d.g;d.g=null,v||Ot(d,"ready");try{x.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function js(d){return d.g?d.g.readyState:0}n.ca=function(){try{return js(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(d){if(this.g){var v=this.g.responseText;return d&&v.indexOf(d)==0&&(v=v.substring(d.length)),mo(v)}};function fn(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Or(d){const v={};d=(d.g&&js(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<d.length;A++){if(O(d[A]))continue;var x=pe(d[A]);const G=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const J=v[G]||[];v[G]=J,J.push(x)}qe(v,function(A){return A.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ar(d,v,x){return x&&x.internalChannelParams&&x.internalChannelParams[d]||v}function mi(d){this.za=0,this.i=[],this.j=new Fn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ar("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ar("baseRetryDelayMs",5e3,d),this.Za=ar("retryDelaySeedMs",1e4,d),this.Ta=ar("forwardChannelMaxRetries",2,d),this.va=ar("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new Ql(d&&d.concurrentRequestLimit),this.Ba=new di,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=mi.prototype,n.ka=8,n.I=1,n.connect=function(d,v,x,A){Dt(0),this.W=d,this.H=v||{},x&&A!==void 0&&(this.H.OSID=x,this.H.OAID=A),this.F=this.X,this.J=sh(this,null,this.W),or(this)};function ac(d){if(xo(d),d.I==3){var v=d.V++,x=Kt(d.J);if(ht(x,"SID",d.M),ht(x,"RID",v),ht(x,"TYPE","terminate"),Sa(d,x),v=new Ie(d,d.j,v),v.M=2,v.A=_a(Kt(x)),x=!1,c.navigator&&c.navigator.sendBeacon)try{x=c.navigator.sendBeacon(v.A.toString(),"")}catch{}!x&&c.Image&&(new Image().src=v.A,x=!0),x||(v.g=rh(v.j,null),v.g.ea(v.A)),v.F=Date.now(),Js(v)}nh(d)}function gi(d){d.g&&(lc(d),d.g.cancel(),d.g=null)}function xo(d){gi(d),d.v&&(c.clearTimeout(d.v),d.v=null),To(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&c.clearTimeout(d.m),d.m=null)}function or(d){if(!Yl(d.h)&&!d.m){d.m=!0;var v=d.Ea;ue||C(),le||(ue(),le=!0),I.add(v,d),d.D=0}}function Eo(d,v){return tr(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=v.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=cs(y(d.Ea,d,v),th(d,d.D)),d.D++,!0)}n.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const G=new Ie(this,this.j,d);let J=this.o;if(this.U&&(J?(J=U(J),W(J,this.U)):J=this.U),this.u!==null||this.R||(G.J=J,J=null),this.S)e:{for(var v=0,x=0;x<this.i.length;x++){t:{var A=this.i[x];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(v+=A,v>4096){v=x;break e}if(v===4096||x===this.i.length-1){v=x+1;break e}}v=1e3}else v=1e3;v=Wu(this,G,v),x=Kt(this.J),ht(x,"RID",d),ht(x,"CVER",22),this.G&&ht(x,"X-HTTP-Session-Id",this.G),Sa(this,x),J&&(this.R?v="headers="+z(fs(J))+"&"+v:this.u&&xa(x,this.u,J)),Xl(this.h,G),this.Ra&&ht(x,"TYPE","init"),this.S?(ht(x,"$req",v),ht(x,"SID","null"),G.U=!0,lt(G,x,null)):lt(G,x,v),this.I=2}}else this.I==3&&(d?oc(this,d):this.i.length==0||Yl(this.h)||oc(this))};function oc(d,v){var x;v?x=v.l:x=d.V++;const A=Kt(d.J);ht(A,"SID",d.M),ht(A,"RID",x),ht(A,"AID",d.K),Sa(d,A),d.u&&d.o&&xa(A,d.u,d.o),x=new Ie(d,d.j,x,d.D+1),d.u===null&&(x.J=d.o),v&&(d.i=v.G.concat(d.i)),v=Wu(d,x,1e3),x.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),Xl(d.h,x),lt(x,A,v)}function Sa(d,v){d.H&&De(d.H,function(x,A){ht(v,A,x)}),d.l&&De({},function(x,A){ht(v,A,x)})}function Wu(d,v,x){x=Math.min(d.i.length,x);const A=d.l?y(d.l.Ka,d.l,d):null;e:{var G=d.i;let Ue=-1;for(;;){const Lt=["count="+x];Ue==-1?x>0?(Ue=G[0].g,Lt.push("ofs="+Ue)):Ue=0:Lt.push("ofs="+Ue);let at=!0;for(let Nt=0;Nt<x;Nt++){var J=G[Nt].g;const ms=G[Nt].map;if(J-=Ue,J<0)Ue=Math.max(0,G[Nt].g-100),at=!1;else try{J="req"+J+"_"||"";try{var he=ms instanceof Map?ms:Object.entries(ms);for(const[cr,ks]of he){let Os=ks;m(ks)&&(Os=Ss(ks)),Lt.push(J+cr+"="+encodeURIComponent(Os))}}catch(cr){throw Lt.push(J+"type="+encodeURIComponent("_badmap")),cr}}catch{A&&A(ms)}}if(at){he=Lt.join("&");break e}}he=void 0}return d=d.i.splice(0,x),v.G=d,he}function Ju(d){if(!d.g&&!d.v){d.Y=1;var v=d.Da;ue||C(),le||(ue(),le=!0),I.add(v,d),d.A=0}}function Aa(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=cs(y(d.Da,d),th(d,d.A)),d.A++,!0)}n.Da=function(){if(this.v=null,Zu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=cs(y(this.Wa,this),d)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Dt(10),gi(this),Zu(this))};function lc(d){d.B!=null&&(c.clearTimeout(d.B),d.B=null)}function Zu(d){d.g=new Ie(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var v=Kt(d.na);ht(v,"RID","rpc"),ht(v,"SID",d.M),ht(v,"AID",d.K),ht(v,"CI",d.F?"0":"1"),!d.F&&d.ia&&ht(v,"TO",d.ia),ht(v,"TYPE","xmlhttp"),Sa(d,v),d.u&&d.o&&xa(v,d.u,d.o),d.O&&(d.g.H=d.O);var x=d.g;d=d.ba,x.M=1,x.A=_a(Kt(v)),x.u=null,x.R=!0,Cn(x,d)}n.Va=function(){this.C!=null&&(this.C=null,gi(this),Aa(this),Dt(19))};function To(d){d.C!=null&&(c.clearTimeout(d.C),d.C=null)}function eh(d,v){var x=null;if(d.g==v){To(d),lc(d),d.g=null;var A=2}else if(nr(d.h,v))x=v.G,Wl(d.h,v),A=1;else return;if(d.I!=0){if(v.o)if(A==1){x=v.u?v.u.length:0,v=Date.now()-v.F;var G=d.D;A=Xs(),Ot(A,new ls(A,x)),or(d)}else Ju(d);else if(G=v.m,G==3||G==0&&v.X>0||!(A==1&&Eo(d,v)||A==2&&Aa(d)))switch(x&&x.length>0&&(v=d.h,v.i=v.i.concat(x)),G){case 1:lr(d,5);break;case 4:lr(d,10);break;case 3:lr(d,6);break;default:lr(d,2)}}}function th(d,v){let x=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(x*=2),x*v}function lr(d,v){if(d.j.info("Error code "+v),v==2){var x=y(d.bb,d),A=d.Ua;const G=!A;A=new Kn(A||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||an(A,"https"),_a(A),G?Cs(A.toString(),x):sc(A.toString(),x)}else Dt(2);d.I=0,d.l&&d.l.pa(v),nh(d),xo(d)}n.bb=function(d){d?(this.j.info("Successfully pinged google.com"),Dt(2)):(this.j.info("Failed to ping google.com"),Dt(1))};function nh(d){if(d.I=0,d.ja=[],d.l){const v=Jl(d.h);(v.length!=0||d.i.length!=0)&&(N(d.ja,v),N(d.ja,d.i),d.h.i.length=0,S(d.i),d.i.length=0),d.l.oa()}}function sh(d,v,x){var A=x instanceof Kn?Kt(x):new Kn(x);if(A.g!="")v&&(A.g=v+"."+A.g),li(A,A.u);else{var G=c.location;A=G.protocol,v=v?v+"."+G.hostname:G.hostname,G=+G.port;const J=new Kn(null);A&&an(J,A),v&&(J.g=v),G&&li(J,G),x&&(J.h=x),A=J}return x=d.G,v=d.wa,x&&v&&ht(A,x,v),ht(A,"VER",d.ka),Sa(d,A),A}function rh(d,v,x){if(v&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return v=d.Aa&&!d.ma?new gt(new rr({ab:x})):new gt(d.ma),v.Fa(d.L),v}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ih(){}n=ih.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function pi(){}pi.prototype.g=function(d,v){return new In(d,v)};function In(d,v){Ct.call(this),this.g=new mi(v),this.l=d,this.h=v&&v.messageUrlParams||null,d=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(d?d["X-WebChannel-Content-Type"]=v.messageContentType:d={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.sa&&(d?d["X-WebChannel-Client-Profile"]=v.sa:d={"X-WebChannel-Client-Profile":v.sa}),this.g.U=d,(d=v&&v.Qb)&&!O(d)&&(this.g.u=d),this.A=v&&v.supportsCrossDomainXhr||!1,this.v=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!O(v)&&(this.g.G=v,d=this.h,d!==null&&v in d&&(d=this.h,v in d&&delete d[v])),this.j=new Dr(this)}w(In,Ct),In.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},In.prototype.close=function(){ac(this.g)},In.prototype.o=function(d){var v=this.g;if(typeof d=="string"){var x={};x.__data__=d,d=x}else this.v&&(x={},x.__data__=Ss(d),d=x);v.i.push(new Gt(v.Ya++,d)),v.I==3&&or(v)},In.prototype.N=function(){this.g.l=null,delete this.j,ac(this.g),delete this.g,In.Z.N.call(this)};function ah(d){Vt.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var v=d.__sm__;if(v){e:{for(const x in v){d=x;break e}d=void 0}(this.i=d)&&(d=this.i,v=v!==null&&d in v?v[d]:void 0),this.data=v}else this.data=d}w(ah,Vt);function oh(){On.call(this),this.status=1}w(oh,On);function Dr(d){this.g=d}w(Dr,ih),Dr.prototype.ra=function(){Ot(this.g,"a")},Dr.prototype.qa=function(d){Ot(this.g,new ah(d))},Dr.prototype.pa=function(d){Ot(this.g,new oh)},Dr.prototype.oa=function(){Ot(this.g,"b")},pi.prototype.createWebChannel=pi.prototype.g,In.prototype.send=In.prototype.o,In.prototype.open=In.prototype.m,In.prototype.close=In.prototype.close,Mx=function(){return new pi},Dx=function(){return Xs()},Ox=At,Rp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ws.NO_ERROR=0,Ws.TIMEOUT=8,Ws.HTTP_ERROR=6,Cd=Ws,Ir.COMPLETE="complete",kx=Ir,As.EventType=Hn,Hn.OPEN="a",Hn.CLOSE="b",Hn.ERROR="c",Hn.MESSAGE="d",Ct.prototype.listen=Ct.prototype.J,Yc=As,gt.prototype.listenOnce=gt.prototype.K,gt.prototype.getLastError=gt.prototype.Ha,gt.prototype.getLastErrorCode=gt.prototype.ya,gt.prototype.getStatus=gt.prototype.ca,gt.prototype.getResponseJson=gt.prototype.La,gt.prototype.getResponseText=gt.prototype.la,gt.prototype.send=gt.prototype.ea,gt.prototype.setWithCredentials=gt.prototype.Fa,jx=gt}).apply(typeof hd<"u"?hd:typeof self<"u"?self:typeof window<"u"?window:{});const u1="@firebase/firestore",h1="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Tn.UNAUTHENTICATED=new Tn(null),Tn.GOOGLE_CREDENTIALS=new Tn("google-credentials-uid"),Tn.FIRST_PARTY=new Tn("first-party-uid"),Tn.MOCK_USER=new Tn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pl="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Za=new y0("@firebase/firestore");function ol(){return Za.logLevel}function ge(n,...e){if(Za.logLevel<=Qe.DEBUG){const t=e.map(_0);Za.debug(`Firestore (${Pl}): ${n}`,...t)}}function ri(n,...e){if(Za.logLevel<=Qe.ERROR){const t=e.map(_0);Za.error(`Firestore (${Pl}): ${n}`,...t)}}function eo(n,...e){if(Za.logLevel<=Qe.WARN){const t=e.map(_0);Za.warn(`Firestore (${Pl}): ${n}`,...t)}}function _0(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Re(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Px(n,r,t)}function Px(n,e,t){let r=`FIRESTORE (${Pl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw ri(r),new Error(r)}function ct(n,e,t,r){let a="Unexpected state";typeof t=="string"?a=t:r=t,n||Px(e,a,r)}function Ve(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class de extends Tr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vx{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Lx{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Tn.UNAUTHENTICATED)))}shutdown(){}}class B4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class q4{constructor(e){this.t=e,this.currentUser=Tn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ct(this.o===void 0,42304);let r=this.i;const a=g=>this.i!==r?(r=this.i,t(g)):Promise.resolve();let l=new Zr;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Zr,e.enqueueRetryable((()=>a(this.currentUser)))};const c=()=>{const g=l;e.enqueueRetryable((async()=>{await g.promise,await a(this.currentUser)}))},m=g=>{ge("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((g=>m(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?m(g):(ge("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Zr)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(ge("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ct(typeof r.accessToken=="string",31837,{l:r}),new Vx(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ct(e===null||typeof e=="string",2055,{h:e}),new Tn(e)}}class H4{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Tn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class $4{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new H4(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Tn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class d1{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class F4{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ns(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ct(this.o===void 0,3512);const r=l=>{l.error!=null&&ge("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,ge("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>r(l)))};const a=l=>{ge("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):ge("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new d1(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(ct(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new d1(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G4(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const a=G4(40);for(let l=0;l<a.length;++l)r.length<20&&a[l]<t&&(r+=e.charAt(a[l]%62))}return r}}function Ye(n,e){return n<e?-1:n>e?1:0}function Cp(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const a=n.charAt(r),l=e.charAt(r);if(a!==l)return sp(a)===sp(l)?Ye(a,l):sp(a)?1:-1}return Ye(n.length,e.length)}const K4=55296,Q4=57343;function sp(n){const e=n.charCodeAt(0);return e>=K4&&e<=Q4}function Al(n,e,t){return n.length===e.length&&n.every(((r,a)=>t(r,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ip="__name__";class gr{constructor(e,t,r){t===void 0?t=0:t>e.length&&Re(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Re(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return gr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof gr?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let a=0;a<r;a++){const l=gr.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return Ye(e.length,t.length)}static compareSegments(e,t){const r=gr.isNumericId(e),a=gr.isNumericId(t);return r&&!a?-1:!r&&a?1:r&&a?gr.extractNumericId(e).compare(gr.extractNumericId(t)):Cp(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Xi.fromString(e.substring(4,e.length-2))}}class Et extends gr{construct(e,t,r){return new Et(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new de(re.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((a=>a.length>0)))}return new Et(t)}static emptyPath(){return new Et([])}}const Y4=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class cn extends gr{construct(e,t,r){return new cn(e,t,r)}static isValidIdentifier(e){return Y4.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),cn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ip}static keyField(){return new cn([Ip])}static fromServerFormat(e){const t=[];let r="",a=0;const l=()=>{if(r.length===0)throw new de(re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let c=!1;for(;a<e.length;){const m=e[a];if(m==="\\"){if(a+1===e.length)throw new de(re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[a+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new de(re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=g,a+=2}else m==="`"?(c=!c,a++):m!=="."||c?(r+=m,a++):(l(),a++)}if(l(),c)throw new de(re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new cn(t)}static emptyPath(){return new cn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(e){this.path=e}static fromPath(e){return new xe(Et.fromString(e))}static fromName(e){return new xe(Et.fromString(e).popFirst(5))}static empty(){return new xe(Et.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Et.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Et.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new xe(new Et(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ux(n,e,t){if(!t)throw new de(re.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function zx(n,e,t,r){if(e===!0&&r===!0)throw new de(re.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function f1(n){if(!xe.isDocumentKey(n))throw new de(re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function m1(n){if(xe.isDocumentKey(n))throw new de(re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Bx(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function wf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Re(12329,{type:typeof n})}function An(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new de(re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=wf(n);throw new de(re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tn(n,e){const t={typeString:n};return e&&(t.value=e),t}function ju(n,e){if(!Bx(n))throw new de(re.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const a=e[r].typeString,l="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const c=n[r];if(a&&typeof c!==a){t=`JSON field '${r}' must be a ${a}.`;break}if(l!==void 0&&c!==l.value){t=`Expected '${r}' field to equal '${l.value}'`;break}}if(t)throw new de(re.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g1=-62135596800,p1=1e6;class _t{static now(){return _t.fromMillis(Date.now())}static fromDate(e){return _t.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*p1);return new _t(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new de(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new de(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<g1)throw new de(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new de(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/p1}_compareTo(e){return this.seconds===e.seconds?Ye(this.nanoseconds,e.nanoseconds):Ye(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:_t._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ju(e,_t._jsonSchema))return new _t(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-g1;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}_t._jsonSchemaVersion="firestore/timestamp/1.0",_t._jsonSchema={type:tn("string",_t._jsonSchemaVersion),seconds:tn("number"),nanoseconds:tn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{static fromTimestamp(e){return new Oe(e)}static min(){return new Oe(new _t(0,0))}static max(){return new Oe(new _t(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fu=-1;function X4(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,a=Oe.fromTimestamp(r===1e9?new _t(t+1,0):new _t(t,r));return new ea(a,xe.empty(),e)}function W4(n){return new ea(n.readTime,n.key,fu)}class ea{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ea(Oe.min(),xe.empty(),fu)}static max(){return new ea(Oe.max(),xe.empty(),fu)}}function J4(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=xe.comparator(n.documentKey,e.documentKey),t!==0?t:Ye(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class e5{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vl(n){if(n.code!==re.FAILED_PRECONDITION||n.message!==Z4)throw n;ge("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Re(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ae(((r,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(r,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(r,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ae?t:ae.resolve(t)}catch(t){return ae.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.reject(t)}static resolve(e){return new ae(((t,r)=>{t(e)}))}static reject(e){return new ae(((t,r)=>{r(e)}))}static waitFor(e){return new ae(((t,r)=>{let a=0,l=0,c=!1;e.forEach((m=>{++a,m.next((()=>{++l,c&&l===a&&t()}),(g=>r(g)))})),c=!0,l===a&&t()}))}static or(e){let t=ae.resolve(!1);for(const r of e)t=t.next((a=>a?ae.resolve(a):r()));return t}static forEach(e,t){const r=[];return e.forEach(((a,l)=>{r.push(t.call(this,a,l))})),this.waitFor(r)}static mapArray(e,t){return new ae(((r,a)=>{const l=e.length,c=new Array(l);let m=0;for(let g=0;g<l;g++){const y=g;t(e[y]).next((_=>{c[y]=_,++m,m===l&&r(c)}),(_=>a(_)))}}))}static doWhile(e,t){return new ae(((r,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):r()};l()}))}}function t5(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Ll(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}xf.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b0=-1;function Ef(n){return n==null}function Ud(n){return n===0&&1/n==-1/0}function n5(n){return typeof n=="number"&&Number.isInteger(n)&&!Ud(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx="";function s5(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=y1(e)),e=r5(n.get(t),e);return y1(e)}function r5(n,e){let t=e;const r=n.length;for(let a=0;a<r;a++){const l=n.charAt(a);switch(l){case"\0":t+="";break;case qx:t+="";break;default:t+=l}}return t}function y1(n){return n+qx+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v1(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function aa(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Hx(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e,t){this.comparator=e,this.root=t||_n.EMPTY}insert(e,t){return new kt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,_n.BLACK,null,null))}remove(e){return new kt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_n.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const a=this.comparator(e,r.key);if(a===0)return t+r.left.size;a<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new dd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new dd(this.root,e,this.comparator,!1)}getReverseIterator(){return new dd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new dd(this.root,e,this.comparator,!0)}}class dd{constructor(e,t,r,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?r(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _n{constructor(e,t,r,a,l){this.key=e,this.value=t,this.color=r??_n.RED,this.left=a??_n.EMPTY,this.right=l??_n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,a,l){return new _n(e??this.key,t??this.value,r??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let a=this;const l=r(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,r),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,r)),a.fixUp()}removeMin(){if(this.left.isEmpty())return _n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return _n.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Re(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Re(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Re(27949);return e+(this.isRed()?0:1)}}_n.EMPTY=null,_n.RED=!0,_n.BLACK=!1;_n.EMPTY=new class{constructor(){this.size=0}get key(){throw Re(57766)}get value(){throw Re(16141)}get color(){throw Re(16727)}get left(){throw Re(29726)}get right(){throw Re(36894)}copy(e,t,r,a,l){return this}insert(e,t,r){return new _n(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this.comparator=e,this.data=new kt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const a=r.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new _1(this.data.getIterator())}getIteratorFrom(e){return new _1(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof rn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=r.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new rn(this.comparator);return t.data=e,t}}class _1{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(e){this.fields=e,e.sort(cn.comparator)}static empty(){return new as([])}unionWith(e){let t=new rn(cn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new as(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Al(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $x extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new $x("Invalid base64 string: "+l):l}})(e);return new hn(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let c=0;c<a.length;++c)l+=String.fromCharCode(a[c]);return l})(e);return new hn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ye(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}hn.EMPTY_BYTE_STRING=new hn("");const i5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ta(n){if(ct(!!n,39018),typeof n=="string"){let e=0;const t=i5.exec(n);if(ct(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Bt(n.seconds),nanos:Bt(n.nanos)}}function Bt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function na(n){return typeof n=="string"?hn.fromBase64String(n):hn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fx="server_timestamp",Gx="__type__",Kx="__previous_value__",Qx="__local_write_time__";function w0(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[Gx])==null?void 0:r.stringValue)===Fx}function Tf(n){const e=n.mapValue.fields[Kx];return w0(e)?Tf(e):e}function mu(n){const e=ta(n.mapValue.fields[Qx].timestampValue);return new _t(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a5{constructor(e,t,r,a,l,c,m,g,y,_){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=a,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=m,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=_}}const zd="(default)";class Nl{constructor(e,t){this.projectId=e,this.database=t||zd}static empty(){return new Nl("","")}get isDefaultDatabase(){return this.database===zd}isEqual(e){return e instanceof Nl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yx="__type__",o5="__max__",fd={mapValue:{}},Xx="__vector__",Bd="value";function sa(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?w0(n)?4:c5(n)?9007199254740991:l5(n)?10:11:Re(28295,{value:n})}function xr(n,e){if(n===e)return!0;const t=sa(n);if(t!==sa(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return mu(n).isEqual(mu(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const c=ta(a.timestampValue),m=ta(l.timestampValue);return c.seconds===m.seconds&&c.nanos===m.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,l){return na(a.bytesValue).isEqual(na(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,l){return Bt(a.geoPointValue.latitude)===Bt(l.geoPointValue.latitude)&&Bt(a.geoPointValue.longitude)===Bt(l.geoPointValue.longitude)})(n,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Bt(a.integerValue)===Bt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const c=Bt(a.doubleValue),m=Bt(l.doubleValue);return c===m?Ud(c)===Ud(m):isNaN(c)&&isNaN(m)}return!1})(n,e);case 9:return Al(n.arrayValue.values||[],e.arrayValue.values||[],xr);case 10:case 11:return(function(a,l){const c=a.mapValue.fields||{},m=l.mapValue.fields||{};if(v1(c)!==v1(m))return!1;for(const g in c)if(c.hasOwnProperty(g)&&(m[g]===void 0||!xr(c[g],m[g])))return!1;return!0})(n,e);default:return Re(52216,{left:n})}}function gu(n,e){return(n.values||[]).find((t=>xr(t,e)))!==void 0}function Rl(n,e){if(n===e)return 0;const t=sa(n),r=sa(e);if(t!==r)return Ye(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ye(n.booleanValue,e.booleanValue);case 2:return(function(l,c){const m=Bt(l.integerValue||l.doubleValue),g=Bt(c.integerValue||c.doubleValue);return m<g?-1:m>g?1:m===g?0:isNaN(m)?isNaN(g)?0:-1:1})(n,e);case 3:return b1(n.timestampValue,e.timestampValue);case 4:return b1(mu(n),mu(e));case 5:return Cp(n.stringValue,e.stringValue);case 6:return(function(l,c){const m=na(l),g=na(c);return m.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(l,c){const m=l.split("/"),g=c.split("/");for(let y=0;y<m.length&&y<g.length;y++){const _=Ye(m[y],g[y]);if(_!==0)return _}return Ye(m.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,c){const m=Ye(Bt(l.latitude),Bt(c.latitude));return m!==0?m:Ye(Bt(l.longitude),Bt(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return w1(n.arrayValue,e.arrayValue);case 10:return(function(l,c){var E,S,N,M;const m=l.fields||{},g=c.fields||{},y=(E=m[Bd])==null?void 0:E.arrayValue,_=(S=g[Bd])==null?void 0:S.arrayValue,w=Ye(((N=y==null?void 0:y.values)==null?void 0:N.length)||0,((M=_==null?void 0:_.values)==null?void 0:M.length)||0);return w!==0?w:w1(y,_)})(n.mapValue,e.mapValue);case 11:return(function(l,c){if(l===fd.mapValue&&c===fd.mapValue)return 0;if(l===fd.mapValue)return 1;if(c===fd.mapValue)return-1;const m=l.fields||{},g=Object.keys(m),y=c.fields||{},_=Object.keys(y);g.sort(),_.sort();for(let w=0;w<g.length&&w<_.length;++w){const E=Cp(g[w],_[w]);if(E!==0)return E;const S=Rl(m[g[w]],y[_[w]]);if(S!==0)return S}return Ye(g.length,_.length)})(n.mapValue,e.mapValue);default:throw Re(23264,{he:t})}}function b1(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ye(n,e);const t=ta(n),r=ta(e),a=Ye(t.seconds,r.seconds);return a!==0?a:Ye(t.nanos,r.nanos)}function w1(n,e){const t=n.values||[],r=e.values||[];for(let a=0;a<t.length&&a<r.length;++a){const l=Rl(t[a],r[a]);if(l)return l}return Ye(t.length,r.length)}function Cl(n){return jp(n)}function jp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=ta(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return na(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return xe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",a=!0;for(const l of t.values||[])a?a=!1:r+=",",r+=jp(l);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const c of r)l?l=!1:a+=",",a+=`${c}:${jp(t.fields[c])}`;return a+"}"})(n.mapValue):Re(61005,{value:n})}function Id(n){switch(sa(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Tf(n);return e?16+Id(e):16;case 5:return 2*n.stringValue.length;case 6:return na(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((a,l)=>a+Id(l)),0)})(n.arrayValue);case 10:case 11:return(function(r){let a=0;return aa(r.fields,((l,c)=>{a+=l.length+Id(c)})),a})(n.mapValue);default:throw Re(13486,{value:n})}}function x1(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function kp(n){return!!n&&"integerValue"in n}function x0(n){return!!n&&"arrayValue"in n}function E1(n){return!!n&&"nullValue"in n}function T1(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function jd(n){return!!n&&"mapValue"in n}function l5(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[Yx])==null?void 0:r.stringValue)===Xx}function tu(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return aa(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=tu(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=tu(n.arrayValue.values[t]);return e}return{...n}}function c5(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===o5}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this.value=e}static empty(){return new qn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!jd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=tu(t)}setAll(e){let t=cn.emptyPath(),r={},a=[];e.forEach(((c,m)=>{if(!t.isImmediateParentOf(m)){const g=this.getFieldsMap(t);this.applyChanges(g,r,a),r={},a=[],t=m.popLast()}c?r[m.lastSegment()]=tu(c):a.push(m.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,r,a)}delete(e){const t=this.field(e.popLast());jd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return xr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let a=t.mapValue.fields[e.get(r)];jd(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,r){aa(t,((a,l)=>e[a]=l));for(const a of r)delete e[a]}clone(){return new qn(tu(this.value))}}function Wx(n){const e=[];return aa(n.fields,((t,r)=>{const a=new cn([t]);if(jd(r)){const l=Wx(r.mapValue).fields;if(l.length===0)e.push(a);else for(const c of l)e.push(a.child(c))}else e.push(a)})),new as(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e,t,r,a,l,c,m){this.key=e,this.documentType=t,this.version=r,this.readTime=a,this.createTime=l,this.data=c,this.documentState=m}static newInvalidDocument(e){return new Sn(e,0,Oe.min(),Oe.min(),Oe.min(),qn.empty(),0)}static newFoundDocument(e,t,r,a){return new Sn(e,1,t,Oe.min(),r,a,0)}static newNoDocument(e,t){return new Sn(e,2,t,Oe.min(),Oe.min(),qn.empty(),0)}static newUnknownDocument(e,t){return new Sn(e,3,t,Oe.min(),Oe.min(),qn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Oe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=qn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=qn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Oe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Sn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Sn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qd{constructor(e,t){this.position=e,this.inclusive=t}}function S1(n,e,t){let r=0;for(let a=0;a<n.position.length;a++){const l=e[a],c=n.position[a];if(l.field.isKeyField()?r=xe.comparator(xe.fromName(c.referenceValue),t.key):r=Rl(c,t.data.field(l.field)),l.dir==="desc"&&(r*=-1),r!==0)break}return r}function A1(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!xr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e,t="asc"){this.field=e,this.dir=t}}function u5(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jx{}class en extends Jx{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new d5(e,t,r):t==="array-contains"?new g5(e,r):t==="in"?new p5(e,r):t==="not-in"?new y5(e,r):t==="array-contains-any"?new v5(e,r):new en(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new f5(e,r):new m5(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Rl(t,this.value)):t!==null&&sa(this.value)===sa(t)&&this.matchesComparison(Rl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Re(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Fs extends Jx{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Fs(e,t)}matches(e){return Zx(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Zx(n){return n.op==="and"}function e2(n){return h5(n)&&Zx(n)}function h5(n){for(const e of n.filters)if(e instanceof Fs)return!1;return!0}function Op(n){if(n instanceof en)return n.field.canonicalString()+n.op.toString()+Cl(n.value);if(e2(n))return n.filters.map((e=>Op(e))).join(",");{const e=n.filters.map((t=>Op(t))).join(",");return`${n.op}(${e})`}}function t2(n,e){return n instanceof en?(function(r,a){return a instanceof en&&r.op===a.op&&r.field.isEqual(a.field)&&xr(r.value,a.value)})(n,e):n instanceof Fs?(function(r,a){return a instanceof Fs&&r.op===a.op&&r.filters.length===a.filters.length?r.filters.reduce(((l,c,m)=>l&&t2(c,a.filters[m])),!0):!1})(n,e):void Re(19439)}function n2(n){return n instanceof en?(function(t){return`${t.field.canonicalString()} ${t.op} ${Cl(t.value)}`})(n):n instanceof Fs?(function(t){return t.op.toString()+" {"+t.getFilters().map(n2).join(" ,")+"}"})(n):"Filter"}class d5 extends en{constructor(e,t,r){super(e,t,r),this.key=xe.fromName(r.referenceValue)}matches(e){const t=xe.comparator(e.key,this.key);return this.matchesComparison(t)}}class f5 extends en{constructor(e,t){super(e,"in",t),this.keys=s2("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class m5 extends en{constructor(e,t){super(e,"not-in",t),this.keys=s2("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function s2(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((r=>xe.fromName(r.referenceValue)))}class g5 extends en{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return x0(t)&&gu(t.arrayValue,this.value)}}class p5 extends en{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&gu(this.value.arrayValue,t)}}class y5 extends en{constructor(e,t){super(e,"not-in",t)}matches(e){if(gu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!gu(this.value.arrayValue,t)}}class v5 extends en{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!x0(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>gu(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _5{constructor(e,t=null,r=[],a=[],l=null,c=null,m=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=a,this.limit=l,this.startAt=c,this.endAt=m,this.Te=null}}function N1(n,e=null,t=[],r=[],a=null,l=null,c=null){return new _5(n,e,t,r,a,l,c)}function E0(n){const e=Ve(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Op(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(l){return l.field.canonicalString()+l.dir})(r))).join(","),Ef(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Cl(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Cl(r))).join(",")),e.Te=t}return e.Te}function T0(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!u5(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!t2(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!A1(n.startAt,e.startAt)&&A1(n.endAt,e.endAt)}function Dp(n){return xe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul{constructor(e,t=null,r=[],a=[],l=null,c="F",m=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=a,this.limit=l,this.limitType=c,this.startAt=m,this.endAt=g,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function b5(n,e,t,r,a,l,c,m){return new Ul(n,e,t,r,a,l,c,m)}function Sf(n){return new Ul(n)}function R1(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function r2(n){return n.collectionGroup!==null}function nu(n){const e=Ve(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let m=new rn(cn.comparator);return c.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(m=m.add(y.field))}))})),m})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new pu(l,r))})),t.has(cn.keyField().canonicalString())||e.Ie.push(new pu(cn.keyField(),r))}return e.Ie}function vr(n){const e=Ve(n);return e.Ee||(e.Ee=w5(e,nu(n))),e.Ee}function w5(n,e){if(n.limitType==="F")return N1(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new pu(a.field,l)}));const t=n.endAt?new qd(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new qd(n.startAt.position,n.startAt.inclusive):null;return N1(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Mp(n,e){const t=n.filters.concat([e]);return new Ul(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Hd(n,e,t){return new Ul(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Af(n,e){return T0(vr(n),vr(e))&&n.limitType===e.limitType}function i2(n){return`${E0(vr(n))}|lt:${n.limitType}`}function ll(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((a=>n2(a))).join(", ")}]`),Ef(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((a=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(a))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((a=>Cl(a))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((a=>Cl(a))).join(",")),`Target(${r})`})(vr(n))}; limitType=${n.limitType})`}function Nf(n,e){return e.isFoundDocument()&&(function(r,a){const l=a.key.path;return r.collectionGroup!==null?a.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(l):xe.isDocumentKey(r.path)?r.path.isEqual(l):r.path.isImmediateParentOf(l)})(n,e)&&(function(r,a){for(const l of nu(r))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(r,a){for(const l of r.filters)if(!l.matches(a))return!1;return!0})(n,e)&&(function(r,a){return!(r.startAt&&!(function(c,m,g){const y=S1(c,m,g);return c.inclusive?y<=0:y<0})(r.startAt,nu(r),a)||r.endAt&&!(function(c,m,g){const y=S1(c,m,g);return c.inclusive?y>=0:y>0})(r.endAt,nu(r),a))})(n,e)}function x5(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function a2(n){return(e,t)=>{let r=!1;for(const a of nu(n)){const l=E5(a,e,t);if(l!==0)return l;r=r||a.field.isKeyField()}return 0}}function E5(n,e,t){const r=n.field.isKeyField()?xe.comparator(e.key,t.key):(function(l,c,m){const g=c.data.field(l),y=m.data.field(l);return g!==null&&y!==null?Rl(g,y):Re(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Re(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[a,l]of r)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),a=this.inner[r];if(a===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return r.length===1?delete this.inner[t]:r.splice(a,1),this.innerSize--,!0;return!1}forEach(e){aa(this.inner,((t,r)=>{for(const[a,l]of r)e(a,l)}))}isEmpty(){return Hx(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T5=new kt(xe.comparator);function ii(){return T5}const o2=new kt(xe.comparator);function Xc(...n){let e=o2;for(const t of n)e=e.insert(t.key,t);return e}function l2(n){let e=o2;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Xa(){return su()}function c2(){return su()}function su(){return new ao((n=>n.toString()),((n,e)=>n.isEqual(e)))}const S5=new kt(xe.comparator),A5=new rn(xe.comparator);function Xe(...n){let e=A5;for(const t of n)e=e.add(t);return e}const N5=new rn(Ye);function R5(){return N5}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S0(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ud(e)?"-0":e}}function u2(n){return{integerValue:""+n}}function C5(n,e){return n5(e)?u2(e):S0(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(){this._=void 0}}function I5(n,e,t){return n instanceof yu?(function(a,l){const c={fields:{[Gx]:{stringValue:Fx},[Qx]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&w0(l)&&(l=Tf(l)),l&&(c.fields[Kx]=l),{mapValue:c}})(t,e):n instanceof Il?d2(n,e):n instanceof jl?f2(n,e):(function(a,l){const c=h2(a,l),m=C1(c)+C1(a.Ae);return kp(c)&&kp(a.Ae)?u2(m):S0(a.serializer,m)})(n,e)}function j5(n,e,t){return n instanceof Il?d2(n,e):n instanceof jl?f2(n,e):t}function h2(n,e){return n instanceof $d?(function(r){return kp(r)||(function(l){return!!l&&"doubleValue"in l})(r)})(e)?e:{integerValue:0}:null}class yu extends Rf{}class Il extends Rf{constructor(e){super(),this.elements=e}}function d2(n,e){const t=m2(e);for(const r of n.elements)t.some((a=>xr(a,r)))||t.push(r);return{arrayValue:{values:t}}}class jl extends Rf{constructor(e){super(),this.elements=e}}function f2(n,e){let t=m2(e);for(const r of n.elements)t=t.filter((a=>!xr(a,r)));return{arrayValue:{values:t}}}class $d extends Rf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function C1(n){return Bt(n.integerValue||n.doubleValue)}function m2(n){return x0(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{constructor(e,t){this.field=e,this.transform=t}}function k5(n,e){return n.field.isEqual(e.field)&&(function(r,a){return r instanceof Il&&a instanceof Il||r instanceof jl&&a instanceof jl?Al(r.elements,a.elements,xr):r instanceof $d&&a instanceof $d?xr(r.Ae,a.Ae):r instanceof yu&&a instanceof yu})(n.transform,e.transform)}class O5{constructor(e,t){this.version=e,this.transformResults=t}}class kn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new kn}static exists(e){return new kn(void 0,e)}static updateTime(e){return new kn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function kd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Cf{}function g2(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new If(n.key,kn.none()):new ku(n.key,n.data,kn.none());{const t=n.data,r=qn.empty();let a=new rn(cn.comparator);for(let l of e.fields)if(!a.has(l)){let c=t.field(l);c===null&&l.length>1&&(l=l.popLast(),c=t.field(l)),c===null?r.delete(l):r.set(l,c),a=a.add(l)}return new oa(n.key,r,new as(a.toArray()),kn.none())}}function D5(n,e,t){n instanceof ku?(function(a,l,c){const m=a.value.clone(),g=j1(a.fieldTransforms,l,c.transformResults);m.setAll(g),l.convertToFoundDocument(c.version,m).setHasCommittedMutations()})(n,e,t):n instanceof oa?(function(a,l,c){if(!kd(a.precondition,l))return void l.convertToUnknownDocument(c.version);const m=j1(a.fieldTransforms,l,c.transformResults),g=l.data;g.setAll(p2(a)),g.setAll(m),l.convertToFoundDocument(c.version,g).setHasCommittedMutations()})(n,e,t):(function(a,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function ru(n,e,t,r){return n instanceof ku?(function(l,c,m,g){if(!kd(l.precondition,c))return m;const y=l.value.clone(),_=k1(l.fieldTransforms,g,c);return y.setAll(_),c.convertToFoundDocument(c.version,y).setHasLocalMutations(),null})(n,e,t,r):n instanceof oa?(function(l,c,m,g){if(!kd(l.precondition,c))return m;const y=k1(l.fieldTransforms,g,c),_=c.data;return _.setAll(p2(l)),_.setAll(y),c.convertToFoundDocument(c.version,_).setHasLocalMutations(),m===null?null:m.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((w=>w.field)))})(n,e,t,r):(function(l,c,m){return kd(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):m})(n,e,t)}function M5(n,e){let t=null;for(const r of n.fieldTransforms){const a=e.data.field(r.field),l=h2(r.transform,a||null);l!=null&&(t===null&&(t=qn.empty()),t.set(r.field,l))}return t||null}function I1(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,a){return r===void 0&&a===void 0||!(!r||!a)&&Al(r,a,((l,c)=>k5(l,c)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ku extends Cf{constructor(e,t,r,a=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class oa extends Cf{constructor(e,t,r,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function p2(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function j1(n,e,t){const r=new Map;ct(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let a=0;a<t.length;a++){const l=n[a],c=l.transform,m=e.data.field(l.field);r.set(l.field,j5(c,m,t[a]))}return r}function k1(n,e,t){const r=new Map;for(const a of n){const l=a.transform,c=t.data.field(a.field);r.set(a.field,I5(l,c,e))}return r}class If extends Cf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class P5 extends Cf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V5{constructor(e,t,r,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=a}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&D5(l,e,r[a])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=ru(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=ru(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=c2();return this.mutations.forEach((a=>{const l=e.get(a.key),c=l.overlayedDocument;let m=this.applyToLocalView(c,l.mutatedFields);m=t.has(a.key)?null:m;const g=g2(c,m);g!==null&&r.set(a.key,g),c.isValidDocument()||c.convertToNoDocument(Oe.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Xe())}isEqual(e){return this.batchId===e.batchId&&Al(this.mutations,e.mutations,((t,r)=>I1(t,r)))&&Al(this.baseMutations,e.baseMutations,((t,r)=>I1(t,r)))}}class N0{constructor(e,t,r,a){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=a}static from(e,t,r){ct(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let a=(function(){return S5})();const l=e.mutations;for(let c=0;c<l.length;c++)a=a.insert(l[c].key,r[c].version);return new N0(e,t,r,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L5{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U5{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jt,Ze;function z5(n){switch(n){case re.OK:return Re(64938);case re.CANCELLED:case re.UNKNOWN:case re.DEADLINE_EXCEEDED:case re.RESOURCE_EXHAUSTED:case re.INTERNAL:case re.UNAVAILABLE:case re.UNAUTHENTICATED:return!1;case re.INVALID_ARGUMENT:case re.NOT_FOUND:case re.ALREADY_EXISTS:case re.PERMISSION_DENIED:case re.FAILED_PRECONDITION:case re.ABORTED:case re.OUT_OF_RANGE:case re.UNIMPLEMENTED:case re.DATA_LOSS:return!0;default:return Re(15467,{code:n})}}function y2(n){if(n===void 0)return ri("GRPC error has no .code"),re.UNKNOWN;switch(n){case Jt.OK:return re.OK;case Jt.CANCELLED:return re.CANCELLED;case Jt.UNKNOWN:return re.UNKNOWN;case Jt.DEADLINE_EXCEEDED:return re.DEADLINE_EXCEEDED;case Jt.RESOURCE_EXHAUSTED:return re.RESOURCE_EXHAUSTED;case Jt.INTERNAL:return re.INTERNAL;case Jt.UNAVAILABLE:return re.UNAVAILABLE;case Jt.UNAUTHENTICATED:return re.UNAUTHENTICATED;case Jt.INVALID_ARGUMENT:return re.INVALID_ARGUMENT;case Jt.NOT_FOUND:return re.NOT_FOUND;case Jt.ALREADY_EXISTS:return re.ALREADY_EXISTS;case Jt.PERMISSION_DENIED:return re.PERMISSION_DENIED;case Jt.FAILED_PRECONDITION:return re.FAILED_PRECONDITION;case Jt.ABORTED:return re.ABORTED;case Jt.OUT_OF_RANGE:return re.OUT_OF_RANGE;case Jt.UNIMPLEMENTED:return re.UNIMPLEMENTED;case Jt.DATA_LOSS:return re.DATA_LOSS;default:return Re(39323,{code:n})}}(Ze=Jt||(Jt={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B5(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q5=new Xi([4294967295,4294967295],0);function O1(n){const e=B5().encode(n),t=new Ix;return t.update(e),new Uint8Array(t.digest())}function D1(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Xi([t,r],0),new Xi([a,l],0)]}class R0{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Wc(`Invalid padding: ${t}`);if(r<0)throw new Wc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Wc(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Wc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Xi.fromNumber(this.ge)}ye(e,t,r){let a=e.add(t.multiply(Xi.fromNumber(r)));return a.compare(q5)===1&&(a=new Xi([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=O1(e),[r,a]=D1(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(r,a,l);if(!this.we(c))return!1}return!0}static create(e,t,r){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new R0(l,a,t);return r.forEach((m=>c.insert(m))),c}insert(e){if(this.ge===0)return;const t=O1(e),[r,a]=D1(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(r,a,l);this.Se(c)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Wc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf{constructor(e,t,r,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const a=new Map;return a.set(e,Ou.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new jf(Oe.min(),a,new kt(Ye),ii(),Xe())}}class Ou{constructor(e,t,r,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Ou(r,t,Xe(),Xe(),Xe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(e,t,r,a){this.be=e,this.removedTargetIds=t,this.key=r,this.De=a}}class v2{constructor(e,t){this.targetId=e,this.Ce=t}}class _2{constructor(e,t,r=hn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=a}}class M1{constructor(){this.ve=0,this.Fe=P1(),this.Me=hn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Xe(),t=Xe(),r=Xe();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:r=r.add(a);break;default:Re(38017,{changeType:l})}})),new Ou(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=P1()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ct(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class H5{constructor(e){this.Ge=e,this.ze=new Map,this.je=ii(),this.Je=md(),this.He=md(),this.Ye=new kt(Ye)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Re(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,a)=>{this.rt(a)&&t(a)}))}st(e){const t=e.targetId,r=e.Ce.count,a=this.ot(t);if(a){const l=a.target;if(Dp(l))if(r===0){const c=new xe(l.path);this.et(t,c,Sn.newNoDocument(c,Oe.min()))}else ct(r===1,20013,{expectedCount:r});else{const c=this._t(t);if(c!==r){const m=this.ut(e),g=m?this.ct(m,e,c):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:a=0},hashCount:l=0}=t;let c,m;try{c=na(r).toUint8Array()}catch(g){if(g instanceof $x)return eo("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{m=new R0(c,a,l)}catch(g){return eo(g instanceof Wc?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return m.ge===0?null:m}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let a=0;return r.forEach((l=>{const c=this.Ge.ht(),m=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(m)||(this.et(t,l,null),a++)})),a}Tt(e){const t=new Map;this.ze.forEach(((l,c)=>{const m=this.ot(c);if(m){if(l.current&&Dp(m.target)){const g=new xe(m.target.path);this.It(g).has(c)||this.Et(c,g)||this.et(c,g,Sn.newNoDocument(g,e))}l.Be&&(t.set(c,l.ke()),l.qe())}}));let r=Xe();this.He.forEach(((l,c)=>{let m=!0;c.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(m=!1,!1)})),m&&(r=r.add(l))})),this.je.forEach(((l,c)=>c.setReadTime(e)));const a=new jf(e,t,this.Ye,this.je,r);return this.je=ii(),this.Je=md(),this.He=md(),this.Ye=new kt(Ye),a}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.Qe(t,1):a.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new M1,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new rn(Ye),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new rn(Ye),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ge("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new M1),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function md(){return new kt(xe.comparator)}function P1(){return new kt(xe.comparator)}const $5={asc:"ASCENDING",desc:"DESCENDING"},F5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},G5={and:"AND",or:"OR"};class K5{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Pp(n,e){return n.useProto3Json||Ef(e)?e:{value:e}}function Fd(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function b2(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Q5(n,e){return Fd(n,e.toTimestamp())}function _r(n){return ct(!!n,49232),Oe.fromTimestamp((function(t){const r=ta(t);return new _t(r.seconds,r.nanos)})(n))}function C0(n,e){return Vp(n,e).canonicalString()}function Vp(n,e){const t=(function(a){return new Et(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function w2(n){const e=Et.fromString(n);return ct(A2(e),10190,{key:e.toString()}),e}function Lp(n,e){return C0(n.databaseId,e.path)}function rp(n,e){const t=w2(e);if(t.get(1)!==n.databaseId.projectId)throw new de(re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new de(re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new xe(E2(t))}function x2(n,e){return C0(n.databaseId,e)}function Y5(n){const e=w2(n);return e.length===4?Et.emptyPath():E2(e)}function Up(n){return new Et(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function E2(n){return ct(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function V1(n,e,t){return{name:Lp(n,e),fields:t.value.mapValue.fields}}function X5(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:Re(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(y,_){return y.useProto3Json?(ct(_===void 0||typeof _=="string",58123),hn.fromBase64String(_||"")):(ct(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),hn.fromUint8Array(_||new Uint8Array))})(n,e.targetChange.resumeToken),c=e.targetChange.cause,m=c&&(function(y){const _=y.code===void 0?re.UNKNOWN:y2(y.code);return new de(_,y.message||"")})(c);t=new _2(r,a,l,m||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const a=rp(n,r.document.name),l=_r(r.document.updateTime),c=r.document.createTime?_r(r.document.createTime):Oe.min(),m=new qn({mapValue:{fields:r.document.fields}}),g=Sn.newFoundDocument(a,l,c,m),y=r.targetIds||[],_=r.removedTargetIds||[];t=new Od(y,_,g.key,g)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const a=rp(n,r.document),l=r.readTime?_r(r.readTime):Oe.min(),c=Sn.newNoDocument(a,l),m=r.removedTargetIds||[];t=new Od([],m,c.key,c)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const a=rp(n,r.document),l=r.removedTargetIds||[];t=new Od([],l,a,null)}else{if(!("filter"in e))return Re(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:a=0,unchangedNames:l}=r,c=new U5(a,l),m=r.targetId;t=new v2(m,c)}}return t}function W5(n,e){let t;if(e instanceof ku)t={update:V1(n,e.key,e.value)};else if(e instanceof If)t={delete:Lp(n,e.key)};else if(e instanceof oa)t={update:V1(n,e.key,e.data),updateMask:aR(e.fieldMask)};else{if(!(e instanceof P5))return Re(16599,{Vt:e.type});t={verify:Lp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(l,c){const m=c.transform;if(m instanceof yu)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(m instanceof Il)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:m.elements}};if(m instanceof jl)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:m.elements}};if(m instanceof $d)return{fieldPath:c.field.canonicalString(),increment:m.Ae};throw Re(20930,{transform:c.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:Q5(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Re(27497)})(n,e.precondition)),t}function J5(n,e){return n&&n.length>0?(ct(e!==void 0,14353),n.map((t=>(function(a,l){let c=a.updateTime?_r(a.updateTime):_r(l);return c.isEqual(Oe.min())&&(c=_r(l)),new O5(c,a.transformResults||[])})(t,e)))):[]}function Z5(n,e){return{documents:[x2(n,e.path)]}}function eR(n,e){const t={structuredQuery:{}},r=e.path;let a;e.collectionGroup!==null?(a=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=x2(n,a);const l=(function(y){if(y.length!==0)return S2(Fs.create(y,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const c=(function(y){if(y.length!==0)return y.map((_=>(function(E){return{field:cl(E.field),direction:sR(E.dir)}})(_)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const m=Pp(n,e.limit);return m!==null&&(t.structuredQuery.limit=m),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:a}}function tR(n){let e=Y5(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let a=null;if(r>0){ct(r===1,65062);const _=t.from[0];_.allDescendants?a=_.collectionId:e=e.child(_.collectionId)}let l=[];t.where&&(l=(function(w){const E=T2(w);return E instanceof Fs&&e2(E)?E.getFilters():[E]})(t.where));let c=[];t.orderBy&&(c=(function(w){return w.map((E=>(function(N){return new pu(ul(N.field),(function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(N.direction))})(E)))})(t.orderBy));let m=null;t.limit&&(m=(function(w){let E;return E=typeof w=="object"?w.value:w,Ef(E)?null:E})(t.limit));let g=null;t.startAt&&(g=(function(w){const E=!!w.before,S=w.values||[];return new qd(S,E)})(t.startAt));let y=null;return t.endAt&&(y=(function(w){const E=!w.before,S=w.values||[];return new qd(S,E)})(t.endAt)),b5(e,a,c,l,m,"F",g,y)}function nR(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Re(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function T2(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=ul(t.unaryFilter.field);return en.create(r,"==",{doubleValue:NaN});case"IS_NULL":const a=ul(t.unaryFilter.field);return en.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=ul(t.unaryFilter.field);return en.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=ul(t.unaryFilter.field);return en.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Re(61313);default:return Re(60726)}})(n):n.fieldFilter!==void 0?(function(t){return en.create(ul(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Re(58110);default:return Re(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Fs.create(t.compositeFilter.filters.map((r=>T2(r))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Re(1026)}})(t.compositeFilter.op))})(n):Re(30097,{filter:n})}function sR(n){return $5[n]}function rR(n){return F5[n]}function iR(n){return G5[n]}function cl(n){return{fieldPath:n.canonicalString()}}function ul(n){return cn.fromServerFormat(n.fieldPath)}function S2(n){return n instanceof en?(function(t){if(t.op==="=="){if(T1(t.value))return{unaryFilter:{field:cl(t.field),op:"IS_NAN"}};if(E1(t.value))return{unaryFilter:{field:cl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(T1(t.value))return{unaryFilter:{field:cl(t.field),op:"IS_NOT_NAN"}};if(E1(t.value))return{unaryFilter:{field:cl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cl(t.field),op:rR(t.op),value:t.value}}})(n):n instanceof Fs?(function(t){const r=t.getFilters().map((a=>S2(a)));return r.length===1?r[0]:{compositeFilter:{op:iR(t.op),filters:r}}})(n):Re(54877,{filter:n})}function aR(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function A2(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(e,t,r,a,l=Oe.min(),c=Oe.min(),m=hn.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=m,this.expectedCount=g}withSequenceNumber(e){return new Gi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Gi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Gi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Gi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oR{constructor(e){this.yt=e}}function lR(n){const e=tR({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Hd(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cR{constructor(){this.Cn=new uR}addToCollectionParentIndex(e,t){return this.Cn.add(t),ae.resolve()}getCollectionParents(e,t){return ae.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ae.resolve()}deleteFieldIndex(e,t){return ae.resolve()}deleteAllFieldIndexes(e){return ae.resolve()}createTargetIndexes(e,t){return ae.resolve()}getDocumentsMatchingTarget(e,t){return ae.resolve(null)}getIndexType(e,t){return ae.resolve(0)}getFieldIndexes(e,t){return ae.resolve([])}getNextCollectionGroupToUpdate(e){return ae.resolve(null)}getMinOffset(e,t){return ae.resolve(ea.min())}getMinOffsetFromCollectionGroup(e,t){return ae.resolve(ea.min())}updateCollectionGroup(e,t,r){return ae.resolve()}updateIndexEntries(e,t){return ae.resolve()}}class uR{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t]||new rn(Et.comparator),l=!a.has(r);return this.index[t]=a.add(r),l}has(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t];return a&&a.has(r)}getEntries(e){return(this.index[e]||new rn(Et.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},N2=41943040;class Bn{static withCacheSize(e){return new Bn(e,Bn.DEFAULT_COLLECTION_PERCENTILE,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Bn.DEFAULT_COLLECTION_PERCENTILE=10,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bn.DEFAULT=new Bn(N2,Bn.DEFAULT_COLLECTION_PERCENTILE,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bn.DISABLED=new Bn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new kl(0)}static cr(){return new kl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U1="LruGarbageCollector",hR=1048576;function z1([n,e],[t,r]){const a=Ye(n,t);return a===0?Ye(e,r):a}class dR{constructor(e){this.Ir=e,this.buffer=new rn(z1),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();z1(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class fR{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ge(U1,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ll(t)?ge(U1,"Ignoring IndexedDB error during garbage collection: ",t):await Vl(t)}await this.Vr(3e5)}))}}class mR{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return ae.resolve(xf.ce);const r=new dR(t);return this.mr.forEachTarget(e,(a=>r.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>r.Ar(a))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ge("LruGarbageCollector","Garbage collection skipped; disabled"),ae.resolve(L1)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(ge("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),L1):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,a,l,c,m,g,y;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((w=>(w>this.params.maximumSequenceNumbersToCollect?(ge("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),a=this.params.maximumSequenceNumbersToCollect):a=w,c=Date.now(),this.nthSequenceNumber(e,a)))).next((w=>(r=w,m=Date.now(),this.removeTargets(e,r,t)))).next((w=>(l=w,g=Date.now(),this.removeOrphanedDocuments(e,r)))).next((w=>(y=Date.now(),ol()<=Qe.DEBUG&&ge("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-_}ms
	Determined least recently used ${a} in `+(m-c)+`ms
	Removed ${l} targets in `+(g-m)+`ms
	Removed ${w} documents in `+(y-g)+`ms
Total Duration: ${y-_}ms`),ae.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:w}))))}}function gR(n,e){return new mR(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pR{constructor(){this.changes=new ao((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Sn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?ae.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vR{constructor(e,t,r,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=a}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(r=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(r!==null&&ru(r.mutation,a,as.empty(),_t.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Xe()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Xe()){const a=Xa();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,r).next((l=>{let c=Xc();return l.forEach(((m,g)=>{c=c.insert(m,g.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const r=Xa();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Xe())))}populateOverlays(e,t,r){const a=[];return r.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((c,m)=>{t.set(c,m)}))}))}computeViews(e,t,r,a){let l=ii();const c=su(),m=(function(){return su()})();return t.forEach(((g,y)=>{const _=r.get(y.key);a.has(y.key)&&(_===void 0||_.mutation instanceof oa)?l=l.insert(y.key,y):_!==void 0?(c.set(y.key,_.mutation.getFieldMask()),ru(_.mutation,y,_.mutation.getFieldMask(),_t.now())):c.set(y.key,as.empty())})),this.recalculateAndSaveOverlays(e,l).next((g=>(g.forEach(((y,_)=>c.set(y,_))),t.forEach(((y,_)=>m.set(y,new yR(_,c.get(y)??null)))),m)))}recalculateAndSaveOverlays(e,t){const r=su();let a=new kt(((c,m)=>c-m)),l=Xe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const m of c)m.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let _=r.get(g)||as.empty();_=m.applyToLocalView(y,_),r.set(g,_);const w=(a.get(m.batchId)||Xe()).add(g);a=a.insert(m.batchId,w)}))})).next((()=>{const c=[],m=a.getReverseIterator();for(;m.hasNext();){const g=m.getNext(),y=g.key,_=g.value,w=c2();_.forEach((E=>{if(!l.has(E)){const S=g2(t.get(E),r.get(E));S!==null&&w.set(E,S),l=l.add(E)}})),c.push(this.documentOverlayCache.saveOverlays(e,y,w))}return ae.waitFor(c)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,a){return(function(c){return xe.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):r2(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,a):this.getDocumentsMatchingCollectionQuery(e,t,r,a)}getNextDocuments(e,t,r,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,a).next((l=>{const c=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,a-l.size):ae.resolve(Xa());let m=fu,g=l;return c.next((y=>ae.forEach(y,((_,w)=>(m<w.largestBatchId&&(m=w.largestBatchId),l.get(_)?ae.resolve():this.remoteDocumentCache.getEntry(e,_).next((E=>{g=g.insert(_,E)}))))).next((()=>this.populateOverlays(e,y,l))).next((()=>this.computeViews(e,g,y,Xe()))).next((_=>({batchId:m,changes:l2(_)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new xe(t)).next((r=>{let a=Xc();return r.isFoundDocument()&&(a=a.insert(r.key,r)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,a){const l=t.collectionGroup;let c=Xc();return this.indexManager.getCollectionParents(e,l).next((m=>ae.forEach(m,(g=>{const y=(function(w,E){return new Ul(E,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)})(t,g.child(l));return this.getDocumentsMatchingCollectionQuery(e,y,r,a).next((_=>{_.forEach(((w,E)=>{c=c.insert(w,E)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,r,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,l,a)))).next((c=>{l.forEach(((g,y)=>{const _=y.getKey();c.get(_)===null&&(c=c.insert(_,Sn.newInvalidDocument(_)))}));let m=Xc();return c.forEach(((g,y)=>{const _=l.get(g);_!==void 0&&ru(_.mutation,y,as.empty(),_t.now()),Nf(t,y)&&(m=m.insert(g,y))})),m}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ae.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:_r(a.createTime)}})(t)),ae.resolve()}getNamedQuery(e,t){return ae.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(a){return{name:a.name,query:lR(a.bundledQuery),readTime:_r(a.readTime)}})(t)),ae.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bR{constructor(){this.overlays=new kt(xe.comparator),this.qr=new Map}getOverlay(e,t){return ae.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Xa();return ae.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&r.set(a,l)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((a,l)=>{this.St(e,t,l)})),ae.resolve()}removeOverlaysForBatchId(e,t,r){const a=this.qr.get(r);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(r)),ae.resolve()}getOverlaysForCollection(e,t,r){const a=Xa(),l=t.length+1,c=new xe(t.child("")),m=this.overlays.getIteratorFrom(c);for(;m.hasNext();){const g=m.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===l&&g.largestBatchId>r&&a.set(g.getKey(),g)}return ae.resolve(a)}getOverlaysForCollectionGroup(e,t,r,a){let l=new kt(((y,_)=>y-_));const c=this.overlays.getIterator();for(;c.hasNext();){const y=c.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>r){let _=l.get(y.largestBatchId);_===null&&(_=Xa(),l=l.insert(y.largestBatchId,_)),_.set(y.getKey(),y)}}const m=Xa(),g=l.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,_)=>m.set(y,_))),!(m.size()>=a)););return ae.resolve(m)}St(e,t,r){const a=this.overlays.get(r.key);if(a!==null){const c=this.qr.get(a.largestBatchId).delete(r.key);this.qr.set(a.largestBatchId,c)}this.overlays=this.overlays.insert(r.key,new L5(t,r));let l=this.qr.get(t);l===void 0&&(l=Xe(),this.qr.set(t,l)),this.qr.set(t,l.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(){this.sessionToken=hn.EMPTY_BYTE_STRING}getSessionToken(e){return ae.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ae.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{constructor(){this.Qr=new rn(ln.$r),this.Ur=new rn(ln.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new ln(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new ln(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new xe(new Et([])),r=new ln(t,e),a=new ln(t,e+1),l=[];return this.Ur.forEachInRange([r,a],(c=>{this.Gr(c),l.push(c.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new xe(new Et([])),r=new ln(t,e),a=new ln(t,e+1);let l=Xe();return this.Ur.forEachInRange([r,a],(c=>{l=l.add(c.key)})),l}containsKey(e){const t=new ln(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class ln{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return xe.comparator(e.key,t.key)||Ye(e.Yr,t.Yr)}static Kr(e,t){return Ye(e.Yr,t.Yr)||xe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xR{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new rn(ln.$r)}checkEmpty(e){return ae.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,a){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new V5(l,t,r,a);this.mutationQueue.push(c);for(const m of a)this.Zr=this.Zr.add(new ln(m.key,l)),this.indexManager.addToCollectionParentIndex(e,m.key.path.popLast());return ae.resolve(c)}lookupMutationBatch(e,t){return ae.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=this.ei(r),l=a<0?0:a;return ae.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ae.resolve(this.mutationQueue.length===0?b0:this.tr-1)}getAllMutationBatches(e){return ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new ln(t,0),a=new ln(t,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([r,a],(c=>{const m=this.Xr(c.Yr);l.push(m)})),ae.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new rn(Ye);return t.forEach((a=>{const l=new ln(a,0),c=new ln(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,c],(m=>{r=r.add(m.Yr)}))})),ae.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1;let l=r;xe.isDocumentKey(l)||(l=l.child(""));const c=new ln(new xe(l),0);let m=new rn(Ye);return this.Zr.forEachWhile((g=>{const y=g.key.path;return!!r.isPrefixOf(y)&&(y.length===a&&(m=m.add(g.Yr)),!0)}),c),ae.resolve(this.ti(m))}ti(e){const t=[];return e.forEach((r=>{const a=this.Xr(r);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){ct(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return ae.forEach(t.mutations,(a=>{const l=new ln(a.key,t.batchId);return r=r.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new ln(t,0),a=this.Zr.firstAfterOrEqual(r);return ae.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ae.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(e){this.ri=e,this.docs=(function(){return new kt(xe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,a=this.docs.get(r),l=a?a.size:0,c=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return ae.resolve(r?r.document.mutableCopy():Sn.newInvalidDocument(t))}getEntries(e,t){let r=ii();return t.forEach((a=>{const l=this.docs.get(a);r=r.insert(a,l?l.document.mutableCopy():Sn.newInvalidDocument(a))})),ae.resolve(r)}getDocumentsMatchingQuery(e,t,r,a){let l=ii();const c=t.path,m=new xe(c.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(m);for(;g.hasNext();){const{key:y,value:{document:_}}=g.getNext();if(!c.isPrefixOf(y.path))break;y.path.length>c.length+1||J4(W4(_),r)<=0||(a.has(_.key)||Nf(t,_))&&(l=l.insert(_.key,_.mutableCopy()))}return ae.resolve(l)}getAllFromCollectionGroup(e,t,r,a){Re(9500)}ii(e,t){return ae.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new TR(this)}getSize(e){return ae.resolve(this.size)}}class TR extends pR{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,a)=>{a.isValidDocument()?t.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(r)})),ae.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SR{constructor(e){this.persistence=e,this.si=new ao((t=>E0(t)),T0),this.lastRemoteSnapshotVersion=Oe.min(),this.highestTargetId=0,this.oi=0,this._i=new I0,this.targetCount=0,this.ai=kl.ur()}forEachTarget(e,t){return this.si.forEach(((r,a)=>t(a))),ae.resolve()}getLastRemoteSnapshotVersion(e){return ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ae.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ae.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),ae.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new kl(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ae.resolve()}updateTargetData(e,t){return this.Pr(t),ae.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ae.resolve()}removeTargets(e,t,r){let a=0;const l=[];return this.si.forEach(((c,m)=>{m.sequenceNumber<=t&&r.get(m.targetId)===null&&(this.si.delete(c),l.push(this.removeMatchingKeysForTargetId(e,m.targetId)),a++)})),ae.waitFor(l).next((()=>a))}getTargetCount(e){return ae.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return ae.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),ae.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((c=>{l.push(a.markPotentiallyOrphaned(e,c))})),ae.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ae.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return ae.resolve(r)}containsKey(e,t){return ae.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R2{constructor(e,t){this.ui={},this.overlays={},this.ci=new xf(0),this.li=!1,this.li=!0,this.hi=new wR,this.referenceDelegate=e(this),this.Pi=new SR(this),this.indexManager=new cR,this.remoteDocumentCache=(function(a){return new ER(a)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new oR(t),this.Ii=new _R(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new bR,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new xR(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){ge("MemoryPersistence","Starting transaction:",e);const a=new AR(this.ci.next());return this.referenceDelegate.Ei(),r(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ai(e,t){return ae.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class AR extends e5{constructor(e){super(),this.currentSequenceNumber=e}}class j0{constructor(e){this.persistence=e,this.Ri=new I0,this.Vi=null}static mi(e){return new j0(e)}get fi(){if(this.Vi)return this.Vi;throw Re(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),ae.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),ae.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ae.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((a=>this.fi.add(a.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.fi.add(l.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ae.forEach(this.fi,(r=>{const a=xe.fromPath(r);return this.gi(e,a).next((l=>{l||t.removeEntry(a,Oe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return ae.or([()=>ae.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Gd{constructor(e,t){this.persistence=e,this.pi=new ao((r=>s5(r.path)),((r,a)=>r.isEqual(a))),this.garbageCollector=gR(this,t)}static mi(e,t){return new Gd(e,t)}Ei(){}di(e){return ae.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((a=>r+a))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return ae.forEach(this.pi,((r,a)=>this.br(e,r,a).next((l=>l?ae.resolve():t(a)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ii(e,(c=>this.br(e,c,t).next((m=>{m||(r++,l.removeEntry(c,Oe.min()))})))).next((()=>l.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ae.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),ae.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),ae.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ae.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Id(e.data.value)),t}br(e,t,r){return ae.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.pi.get(t);return ae.resolve(a!==void 0&&a>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0{constructor(e,t,r,a){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=a}static As(e,t){let r=Xe(),a=Xe();for(const l of t.docChanges)switch(l.type){case 0:r=r.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new k0(e,t.fromCache,r,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NR{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RR{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return xN()?8:t5(Nn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,a){const l={result:null};return this.ys(e,t).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ws(e,t,a,r).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new NR;return this.Ss(e,t,c).next((m=>{if(l.result=m,this.Vs)return this.bs(e,t,c,m.size)}))})).next((()=>l.result))}bs(e,t,r,a){return r.documentReadCount<this.fs?(ol()<=Qe.DEBUG&&ge("QueryEngine","SDK will not create cache indexes for query:",ll(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ae.resolve()):(ol()<=Qe.DEBUG&&ge("QueryEngine","Query:",ll(t),"scans",r.documentReadCount,"local documents and returns",a,"documents as results."),r.documentReadCount>this.gs*a?(ol()<=Qe.DEBUG&&ge("QueryEngine","The SDK decides to create cache indexes for query:",ll(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,vr(t))):ae.resolve())}ys(e,t){if(R1(t))return ae.resolve(null);let r=vr(t);return this.indexManager.getIndexType(e,r).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=Hd(t,null,"F"),r=vr(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((l=>{const c=Xe(...l);return this.ps.getDocuments(e,c).next((m=>this.indexManager.getMinOffset(e,r).next((g=>{const y=this.Ds(t,m);return this.Cs(t,y,c,g.readTime)?this.ys(e,Hd(t,null,"F")):this.vs(e,y,t,g)}))))})))))}ws(e,t,r,a){return R1(t)||a.isEqual(Oe.min())?ae.resolve(null):this.ps.getDocuments(e,r).next((l=>{const c=this.Ds(t,l);return this.Cs(t,c,r,a)?ae.resolve(null):(ol()<=Qe.DEBUG&&ge("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),ll(t)),this.vs(e,c,t,X4(a,fu)).next((m=>m)))}))}Ds(e,t){let r=new rn(a2(e));return t.forEach(((a,l)=>{Nf(e,l)&&(r=r.add(l))})),r}Cs(e,t,r,a){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}Ss(e,t,r){return ol()<=Qe.DEBUG&&ge("QueryEngine","Using full collection scan to execute query:",ll(t)),this.ps.getDocumentsMatchingQuery(e,t,ea.min(),r)}vs(e,t,r,a){return this.ps.getDocumentsMatchingQuery(e,r,a).next((l=>(t.forEach((c=>{l=l.insert(c.key,c)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O0="LocalStore",CR=3e8;class IR{constructor(e,t,r,a){this.persistence=e,this.Fs=t,this.serializer=a,this.Ms=new kt(Ye),this.xs=new ao((l=>E0(l)),T0),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new vR(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function jR(n,e,t,r){return new IR(n,e,t,r)}async function C2(n,e){const t=Ve(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let a;return t.mutationQueue.getAllMutationBatches(r).next((l=>(a=l,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((l=>{const c=[],m=[];let g=Xe();for(const y of a){c.push(y.batchId);for(const _ of y.mutations)g=g.add(_.key)}for(const y of l){m.push(y.batchId);for(const _ of y.mutations)g=g.add(_.key)}return t.localDocuments.getDocuments(r,g).next((y=>({Ls:y,removedBatchIds:c,addedBatchIds:m})))}))}))}function kR(n,e){const t=Ve(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const a=e.batch.keys(),l=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(m,g,y,_){const w=y.batch,E=w.keys();let S=ae.resolve();return E.forEach((N=>{S=S.next((()=>_.getEntry(g,N))).next((M=>{const k=y.docVersions.get(N);ct(k!==null,48541),M.version.compareTo(k)<0&&(w.applyToRemoteDocument(M,y),M.isValidDocument()&&(M.setReadTime(y.commitVersion),_.addEntry(M)))}))})),S.next((()=>m.mutationQueue.removeMutationBatch(g,w)))})(t,r,e,l).next((()=>l.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(m){let g=Xe();for(let y=0;y<m.mutationResults.length;++y)m.mutationResults[y].transformResults.length>0&&(g=g.add(m.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(r,a)))}))}function I2(n){const e=Ve(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function OR(n,e){const t=Ve(n),r=e.snapshotVersion;let a=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=t.Ns.newChangeBuffer({trackRemovals:!0});a=t.Ms;const m=[];e.targetChanges.forEach(((_,w)=>{const E=a.get(w);if(!E)return;m.push(t.Pi.removeMatchingKeys(l,_.removedDocuments,w).next((()=>t.Pi.addMatchingKeys(l,_.addedDocuments,w))));let S=E.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(w)!==null?S=S.withResumeToken(hn.EMPTY_BYTE_STRING,Oe.min()).withLastLimboFreeSnapshotVersion(Oe.min()):_.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(_.resumeToken,r)),a=a.insert(w,S),(function(M,k,V){return M.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=CR?!0:V.addedDocuments.size+V.modifiedDocuments.size+V.removedDocuments.size>0})(E,S,_)&&m.push(t.Pi.updateTargetData(l,S))}));let g=ii(),y=Xe();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&m.push(t.persistence.referenceDelegate.updateLimboDocument(l,_))})),m.push(DR(l,c,e.documentUpdates).next((_=>{g=_.ks,y=_.qs}))),!r.isEqual(Oe.min())){const _=t.Pi.getLastRemoteSnapshotVersion(l).next((w=>t.Pi.setTargetsMetadata(l,l.currentSequenceNumber,r)));m.push(_)}return ae.waitFor(m).next((()=>c.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,g,y))).next((()=>g))})).then((l=>(t.Ms=a,l)))}function DR(n,e,t){let r=Xe(),a=Xe();return t.forEach((l=>r=r.add(l))),e.getEntries(n,r).next((l=>{let c=ii();return t.forEach(((m,g)=>{const y=l.get(m);g.isFoundDocument()!==y.isFoundDocument()&&(a=a.add(m)),g.isNoDocument()&&g.version.isEqual(Oe.min())?(e.removeEntry(m,g.readTime),c=c.insert(m,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),c=c.insert(m,g)):ge(O0,"Ignoring outdated watch update for ",m,". Current version:",y.version," Watch version:",g.version)})),{ks:c,qs:a}}))}function MR(n,e){const t=Ve(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=b0),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function PR(n,e){const t=Ve(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let a;return t.Pi.getTargetData(r,e).next((l=>l?(a=l,ae.resolve(a)):t.Pi.allocateTargetId(r).next((c=>(a=new Gi(e,c,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,a).next((()=>a)))))))})).then((r=>{const a=t.Ms.get(r.targetId);return(a===null||r.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function zp(n,e,t){const r=Ve(n),a=r.Ms.get(e),l=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",l,(c=>r.persistence.referenceDelegate.removeTarget(c,a)))}catch(c){if(!Ll(c))throw c;ge(O0,`Failed to update sequence numbers for target ${e}: ${c}`)}r.Ms=r.Ms.remove(e),r.xs.delete(a.target)}function B1(n,e,t){const r=Ve(n);let a=Oe.min(),l=Xe();return r.persistence.runTransaction("Execute query","readwrite",(c=>(function(g,y,_){const w=Ve(g),E=w.xs.get(_);return E!==void 0?ae.resolve(w.Ms.get(E)):w.Pi.getTargetData(y,_)})(r,c,vr(e)).next((m=>{if(m)return a=m.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(c,m.targetId).next((g=>{l=g}))})).next((()=>r.Fs.getDocumentsMatchingQuery(c,e,t?a:Oe.min(),t?l:Xe()))).next((m=>(VR(r,x5(e),m),{documents:m,Qs:l})))))}function VR(n,e,t){let r=n.Os.get(e)||Oe.min();t.forEach(((a,l)=>{l.readTime.compareTo(r)>0&&(r=l.readTime)})),n.Os.set(e,r)}class q1{constructor(){this.activeTargetIds=R5()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class LR{constructor(){this.Mo=new q1,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new q1,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UR{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H1="ConnectivityMonitor";class $1{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ge(H1,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ge(H1,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gd=null;function Bp(){return gd===null?gd=(function(){return 268435456+Math.round(2147483648*Math.random())})():gd++,"0x"+gd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ip="RestConnection",zR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class BR{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${a}`,this.Wo=this.databaseId.database===zd?`project_id=${r}`:`project_id=${r}&database_id=${a}`}Go(e,t,r,a,l){const c=Bp(),m=this.zo(e,t.toUriEncodedString());ge(ip,`Sending RPC '${e}' ${c}:`,m,r);const g={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(g,a,l);const{host:y}=new URL(m),_=ro(y);return this.Jo(e,m,g,r,_).then((w=>(ge(ip,`Received RPC '${e}' ${c}: `,w),w)),(w=>{throw eo(ip,`RPC '${e}' ${c} failed with error: `,w,"url: ",m,"request:",r),w}))}Ho(e,t,r,a,l,c){return this.Go(e,t,r,a,l)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Pl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),r&&r.headers.forEach(((a,l)=>e[l]=a))}zo(e,t){const r=zR[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qR{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xn="WebChannelConnection";class HR extends BR{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,a,l){const c=Bp();return new Promise(((m,g)=>{const y=new jx;y.setWithCredentials(!0),y.listenOnce(kx.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case Cd.NO_ERROR:const w=y.getResponseJson();ge(xn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(w)),m(w);break;case Cd.TIMEOUT:ge(xn,`RPC '${e}' ${c} timed out`),g(new de(re.DEADLINE_EXCEEDED,"Request time out"));break;case Cd.HTTP_ERROR:const E=y.getStatus();if(ge(xn,`RPC '${e}' ${c} failed with status:`,E,"response text:",y.getResponseText()),E>0){let S=y.getResponseJson();Array.isArray(S)&&(S=S[0]);const N=S==null?void 0:S.error;if(N&&N.status&&N.message){const M=(function(V){const F=V.toLowerCase().replace(/_/g,"-");return Object.values(re).indexOf(F)>=0?F:re.UNKNOWN})(N.status);g(new de(M,N.message))}else g(new de(re.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new de(re.UNAVAILABLE,"Connection failed."));break;default:Re(9055,{l_:e,streamId:c,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{ge(xn,`RPC '${e}' ${c} completed.`)}}));const _=JSON.stringify(a);ge(xn,`RPC '${e}' ${c} sending request:`,a),y.send(t,"POST",_,r,15)}))}T_(e,t,r){const a=Bp(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=Mx(),m=Dx(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},y=this.longPollingOptions.timeoutSeconds;y!==void 0&&(g.longPollingTimeout=Math.round(1e3*y)),this.useFetchStreams&&(g.useFetchStreams=!0),this.jo(g.initMessageHeaders,t,r),g.encodeInitMessageHeaders=!0;const _=l.join("");ge(xn,`Creating RPC '${e}' stream ${a}: ${_}`,g);const w=c.createWebChannel(_,g);this.I_(w);let E=!1,S=!1;const N=new qR({Yo:k=>{S?ge(xn,`Not sending because RPC '${e}' stream ${a} is closed:`,k):(E||(ge(xn,`Opening RPC '${e}' stream ${a} transport.`),w.open(),E=!0),ge(xn,`RPC '${e}' stream ${a} sending:`,k),w.send(k))},Zo:()=>w.close()}),M=(k,V,F)=>{k.listen(V,($=>{try{F($)}catch(te){setTimeout((()=>{throw te}),0)}}))};return M(w,Yc.EventType.OPEN,(()=>{S||(ge(xn,`RPC '${e}' stream ${a} transport opened.`),N.o_())})),M(w,Yc.EventType.CLOSE,(()=>{S||(S=!0,ge(xn,`RPC '${e}' stream ${a} transport closed`),N.a_(),this.E_(w))})),M(w,Yc.EventType.ERROR,(k=>{S||(S=!0,eo(xn,`RPC '${e}' stream ${a} transport errored. Name:`,k.name,"Message:",k.message),N.a_(new de(re.UNAVAILABLE,"The operation could not be completed")))})),M(w,Yc.EventType.MESSAGE,(k=>{var V;if(!S){const F=k.data[0];ct(!!F,16349);const $=F,te=($==null?void 0:$.error)||((V=$[0])==null?void 0:V.error);if(te){ge(xn,`RPC '${e}' stream ${a} received error:`,te);const ue=te.status;let le=(function(j){const R=Jt[j];if(R!==void 0)return y2(R)})(ue),I=te.message;le===void 0&&(le=re.INTERNAL,I="Unknown error status: "+ue+" with message "+te.message),S=!0,N.a_(new de(le,I)),w.close()}else ge(xn,`RPC '${e}' stream ${a} received:`,F),N.u_(F)}})),M(m,Ox.STAT_EVENT,(k=>{k.stat===Rp.PROXY?ge(xn,`RPC '${e}' stream ${a} detected buffering proxy`):k.stat===Rp.NOPROXY&&ge(xn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{N.__()}),0),N}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function ap(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kf(n){return new K5(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{constructor(e,t,r=1e3,a=1.5,l=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=a,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-r);a>0&&ge("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F1="PersistentStream";class k2{constructor(e,t,r,a,l,c,m,g){this.Mi=e,this.S_=r,this.b_=a,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=m,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new j2(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===re.RESOURCE_EXHAUSTED?(ri(t.toString()),ri("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,a])=>{this.D_===t&&this.G_(r,a)}),(r=>{e((()=>{const a=new de(re.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(a)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{r((()=>this.z_(a)))})),this.stream.onMessage((a=>{r((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ge(F1,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(ge(F1,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class $R extends k2{constructor(e,t,r,a,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,a,c),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=X5(this.serializer,e),r=(function(l){if(!("targetChange"in l))return Oe.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?Oe.min():c.readTime?_r(c.readTime):Oe.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Up(this.serializer),t.addTarget=(function(l,c){let m;const g=c.target;if(m=Dp(g)?{documents:Z5(l,g)}:{query:eR(l,g).ft},m.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){m.resumeToken=b2(l,c.resumeToken);const y=Pp(l,c.expectedCount);y!==null&&(m.expectedCount=y)}else if(c.snapshotVersion.compareTo(Oe.min())>0){m.readTime=Fd(l,c.snapshotVersion.toTimestamp());const y=Pp(l,c.expectedCount);y!==null&&(m.expectedCount=y)}return m})(this.serializer,e);const r=nR(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Up(this.serializer),t.removeTarget=e,this.q_(t)}}class FR extends k2{constructor(e,t,r,a,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,a,c),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return ct(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ct(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ct(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=J5(e.writeResults,e.commitTime),r=_r(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Up(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>W5(this.serializer,r)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GR{}class KR extends GR{constructor(e,t,r,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new de(re.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Go(e,Vp(t,r),a,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new de(re.UNKNOWN,l.toString())}))}Ho(e,t,r,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,m])=>this.connection.Ho(e,Vp(t,r),a,c,m,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new de(re.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class QR{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ri(t),this.aa=!1):ge("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const to="RemoteStore";class YR{constructor(e,t,r,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((c=>{r.enqueueAndForget((async()=>{oo(this)&&(ge(to,"Restarting streams for network reachability change."),await(async function(g){const y=Ve(g);y.Ea.add(4),await Du(y),y.Ra.set("Unknown"),y.Ea.delete(4),await Of(y)})(this))}))})),this.Ra=new QR(r,a)}}async function Of(n){if(oo(n))for(const e of n.da)await e(!0)}async function Du(n){for(const e of n.da)await e(!1)}function O2(n,e){const t=Ve(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),V0(t)?P0(t):zl(t).O_()&&M0(t,e))}function D0(n,e){const t=Ve(n),r=zl(t);t.Ia.delete(e),r.O_()&&D2(t,e),t.Ia.size===0&&(r.O_()?r.L_():oo(t)&&t.Ra.set("Unknown"))}function M0(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Oe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}zl(n).Y_(e)}function D2(n,e){n.Va.Ue(e),zl(n).Z_(e)}function P0(n){n.Va=new H5({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),zl(n).start(),n.Ra.ua()}function V0(n){return oo(n)&&!zl(n).x_()&&n.Ia.size>0}function oo(n){return Ve(n).Ea.size===0}function M2(n){n.Va=void 0}async function XR(n){n.Ra.set("Online")}async function WR(n){n.Ia.forEach(((e,t)=>{M0(n,e)}))}async function JR(n,e){M2(n),V0(n)?(n.Ra.ha(e),P0(n)):n.Ra.set("Unknown")}async function ZR(n,e,t){if(n.Ra.set("Online"),e instanceof _2&&e.state===2&&e.cause)try{await(async function(a,l){const c=l.cause;for(const m of l.targetIds)a.Ia.has(m)&&(await a.remoteSyncer.rejectListen(m,c),a.Ia.delete(m),a.Va.removeTarget(m))})(n,e)}catch(r){ge(to,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Kd(n,r)}else if(e instanceof Od?n.Va.Ze(e):e instanceof v2?n.Va.st(e):n.Va.tt(e),!t.isEqual(Oe.min()))try{const r=await I2(n.localStore);t.compareTo(r)>=0&&await(function(l,c){const m=l.Va.Tt(c);return m.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const _=l.Ia.get(y);_&&l.Ia.set(y,_.withResumeToken(g.resumeToken,c))}})),m.targetMismatches.forEach(((g,y)=>{const _=l.Ia.get(g);if(!_)return;l.Ia.set(g,_.withResumeToken(hn.EMPTY_BYTE_STRING,_.snapshotVersion)),D2(l,g);const w=new Gi(_.target,g,y,_.sequenceNumber);M0(l,w)})),l.remoteSyncer.applyRemoteEvent(m)})(n,t)}catch(r){ge(to,"Failed to raise snapshot:",r),await Kd(n,r)}}async function Kd(n,e,t){if(!Ll(e))throw e;n.Ea.add(1),await Du(n),n.Ra.set("Offline"),t||(t=()=>I2(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ge(to,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Of(n)}))}function P2(n,e){return e().catch((t=>Kd(n,t,e)))}async function Df(n){const e=Ve(n),t=ra(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:b0;for(;eC(e);)try{const a=await MR(e.localStore,r);if(a===null){e.Ta.length===0&&t.L_();break}r=a.batchId,tC(e,a)}catch(a){await Kd(e,a)}V2(e)&&L2(e)}function eC(n){return oo(n)&&n.Ta.length<10}function tC(n,e){n.Ta.push(e);const t=ra(n);t.O_()&&t.X_&&t.ea(e.mutations)}function V2(n){return oo(n)&&!ra(n).x_()&&n.Ta.length>0}function L2(n){ra(n).start()}async function nC(n){ra(n).ra()}async function sC(n){const e=ra(n);for(const t of n.Ta)e.ea(t.mutations)}async function rC(n,e,t){const r=n.Ta.shift(),a=N0.from(r,e,t);await P2(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await Df(n)}async function iC(n,e){e&&ra(n).X_&&await(async function(r,a){if((function(c){return z5(c)&&c!==re.ABORTED})(a.code)){const l=r.Ta.shift();ra(r).B_(),await P2(r,(()=>r.remoteSyncer.rejectFailedWrite(l.batchId,a))),await Df(r)}})(n,e),V2(n)&&L2(n)}async function G1(n,e){const t=Ve(n);t.asyncQueue.verifyOperationInProgress(),ge(to,"RemoteStore received new credentials");const r=oo(t);t.Ea.add(3),await Du(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Of(t)}async function aC(n,e){const t=Ve(n);e?(t.Ea.delete(2),await Of(t)):e||(t.Ea.add(2),await Du(t),t.Ra.set("Unknown"))}function zl(n){return n.ma||(n.ma=(function(t,r,a){const l=Ve(t);return l.sa(),new $R(r,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Xo:XR.bind(null,n),t_:WR.bind(null,n),r_:JR.bind(null,n),H_:ZR.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),V0(n)?P0(n):n.Ra.set("Unknown")):(await n.ma.stop(),M2(n))}))),n.ma}function ra(n){return n.fa||(n.fa=(function(t,r,a){const l=Ve(t);return l.sa(),new FR(r,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:nC.bind(null,n),r_:iC.bind(null,n),ta:sC.bind(null,n),na:rC.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Df(n)):(await n.fa.stop(),n.Ta.length>0&&(ge(to,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{constructor(e,t,r,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=a,this.removalCallback=l,this.deferred=new Zr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,a,l){const c=Date.now()+r,m=new L0(e,t,c,a,l);return m.start(r),m}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new de(re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function U0(n,e){if(ri("AsyncQueue",`${e}: ${n}`),Ll(n))return new de(re.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{static emptySet(e){return new yl(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||xe.comparator(t.key,r.key):(t,r)=>xe.comparator(t.key,r.key),this.keyedMap=Xc(),this.sortedSet=new kt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof yl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=r.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new yl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{constructor(){this.ga=new kt(xe.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Re(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Ol{constructor(e,t,r,a,l,c,m,g,y){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=m,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,r,a,l){const c=[];return t.forEach((m=>{c.push({type:0,doc:m})})),new Ol(e,t,yl.emptySet(t),c,r,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Af(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==r[a].type||!t[a].doc.isEqual(r[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class lC{constructor(){this.queries=Q1(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const a=Ve(t),l=a.queries;a.queries=Q1(),l.forEach(((c,m)=>{for(const g of m.Sa)g.onError(r)}))})(this,new de(re.ABORTED,"Firestore shutting down"))}}function Q1(){return new ao((n=>i2(n)),Af)}async function z0(n,e){const t=Ve(n);let r=3;const a=e.query;let l=t.queries.get(a);l?!l.ba()&&e.Da()&&(r=2):(l=new oC,r=e.Da()?0:1);try{switch(r){case 0:l.wa=await t.onListen(a,!0);break;case 1:l.wa=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(c){const m=U0(c,`Initialization of query '${ll(e.query)}' failed`);return void e.onError(m)}t.queries.set(a,l),l.Sa.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&q0(t)}async function B0(n,e){const t=Ve(n),r=e.query;let a=3;const l=t.queries.get(r);if(l){const c=l.Sa.indexOf(e);c>=0&&(l.Sa.splice(c,1),l.Sa.length===0?a=e.Da()?0:1:!l.ba()&&e.Da()&&(a=2))}switch(a){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function cC(n,e){const t=Ve(n);let r=!1;for(const a of e){const l=a.query,c=t.queries.get(l);if(c){for(const m of c.Sa)m.Fa(a)&&(r=!0);c.wa=a}}r&&q0(t)}function uC(n,e,t){const r=Ve(n),a=r.queries.get(e);if(a)for(const l of a.Sa)l.onError(t);r.queries.delete(e)}function q0(n){n.Ca.forEach((e=>{e.next()}))}var qp,Y1;(Y1=qp||(qp={})).Ma="default",Y1.Cache="cache";class H0{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const a of e.docChanges)a.type!==3&&r.push(a);e=new Ol(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Ol.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==qp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U2{constructor(e){this.key=e}}class z2{constructor(e){this.key=e}}class hC{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Xe(),this.mutatedKeys=Xe(),this.eu=a2(e),this.tu=new yl(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new K1,a=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,c=a,m=!1;const g=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,y=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((_,w)=>{const E=a.get(_),S=Nf(this.query,w)?w:null,N=!!E&&this.mutatedKeys.has(E.key),M=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let k=!1;E&&S?E.data.isEqual(S.data)?N!==M&&(r.track({type:3,doc:S}),k=!0):this.su(E,S)||(r.track({type:2,doc:S}),k=!0,(g&&this.eu(S,g)>0||y&&this.eu(S,y)<0)&&(m=!0)):!E&&S?(r.track({type:0,doc:S}),k=!0):E&&!S&&(r.track({type:1,doc:E}),k=!0,(g||y)&&(m=!0)),k&&(S?(c=c.add(S),l=M?l.add(_):l.delete(_)):(c=c.delete(_),l=l.delete(_)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const _=this.query.limitType==="F"?c.last():c.first();c=c.delete(_.key),l=l.delete(_.key),r.track({type:1,doc:_})}return{tu:c,iu:r,Cs:m,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((_,w)=>(function(S,N){const M=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Re(20277,{Rt:k})}};return M(S)-M(N)})(_.type,w.type)||this.eu(_.doc,w.doc))),this.ou(r),a=a??!1;const m=t&&!a?this._u():[],g=this.Xa.size===0&&this.current&&!a?1:0,y=g!==this.Za;return this.Za=g,c.length!==0||y?{snapshot:new Ol(this.query,e.tu,l,c,e.mutatedKeys,g===0,y,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:m}:{au:m}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new K1,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Xe(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new z2(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new U2(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=Xe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ol.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const $0="SyncEngine";class dC{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class fC{constructor(e){this.key=e,this.hu=!1}}class mC{constructor(e,t,r,a,l,c){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new ao((m=>i2(m)),Af),this.Iu=new Map,this.Eu=new Set,this.du=new kt(xe.comparator),this.Au=new Map,this.Ru=new I0,this.Vu={},this.mu=new Map,this.fu=kl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function gC(n,e,t=!0){const r=G2(n);let a;const l=r.Tu.get(e);return l?(r.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await B2(r,e,t,!0),a}async function pC(n,e){const t=G2(n);await B2(t,e,!0,!1)}async function B2(n,e,t,r){const a=await PR(n.localStore,vr(e)),l=a.targetId,c=n.sharedClientState.addLocalQueryTarget(l,t);let m;return r&&(m=await yC(n,e,l,c==="current",a.resumeToken)),n.isPrimaryClient&&t&&O2(n.remoteStore,a),m}async function yC(n,e,t,r,a){n.pu=(w,E,S)=>(async function(M,k,V,F){let $=k.view.ru(V);$.Cs&&($=await B1(M.localStore,k.query,!1).then((({documents:I})=>k.view.ru(I,$))));const te=F&&F.targetChanges.get(k.targetId),ue=F&&F.targetMismatches.get(k.targetId)!=null,le=k.view.applyChanges($,M.isPrimaryClient,te,ue);return W1(M,k.targetId,le.au),le.snapshot})(n,w,E,S);const l=await B1(n.localStore,e,!0),c=new hC(e,l.Qs),m=c.ru(l.documents),g=Ou.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",a),y=c.applyChanges(m,n.isPrimaryClient,g);W1(n,t,y.au);const _=new dC(e,t,c);return n.Tu.set(e,_),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),y.snapshot}async function vC(n,e,t){const r=Ve(n),a=r.Tu.get(e),l=r.Iu.get(a.targetId);if(l.length>1)return r.Iu.set(a.targetId,l.filter((c=>!Af(c,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await zp(r.localStore,a.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(a.targetId),t&&D0(r.remoteStore,a.targetId),Hp(r,a.targetId)})).catch(Vl)):(Hp(r,a.targetId),await zp(r.localStore,a.targetId,!0))}async function _C(n,e){const t=Ve(n),r=t.Tu.get(e),a=t.Iu.get(r.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),D0(t.remoteStore,r.targetId))}async function bC(n,e,t){const r=NC(n);try{const a=await(function(c,m){const g=Ve(c),y=_t.now(),_=m.reduce(((S,N)=>S.add(N.key)),Xe());let w,E;return g.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let N=ii(),M=Xe();return g.Ns.getEntries(S,_).next((k=>{N=k,N.forEach(((V,F)=>{F.isValidDocument()||(M=M.add(V))}))})).next((()=>g.localDocuments.getOverlayedDocuments(S,N))).next((k=>{w=k;const V=[];for(const F of m){const $=M5(F,w.get(F.key).overlayedDocument);$!=null&&V.push(new oa(F.key,$,Wx($.value.mapValue),kn.exists(!0)))}return g.mutationQueue.addMutationBatch(S,y,V,m)})).next((k=>{E=k;const V=k.applyToLocalDocumentSet(w,M);return g.documentOverlayCache.saveOverlays(S,k.batchId,V)}))})).then((()=>({batchId:E.batchId,changes:l2(w)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(a.batchId),(function(c,m,g){let y=c.Vu[c.currentUser.toKey()];y||(y=new kt(Ye)),y=y.insert(m,g),c.Vu[c.currentUser.toKey()]=y})(r,a.batchId,t),await Mu(r,a.changes),await Df(r.remoteStore)}catch(a){const l=U0(a,"Failed to persist write");t.reject(l)}}async function q2(n,e){const t=Ve(n);try{const r=await OR(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const c=t.Au.get(l);c&&(ct(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?c.hu=!0:a.modifiedDocuments.size>0?ct(c.hu,14607):a.removedDocuments.size>0&&(ct(c.hu,42227),c.hu=!1))})),await Mu(t,r,e)}catch(r){await Vl(r)}}function X1(n,e,t){const r=Ve(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const a=[];r.Tu.forEach(((l,c)=>{const m=c.view.va(e);m.snapshot&&a.push(m.snapshot)})),(function(c,m){const g=Ve(c);g.onlineState=m;let y=!1;g.queries.forEach(((_,w)=>{for(const E of w.Sa)E.va(m)&&(y=!0)})),y&&q0(g)})(r.eventManager,e),a.length&&r.Pu.H_(a),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function wC(n,e,t){const r=Ve(n);r.sharedClientState.updateQueryState(e,"rejected",t);const a=r.Au.get(e),l=a&&a.key;if(l){let c=new kt(xe.comparator);c=c.insert(l,Sn.newNoDocument(l,Oe.min()));const m=Xe().add(l),g=new jf(Oe.min(),new Map,new kt(Ye),c,m);await q2(r,g),r.du=r.du.remove(l),r.Au.delete(e),F0(r)}else await zp(r.localStore,e,!1).then((()=>Hp(r,e,t))).catch(Vl)}async function xC(n,e){const t=Ve(n),r=e.batch.batchId;try{const a=await kR(t.localStore,e);$2(t,r,null),H2(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Mu(t,a)}catch(a){await Vl(a)}}async function EC(n,e,t){const r=Ve(n);try{const a=await(function(c,m){const g=Ve(c);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let _;return g.mutationQueue.lookupMutationBatch(y,m).next((w=>(ct(w!==null,37113),_=w.keys(),g.mutationQueue.removeMutationBatch(y,w)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,_,m))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,_))).next((()=>g.localDocuments.getDocuments(y,_)))}))})(r.localStore,e);$2(r,e,t),H2(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Mu(r,a)}catch(a){await Vl(a)}}function H2(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function $2(n,e,t){const r=Ve(n);let a=r.Vu[r.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),r.Vu[r.currentUser.toKey()]=a}}function Hp(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||F2(n,r)}))}function F2(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(D0(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),F0(n))}function W1(n,e,t){for(const r of t)r instanceof U2?(n.Ru.addReference(r.key,e),TC(n,r)):r instanceof z2?(ge($0,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||F2(n,r.key)):Re(19791,{wu:r})}function TC(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(ge($0,"New document in limbo: "+t),n.Eu.add(r),F0(n))}function F0(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new xe(Et.fromString(e)),r=n.fu.next();n.Au.set(r,new fC(t)),n.du=n.du.insert(t,r),O2(n.remoteStore,new Gi(vr(Sf(t.path)),r,"TargetPurposeLimboResolution",xf.ce))}}async function Mu(n,e,t){const r=Ve(n),a=[],l=[],c=[];r.Tu.isEmpty()||(r.Tu.forEach(((m,g)=>{c.push(r.pu(g,e,t).then((y=>{var _;if((y||t)&&r.isPrimaryClient){const w=y?!y.fromCache:(_=t==null?void 0:t.targetChanges.get(g.targetId))==null?void 0:_.current;r.sharedClientState.updateQueryState(g.targetId,w?"current":"not-current")}if(y){a.push(y);const w=k0.As(g.targetId,y);l.push(w)}})))})),await Promise.all(c),r.Pu.H_(a),await(async function(g,y){const _=Ve(g);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(w=>ae.forEach(y,(E=>ae.forEach(E.Es,(S=>_.persistence.referenceDelegate.addReference(w,E.targetId,S))).next((()=>ae.forEach(E.ds,(S=>_.persistence.referenceDelegate.removeReference(w,E.targetId,S)))))))))}catch(w){if(!Ll(w))throw w;ge(O0,"Failed to update sequence numbers: "+w)}for(const w of y){const E=w.targetId;if(!w.fromCache){const S=_.Ms.get(E),N=S.snapshotVersion,M=S.withLastLimboFreeSnapshotVersion(N);_.Ms=_.Ms.insert(E,M)}}})(r.localStore,l))}async function SC(n,e){const t=Ve(n);if(!t.currentUser.isEqual(e)){ge($0,"User change. New user:",e.toKey());const r=await C2(t.localStore,e);t.currentUser=e,(function(l,c){l.mu.forEach((m=>{m.forEach((g=>{g.reject(new de(re.CANCELLED,c))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Mu(t,r.Ls)}}function AC(n,e){const t=Ve(n),r=t.Au.get(e);if(r&&r.hu)return Xe().add(r.key);{let a=Xe();const l=t.Iu.get(e);if(!l)return a;for(const c of l){const m=t.Tu.get(c);a=a.unionWith(m.view.nu)}return a}}function G2(n){const e=Ve(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=q2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=AC.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=wC.bind(null,e),e.Pu.H_=cC.bind(null,e.eventManager),e.Pu.yu=uC.bind(null,e.eventManager),e}function NC(n){const e=Ve(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=xC.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=EC.bind(null,e),e}class Qd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=kf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return jR(this.persistence,new RR,e.initialUser,this.serializer)}Cu(e){return new R2(j0.mi,this.serializer)}Du(e){return new LR}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Qd.provider={build:()=>new Qd};class RC extends Qd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){ct(this.persistence.referenceDelegate instanceof Gd,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new fR(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Bn.withCacheSize(this.cacheSizeBytes):Bn.DEFAULT;return new R2((r=>Gd.mi(r,t)),this.serializer)}}class $p{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>X1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=SC.bind(null,this.syncEngine),await aC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new lC})()}createDatastore(e){const t=kf(e.databaseInfo.databaseId),r=(function(l){return new HR(l)})(e.databaseInfo);return(function(l,c,m,g){return new KR(l,c,m,g)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,a,l,c,m){return new YR(r,a,l,c,m)})(this.localStore,this.datastore,e.asyncQueue,(t=>X1(this.syncEngine,t,0)),(function(){return $1.v()?new $1:new UR})())}createSyncEngine(e,t){return(function(a,l,c,m,g,y,_){const w=new mC(a,l,c,m,g,y);return _&&(w.gu=!0),w})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=Ve(a);ge(to,"RemoteStore shutting down."),l.Ea.add(5),await Du(l),l.Aa.shutdown(),l.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}$p.provider={build:()=>new $p};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ri("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ia="FirestoreClient";class CC{constructor(e,t,r,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=a,this.user=Tn.UNAUTHENTICATED,this.clientId=bf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(r,(async c=>{ge(ia,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(r,(c=>(ge(ia,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Zr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=U0(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function op(n,e){n.asyncQueue.verifyOperationInProgress(),ge(ia,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async a=>{r.isEqual(a)||(await C2(e.localStore,a),r=a)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function J1(n,e){n.asyncQueue.verifyOperationInProgress();const t=await IC(n);ge(ia,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>G1(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,a)=>G1(e.remoteStore,a))),n._onlineComponents=e}async function IC(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ge(ia,"Using user provided OfflineComponentProvider");try{await op(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===re.FAILED_PRECONDITION||a.code===re.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;eo("Error using user provided cache. Falling back to memory cache: "+t),await op(n,new Qd)}}else ge(ia,"Using default OfflineComponentProvider"),await op(n,new RC(void 0));return n._offlineComponents}async function K2(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ge(ia,"Using user provided OnlineComponentProvider"),await J1(n,n._uninitializedComponentsProvider._online)):(ge(ia,"Using default OnlineComponentProvider"),await J1(n,new $p))),n._onlineComponents}function jC(n){return K2(n).then((e=>e.syncEngine))}async function Yd(n){const e=await K2(n),t=e.eventManager;return t.onListen=gC.bind(null,e.syncEngine),t.onUnlisten=vC.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=pC.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=_C.bind(null,e.syncEngine),t}function kC(n,e,t={}){const r=new Zr;return n.asyncQueue.enqueueAndForget((async()=>(function(l,c,m,g,y){const _=new G0({next:E=>{_.Nu(),c.enqueueAndForget((()=>B0(l,w)));const S=E.docs.has(m);!S&&E.fromCache?y.reject(new de(re.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&E.fromCache&&g&&g.source==="server"?y.reject(new de(re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(E)},error:E=>y.reject(E)}),w=new H0(Sf(m.path),_,{includeMetadataChanges:!0,qa:!0});return z0(l,w)})(await Yd(n),n.asyncQueue,e,t,r))),r.promise}function OC(n,e,t={}){const r=new Zr;return n.asyncQueue.enqueueAndForget((async()=>(function(l,c,m,g,y){const _=new G0({next:E=>{_.Nu(),c.enqueueAndForget((()=>B0(l,w))),E.fromCache&&g.source==="server"?y.reject(new de(re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(E)},error:E=>y.reject(E)}),w=new H0(m,_,{includeMetadataChanges:!0,qa:!0});return z0(l,w)})(await Yd(n),n.asyncQueue,e,t,r))),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q2(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z1=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y2="firestore.googleapis.com",ew=!0;class tw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new de(re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Y2,this.ssl=ew}else this.host=e.host,this.ssl=e.ssl??ew;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=N2;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<hR)throw new de(re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}zx("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Q2(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new de(re.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new de(re.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new de(re.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,a){return r.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Mf{constructor(e,t,r,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new tw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new de(re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new de(re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new tw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new Lx;switch(r.type){case"firstParty":return new $4(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new de(re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=Z1.get(t);r&&(ge("ComponentProvider","Removing Datastore"),Z1.delete(t),r.terminate())})(this),Promise.resolve()}}function X2(n,e,t,r={}){var y;n=An(n,Mf);const a=ro(e),l=n._getSettings(),c={...l,emulatorOptions:n._getEmulatorOptions()},m=`${e}:${t}`;a&&(g0(`https://${m}`),p0("Firestore",!0)),l.host!==Y2&&l.host!==m&&eo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...l,host:m,ssl:a,emulatorOptions:r};if(!ni(g,c)&&(n._setSettings(g),r.mockUserToken)){let _,w;if(typeof r.mockUserToken=="string")_=r.mockUserToken,w=Tn.MOCK_USER;else{_=Tx(r.mockUserToken,(y=n._app)==null?void 0:y.options.projectId);const E=r.mockUserToken.sub||r.mockUserToken.user_id;if(!E)throw new de(re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");w=new Tn(E)}n._authCredentials=new B4(new Vx(_,w))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Sr(this.firestore,e,this._query)}}class jt{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ei(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new jt(this.firestore,e,this._key)}toJSON(){return{type:jt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(ju(t,jt._jsonSchema))return new jt(e,r||null,new xe(Et.fromString(t.referencePath)))}}jt._jsonSchemaVersion="firestore/documentReference/1.0",jt._jsonSchema={type:tn("string",jt._jsonSchemaVersion),referencePath:tn("string")};class ei extends Sr{constructor(e,t,r){super(e,t,Sf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new jt(this.firestore,null,new xe(e))}withConverter(e){return new ei(this.firestore,e,this._path)}}function xt(n,e,...t){if(n=$t(n),Ux("collection","path",e),n instanceof Mf){const r=Et.fromString(e,...t);return m1(r),new ei(n,null,r)}{if(!(n instanceof jt||n instanceof ei))throw new de(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Et.fromString(e,...t));return m1(r),new ei(n.firestore,null,r)}}function qt(n,e,...t){if(n=$t(n),arguments.length===1&&(e=bf.newId()),Ux("doc","path",e),n instanceof Mf){const r=Et.fromString(e,...t);return f1(r),new jt(n,null,new xe(r))}{if(!(n instanceof jt||n instanceof ei))throw new de(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Et.fromString(e,...t));return f1(r),new jt(n.firestore,n instanceof ei?n.converter:null,new xe(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nw="AsyncQueue";class sw{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new j2(this,"async_queue_retry"),this._c=()=>{const r=ap();r&&ge(nw,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=ap();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=ap();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Zr;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ll(e))throw e;ge(nw,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,ri("INTERNAL UNHANDLED ERROR: ",rw(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=L0.createAndSchedule(this,e,t,r,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&Re(47125,{Pc:rw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function rw(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iw(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const a=t;for(const l of r)if(l in a&&typeof a[l]=="function")return!0;return!1})(n,["next","error","complete"])}class Gs extends Mf{constructor(e,t,r,a){super(e,t,r,a),this.type="firestore",this._queue=new sw,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new sw(e),this._firestoreClient=void 0,await e}}}function W2(n,e){const t=typeof n=="object"?n:_f(),r=typeof n=="string"?n:zd,a=vf(t,"firestore").getImmediate({identifier:r});if(!a._initialized){const l=wx("firestore");l&&X2(a,...l)}return a}function Bl(n){if(n._terminated)throw new de(re.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||DC(n),n._firestoreClient}function DC(n){var r,a,l;const e=n._freezeSettings(),t=(function(m,g,y,_){return new a5(m,g,y,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,Q2(_.experimentalLongPollingOptions),_.useFetchStreams,_.isUsingEmulator)})(n._databaseId,((r=n._app)==null?void 0:r.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(a=e.localCache)!=null&&a._offlineComponentProvider&&((l=e.localCache)!=null&&l._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new CC(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(m){const g=m==null?void 0:m._online.build();return{_offline:m==null?void 0:m._offline.build(g),_online:g}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ss(hn.fromBase64String(e))}catch(t){throw new de(re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ss(hn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ss._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ju(e,ss._jsonSchema))return ss.fromBase64String(e.bytes)}}ss._jsonSchemaVersion="firestore/bytes/1.0",ss._jsonSchema={type:tn("string",ss._jsonSchemaVersion),bytes:tn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new de(re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new cn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function Pf(){return new lo(Ip)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new de(re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new de(re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ye(this._lat,e._lat)||Ye(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Hs._jsonSchemaVersion}}static fromJSON(e){if(ju(e,Hs._jsonSchema))return new Hs(e.latitude,e.longitude)}}Hs._jsonSchemaVersion="firestore/geoPoint/1.0",Hs._jsonSchema={type:tn("string",Hs._jsonSchemaVersion),latitude:tn("number"),longitude:tn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,a){if(r.length!==a.length)return!1;for(let l=0;l<r.length;++l)if(r[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:$s._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ju(e,$s._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new $s(e.vectorValues);throw new de(re.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}$s._jsonSchemaVersion="firestore/vectorValue/1.0",$s._jsonSchema={type:tn("string",$s._jsonSchemaVersion),vectorValues:tn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MC=/^__.*__$/;class PC{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new oa(e,this.data,this.fieldMask,t,this.fieldTransforms):new ku(e,this.data,t,this.fieldTransforms)}}class J2{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new oa(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Z2(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Re(40011,{Ac:n})}}class Vf{constructor(e,t,r,a,l,c){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=a,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Vf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var a;const t=(a=this.path)==null?void 0:a.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){var a;const t=(a=this.path)==null?void 0:a.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Xd(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Z2(this.Ac)&&MC.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class VC{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||kf(e)}Cc(e,t,r,a=!1){return new Vf({Ac:e,methodName:t,Dc:r,path:cn.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Pu(n){const e=n._freezeSettings(),t=kf(n._databaseId);return new VC(n._databaseId,!!e.ignoreUndefinedProperties,t)}function K0(n,e,t,r,a,l={}){const c=n.Cc(l.merge||l.mergeFields?2:0,e,t,a);W0("Data must be an object, but it was:",c,r);const m=sE(r,c);let g,y;if(l.merge)g=new as(c.fieldMask),y=c.fieldTransforms;else if(l.mergeFields){const _=[];for(const w of l.mergeFields){const E=Fp(e,w,t);if(!c.contains(E))throw new de(re.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);iE(_,E)||_.push(E)}g=new as(_),y=c.fieldTransforms.filter((w=>g.covers(w.field)))}else g=null,y=c.fieldTransforms;return new PC(new qn(m),g,y)}class Lf extends co{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Lf}}function eE(n,e,t){return new Vf({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Q0 extends co{_toFieldTransform(e){return new A0(e.path,new yu)}isEqual(e){return e instanceof Q0}}class Y0 extends co{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=eE(this,e,!0),r=this.vc.map((l=>uo(l,t))),a=new Il(r);return new A0(e.path,a)}isEqual(e){return e instanceof Y0&&ni(this.vc,e.vc)}}class X0 extends co{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=eE(this,e,!0),r=this.vc.map((l=>uo(l,t))),a=new jl(r);return new A0(e.path,a)}isEqual(e){return e instanceof X0&&ni(this.vc,e.vc)}}function tE(n,e,t,r){const a=n.Cc(1,e,t);W0("Data must be an object, but it was:",a,r);const l=[],c=qn.empty();aa(r,((g,y)=>{const _=J0(e,g,t);y=$t(y);const w=a.yc(_);if(y instanceof Lf)l.push(_);else{const E=uo(y,w);E!=null&&(l.push(_),c.set(_,E))}}));const m=new as(l);return new J2(c,m,a.fieldTransforms)}function nE(n,e,t,r,a,l){const c=n.Cc(1,e,t),m=[Fp(e,r,t)],g=[a];if(l.length%2!=0)throw new de(re.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<l.length;E+=2)m.push(Fp(e,l[E])),g.push(l[E+1]);const y=[],_=qn.empty();for(let E=m.length-1;E>=0;--E)if(!iE(y,m[E])){const S=m[E];let N=g[E];N=$t(N);const M=c.yc(S);if(N instanceof Lf)y.push(S);else{const k=uo(N,M);k!=null&&(y.push(S),_.set(S,k))}}const w=new as(y);return new J2(_,w,c.fieldTransforms)}function LC(n,e,t,r=!1){return uo(t,n.Cc(r?4:3,e))}function uo(n,e){if(rE(n=$t(n)))return W0("Unsupported field value:",e,n),sE(n,e);if(n instanceof co)return(function(r,a){if(!Z2(a.Ac))throw a.Sc(`${r._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${r._methodName}() is not currently supported inside arrays`);const l=r._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,a){const l=[];let c=0;for(const m of r){let g=uo(m,a.wc(c));g==null&&(g={nullValue:"NULL_VALUE"}),l.push(g),c++}return{arrayValue:{values:l}}})(n,e)}return(function(r,a){if((r=$t(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return C5(a.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const l=_t.fromDate(r);return{timestampValue:Fd(a.serializer,l)}}if(r instanceof _t){const l=new _t(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Fd(a.serializer,l)}}if(r instanceof Hs)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ss)return{bytesValue:b2(a.serializer,r._byteString)};if(r instanceof jt){const l=a.databaseId,c=r.firestore._databaseId;if(!c.isEqual(l))throw a.Sc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:C0(r.firestore._databaseId||a.databaseId,r._key.path)}}if(r instanceof $s)return(function(c,m){return{mapValue:{fields:{[Yx]:{stringValue:Xx},[Bd]:{arrayValue:{values:c.toArray().map((y=>{if(typeof y!="number")throw m.Sc("VectorValues must only contain numeric values.");return S0(m.serializer,y)}))}}}}}})(r,a);throw a.Sc(`Unsupported field value: ${wf(r)}`)})(n,e)}function sE(n,e){const t={};return Hx(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):aa(n,((r,a)=>{const l=uo(a,e.mc(r));l!=null&&(t[r]=l)})),{mapValue:{fields:t}}}function rE(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof _t||n instanceof Hs||n instanceof ss||n instanceof jt||n instanceof co||n instanceof $s)}function W0(n,e,t){if(!rE(t)||!Bx(t)){const r=wf(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function Fp(n,e,t){if((e=$t(e))instanceof lo)return e._internalPath;if(typeof e=="string")return J0(n,e);throw Xd("Field path arguments must be of type string or ",n,!1,void 0,t)}const UC=new RegExp("[~\\*/\\[\\]]");function J0(n,e,t){if(e.search(UC)>=0)throw Xd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new lo(...e.split("."))._internalPath}catch{throw Xd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Xd(n,e,t,r,a){const l=r&&!r.isEmpty(),c=a!==void 0;let m=`Function ${e}() called with invalid data`;t&&(m+=" (via `toFirestore()`)"),m+=". ";let g="";return(l||c)&&(g+=" (found",l&&(g+=` in field ${r}`),c&&(g+=` in document ${a}`),g+=")"),new de(re.INVALID_ARGUMENT,m+n+g)}function iE(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{constructor(e,t,r,a,l){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new jt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new zC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Uf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class zC extends aE{data(){return super.data()}}function Uf(n,e){return typeof e=="string"?J0(n,e):e instanceof lo?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oE(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new de(re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Z0{}class zf extends Z0{}function Ht(n,e,...t){let r=[];e instanceof Z0&&r.push(e),r=r.concat(t),(function(l){const c=l.filter((g=>g instanceof Bf)).length,m=l.filter((g=>g instanceof Vu)).length;if(c>1||c>0&&m>0)throw new de(re.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const a of r)n=a._apply(n);return n}class Vu extends zf{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Vu(e,t,r)}_apply(e){const t=this._parse(e);return lE(e._query,t),new Sr(e.firestore,e.converter,Mp(e._query,t))}_parse(e){const t=Pu(e.firestore);return(function(l,c,m,g,y,_,w){let E;if(y.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new de(re.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){ow(w,_);const N=[];for(const M of w)N.push(aw(g,l,M));E={arrayValue:{values:N}}}else E=aw(g,l,w)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||ow(w,_),E=LC(m,c,w,_==="in"||_==="not-in");return en.create(y,_,E)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function un(n,e,t){const r=e,a=Uf("where",n);return Vu._create(a,r,t)}class Bf extends Z0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Bf(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Fs.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let c=a;const m=l.getFlattenedFilters();for(const g of m)lE(c,g),c=Mp(c,g)})(e._query,t),new Sr(e.firestore,e.converter,Mp(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class qf extends zf{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new qf(e,t)}_apply(e){const t=(function(a,l,c){if(a.startAt!==null)throw new de(re.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new de(re.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new pu(l,c)})(e._query,this._field,this._direction);return new Sr(e.firestore,e.converter,(function(a,l){const c=a.explicitOrderBy.concat([l]);return new Ul(a.path,a.collectionGroup,c,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)})(e._query,t))}}function Hf(n,e="asc"){const t=e,r=Uf("orderBy",n);return qf._create(r,t)}class $f extends zf{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new $f(e,t,r)}_apply(e){return new Sr(e.firestore,e.converter,Hd(e._query,this._limit,this._limitType))}}function Wd(n){return $f._create("limit",n,"F")}function aw(n,e,t){if(typeof(t=$t(t))=="string"){if(t==="")throw new de(re.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!r2(e)&&t.indexOf("/")!==-1)throw new de(re.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Et.fromString(t));if(!xe.isDocumentKey(r))throw new de(re.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return x1(n,new xe(r))}if(t instanceof jt)return x1(n,t._key);throw new de(re.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${wf(t)}.`)}function ow(n,e){if(!Array.isArray(n)||n.length===0)throw new de(re.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function lE(n,e){const t=(function(a,l){for(const c of a)for(const m of c.getFlattenedFilters())if(l.indexOf(m.op)>=0)return m.op;return null})(n.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new de(re.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new de(re.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class cE{convertValue(e,t="none"){switch(sa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Bt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(na(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Re(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return aa(e,((a,l)=>{r[a]=this.convertValue(l,t)})),r}convertVectorValue(e){var r,a,l;const t=(l=(a=(r=e.fields)==null?void 0:r[Bd].arrayValue)==null?void 0:a.values)==null?void 0:l.map((c=>Bt(c.doubleValue)));return new $s(t)}convertGeoPoint(e){return new Hs(Bt(e.latitude),Bt(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Tf(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(mu(e));default:return null}}convertTimestamp(e){const t=ta(e);return new _t(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Et.fromString(e);ct(A2(r),9688,{name:e});const a=new Nl(r.get(1),r.get(3)),l=new xe(r.popFirst(5));return a.isEqual(t)||ri(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ey(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class fl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Wi extends aE{constructor(e,t,r,a,l,c){super(e,t,r,a,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new iu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Uf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new de(re.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Wi._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Wi._jsonSchemaVersion="firestore/documentSnapshot/1.0",Wi._jsonSchema={type:tn("string",Wi._jsonSchemaVersion),bundleSource:tn("string","DocumentSnapshot"),bundleName:tn("string"),bundle:tn("string")};class iu extends Wi{data(e={}){return super.data(e)}}class Ji{constructor(e,t,r,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new fl(a.hasPendingWrites,a.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new iu(this._firestore,this._userDataWriter,r.key,r,new fl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new de(re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map((m=>{const g=new iu(a._firestore,a._userDataWriter,m.doc.key,m.doc,new fl(a._snapshot.mutatedKeys.has(m.doc.key),a._snapshot.fromCache),a.query.converter);return m.doc,{type:"added",doc:g,oldIndex:-1,newIndex:c++}}))}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((m=>l||m.type!==3)).map((m=>{const g=new iu(a._firestore,a._userDataWriter,m.doc.key,m.doc,new fl(a._snapshot.mutatedKeys.has(m.doc.key),a._snapshot.fromCache),a.query.converter);let y=-1,_=-1;return m.type!==0&&(y=c.indexOf(m.doc.key),c=c.delete(m.doc.key)),m.type!==1&&(c=c.add(m.doc),_=c.indexOf(m.doc.key)),{type:BC(m.type),doc:g,oldIndex:y,newIndex:_}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new de(re.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ji._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=bf.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),r.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function BC(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Re(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vu(n){n=An(n,jt);const e=An(n.firestore,Gs);return kC(Bl(e),n._key).then((t=>hE(e,n,t)))}Ji._jsonSchemaVersion="firestore/querySnapshot/1.0",Ji._jsonSchema={type:tn("string",Ji._jsonSchemaVersion),bundleSource:tn("string","QuerySnapshot"),bundleName:tn("string"),bundle:tn("string")};class ty extends cE{constructor(e){super(),this.firestore=e}convertBytes(e){return new ss(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new jt(this.firestore,null,t)}}function bn(n){n=An(n,Sr);const e=An(n.firestore,Gs),t=Bl(e),r=new ty(e);return oE(n._query),OC(t,n._query).then((a=>new Ji(e,r,n,a)))}function uE(n,e,t){n=An(n,jt);const r=An(n.firestore,Gs),a=ey(n.converter,e,t);return ql(r,[K0(Pu(r),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,kn.none())])}function pr(n,e,t,...r){n=An(n,jt);const a=An(n.firestore,Gs),l=Pu(a);let c;return c=typeof(e=$t(e))=="string"||e instanceof lo?nE(l,"updateDoc",n._key,e,t,r):tE(l,"updateDoc",n._key,e),ql(a,[c.toMutation(n._key,kn.exists(!0))])}function ny(n){return ql(An(n.firestore,Gs),[new If(n._key,kn.none())])}function _u(n,e){const t=An(n.firestore,Gs),r=qt(n),a=ey(n.converter,e);return ql(t,[K0(Pu(n.firestore),"addDoc",r._key,a,n.converter!==null,{}).toMutation(r._key,kn.exists(!1))]).then((()=>r))}function vl(n,...e){var g,y,_;n=$t(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||iw(e[r])||(t=e[r++]);const a={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(iw(e[r])){const w=e[r];e[r]=(g=w.next)==null?void 0:g.bind(w),e[r+1]=(y=w.error)==null?void 0:y.bind(w),e[r+2]=(_=w.complete)==null?void 0:_.bind(w)}let l,c,m;if(n instanceof jt)c=An(n.firestore,Gs),m=Sf(n._key.path),l={next:w=>{e[r]&&e[r](hE(c,n,w))},error:e[r+1],complete:e[r+2]};else{const w=An(n,Sr);c=An(w.firestore,Gs),m=w._query;const E=new ty(c);l={next:S=>{e[r]&&e[r](new Ji(c,E,w,S))},error:e[r+1],complete:e[r+2]},oE(n._query)}return(function(E,S,N,M){const k=new G0(M),V=new H0(S,k,N);return E.asyncQueue.enqueueAndForget((async()=>z0(await Yd(E),V))),()=>{k.Nu(),E.asyncQueue.enqueueAndForget((async()=>B0(await Yd(E),V)))}})(Bl(c),m,a,l)}function ql(n,e){return(function(r,a){const l=new Zr;return r.asyncQueue.enqueueAndForget((async()=>bC(await jC(r),a,l))),l.promise})(Bl(n),e)}function hE(n,e,t){const r=t.docs.get(e._key),a=new ty(n);return new Wi(n,a,e._key,r,new fl(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dE{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Pu(e)}set(e,t,r){this._verifyNotCommitted();const a=lp(e,this._firestore),l=ey(a.converter,t,r),c=K0(this._dataReader,"WriteBatch.set",a._key,l,a.converter!==null,r);return this._mutations.push(c.toMutation(a._key,kn.none())),this}update(e,t,r,...a){this._verifyNotCommitted();const l=lp(e,this._firestore);let c;return c=typeof(t=$t(t))=="string"||t instanceof lo?nE(this._dataReader,"WriteBatch.update",l._key,t,r,a):tE(this._dataReader,"WriteBatch.update",l._key,t),this._mutations.push(c.toMutation(l._key,kn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=lp(e,this._firestore);return this._mutations=this._mutations.concat(new If(t._key,kn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new de(re.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function lp(n,e){if((n=$t(n)).firestore!==e)throw new de(re.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function Lu(){return new Q0("serverTimestamp")}function fE(...n){return new Y0("arrayUnion",n)}function mE(...n){return new X0("arrayRemove",n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gE(n){return Bl(n=An(n,Gs)),new dE(n,(e=>ql(n,e)))}(function(e,t=!0){(function(a){Pl=a})(io),Ja(new Zi("firestore",((r,{instanceIdentifier:a,options:l})=>{const c=r.getProvider("app").getImmediate(),m=new Gs(new q4(r.getProvider("auth-internal")),new F4(c,r.getProvider("app-check-internal")),(function(y,_){if(!Object.prototype.hasOwnProperty.apply(y.options,["projectId"]))throw new de(re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Nl(y.options.projectId,_)})(c,a),c);return l={useFetchStreams:t,...l},m._setSettings(l),m}),"PUBLIC").setMultipleInstances(!0)),yr(u1,h1,e),yr(u1,h1,"esm2020")})();const pE=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:cE,Bytes:ss,CollectionReference:ei,DocumentReference:jt,DocumentSnapshot:Wi,FieldPath:lo,FieldValue:co,Firestore:Gs,FirestoreError:de,GeoPoint:Hs,Query:Sr,QueryCompositeFilterConstraint:Bf,QueryConstraint:zf,QueryDocumentSnapshot:iu,QueryFieldFilterConstraint:Vu,QueryLimitConstraint:$f,QueryOrderByConstraint:qf,QuerySnapshot:Ji,SnapshotMetadata:fl,Timestamp:_t,VectorValue:$s,WriteBatch:dE,_AutoId:bf,_ByteString:hn,_DatabaseId:Nl,_DocumentKey:xe,_EmptyAuthCredentialsProvider:Lx,_FieldPath:cn,_cast:An,_logWarn:eo,_validateIsNotUsedTogether:zx,addDoc:_u,arrayRemove:mE,arrayUnion:fE,collection:xt,connectFirestoreEmulator:X2,deleteDoc:ny,doc:qt,documentId:Pf,ensureFirestoreConfigured:Bl,executeWrite:ql,getDoc:vu,getDocs:bn,getFirestore:W2,limit:Wd,onSnapshot:vl,orderBy:Hf,query:Ht,serverTimestamp:Lu,setDoc:uE,updateDoc:pr,where:un,writeBatch:gE},Symbol.toStringTag,{value:"Module"}));var qC="firebase",HC="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yr(qC,HC,"app");function yE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const $C=yE,vE=new Cu("auth","Firebase",yE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd=new y0("@firebase/auth");function FC(n,...e){Jd.logLevel<=Qe.WARN&&Jd.warn(`Auth (${io}): ${n}`,...e)}function Dd(n,...e){Jd.logLevel<=Qe.ERROR&&Jd.error(`Auth (${io}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ks(n,...e){throw sy(n,...e)}function br(n,...e){return sy(n,...e)}function _E(n,e,t){const r={...$C(),[e]:t};return new Cu("auth","Firebase",r).create(e,{appName:n.name})}function ti(n){return _E(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function sy(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return vE.create(n,...e)}function Ne(n,e,...t){if(!n)throw sy(e,...t)}function Wr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Dd(e),new Error(e)}function ai(n,e){n||Wr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gp(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function GC(){return lw()==="http:"||lw()==="https:"}function lw(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(GC()||_N()||"connection"in navigator)?navigator.onLine:!0}function QC(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(e,t){this.shortDelay=e,this.longDelay=t,ai(t>e,"Short delay should be less than long delay!"),this.isMobile=pN()||bN()}get(){return KC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ry(n,e){ai(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bE{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Wr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Wr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Wr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],WC=new Uu(3e4,6e4);function la(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function ca(n,e,t,r,a={}){return wE(n,a,async()=>{let l={},c={};r&&(e==="GET"?c=r:l={body:JSON.stringify(r)});const m=Iu({key:n.config.apiKey,...c}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const y={method:e,headers:g,...l};return vN()||(y.referrerPolicy="no-referrer"),n.emulatorConfig&&ro(n.emulatorConfig.host)&&(y.credentials="include"),bE.fetch()(await xE(n,n.config.apiHost,t,m),y)})}async function wE(n,e,t){n._canInitEmulator=!1;const r={...YC,...e};try{const a=new ZC(n),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw pd(n,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const m=l.ok?c.errorMessage:c.error.message,[g,y]=m.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw pd(n,"credential-already-in-use",c);if(g==="EMAIL_EXISTS")throw pd(n,"email-already-in-use",c);if(g==="USER_DISABLED")throw pd(n,"user-disabled",c);const _=r[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw _E(n,_,y);Ks(n,_)}}catch(a){if(a instanceof Tr)throw a;Ks(n,"network-request-failed",{message:String(a)})}}async function zu(n,e,t,r,a={}){const l=await ca(n,e,t,r,a);return"mfaPendingCredential"in l&&Ks(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function xE(n,e,t,r){const a=`${e}${t}?${r}`,l=n,c=l.config.emulator?ry(n.config,a):`${n.config.apiScheme}://${a}`;return XC.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}function JC(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class ZC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(br(this.auth,"network-request-failed")),WC.get())})}}function pd(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const a=br(n,e,r);return a.customData._tokenResponse=t,a}function cw(n){return n!==void 0&&n.enterprise!==void 0}class e3{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return JC(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function t3(n,e){return ca(n,"GET","/v2/recaptchaConfig",la(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n3(n,e){return ca(n,"POST","/v1/accounts:delete",e)}async function Zd(n,e){return ca(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function au(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function s3(n,e=!1){const t=$t(n),r=await t.getIdToken(e),a=iy(r);Ne(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,c=l==null?void 0:l.sign_in_provider;return{claims:a,token:r,authTime:au(cp(a.auth_time)),issuedAtTime:au(cp(a.iat)),expirationTime:au(cp(a.exp)),signInProvider:c||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function cp(n){return Number(n)*1e3}function iy(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Dd("JWT malformed, contained fewer than 3 sections"),null;try{const a=_x(t);return a?JSON.parse(a):(Dd("Failed to decode base64 JWT payload"),null)}catch(a){return Dd("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function uw(n){const e=iy(n);return Ne(e,"internal-error"),Ne(typeof e.exp<"u","internal-error"),Ne(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bu(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Tr&&r3(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function r3({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i3{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=au(this.lastLoginAt),this.creationTime=au(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ef(n){var w;const e=n.auth,t=await n.getIdToken(),r=await bu(n,Zd(e,{idToken:t}));Ne(r==null?void 0:r.users.length,e,"internal-error");const a=r.users[0];n._notifyReloadListener(a);const l=(w=a.providerUserInfo)!=null&&w.length?EE(a.providerUserInfo):[],c=o3(n.providerData,l),m=n.isAnonymous,g=!(n.email&&a.passwordHash)&&!(c!=null&&c.length),y=m?g:!1,_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new Kp(a.createdAt,a.lastLoginAt),isAnonymous:y};Object.assign(n,_)}async function a3(n){const e=$t(n);await ef(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function o3(n,e){return[...n.filter(r=>!e.some(a=>a.providerId===r.providerId)),...e]}function EE(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l3(n,e){const t=await wE(n,{},async()=>{const r=Iu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=n.config,c=await xE(n,a,"/v1/token",`key=${l}`),m=await n._getAdditionalHeaders();m["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:m,body:r};return n.emulatorConfig&&ro(n.emulatorConfig.host)&&(g.credentials="include"),bE.fetch()(c,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function c3(n,e){return ca(n,"POST","/v2/accounts:revokeToken",la(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ne(e.idToken,"internal-error"),Ne(typeof e.idToken<"u","internal-error"),Ne(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):uw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ne(e.length!==0,"internal-error");const t=uw(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ne(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:a,expiresIn:l}=await l3(e,t);this.updateTokensAndExpiration(r,a,Number(l))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:a,expirationTime:l}=t,c=new _l;return r&&(Ne(typeof r=="string","internal-error",{appName:e}),c.refreshToken=r),a&&(Ne(typeof a=="string","internal-error",{appName:e}),c.accessToken=a),l&&(Ne(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new _l,this.toJSON())}_performRefresh(){return Wr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ui(n,e){Ne(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Bs{constructor({uid:e,auth:t,stsTokenManager:r,...a}){this.providerId="firebase",this.proactiveRefresh=new i3(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Kp(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await bu(this,this.stsTokenManager.getToken(this.auth,e));return Ne(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return s3(this,e)}reload(){return a3(this)}_assign(e){this!==e&&(Ne(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Bs({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ne(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await ef(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ns(this.auth.app))return Promise.reject(ti(this.auth));const e=await this.getIdToken();return await bu(this,n3(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,a=t.email??void 0,l=t.phoneNumber??void 0,c=t.photoURL??void 0,m=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,_=t.lastLoginAt??void 0,{uid:w,emailVerified:E,isAnonymous:S,providerData:N,stsTokenManager:M}=t;Ne(w&&M,e,"internal-error");const k=_l.fromJSON(this.name,M);Ne(typeof w=="string",e,"internal-error"),Ui(r,e.name),Ui(a,e.name),Ne(typeof E=="boolean",e,"internal-error"),Ne(typeof S=="boolean",e,"internal-error"),Ui(l,e.name),Ui(c,e.name),Ui(m,e.name),Ui(g,e.name),Ui(y,e.name),Ui(_,e.name);const V=new Bs({uid:w,auth:e,email:a,emailVerified:E,displayName:r,isAnonymous:S,photoURL:c,phoneNumber:l,tenantId:m,stsTokenManager:k,createdAt:y,lastLoginAt:_});return N&&Array.isArray(N)&&(V.providerData=N.map(F=>({...F}))),g&&(V._redirectEventId=g),V}static async _fromIdTokenResponse(e,t,r=!1){const a=new _l;a.updateFromServerResponse(t);const l=new Bs({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:r});return await ef(l),l}static async _fromGetAccountInfoResponse(e,t,r){const a=t.users[0];Ne(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?EE(a.providerUserInfo):[],c=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),m=new _l;m.updateFromIdToken(r);const g=new Bs({uid:a.localId,auth:e,stsTokenManager:m,isAnonymous:c}),y={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Kp(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(g,y),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hw=new Map;function Jr(n){ai(n instanceof Function,"Expected a class definition");let e=hw.get(n);return e?(ai(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,hw.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}TE.type="NONE";const dw=TE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Md(n,e,t){return`firebase:${n}:${e}:${t}`}class bl{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:a,name:l}=this.auth;this.fullUserKey=Md(this.userKey,a.apiKey,l),this.fullPersistenceKey=Md("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Zd(this.auth,{idToken:e}).catch(()=>{});return t?Bs._fromGetAccountInfoResponse(this.auth,t,e):null}return Bs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new bl(Jr(dw),e,r);const a=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let l=a[0]||Jr(dw);const c=Md(r,e.config.apiKey,e.name);let m=null;for(const y of t)try{const _=await y._get(c);if(_){let w;if(typeof _=="string"){const E=await Zd(e,{idToken:_}).catch(()=>{});if(!E)break;w=await Bs._fromGetAccountInfoResponse(e,E,_)}else w=Bs._fromJSON(e,_);y!==l&&(m=w),l=y;break}}catch{}const g=a.filter(y=>y._shouldAllowMigration);return!l._shouldAllowMigration||!g.length?new bl(l,e,r):(l=g[0],m&&await l._set(c,m.toJSON()),await Promise.all(t.map(async y=>{if(y!==l)try{await y._remove(c)}catch{}})),new bl(l,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fw(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(RE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(SE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(IE(e))return"Blackberry";if(jE(e))return"Webos";if(AE(e))return"Safari";if((e.includes("chrome/")||NE(e))&&!e.includes("edge/"))return"Chrome";if(CE(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function SE(n=Nn()){return/firefox\//i.test(n)}function AE(n=Nn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function NE(n=Nn()){return/crios\//i.test(n)}function RE(n=Nn()){return/iemobile/i.test(n)}function CE(n=Nn()){return/android/i.test(n)}function IE(n=Nn()){return/blackberry/i.test(n)}function jE(n=Nn()){return/webos/i.test(n)}function ay(n=Nn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function u3(n=Nn()){var e;return ay(n)&&!!((e=window.navigator)!=null&&e.standalone)}function h3(){return wN()&&document.documentMode===10}function kE(n=Nn()){return ay(n)||CE(n)||jE(n)||IE(n)||/windows phone/i.test(n)||RE(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OE(n,e=[]){let t;switch(n){case"Browser":t=fw(Nn());break;case"Worker":t=`${fw(Nn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${io}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d3{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=l=>new Promise((c,m)=>{try{const g=e(l);c(g)}catch(g){m(g)}});r.onAbort=t,this.queue.push(r);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f3(n,e={}){return ca(n,"GET","/v2/passwordPolicy",la(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m3=6;class g3{constructor(e){var r;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??m3,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let a=0;a<e.length;a++)r=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p3{constructor(e,t,r,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new mw(this),this.idTokenSubscription=new mw(this),this.beforeStateQueue=new d3(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=vE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Jr(t)),this._initializationPromise=this.queue(async()=>{var r,a,l;if(!this._deleted&&(this.persistenceManager=await bl.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((a=this._popupRedirectResolver)!=null&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)==null?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Zd(this,{idToken:e}),r=await Bs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var l;if(ns(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(m=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(m,m))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(l=this.redirectUser)==null?void 0:l._redirectEventId,m=r==null?void 0:r._redirectEventId,g=await this.tryRedirectSignIn(e);(!c||c===m)&&(g!=null&&g.user)&&(r=g.user,a=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(r)}catch(c){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ne(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ef(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=QC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ns(this.app))return Promise.reject(ti(this));const t=e?$t(e):null;return t&&Ne(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ne(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ns(this.app)?Promise.reject(ti(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ns(this.app)?Promise.reject(ti(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Jr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await f3(this),t=new g3(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Cu("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await c3(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Jr(e)||this._popupRedirectResolver;Ne(t,this,"argument-error"),this.redirectPersistenceManager=await bl.create(this,[Jr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let c=!1;const m=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ne(m,this,"internal-error"),m.then(()=>{c||l(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,r,a);return()=>{c=!0,g()}}else{const g=e.addObserver(t);return()=>{c=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ne(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=OE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var a;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((a=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:a.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;if(ns(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&FC(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function ho(n){return $t(n)}class mw{constructor(e){this.auth=e,this.observer=null,this.addObserver=CN(t=>this.observer=t)}get next(){return Ne(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ff={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function y3(n){Ff=n}function DE(n){return Ff.loadJS(n)}function v3(){return Ff.recaptchaEnterpriseScript}function _3(){return Ff.gapiScript}function b3(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class w3{constructor(){this.enterprise=new x3}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class x3{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const E3="recaptcha-enterprise",ME="NO_RECAPTCHA";class T3{constructor(e){this.type=E3,this.auth=ho(e)}async verify(e="verify",t=!1){async function r(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(c,m)=>{t3(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)m(new Error("recaptcha Enterprise site key undefined"));else{const y=new e3(g);return l.tenantId==null?l._agentRecaptchaConfig=y:l._tenantRecaptchaConfigs[l.tenantId]=y,c(y.siteKey)}}).catch(g=>{m(g)})})}function a(l,c,m){const g=window.grecaptcha;cw(g)?g.enterprise.ready(()=>{g.enterprise.execute(l,{action:e}).then(y=>{c(y)}).catch(()=>{c(ME)})}):m(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new w3().execute("siteKey",{action:"verify"}):new Promise((l,c)=>{r(this.auth).then(m=>{if(!t&&cw(window.grecaptcha))a(m,l,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let g=v3();g.length!==0&&(g+=m),DE(g).then(()=>{a(m,l,c)}).catch(y=>{c(y)})}}).catch(m=>{c(m)})})}}async function gw(n,e,t,r=!1,a=!1){const l=new T3(n);let c;if(a)c=ME;else try{c=await l.verify(t)}catch{c=await l.verify(t,!0)}const m={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in m){const g=m.phoneEnrollmentInfo.phoneNumber,y=m.phoneEnrollmentInfo.recaptchaToken;Object.assign(m,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in m){const g=m.phoneSignInInfo.recaptchaToken;Object.assign(m,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return m}return r?Object.assign(m,{captchaResp:c}):Object.assign(m,{captchaResponse:c}),Object.assign(m,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(m,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),m}async function Qp(n,e,t,r,a){var l;if((l=n._getRecaptchaConfig())!=null&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await gw(n,e,t,t==="getOobCode");return r(n,c)}else return r(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const m=await gw(n,e,t,t==="getOobCode");return r(n,m)}else return Promise.reject(c)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S3(n,e){const t=vf(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(ni(l,e??{}))return a;Ks(a,"already-initialized")}return t.initialize({options:e})}function A3(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Jr);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function N3(n,e,t){const r=ho(n);Ne(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const a=!1,l=PE(e),{host:c,port:m}=R3(e),g=m===null?"":`:${m}`,y={url:`${l}//${c}${g}/`},_=Object.freeze({host:c,port:m,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!r._canInitEmulator){Ne(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ne(ni(y,r.config.emulator)&&ni(_,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=y,r.emulatorConfig=_,r.settings.appVerificationDisabledForTesting=!0,ro(c)?(g0(`${l}//${c}${g}`),p0("Auth",!0)):C3()}function PE(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function R3(n){const e=PE(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const l=a[1];return{host:l,port:pw(r.substr(l.length+1))}}else{const[l,c]=r.split(":");return{host:l,port:pw(c)}}}function pw(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function C3(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Wr("not implemented")}_getIdTokenResponse(e){return Wr("not implemented")}_linkToIdToken(e,t){return Wr("not implemented")}_getReauthenticationResolver(e){return Wr("not implemented")}}async function I3(n,e){return ca(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j3(n,e){return zu(n,"POST","/v1/accounts:signInWithPassword",la(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k3(n,e){return zu(n,"POST","/v1/accounts:signInWithEmailLink",la(n,e))}async function O3(n,e){return zu(n,"POST","/v1/accounts:signInWithEmailLink",la(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu extends oy{constructor(e,t,r,a=null){super("password",r),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new wu(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new wu(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Qp(e,t,"signInWithPassword",j3);case"emailLink":return k3(e,{email:this._email,oobCode:this._password});default:Ks(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Qp(e,r,"signUpPassword",I3);case"emailLink":return O3(e,{idToken:t,email:this._email,oobCode:this._password});default:Ks(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wl(n,e){return zu(n,"POST","/v1/accounts:signInWithIdp",la(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D3="http://localhost";class no extends oy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new no(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ks("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a,...l}=t;if(!r||!a)return null;const c=new no(r,a);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return wl(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,wl(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,wl(e,t)}buildRequest(){const e={requestUri:D3,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Iu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M3(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function P3(n){const e=Kc(Qc(n)).link,t=e?Kc(Qc(e)).deep_link_id:null,r=Kc(Qc(n)).deep_link_id;return(r?Kc(Qc(r)).link:null)||r||t||e||n}class ly{constructor(e){const t=Kc(Qc(e)),r=t.apiKey??null,a=t.oobCode??null,l=M3(t.mode??null);Ne(r&&a&&l,"argument-error"),this.apiKey=r,this.operation=l,this.code=a,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=P3(e);try{return new ly(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(){this.providerId=Hl.PROVIDER_ID}static credential(e,t){return wu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=ly.parseLink(t);return Ne(r,"argument-error"),wu._fromEmailAndCode(e,r.code,r.tenantId)}}Hl.PROVIDER_ID="password";Hl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Hl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu extends VE{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi extends Bu{constructor(){super("facebook.com")}static credential(e){return no._fromParams({providerId:Bi.PROVIDER_ID,signInMethod:Bi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bi.credentialFromTaggedObject(e)}static credentialFromError(e){return Bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bi.credential(e.oauthAccessToken)}catch{return null}}}Bi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Bi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi extends Bu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return no._fromParams({providerId:qi.PROVIDER_ID,signInMethod:qi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return qi.credentialFromTaggedObject(e)}static credentialFromError(e){return qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return qi.credential(t,r)}catch{return null}}}qi.GOOGLE_SIGN_IN_METHOD="google.com";qi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi extends Bu{constructor(){super("github.com")}static credential(e){return no._fromParams({providerId:Hi.PROVIDER_ID,signInMethod:Hi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Hi.credentialFromTaggedObject(e)}static credentialFromError(e){return Hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Hi.credential(e.oauthAccessToken)}catch{return null}}}Hi.GITHUB_SIGN_IN_METHOD="github.com";Hi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i extends Bu{constructor(){super("twitter.com")}static credential(e,t){return no._fromParams({providerId:$i.PROVIDER_ID,signInMethod:$i.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return $i.credentialFromTaggedObject(e)}static credentialFromError(e){return $i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return $i.credential(t,r)}catch{return null}}}$i.TWITTER_SIGN_IN_METHOD="twitter.com";$i.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V3(n,e){return zu(n,"POST","/v1/accounts:signUp",la(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,a=!1){const l=await Bs._fromIdTokenResponse(e,r,a),c=yw(r);return new so({user:l,providerId:c,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const a=yw(r);return new so({user:e,providerId:a,_tokenResponse:r,operationType:t})}}function yw(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf extends Tr{constructor(e,t,r,a){super(t.code,t.message),this.operationType=r,this.user=a,Object.setPrototypeOf(this,tf.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,a){return new tf(e,t,r,a)}}function LE(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?tf._fromErrorAndOperation(n,l,e,r):l})}async function L3(n,e,t=!1){const r=await bu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return so._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U3(n,e,t=!1){const{auth:r}=n;if(ns(r.app))return Promise.reject(ti(r));const a="reauthenticate";try{const l=await bu(n,LE(r,a,e,n),t);Ne(l.idToken,r,"internal-error");const c=iy(l.idToken);Ne(c,r,"internal-error");const{sub:m}=c;return Ne(n.uid===m,r,"user-mismatch"),so._forOperation(n,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&Ks(r,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UE(n,e,t=!1){if(ns(n.app))return Promise.reject(ti(n));const r="signIn",a=await LE(n,r,e),l=await so._fromIdTokenResponse(n,r,a);return t||await n._updateCurrentUser(l.user),l}async function z3(n,e){return UE(ho(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zE(n){const e=ho(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function B3(n,e,t){if(ns(n.app))return Promise.reject(ti(n));const r=ho(n),c=await Qp(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",V3).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&zE(n),g}),m=await so._fromIdTokenResponse(r,"signIn",c);return await r._updateCurrentUser(m.user),m}function q3(n,e,t){return ns(n.app)?Promise.reject(ti(n)):z3($t(n),Hl.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&zE(n),r})}function H3(n,e,t,r){return $t(n).onIdTokenChanged(e,t,r)}function $3(n,e,t){return $t(n).beforeAuthStateChanged(e,t)}function F3(n,e,t,r){return $t(n).onAuthStateChanged(e,t,r)}const nf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(nf,"1"),this.storage.removeItem(nf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G3=1e3,K3=10;class qE extends BE{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=kE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),a=this.localCache[t];r!==a&&e(t,a,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,m,g)=>{this.notifyListeners(c,g)});return}const r=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const c=this.storage.getItem(r);!t&&this.localCache[r]===c||this.notifyListeners(r,c)},l=this.storage.getItem(r);h3()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,K3):a()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},G3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}qE.type="LOCAL";const Q3=qE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE extends BE{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}HE.type="SESSION";const $E=HE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y3(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const r=new Gf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:a,data:l}=t.data,c=this.handlersMap[a];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:a});const m=Array.from(c).map(async y=>y(t.origin,l)),g=await Y3(m);t.ports[0].postMessage({status:"done",eventId:r,eventType:a,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Gf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cy(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X3{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,c;return new Promise((m,g)=>{const y=cy("",20);a.port1.start();const _=setTimeout(()=>{g(new Error("unsupported_event"))},r);c={messageChannel:a,onMessage(w){const E=w;if(E.data.eventId===y)switch(E.data.status){case"ack":clearTimeout(_),l=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),m(E.data.response);break;default:clearTimeout(_),clearTimeout(l),g(new Error("invalid_response"));break}}},this.handlers.add(c),a.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[a.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wr(){return window}function W3(n){wr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FE(){return typeof wr().WorkerGlobalScope<"u"&&typeof wr().importScripts=="function"}async function J3(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Z3(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function eI(){return FE()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GE="firebaseLocalStorageDb",tI=1,sf="firebaseLocalStorage",KE="fbase_key";class qu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Kf(n,e){return n.transaction([sf],e?"readwrite":"readonly").objectStore(sf)}function nI(){const n=indexedDB.deleteDatabase(GE);return new qu(n).toPromise()}function Yp(){const n=indexedDB.open(GE,tI);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(sf,{keyPath:KE})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(sf)?e(r):(r.close(),await nI(),e(await Yp()))})})}async function vw(n,e,t){const r=Kf(n,!0).put({[KE]:e,value:t});return new qu(r).toPromise()}async function sI(n,e){const t=Kf(n,!1).get(e),r=await new qu(t).toPromise();return r===void 0?null:r.value}function _w(n,e){const t=Kf(n,!0).delete(e);return new qu(t).toPromise()}const rI=800,iI=3;class QE{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Yp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>iI)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return FE()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Gf._getInstance(eI()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await J3(),!this.activeServiceWorker)return;this.sender=new X3(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Z3()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Yp();return await vw(e,nf,"1"),await _w(e,nf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>vw(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>sI(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>_w(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=Kf(a,!1).getAll();return new qu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)r.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!r.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),rI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}QE.type="LOCAL";const aI=QE;new Uu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oI(n,e){return e?Jr(e):(Ne(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uy extends oy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return wl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return wl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return wl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function lI(n){return UE(n.auth,new uy(n),n.bypassAuthState)}function cI(n){const{auth:e,user:t}=n;return Ne(t,e,"internal-error"),U3(t,new uy(n),n.bypassAuthState)}async function uI(n){const{auth:e,user:t}=n;return Ne(t,e,"internal-error"),L3(t,new uy(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YE{constructor(e,t,r,a,l=!1){this.auth=e,this.resolver=r,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:a,tenantId:l,error:c,type:m}=e;if(c){this.reject(c);return}const g={auth:this.auth,requestUri:t,sessionId:r,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(m)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return lI;case"linkViaPopup":case"linkViaRedirect":return uI;case"reauthViaPopup":case"reauthViaRedirect":return cI;default:Ks(this.auth,"internal-error")}}resolve(e){ai(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ai(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hI=new Uu(2e3,1e4);class ml extends YE{constructor(e,t,r,a,l){super(e,t,a,l),this.provider=r,this.authWindow=null,this.pollId=null,ml.currentPopupAction&&ml.currentPopupAction.cancel(),ml.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ne(e,this.auth,"internal-error"),e}async onExecution(){ai(this.filter.length===1,"Popup operations only handle one event");const e=cy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(br(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(br(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ml.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if((r=(t=this.authWindow)==null?void 0:t.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(br(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,hI.get())};e()}}ml.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dI="pendingRedirect",Pd=new Map;class fI extends YE{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Pd.get(this.auth._key());if(!e){try{const r=await mI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Pd.set(this.auth._key(),e)}return this.bypassAuthState||Pd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function mI(n,e){const t=yI(e),r=pI(n);if(!await r._isAvailable())return!1;const a=await r._get(t)==="true";return await r._remove(t),a}function gI(n,e){Pd.set(n._key(),e)}function pI(n){return Jr(n._redirectPersistence)}function yI(n){return Md(dI,n.config.apiKey,n.name)}async function vI(n,e,t=!1){if(ns(n.app))return Promise.reject(ti(n));const r=ho(n),a=oI(r,e),c=await new fI(r,a,t).execute();return c&&!t&&(delete c.user._redirectEventId,await r._persistUserIfCurrent(c.user),await r._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I=600*1e3;class bI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!wI(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!XE(e)){const a=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";t.onError(br(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=_I&&this.cachedEventUids.clear(),this.cachedEventUids.has(bw(e))}saveEventToCache(e){this.cachedEventUids.add(bw(e)),this.lastProcessedEventTime=Date.now()}}function bw(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function XE({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function wI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return XE(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xI(n,e={}){return ca(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,TI=/^https?/;async function SI(n){if(n.config.emulator)return;const{authorizedDomains:e}=await xI(n);for(const t of e)try{if(AI(t))return}catch{}Ks(n,"unauthorized-domain")}function AI(n){const e=Gp(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===r}if(!TI.test(t))return!1;if(EI.test(n))return r===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NI=new Uu(3e4,6e4);function ww(){const n=wr().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function RI(n){return new Promise((e,t)=>{var a,l,c;function r(){ww(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ww(),t(br(n,"network-request-failed"))},timeout:NI.get()})}if((l=(a=wr().gapi)==null?void 0:a.iframes)!=null&&l.Iframe)e(gapi.iframes.getContext());else if((c=wr().gapi)!=null&&c.load)r();else{const m=b3("iframefcb");return wr()[m]=()=>{gapi.load?r():t(br(n,"network-request-failed"))},DE(`${_3()}?onload=${m}`).catch(g=>t(g))}}).catch(e=>{throw Vd=null,e})}let Vd=null;function CI(n){return Vd=Vd||RI(n),Vd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const II=new Uu(5e3,15e3),jI="__/auth/iframe",kI="emulator/auth/iframe",OI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},DI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function MI(n){const e=n.config;Ne(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?ry(e,kI):`https://${n.config.authDomain}/${jI}`,r={apiKey:e.apiKey,appName:n.name,v:io},a=DI.get(n.config.apiHost);a&&(r.eid=a);const l=n._getFrameworks();return l.length&&(r.fw=l.join(",")),`${t}?${Iu(r).slice(1)}`}async function PI(n){const e=await CI(n),t=wr().gapi;return Ne(t,n,"internal-error"),e.open({where:document.body,url:MI(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:OI,dontclear:!0},r=>new Promise(async(a,l)=>{await r.restyle({setHideOnLeave:!1});const c=br(n,"network-request-failed"),m=wr().setTimeout(()=>{l(c)},II.get());function g(){wr().clearTimeout(m),a(r)}r.ping(g).then(g,()=>{l(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},LI=500,UI=600,zI="_blank",BI="http://localhost";class xw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function qI(n,e,t,r=LI,a=UI){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),c=Math.max((window.screen.availWidth-r)/2,0).toString();let m="";const g={...VI,width:r.toString(),height:a.toString(),top:l,left:c},y=Nn().toLowerCase();t&&(m=NE(y)?zI:t),SE(y)&&(e=e||BI,g.scrollbars="yes");const _=Object.entries(g).reduce((E,[S,N])=>`${E}${S}=${N},`,"");if(u3(y)&&m!=="_self")return HI(e||"",m),new xw(null);const w=window.open(e||"",m,_);Ne(w,n,"popup-blocked");try{w.focus()}catch{}return new xw(w)}function HI(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $I="__/auth/handler",FI="emulator/auth/handler",GI=encodeURIComponent("fac");async function Ew(n,e,t,r,a,l){Ne(n.config.authDomain,n,"auth-domain-config-required"),Ne(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:io,eventId:a};if(e instanceof VE){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",RN(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,w]of Object.entries({}))c[_]=w}if(e instanceof Bu){const _=e.getScopes().filter(w=>w!=="");_.length>0&&(c.scopes=_.join(","))}n.tenantId&&(c.tid=n.tenantId);const m=c;for(const _ of Object.keys(m))m[_]===void 0&&delete m[_];const g=await n._getAppCheckToken(),y=g?`#${GI}=${encodeURIComponent(g)}`:"";return`${KI(n)}?${Iu(m).slice(1)}${y}`}function KI({config:n}){return n.emulator?ry(n,FI):`https://${n.authDomain}/${$I}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const up="webStorageSupport";class QI{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=$E,this._completeRedirectFn=vI,this._overrideRedirectResult=gI}async _openPopup(e,t,r,a){var c;ai((c=this.eventManagers[e._key()])==null?void 0:c.manager,"_initialize() not called before _openPopup()");const l=await Ew(e,t,r,Gp(),a);return qI(e,l,cy())}async _openRedirect(e,t,r,a){await this._originValidation(e);const l=await Ew(e,t,r,Gp(),a);return W3(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(ai(l,"If manager is not set, promise should be"),l)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await PI(e),r=new bI(e);return t.register("authEvent",a=>(Ne(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:r.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(up,{type:up},a=>{var c;const l=(c=a==null?void 0:a[0])==null?void 0:c[up];l!==void 0&&t(!!l),Ks(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=SI(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return kE()||AE()||ay()}}const YI=QI;var Tw="@firebase/auth",Sw="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ne(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function JI(n){Ja(new Zi("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:m}=r.options;Ne(c&&!c.includes(":"),"invalid-api-key",{appName:r.name});const g={apiKey:c,authDomain:m,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:OE(n)},y=new p3(r,a,l,g);return A3(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Ja(new Zi("auth-internal",e=>{const t=ho(e.getProvider("auth").getImmediate());return(r=>new XI(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),yr(Tw,Sw,WI(n)),yr(Tw,Sw,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZI=300,e6=Ex("authIdTokenMaxAge")||ZI;let Aw=null;const t6=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>e6)return;const a=t==null?void 0:t.token;Aw!==a&&(Aw=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function n6(n=_f()){const e=vf(n,"auth");if(e.isInitialized())return e.getImmediate();const t=S3(n,{popupRedirectResolver:YI,persistence:[aI,Q3,$E]}),r=Ex("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(r,location.origin);if(location.origin===l.origin){const c=t6(l.toString());$3(t,c,()=>c(t.currentUser)),H3(t,m=>c(m))}}const a=bx("auth");return a&&N3(t,`http://${a}`),t}function s6(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}y3({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=a=>{const l=br("internal-error");l.customData=a,t(l)},r.type="text/javascript",r.charset="UTF-8",s6().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});JI("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WE="firebasestorage.googleapis.com",r6="storageBucket",i6=120*1e3,a6=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ua=class JE extends Tr{constructor(e,t,r=0){super(hp(e),`Firebase Storage: ${t} (${hp(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,JE.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return hp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}};var Er;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Er||(Er={}));function hp(n){return"storage/"+n}function o6(){const n="An unknown error occurred, please check the error payload for server response.";return new ua(Er.UNKNOWN,n)}function l6(){return new ua(Er.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function c6(){return new ua(Er.CANCELED,"User canceled the upload/download.")}function u6(n){return new ua(Er.INVALID_URL,"Invalid URL '"+n+"'.")}function h6(n){return new ua(Er.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Nw(n){return new ua(Er.INVALID_ARGUMENT,n)}function ZE(){return new ua(Er.APP_DELETED,"The Firebase app was deleted.")}function d6(n){return new ua(Er.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=qs.makeFromUrl(e,t)}catch{return new qs(e,"")}if(r.path==="")return r;throw h6(e)}static makeFromUrl(e,t){let r=null;const a="([A-Za-z0-9.\\-_]+)";function l(te){te.path.charAt(te.path.length-1)==="/"&&(te.path_=te.path_.slice(0,-1))}const c="(/(.*))?$",m=new RegExp("^gs://"+a+c,"i"),g={bucket:1,path:3};function y(te){te.path_=decodeURIComponent(te.path)}const _="v[A-Za-z0-9_]+",w=t.replace(/[.]/g,"\\."),E="(/([^?#]*).*)?$",S=new RegExp(`^https?://${w}/${_}/b/${a}/o${E}`,"i"),N={bucket:1,path:3},M=t===WE?"(?:storage.googleapis.com|storage.cloud.google.com)":t,k="([^?#]*)",V=new RegExp(`^https?://${M}/${a}/${k}`,"i"),$=[{regex:m,indices:g,postModify:l},{regex:S,indices:N,postModify:y},{regex:V,indices:{bucket:1,path:2},postModify:y}];for(let te=0;te<$.length;te++){const ue=$[te],le=ue.regex.exec(e);if(le){const I=le[ue.indices.bucket];let C=le[ue.indices.path];C||(C=""),r=new qs(I,C),ue.postModify(r);break}}if(r==null)throw u6(e);return r}}class f6{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m6(n,e,t){let r=1,a=null,l=null,c=!1,m=0;function g(){return m===2}let y=!1;function _(...k){y||(y=!0,e.apply(null,k))}function w(k){a=setTimeout(()=>{a=null,n(S,g())},k)}function E(){l&&clearTimeout(l)}function S(k,...V){if(y){E();return}if(k){E(),_.call(null,k,...V);return}if(g()||c){E(),_.call(null,k,...V);return}r<64&&(r*=2);let $;m===1?(m=2,$=0):$=(r+Math.random())*1e3,w($)}let N=!1;function M(k){N||(N=!0,E(),!y&&(a!==null?(k||(m=2),clearTimeout(a),w(0)):k||(m=1)))}return w(0),l=setTimeout(()=>{c=!0,M(!0)},t),M}function g6(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p6(n){return n!==void 0}function Rw(n,e,t,r){if(r<e)throw Nw(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Nw(`Invalid value for '${n}'. Expected ${t} or less.`)}function y6(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const a=e(r)+"="+e(n[r]);t=t+a+"&"}return t=t.slice(0,-1),t}var rf;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(rf||(rf={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v6(n,e){const t=n>=500&&n<600,a=[408,429].indexOf(n)!==-1,l=e.indexOf(n)!==-1;return t||a||l}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _6{constructor(e,t,r,a,l,c,m,g,y,_,w,E=!0,S=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=a,this.successCodes_=l,this.additionalRetryCodes_=c,this.callback_=m,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=_,this.connectionFactory_=w,this.retry=E,this.isUsingEmulator=S,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((N,M)=>{this.resolve_=N,this.reject_=M,this.start_()})}start_(){const e=(r,a)=>{if(a){r(!1,new yd(!1,null,!0));return}const l=this.connectionFactory_();this.pendingConnection_=l;const c=m=>{const g=m.loaded,y=m.lengthComputable?m.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&l.addUploadProgressListener(c),l.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&l.removeUploadProgressListener(c),this.pendingConnection_=null;const m=l.getErrorCode()===rf.NO_ERROR,g=l.getStatus();if(!m||v6(g,this.additionalRetryCodes_)&&this.retry){const _=l.getErrorCode()===rf.ABORT;r(!1,new yd(!1,null,_));return}const y=this.successCodes_.indexOf(g)!==-1;r(!0,new yd(y,l))})},t=(r,a)=>{const l=this.resolve_,c=this.reject_,m=a.connection;if(a.wasSuccessCode)try{const g=this.callback_(m,m.getResponse());p6(g)?l(g):l()}catch(g){c(g)}else if(m!==null){const g=o6();g.serverResponse=m.getErrorText(),this.errorCallback_?c(this.errorCallback_(m,g)):c(g)}else if(a.canceled){const g=this.appDelete_?ZE():c6();c(g)}else{const g=l6();c(g)}};this.canceled_?t(!1,new yd(!1,null,!0)):this.backoffId_=m6(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&g6(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class yd{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function b6(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function w6(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function x6(n,e){e&&(n["X-Firebase-GMPID"]=e)}function E6(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function T6(n,e,t,r,a,l,c=!0,m=!1){const g=y6(n.urlParams),y=n.url+g,_=Object.assign({},n.headers);return x6(_,e),b6(_,t),w6(_,l),E6(_,r),new _6(y,n.method,_,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,a,c,m)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S6(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function A6(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af{constructor(e,t){this._service=e,t instanceof qs?this._location=t:this._location=qs.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new af(e,t)}get root(){const e=new qs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return A6(this._location.path)}get storage(){return this._service}get parent(){const e=S6(this._location.path);if(e===null)return null;const t=new qs(this._location.bucket,e);return new af(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw d6(e)}}function Cw(n,e){const t=e==null?void 0:e[r6];return t==null?null:qs.makeFromBucketSpec(t,n)}function N6(n,e,t,r={}){n.host=`${e}:${t}`;const a=ro(e);a&&(g0(`https://${n.host}/b`),p0("Storage",!0)),n._isUsingEmulator=!0,n._protocol=a?"https":"http";const{mockUserToken:l}=r;l&&(n._overrideAuthToken=typeof l=="string"?l:Tx(l,n.app.options.projectId))}class R6{constructor(e,t,r,a,l,c=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=a,this._firebaseVersion=l,this._isUsingEmulator=c,this._bucket=null,this._host=WE,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=i6,this._maxUploadRetryTime=a6,this._requests=new Set,a!=null?this._bucket=qs.makeFromBucketSpec(a,this._host):this._bucket=Cw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=qs.makeFromBucketSpec(this._url,e):this._bucket=Cw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Rw("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Rw("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(ns(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new af(this,e)}_makeRequest(e,t,r,a,l=!0){if(this._deleted)return new f6(ZE());{const c=T6(e,this._appId,r,a,t,this._firebaseVersion,l,this._isUsingEmulator);return this._requests.add(c),c.getPromise().then(()=>this._requests.delete(c),()=>this._requests.delete(c)),c}}async makeRequestWithTokens(e,t){const[r,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,a).getPromise()}}const Iw="@firebase/storage",jw="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eT="storage";function C6(n=_f(),e){n=$t(n);const r=vf(n,eT).getImmediate({identifier:e}),a=wx("storage");return a&&I6(r,...a),r}function I6(n,e,t,r={}){N6(n,e,t,r)}function j6(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),a=n.getProvider("app-check-internal");return new R6(t,r,a,e,io)}function k6(){Ja(new Zi(eT,j6,"PUBLIC").setMultipleInstances(!0)),yr(Iw,jw,""),yr(Iw,jw,"esm2020")}k6();const O6={apiKey:"AIzaSyDll7h-FpzCVml2vy8KeMPA6xExGUda_NE",authDomain:"thi-tnd.firebaseapp.com",projectId:"thi-tnd",storageBucket:"thi-tnd.firebasestorage.app",messagingSenderId:"107125875663",appId:"1:107125875663:web:0e1a632779f51340c828ba",databaseURL:"https://thi-tnd-default-rtdb.asia-southeast1.firebasedatabase.app"},Qf=I4().length?_f():Nx(O6),xu=n6(Qf),ke=W2(Qf);C6(Qf);const D6=Object.freeze(Object.defineProperty({__proto__:null,app:Qf,auth:xu,db:ke},Symbol.toStringTag,{value:"Module"})),tT=async(n,e,t,r,a,l,c,m)=>{try{const g={title:n,message:e,type:t,targetType:r,targetId:a,senderId:l,senderName:c||"H thng",createdAt:Lu(),expiryDate:m?_t.fromDate(m):null,read:!1,readBy:[],deletedBy:[]};if(r==="user"&&a)await _u(xt(ke,"users",a,"notifications"),g),console.log(`Notification sent to user ${a}`);else if(r==="class"&&a){let y=new Map;const _=Ht(xt(ke,"courses"),un("name","==",a)),w=await bn(_);let E=null,S=a;if(!w.empty)E=w.docs[0].id;else{const k=qt(ke,"courses",a),V=await bn(Ht(xt(ke,"courses"),un(Pf(),"==",a)));V.empty||(E=a,S=V.docs[0].data().name)}console.log(`Resolved Class Target: ID=${E}, Name=${S}`);const N=[];if(S&&(N.push(bn(Ht(xt(ke,"users"),un("courseName","==",S)))),N.push(bn(Ht(xt(ke,"users"),un("class","==",S))))),E&&N.push(bn(Ht(xt(ke,"users"),un("courseId","==",E)))),(await Promise.all(N)).forEach(k=>{k.docs.forEach(V=>{y.set(V.id,V.id)})}),y.size===0)console.log("No students found for this class.");else{const k=gE(ke);let V=0;y.forEach(F=>{const $=qt(xt(ke,"users",F,"notifications"));k.set($,g),V++}),await k.commit(),console.log(`Notification sent to ${y.size} students in class ${S}`)}}await _u(xt(ke,"notifications"),g),console.log("Master notification record created.")}catch(g){throw console.error("Error sending notification:",g),g}},M6=async(n,e)=>{try{const t=[],r=Ht(xt(ke,"notifications"),un("targetType","==","all"),Wd(20)),a=Ht(xt(ke,"users",n,"notifications"),Hf("createdAt","desc"),Wd(20));try{(await bn(r)).docs.forEach(m=>{var _;const g=m.data(),y=((_=g.readBy)==null?void 0:_.includes(n))||!1;t.push({id:m.id,...g,read:y})})}catch(c){console.warn("Retrying global fetch without constraints due to error:",c)}try{(await bn(a)).docs.forEach(m=>{t.push({id:m.id,...m.data()})})}catch(c){console.error("Error fetching personal notifications:",c)}return t.sort((c,m)=>{var _,w;const g=((_=c.createdAt)==null?void 0:_.seconds)||0;return(((w=m.createdAt)==null?void 0:w.seconds)||0)-g}).filter(c=>{var m;return!((m=c.deletedBy)!=null&&m.includes(n))})}catch(t){return console.error("Error fetching notifications:",t),[]}},P6=async(n,e)=>{try{const t=qt(ke,"notifications",n),{arrayUnion:r}=await Ls(async()=>{const{arrayUnion:l}=await Promise.resolve().then(()=>pE);return{arrayUnion:l}},void 0);try{await pr(t,{deletedBy:r(e)});return}catch{}const a=qt(ke,"users",e,"notifications",n);await pr(a,{deletedBy:r(e)})}catch{}},nT=async()=>{try{const n=_t.now(),e=Ht(xt(ke,"notifications"),un("targetType","==","all"),Wd(20)),t=await bn(e),r=[];return t.forEach(a=>{const l=a.data();(l.type==="special"||l.type==="attention")&&(l.expiryDate&&l.expiryDate.seconds?l.expiryDate.seconds>n.seconds&&r.push({id:a.id,...l}):r.push({id:a.id,...l}))}),r}catch(n){return console.error("Error fetching marquee:",n),[]}},V6=async()=>{try{const n=Ht(xt(ke,"notifications"),Hf("createdAt","desc"));return(await bn(n)).docs.map(t=>({id:t.id,...t.data()}))}catch(n){return console.error("Error fetching all notifications:",n),[]}},L6=async n=>{try{return await ny(qt(ke,"notifications",n)),!0}catch(e){return console.error("Error deleting notification:",e),!1}};var sT={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},kw=Ki.createContext&&Ki.createContext(sT),U6=["attr","size","title"];function z6(n,e){if(n==null)return{};var t=B6(n,e),r,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);for(a=0;a<l.length;a++)r=l[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function B6(n,e){if(n==null)return{};var t={};for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){if(e.indexOf(r)>=0)continue;t[r]=n[r]}return t}function of(){return of=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},of.apply(this,arguments)}function Ow(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function lf(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ow(Object(t),!0).forEach(function(r){q6(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Ow(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function q6(n,e,t){return e=H6(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function H6(n){var e=$6(n,"string");return typeof e=="symbol"?e:e+""}function $6(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function rT(n){return n&&n.map((e,t)=>Ki.createElement(e.tag,lf({key:t},e.attr),rT(e.child)))}function ut(n){return e=>Ki.createElement(F6,of({attr:lf({},n.attr)},e),rT(n.child))}function F6(n){var e=t=>{var{attr:r,size:a,title:l}=n,c=z6(n,U6),m=a||t.size||"1em",g;return t.className&&(g=t.className),n.className&&(g=(g?g+" ":"")+n.className),Ki.createElement("svg",of({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,c,{className:g,style:lf(lf({color:n.color||t.color},t.style),n.style),height:m,width:m,xmlns:"http://www.w3.org/2000/svg"}),l&&Ki.createElement("title",null,l),n.children)};return kw!==void 0?Ki.createElement(kw.Consumer,null,t=>e(t)):e(sT)}function cf(n){return ut({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"},child:[]}]})(n)}function G6(n){return ut({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.034 8 8 119.033 8 256s111.034 248 248 248 248-111.034 248-248S392.967 8 256 8zm130.108 117.892c65.448 65.448 70 165.481 20.677 235.637L150.47 105.216c70.204-49.356 170.226-44.735 235.638 20.676zM125.892 386.108c-65.448-65.448-70-165.481-20.677-235.637L361.53 406.784c-70.203 49.356-170.226 44.736-235.638-20.676z"},child:[]}]})(n)}function Eu(n){return ut({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 512c35.32 0 63.97-28.65 63.97-64H160.03c0 35.35 28.65 64 63.97 64zm215.39-149.71c-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84C118.56 68.1 64.08 130.3 64.08 208c0 102.3-36.15 133.53-55.47 154.29-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h383.8c19.12 0 32-15.6 32.1-32 .05-7.55-2.61-15.27-8.61-21.71z"},child:[]}]})(n)}function K6(n){return ut({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"},child:[]}]})(n)}function Q6(n){return ut({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M208 352c-2.39 0-4.78.35-7.06 1.09C187.98 357.3 174.35 360 160 360c-14.35 0-27.98-2.7-40.95-6.91-2.28-.74-4.66-1.09-7.05-1.09C49.94 352-.33 402.48 0 464.62.14 490.88 21.73 512 48 512h224c26.27 0 47.86-21.12 48-47.38.33-62.14-49.94-112.62-112-112.62zm-48-32c53.02 0 96-42.98 96-96s-42.98-96-96-96-96 42.98-96 96 42.98 96 96 96zM592 0H208c-26.47 0-48 22.25-48 49.59V96c23.42 0 45.1 6.78 64 17.8V64h352v288h-64v-64H384v64h-76.24c19.1 16.69 33.12 38.73 39.69 64H592c26.47 0 48-22.25 48-49.59V49.59C640 22.25 618.47 0 592 0z"},child:[]}]})(n)}function iT(n){return ut({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},child:[]}]})(n)}function Y6(n){return ut({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"},child:[]}]})(n)}function Jc(n){return ut({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(n)}function X6(n){return ut({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 464c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V200.724a48 48 0 0 1 18.387-37.776c24.913-19.529 45.501-35.365 164.2-121.511C199.412 29.17 232.797-.347 256 .003c23.198-.354 56.596 29.172 73.413 41.433 118.687 86.137 139.303 101.995 164.2 121.512A48 48 0 0 1 512 200.724V464zm-65.666-196.605c-2.563-3.728-7.7-4.595-11.339-1.907-22.845 16.873-55.462 40.705-105.582 77.079-16.825 12.266-50.21 41.781-73.413 41.43-23.211.344-56.559-29.143-73.413-41.43-50.114-36.37-82.734-60.204-105.582-77.079-3.639-2.688-8.776-1.821-11.339 1.907l-9.072 13.196a7.998 7.998 0 0 0 1.839 10.967c22.887 16.899 55.454 40.69 105.303 76.868 20.274 14.781 56.524 47.813 92.264 47.573 35.724.242 71.961-32.771 92.263-47.573 49.85-36.179 82.418-59.97 105.303-76.868a7.998 7.998 0 0 0 1.839-10.967l-9.071-13.196z"},child:[]}]})(n)}function Yf(n){return ut({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(n)}function Dw(n){return ut({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"},child:[]}]})(n)}function aT(n){return ut({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M622.34 153.2L343.4 67.5c-15.2-4.67-31.6-4.67-46.79 0L17.66 153.2c-23.54 7.23-23.54 38.36 0 45.59l48.63 14.94c-10.67 13.19-17.23 29.28-17.88 46.9C38.78 266.15 32 276.11 32 288c0 10.78 5.68 19.85 13.86 25.65L20.33 428.53C18.11 438.52 25.71 448 35.94 448h56.11c10.24 0 17.84-9.48 15.62-19.47L82.14 313.65C90.32 307.85 96 298.78 96 288c0-11.57-6.47-21.25-15.66-26.87.76-15.02 8.44-28.3 20.69-36.72L296.6 284.5c9.06 2.78 26.44 6.25 46.79 0l278.95-85.7c23.55-7.24 23.55-38.36 0-45.6zM352.79 315.09c-28.53 8.76-52.84 3.92-65.59 0l-145.02-44.55L128 384c0 35.35 85.96 64 192 64s192-28.65 192-64l-14.18-113.47-145.03 44.56z"},child:[]}]})(n)}function ou(n){return ut({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z"},child:[]}]})(n)}function W6(n){return ut({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(n)}function oT(n){return ut({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M80 368H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm0-320H16A16 16 0 0 0 0 64v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16V64a16 16 0 0 0-16-16zm0 160H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm416 176H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"},child:[]}]})(n)}function vd(n){return ut({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"},child:[]}]})(n)}function gl(n){return ut({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(n)}function lT(n){return ut({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(n)}function xl(n){return ut({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M0 224v272c0 8.84 7.16 16 16 16h80V192H32c-17.67 0-32 14.33-32 32zm360-48h-24v-40c0-4.42-3.58-8-8-8h-16c-4.42 0-8 3.58-8 8v64c0 4.42 3.58 8 8 8h48c4.42 0 8-3.58 8-8v-16c0-4.42-3.58-8-8-8zm137.75-63.96l-160-106.67a32.02 32.02 0 0 0-35.5 0l-160 106.67A32.002 32.002 0 0 0 128 138.66V512h128V368c0-8.84 7.16-16 16-16h96c8.84 0 16 7.16 16 16v144h128V138.67c0-10.7-5.35-20.7-14.25-26.63zM320 256c-44.18 0-80-35.82-80-80s35.82-80 80-80 80 35.82 80 80-35.82 80-80 80zm288-64h-64v320h80c8.84 0 16-7.16 16-16V224c0-17.67-14.33-32-32-32z"},child:[]}]})(n)}function Xp(n){return ut({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(n)}function J6(n){return ut({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(n)}function cT(n){return ut({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M296 32h192c13.255 0 24 10.745 24 24v160c0 13.255-10.745 24-24 24H296c-13.255 0-24-10.745-24-24V56c0-13.255 10.745-24 24-24zm-80 0H24C10.745 32 0 42.745 0 56v160c0 13.255 10.745 24 24 24h192c13.255 0 24-10.745 24-24V56c0-13.255-10.745-24-24-24zM0 296v160c0 13.255 10.745 24 24 24h192c13.255 0 24-10.745 24-24V296c0-13.255-10.745-24-24-24H24c-13.255 0-24 10.745-24 24zm296 184h192c13.255 0 24-10.745 24-24V296c0-13.255-10.745-24-24-24H296c-13.255 0-24 10.745-24 24v160c0 13.255 10.745 24 24 24z"},child:[]}]})(n)}function pl(n){return ut({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(n)}function El(n){return ut({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(n)}function Z6(n){return ut({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M496 128v16a8 8 0 0 1-8 8h-24v12c0 6.627-5.373 12-12 12H60c-6.627 0-12-5.373-12-12v-12H24a8 8 0 0 1-8-8v-16a8 8 0 0 1 4.941-7.392l232-88a7.996 7.996 0 0 1 6.118 0l232 88A8 8 0 0 1 496 128zm-24 304H40c-13.255 0-24 10.745-24 24v16a8 8 0 0 0 8 8h464a8 8 0 0 0 8-8v-16c0-13.255-10.745-24-24-24zM96 192v192H60c-6.627 0-12 5.373-12 12v20h416v-20c0-6.627-5.373-12-12-12h-36V192h-64v192h-64V192h-64v192h-64V192H96z"},child:[]}]})(n)}function ej(n){return ut({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M610.5 373.3c2.6-14.1 2.6-28.5 0-42.6l25.8-14.9c3-1.7 4.3-5.2 3.3-8.5-6.7-21.6-18.2-41.2-33.2-57.4-2.3-2.5-6-3.1-9-1.4l-25.8 14.9c-10.9-9.3-23.4-16.5-36.9-21.3v-29.8c0-3.4-2.4-6.4-5.7-7.1-22.3-5-45-4.8-66.2 0-3.3.7-5.7 3.7-5.7 7.1v29.8c-13.5 4.8-26 12-36.9 21.3l-25.8-14.9c-2.9-1.7-6.7-1.1-9 1.4-15 16.2-26.5 35.8-33.2 57.4-1 3.3.4 6.8 3.3 8.5l25.8 14.9c-2.6 14.1-2.6 28.5 0 42.6l-25.8 14.9c-3 1.7-4.3 5.2-3.3 8.5 6.7 21.6 18.2 41.1 33.2 57.4 2.3 2.5 6 3.1 9 1.4l25.8-14.9c10.9 9.3 23.4 16.5 36.9 21.3v29.8c0 3.4 2.4 6.4 5.7 7.1 22.3 5 45 4.8 66.2 0 3.3-.7 5.7-3.7 5.7-7.1v-29.8c13.5-4.8 26-12 36.9-21.3l25.8 14.9c2.9 1.7 6.7 1.1 9-1.4 15-16.2 26.5-35.8 33.2-57.4 1-3.3-.4-6.8-3.3-8.5l-25.8-14.9zM496 400.5c-26.8 0-48.5-21.8-48.5-48.5s21.8-48.5 48.5-48.5 48.5 21.8 48.5 48.5-21.7 48.5-48.5 48.5zM224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm201.2 226.5c-2.3-1.2-4.6-2.6-6.8-3.9l-7.9 4.6c-6 3.4-12.8 5.3-19.6 5.3-10.9 0-21.4-4.6-28.9-12.6-18.3-19.8-32.3-43.9-40.2-69.6-5.5-17.7 1.9-36.4 17.9-45.7l7.9-4.6c-.1-2.6-.1-5.2 0-7.8l-7.9-4.6c-16-9.2-23.4-28-17.9-45.7.9-2.9 2.2-5.8 3.2-8.7-3.8-.3-7.5-1.2-11.4-1.2h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c10.1 0 19.5-3.2 27.2-8.5-1.2-3.8-2-7.7-2-11.8v-9.2z"},child:[]}]})(n)}function Mw(n){return ut({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M319.4 320.6L224 416l-95.4-95.4C57.1 323.7 0 382.2 0 454.4v9.6c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-9.6c0-72.2-57.1-130.7-128.6-133.8zM13.6 79.8l6.4 1.5v58.4c-7 4.2-12 11.5-12 20.3 0 8.4 4.6 15.4 11.1 19.7L3.5 242c-1.7 6.9 2.1 14 7.6 14h41.8c5.5 0 9.3-7.1 7.6-14l-15.6-62.3C51.4 175.4 56 168.4 56 160c0-8.8-5-16.1-12-20.3V87.1l66 15.9c-8.6 17.2-14 36.4-14 57 0 70.7 57.3 128 128 128s128-57.3 128-128c0-20.6-5.3-39.8-14-57l96.3-23.2c18.2-4.4 18.2-27.1 0-31.5l-190.4-46c-13-3.1-26.7-3.1-39.7 0L13.6 48.2c-18.1 4.4-18.1 27.2 0 31.6z"},child:[]}]})(n)}function lu(n){return ut({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm95.8 32.6L272 480l-32-136 32-56h-96l32 56-32 136-47.8-191.4C56.9 292 0 350.3 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-72.1-56.9-130.4-128.2-133.8z"},child:[]}]})(n)}function uf(n){return ut({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(n)}function Tu(n){return ut({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(n)}const tj=()=>{const[n,e]=Y.useState([]);return Y.useEffect(()=>{const t=async()=>{const a=await nT();a.sort((l,c)=>{var y,_;const m=((y=l.createdAt)==null?void 0:y.seconds)||0;return(((_=c.createdAt)==null?void 0:_.seconds)||0)-m}),e(a)};t();const r=setInterval(t,3e4);return()=>clearInterval(r)},[]),n.length===0?null:h.jsx("div",{className:"fixed top-16 left-0 right-0 z-[30] pointer-events-none",children:n.map(t=>{const r=t.type==="special",a=r?"bg-gradient-to-r from-red-600 to-red-700 text-white border-b border-red-800 shadow-red-500/50":"bg-gradient-to-r from-amber-500 to-orange-600 text-white border-b border-orange-700 shadow-orange-500/50";return h.jsx("div",{className:`${a} shadow-lg py-3 relative`,children:h.jsx("marquee",{behavior:"scroll",direction:"left",scrollamount:"5",width:"100%",children:h.jsxs("div",{className:"inline-flex items-center gap-4 mx-8 font-bold text-sm md:text-base uppercase tracking-wider",children:[r?h.jsx(Yf,{className:"animate-pulse"}):h.jsx(Eu,{className:"animate-bounce"}),h.jsxs("span",{children:[t.title,":"]}),h.jsx("span",{className:"font-medium normal-case",children:t.message})]})})},t.id)})})},nj=()=>{const[n,e]=Y.useState(null);Y.useEffect(()=>{(async()=>{const l=await nT();if(l.length>0){const c=l.find(y=>y.type==="special"),m=l.find(y=>y.type==="attention"),g=c||m;g&&(sessionStorage.getItem(`seen_alert_${g.id}`)||e(g))}})()},[]);const t=()=>{n&&(sessionStorage.setItem(`seen_alert_${n.id}`,"true"),e(null))};if(!n)return null;const r=n.type==="special";return h.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm animate-fade-in p-4",children:h.jsx("div",{className:`bg-white dark:bg-slate-800 rounded-3xl shadow-2xl max-w-md w-full overflow-hidden transform transition-all scale-100 animate-bounce-in border-t-8 ${r?"border-red-500":"border-orange-500"}`,children:h.jsxs("div",{className:"p-8 flex flex-col items-center text-center",children:[h.jsx("div",{className:`w-20 h-20 rounded-full flex items-center justify-center mb-6 ${r?"bg-red-100 text-red-500":"bg-orange-100 text-orange-500"}`,children:h.jsx(Yf,{className:"text-4xl animate-pulse"})}),h.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white mb-2",children:r?"THNG BO C BIT":"CH "}),h.jsx("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-200 mb-4",children:n.title}),h.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8 leading-relaxed",children:n.message}),h.jsx("button",{onClick:t,className:`px-8 py-3 rounded-xl font-bold text-white shadow-lg hover:shadow-xl hover:scale-105 transition-all ${r?"bg-gradient-to-r from-red-500 to-pink-600":"bg-gradient-to-r from-orange-400 to-yellow-500"}`,children:" Hiu"})]})})})},sj=async n=>{try{const e=qt(ke,"users",n),t=await vu(e);if(t.exists()){const r=t.data();return{id:n,email:r.email,full_name:r.fullName||r.full_name||"Ngi dng",role:(()=>{const a=r.role;return a==="teacher"||a==="giao-vien"||a==="giao_vien"?"giao_vien":a==="student"||a==="hoc-vien"||a==="hoc_vien"?"hoc_vien":a==="manager"||a==="quan-ly"||a==="quan_ly"?"quan_ly":a==="leader"||a==="lanh-dao"||a==="lanh_dao"?"lanh_dao":a==="admin"?"admin":"hoc_vien"})(),photoURL:r.photoURL||"",birthDate:r.birthDate||"",address:r.address||"",class:r.class||"",phoneNumber:r.phoneNumber||"",courseName:r.courseName||"",courseId:r.courseId||""}}return null}catch(e){return console.error("Error fetching user profile from Firestore:",e),null}},Pw=async(n,e,t,r,a,l,c,m)=>{try{let g=t;a==="n tp"&&r?g=`${t} / ${r}`:a==="Thi th"&&(g=`${t} (Thi th)`),await _u(xt(ke,"exam_results"),{studentId:n,licenseId:e,score:l,totalQuestions:c,timeTaken:m,completedAt:Lu(),type:a,quizTitle:g})}catch(g){console.error("Error saving exam result to Firestore:",g)}},rj=async()=>{try{const n=Ht(xt(ke,"courses")),e=await bn(n),t=[];return e.forEach(r=>{const a=r.data();a.name&&t.push({id:r.id,name:a.name})}),t.sort((r,a)=>r.name.localeCompare(a.name))}catch(n){return console.error("Error fetching courses:",n),[]}},ij=async n=>{try{if(!n||n.length<3)return[];const e=Ht(xt(ke,"users"),un("email",">=",n),un("email","<=",n+""));return(await bn(e)).docs.map(r=>{const a=r.data();return{id:r.id,email:a.email,full_name:a.fullName||a.full_name||"Ngi dng",role:(()=>{const l=a.role;return l==="teacher"||l==="giao-vien"?"giao_vien":l==="student"||l==="hoc-vien"?"hoc_vien":l==="manager"||l==="quan-ly"?"quan_ly":l==="leader"||l==="lanh-dao"?"lanh_dao":l||"hoc_vien"})(),photoURL:a.photoURL||"",birthDate:a.birthDate||"",address:a.address||"",class:a.class||"",phoneNumber:a.phoneNumber||"",courseName:a.courseName||"",courseId:a.courseId||""}})}catch(e){return console.error("Error searching users:",e),[]}},aj=({userProfile:n})=>{const[e,t]=Y.useState([]),[r,a]=Y.useState(!0);Y.useEffect(()=>{l()},[]);const l=async()=>{a(!0);const q=await V6();t(q),a(!1)},c=q=>!(n.role==="giao_vien"&&(q.type==="special"||q.type==="attention")),m=async q=>{confirm("Bn c chc chn mun XA VNH VIN thng bo ny? Hnh ng ny s g thng bo khi mn hnh ca tt c ngi dng.")&&(await L6(q)?(alert(" xa thng bo!"),l()):alert("C li xy ra khi xa."))},g=q=>q?new Date(q*1e3).toLocaleString("vi-VN"):"--",[y,_]=Y.useState(!1),[w,E]=Y.useState(""),[S,N]=Y.useState(""),[M,k]=Y.useState("system"),[V,F]=Y.useState("all"),[$,te]=Y.useState([]),[ue,le]=Y.useState(""),[I,C]=Y.useState(""),[j,R]=Y.useState([]),[D,L]=Y.useState(null),[O,Fe]=Y.useState("");Y.useEffect(()=>{y&&V==="class"&&rj().then(te)},[y,V]),Y.useEffect(()=>{if(I.length>2&&V==="user"){const q=setTimeout(async()=>{const ce=await ij(I);R(ce)},500);return()=>clearTimeout(q)}},[I,V]);const et=async q=>{if(q.preventDefault(),!w||!S)return alert("Vui lng nhp tiu  v ni dung");if(V==="class"&&!ue)return alert("Vui lng chn lp");if(V==="user"&&!D)return alert("Vui lng chn ngi nhn");try{let ce=null;V==="class"&&(ce=ue),V==="user"&&(ce=D.id),await tT(w,S,M,V,ce,n.id,n.full_name,O?new Date(O):null),alert(" gi thng bo thnh cng!"),_(!1),E(""),N(""),k("system"),l()}catch(ce){console.error(ce),alert("Li khi gi thng bo")}};return h.jsxs("div",{className:"p-4 md:p-8 animate-fade-in pb-20 max-w-7xl mx-auto",children:[h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-xl overflow-hidden min-h-[500px] flex flex-col",children:[h.jsxs("div",{className:"p-6 border-b border-gray-100 dark:border-slate-700 bg-gradient-to-r from-teal-500 to-emerald-600 text-white flex justify-between items-center",children:[h.jsxs("div",{children:[h.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-3",children:[h.jsx(Yf,{})," Qun L Thng Bo H Thng"]}),h.jsx("p",{className:"text-teal-100 mt-1 opacity-90",children:n.role==="giao_vien"?"Bn c th xem tt c v qun l thng bo thng.":"Bn c ton quyn qun l thng bo."})]}),h.jsxs("button",{onClick:()=>_(!0),className:"bg-white text-teal-600 px-4 py-2 rounded-lg font-bold shadow hover:bg-teal-50 transition flex items-center gap-2",children:[h.jsx(gl,{})," To mi"]})]}),h.jsx("div",{className:"flex-1 p-6 bg-gray-50 dark:bg-slate-900/50 overflow-x-auto",children:r?h.jsx("div",{className:"text-center py-20 text-gray-500",children:"ang ti d liu..."}):h.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-gray-200 dark:border-slate-700 overflow-hidden min-w-[800px]",children:h.jsxs("table",{className:"w-full text-left text-sm",children:[h.jsx("thead",{className:"bg-gray-100 dark:bg-slate-700 text-gray-700 dark:text-gray-200 font-bold uppercase",children:h.jsxs("tr",{children:[h.jsx("th",{className:"p-4 w-32",children:"i tng"}),h.jsx("th",{className:"p-4 w-32",children:"Loi"}),h.jsx("th",{className:"p-4",children:"Tiu  & Ni dung"}),h.jsx("th",{className:"p-4 w-40",children:"Ngi to"}),h.jsx("th",{className:"p-4 w-48",children:"Ht hn (Marquee)"}),h.jsx("th",{className:"p-4 w-40",children:"Ngy to"}),h.jsx("th",{className:"p-4 w-32 text-center",children:"Hnh ng"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-slate-700",children:e.length===0?h.jsx("tr",{children:h.jsx("td",{colSpan:7,className:"p-10 text-center text-gray-500 text-base",children:"H thng cha c thng bo no."})}):e.map(q=>{var _e,De;const ce=c(q);return h.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors",children:[h.jsxs("td",{className:"p-4 align-top",children:[h.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-bold whitespace-nowrap border
                                                            ${q.targetType==="all"?"bg-purple-100 text-purple-700 border-purple-200":q.targetType==="class"?"bg-indigo-100 text-indigo-700 border-indigo-200":"bg-pink-100 text-pink-700 border-pink-200"}
                                                        `,children:[q.targetType==="all"&&h.jsxs(h.Fragment,{children:[h.jsx(Dw,{})," Tt c"]}),q.targetType==="class"&&h.jsxs(h.Fragment,{children:[h.jsx(Tu,{})," Lp"]}),q.targetType==="user"&&h.jsxs(h.Fragment,{children:[h.jsx(uf,{})," C nhn"]})]}),q.targetId&&q.targetType!=="all"&&h.jsx("div",{className:"text-xs text-gray-500 mt-1 font-mono",children:q.targetId})]}),h.jsx("td",{className:"p-4 align-top",children:h.jsx("span",{className:`inline-block px-2 py-1 rounded text-xs font-bold whitespace-nowrap
                                                            ${q.type==="special"?"bg-red-100 text-red-600":q.type==="attention"?"bg-orange-100 text-orange-600":"bg-blue-100 text-blue-600"}
                                                        `,children:q.type==="special"?"C BIT":q.type==="attention"?"CH ":"Thng"})}),h.jsxs("td",{className:"p-4 align-top",children:[h.jsx("div",{className:"font-bold text-gray-900 dark:text-white mb-1 text-base",children:q.title}),h.jsx("div",{className:"text-gray-600 dark:text-gray-400 line-clamp-2",children:q.message})]}),h.jsxs("td",{className:"p-4 align-top text-gray-700 dark:text-gray-300 font-medium",children:[q.senderName,h.jsx("div",{className:"text-xs text-gray-400 font-normal",children:q.senderId===n.id?"(Bn)":""})]}),h.jsx("td",{className:"p-4 align-top",children:q.type==="special"||q.type==="attention"?h.jsxs("div",{className:"flex items-center gap-1 text-xs font-mono bg-gray-100 dark:bg-slate-900 px-2 py-1 rounded border whitespace-nowrap",children:[h.jsx(Y6,{className:"text-gray-400"}),g((_e=q.expiryDate)==null?void 0:_e.seconds)]}):h.jsx("span",{className:"text-gray-400 text-xs",children:"--"})}),h.jsx("td",{className:"p-4 align-top text-gray-500 text-xs whitespace-nowrap",children:g((De=q.createdAt)==null?void 0:De.seconds)}),h.jsx("td",{className:"p-4 align-top text-center",children:ce?h.jsxs("button",{onClick:()=>m(q.id),className:"text-red-500 hover:text-red-700 p-2 bg-red-50 hover:bg-red-100 rounded-lg transition-colors flex items-center gap-1 mx-auto",title:"Xa vnh vin",children:[h.jsx(El,{size:14})," ",h.jsx("span",{className:"text-xs font-bold",children:"Xa"})]}):h.jsx("div",{className:"text-gray-300 flex justify-center p-2 cursor-not-allowed",title:"Bn khng c quyn xa thng bo cp cao ny",children:h.jsx(G6,{})})})]},q.id)})})]})})})]}),y&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-4 backdrop-blur-sm",onClick:()=>_(!1),children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden animate-scale-in",onClick:q=>q.stopPropagation(),children:[h.jsxs("div",{className:"p-6 border-b dark:border-slate-700 bg-gray-50 dark:bg-slate-900 flex justify-between items-center",children:[h.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-gray-800 dark:text-white",children:[h.jsx(gl,{className:"text-teal-600"})," To thng bo mi"]}),h.jsx("button",{onClick:()=>_(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:""})]}),h.jsxs("form",{onSubmit:et,className:"p-6 space-y-4",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300",children:"Gi ti:"}),h.jsxs("div",{className:"flex gap-4",children:[h.jsxs("label",{className:`flex items-center gap-2 p-3 rounded-lg border cursor-pointer flex-1 justify-center transition-all ${V==="all"?"bg-purple-50 border-purple-500 text-purple-700 ring-1 ring-purple-500":"border-gray-200 hover:bg-gray-50"}`,children:[h.jsx("input",{type:"radio",name:"target",value:"all",checked:V==="all",onChange:()=>F("all"),className:"hidden"}),h.jsx(Dw,{})," Tt c"]}),h.jsxs("label",{className:`flex items-center gap-2 p-3 rounded-lg border cursor-pointer flex-1 justify-center transition-all ${V==="class"?"bg-indigo-50 border-indigo-500 text-indigo-700 ring-1 ring-indigo-500":"border-gray-200 hover:bg-gray-50"}`,children:[h.jsx("input",{type:"radio",name:"target",value:"class",checked:V==="class",onChange:()=>F("class"),className:"hidden"}),h.jsx(Tu,{})," Lp hc"]}),h.jsxs("label",{className:`flex items-center gap-2 p-3 rounded-lg border cursor-pointer flex-1 justify-center transition-all ${V==="user"?"bg-pink-50 border-pink-500 text-pink-700 ring-1 ring-pink-500":"border-gray-200 hover:bg-gray-50"}`,children:[h.jsx("input",{type:"radio",name:"target",value:"user",checked:V==="user",onChange:()=>F("user"),className:"hidden"}),h.jsx(uf,{})," C nhn"]})]})]}),V==="class"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"Chn lp:"}),h.jsxs("select",{className:"w-full p-2 border rounded-lg dark:bg-slate-700",value:ue,onChange:q=>le(q.target.value),required:!0,children:[h.jsx("option",{value:"",children:"-- Chn lp --"}),$.map(q=>h.jsxs("option",{value:q.name,children:[q.name," -- (",q.id,")"]},q.id))]})]}),V==="user"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"Tm ngi nhn (Email):"}),h.jsx("input",{className:"w-full p-2 border rounded-lg dark:bg-slate-700",placeholder:"Nhp email...",value:I,onChange:q=>C(q.target.value)}),j.length>0&&h.jsx("div",{className:"mt-2 border rounded max-h-40 overflow-y-auto bg-gray-50 dark:bg-slate-900",children:j.map(q=>h.jsxs("div",{onClick:()=>{L(q),R([]),C(q.email)},className:"p-2 hover:bg-teal-50 cursor-pointer flex justify-between items-center border-b last:border-0",children:[h.jsx("span",{className:"font-medium",children:q.full_name}),h.jsx("span",{className:"text-xs text-gray-500",children:q.email})]},q.id))}),D&&h.jsxs("div",{className:"mt-2 p-2 bg-green-50 text-green-700 text-sm rounded flex items-center gap-2",children:[h.jsx(iT,{}),"  chn: ",h.jsx("b",{children:D.full_name})," (",D.email,")"]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"Tiu :"}),h.jsx("input",{className:"w-full p-2 border rounded-lg dark:bg-slate-700",value:w,onChange:q=>E(q.target.value),required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"Ni dung:"}),h.jsx("textarea",{className:"w-full p-2 border rounded-lg dark:bg-slate-700 h-24",value:S,onChange:q=>N(q.target.value),required:!0})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"Loi thng bo:"}),h.jsxs("select",{className:"w-full p-2 border rounded-lg dark:bg-slate-700",value:M,onChange:q=>k(q.target.value),children:[h.jsx("option",{value:"system",children:"Thng (Xanh)"}),h.jsx("option",{value:"attention",children:"Ch  (Cam)"}),h.jsx("option",{value:"special",children:"c bit ( - Marquee)"})]})]}),(M==="attention"||M==="special")&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"Ht hn chy ch (Marquee):"}),h.jsx("input",{type:"datetime-local",className:"w-full p-2 border rounded-lg dark:bg-slate-700",value:O,onChange:q=>Fe(q.target.value),required:!0})]})]}),h.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t dark:border-slate-700 mt-6",children:[h.jsx("button",{type:"button",onClick:()=>_(!1),className:"px-5 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg font-medium transition",children:"Hy"}),h.jsx("button",{type:"submit",className:"px-5 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg font-bold shadow-lg shadow-teal-500/30 transition transform hover:-translate-y-0.5",children:"Gi thng bo"})]})]})]})})]})},Vw=({onStart:n,onLoginClick:e,onRegisterClick:t})=>{const{theme:r}=Rn();return h.jsx("div",{className:"text-center p-4 animate-slide-in-right",children:h.jsxs("div",{className:"bg-card text-card-foreground rounded-2xl shadow-xl p-8 md:p-12 max-w-2xl mx-auto relative",children:[r==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/MH9hVp8S/happy-techers-day.jpg",alt:"Icon Chc mng Ngy Nh gio",className:"h-24 w-24 mx-auto mb-4 rounded-full object-cover"}):r==="noel"?h.jsx(Sl,{className:"h-24 w-24 mx-auto text-primary mb-4"}):h.jsx(Sl,{className:"h-24 w-24 mx-auto text-primary mb-4"}),h.jsx("h1",{className:"text-4xl md:text-5xl font-extrabold text-foreground mb-2",children:"ng Dng n tp"}),r==="tri-an"&&h.jsx("p",{className:"text-xl font-semibold text-primary mb-4",children:"Phin bn c bit Tri n Thy C"}),r==="noel"&&h.jsx("p",{className:"text-xl font-semibold text-primary mb-4",children:"Cho n Ging Sinh An Lnh"}),h.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"Cho mng anh/ch  n vi ng dng n tp, n thi chng ch chuyn mn phng tin thy ni a."}),r==="tri-an"&&h.jsx("p",{className:"text-lg text-muted-foreground mb-8 italic",children:'"Nhn ngy Nh gio Vit Nam 20-11, knh chc qu thy c lun mnh khe, hnh phc v thnh cng trong s nghip trng ngi."'}),h.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[h.jsx("button",{onClick:n,className:"w-full sm:w-auto bg-primary text-primary-foreground font-bold text-lg py-4 px-10 rounded-lg hover:bg-primary/90 focus:outline-none focus:ring-4 focus:ring-ring transition-all duration-300 transform hover:scale-105",children:"Bt u"}),h.jsx("button",{onClick:e,className:"w-full sm:w-auto bg-secondary text-secondary-foreground font-bold text-lg py-4 px-10 rounded-lg hover:bg-secondary/80 focus:outline-none focus:ring-4 focus:ring-ring transition-all duration-300",children:"ng nhp"})]}),h.jsx("div",{className:"mt-4",children:h.jsx("button",{onClick:t,className:"text-primary hover:underline font-medium",children:"Cha c ti khon? ng k ngay"})})]})})},oj=async n=>{const e=n.trim();return e.includes("@")?e:`${e}@gmail.com`},lj=({onBack:n})=>{const[e,t]=Y.useState(""),[r,a]=Y.useState(""),[l,c]=Y.useState(!1),[m,g]=Y.useState(null),y=async _=>{_.preventDefault(),c(!0),g(null);try{const w=await oj(e);await q3(xu,w,r)}catch(w){console.error("Login failed:",w),w.code==="auth/invalid-email"?g("Tn ng nhp hoc email khng hp l."):w.code==="auth/user-not-found"||w.code==="auth/wrong-password"||w.code==="auth/invalid-credential"?g("Ti khon hoc mt khu khng chnh xc."):g("ng nhp tht bi. Vui lng th li.")}finally{c(!1)}};return h.jsxs("div",{className:"w-full max-w-md mx-auto p-4 animate-slide-in-right",children:[h.jsxs("div",{className:"relative text-center mb-10",children:[h.jsx("button",{onClick:n,className:"absolute left-0 top-1/2 -translate-y-1/2 bg-card/50 p-3 rounded-full shadow-md hover:bg-muted focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:ring-offset-background transition-all duration-300 transform hover:scale-110","aria-label":"Quay li",children:h.jsx(Ml,{className:"h-10 w-10 text-primary"})}),h.jsx(Sl,{className:"h-20 w-20 mx-auto text-primary mb-4"}),h.jsx("h1",{className:"text-4xl font-bold text-foreground",children:"ng nhp"}),h.jsx("p",{className:"text-lg text-muted-foreground mt-2",children:"Truy cp vo h thng qun l hc tp."})]}),h.jsx("div",{className:"bg-card p-8 rounded-2xl shadow-lg",children:h.jsxs("form",{onSubmit:y,children:[m&&h.jsx("p",{className:"bg-destructive/10 text-destructive p-3 rounded-md mb-4 text-center",children:m}),h.jsxs("div",{className:"mb-4",children:[h.jsx("label",{htmlFor:"account",className:"block text-sm font-medium text-card-foreground mb-2",children:"Ti khon"}),h.jsx("input",{id:"account",type:"text",value:e,onChange:_=>t(_.target.value),placeholder:"Nhp ti khon hoc email",className:"w-full px-4 py-3 bg-background border border-border rounded-lg text-foreground focus:outline-none focus:ring-2 focus:ring-ring transition-colors duration-300",required:!0,autoFocus:!0})]}),h.jsxs("div",{className:"mb-6",children:[h.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-card-foreground mb-2",children:"Mt khu"}),h.jsx("input",{id:"password",type:"password",value:r,onChange:_=>a(_.target.value),placeholder:"",className:"w-full px-4 py-3 bg-background border border-border rounded-lg text-foreground focus:outline-none focus:ring-2 focus:ring-ring transition-colors duration-300",required:!0})]}),h.jsx("button",{type:"submit",disabled:l,className:"w-full bg-primary text-primary-foreground font-bold py-3 px-6 rounded-lg hover:bg-primary/90 focus:outline-none focus:ring-4 focus:ring-ring transition-all duration-300 disabled:opacity-50 disabled:cursor-wait",children:l?"ang x l...":"ng nhp"})]})})]})},cj=({onBack:n,onSuccess:e})=>{const[t,r]=Y.useState(""),[a,l]=Y.useState(""),[c,m]=Y.useState(""),[g,y]=Y.useState(""),[_,w]=Y.useState(""),[E,S]=Y.useState(""),[N,M]=Y.useState(!1),[k,V]=Y.useState(null),F=async $=>{if($.preventDefault(),M(!0),V(null),a.length<6){V("Mt khu phi c t nht 6 k t."),M(!1);return}try{const ue=(await B3(xu,t.trim(),a)).user,le=t.split("@")[0].toLowerCase();await uE(qt(ke,"users",ue.uid),{email:ue.email,fullName:c.trim(),phoneNumber:_.trim(),birthDate:E,role:"hoc_vien",class:g.trim(),username:le,createdAt:Lu()}),console.log("Registration successful"),e()}catch(te){console.error("Registration failed:",te),te.code==="auth/email-already-in-use"?V("Email ny  c s dng."):te.code==="auth/invalid-email"?V("Email khng hp l."):te.code==="auth/weak-password"?V("Mt khu qu yu."):V("ng k tht bi. Vui lng th li.")}finally{M(!1)}};return h.jsxs("div",{className:"w-full max-w-md mx-auto p-4 animate-slide-in-right",children:[h.jsxs("div",{className:"relative text-center mb-6",children:[h.jsx("button",{onClick:n,className:"absolute left-0 top-1/2 -translate-y-1/2 bg-card/50 p-2 rounded-full shadow-md hover:bg-muted transition-all duration-300",children:h.jsx(Ml,{className:"h-8 w-8 text-primary"})}),h.jsx(Sl,{className:"h-16 w-16 mx-auto text-primary mb-2"}),h.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"ng K"}),h.jsx("p",{className:"text-sm text-muted-foreground",children:"To ti khon hc vin mi"})]}),h.jsx("div",{className:"bg-card p-6 rounded-2xl shadow-lg",children:h.jsxs("form",{onSubmit:F,className:"space-y-4",children:[k&&h.jsx("p",{className:"bg-destructive/10 text-destructive p-3 rounded-md text-sm text-center",children:k}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-card-foreground mb-1",children:"H v Tn *"}),h.jsx("input",{type:"text",value:c,onChange:$=>m($.target.value),required:!0,className:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:ring-2 focus:ring-primary outline-none",placeholder:"Nguyn Vn A"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-card-foreground mb-1",children:"Lp Hc *"}),h.jsx("input",{type:"text",value:g,onChange:$=>y($.target.value),required:!0,className:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:ring-2 focus:ring-primary outline-none",placeholder:"Nhp tn lp (GV s duyt)"})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-card-foreground mb-1",children:"Ngy sinh"}),h.jsx("input",{type:"date",value:E,onChange:$=>S($.target.value),className:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:ring-2 focus:ring-primary outline-none"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-card-foreground mb-1",children:"ST"}),h.jsx("input",{type:"tel",value:_,onChange:$=>w($.target.value),className:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:ring-2 focus:ring-primary outline-none",placeholder:"09..."})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-card-foreground mb-1",children:"Email *"}),h.jsx("input",{type:"email",value:t,onChange:$=>r($.target.value),required:!0,className:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:ring-2 focus:ring-primary outline-none",placeholder:"email@example.com"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-card-foreground mb-1",children:"Mt khu *"}),h.jsx("input",{type:"password",value:a,onChange:$=>l($.target.value),required:!0,className:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:ring-2 focus:ring-primary outline-none",placeholder:"t nht 6 k t"})]}),h.jsx("button",{type:"submit",disabled:N,className:"w-full bg-primary text-primary-foreground font-bold py-3 px-6 rounded-lg hover:bg-primary/90 transition-all duration-300 mt-4 disabled:opacity-50",children:N?"ang to ti khon...":"ng K"})]})})]})},uj=(n,e)=>{const t="h-14 w-14 mx-auto text-primary mb-3 object-contain",r="h-14 w-14 mx-auto mb-3 object-cover rounded-full border-2 border-border/20 shadow-sm",a="h-14 w-14 mx-auto mb-3 object-contain drop-shadow-lg",l=n.name.toLowerCase();if(e==="noel")return l.includes("thuyn trng")?h.jsx("img",{src:"/assets/img/hat.png",alt:"Captain Hat",className:a}):l.includes("my trng")?h.jsx("img",{src:"/assets/img/gift4.png",alt:"Chief Engineer",className:a}):l.includes("thy th")?h.jsx("img",{src:"/assets/img/bell.png",alt:"Sailor",className:a}):l.includes("li phng tin")?h.jsx("img",{src:"/assets/img/tree.png",alt:"Helm",className:a}):l.includes("chng ch")?h.jsx("img",{src:"/assets/img/star-gold.png",alt:"Certificate",className:a}):h.jsx("img",{src:"/assets/img/gift5.png",alt:"Default",className:a});if(e==="tri-an")switch(n.id){case"thuyentruong-h1":return h.jsx("img",{src:"https://i.postimg.cc/Vs76y54F/8.jpg",alt:n.name,className:r});case"thuyentruong-h2":return h.jsx("img",{src:"https://i.postimg.cc/Pf6xGNK4/9.jpg",alt:n.name,className:r});case"thuyentruong-h3":return h.jsx("img",{src:"https://i.postimg.cc/Vs76y54W/7.jpg",alt:n.name,className:r});case"thuythu":return h.jsx(xp,{className:t});case"lai-phuong-tien":return h.jsx(Sl,{className:t});case"maytruong-h1":return h.jsx("img",{src:"https://i.postimg.cc/zDpm90H6/undefined.jpg",alt:n.name,className:r});case"maytruong-h2":return h.jsx("img",{src:"https://i.postimg.cc/wMwSLjdc/Teachers-day-background-design-art-illustration.jpg",alt:n.name,className:r});case"maytruong-h3":return h.jsx("img",{src:"https://i.postimg.cc/NFdWmjwH/Hinh-thiep.jpg",alt:n.name,className:r});case"thomay":return h.jsx("img",{src:"https://i.postimg.cc/cJYy2WQN/hinh-nen-3.jpg",alt:n.name,className:r});case"caotoc":return h.jsx("img",{src:"https://i.postimg.cc/dQWMQybn/5.jpg",alt:n.name,className:r});case"ven-bien":return h.jsx("img",{src:"https://i.postimg.cc/zDdmDgs0/6.jpg",alt:n.name,className:r});case"antoan-ven-bien":return h.jsx("img",{src:"https://i.postimg.cc/ZYFWdtv0/BOARD.webp",alt:n.name,className:r});case"antoan-xang-dau":return h.jsx("img",{src:"https://i.postimg.cc/T2k82Dzc/4.jpg",alt:n.name,className:r});case"antoan-hoa-chat":return h.jsx("img",{src:"https://i.postimg.cc/mZVx08Ff/World-Teacher-s-Day-Flowers-Border-Pink.jpg",alt:n.name,className:r});default:return l.includes("chng ch")?h.jsx(Wb,{className:t}):h.jsx(Xb,{className:t})}return l.includes("thuyn trng")?h.jsx(eN,{className:t}):l.includes("my trng")?h.jsx(ZA,{className:t}):l.includes("thy th")?h.jsx(xp,{className:t}):l.includes("li phng tin")?h.jsx(Sl,{className:t}):l.includes("chng ch")?h.jsx(Wb,{className:t}):h.jsx(Xb,{className:t})},hj=({licenses:n,onSelect:e,onBack:t})=>{const{theme:r}=Rn();return h.jsxs("div",{className:"w-full max-w-4xl mx-auto p-4 animate-slide-in-right",children:[h.jsxs("div",{className:"relative text-center mb-10",children:[h.jsx("button",{onClick:t,className:"absolute left-0 top-1/2 -translate-y-1/2 bg-card/50 p-3 rounded-full shadow-md hover:bg-muted focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:ring-offset-background transition-all duration-300 transform hover:scale-110","aria-label":"Quay li",children:h.jsx(Ml,{className:"h-10 w-10 text-primary"})}),r==="noel"?h.jsx("img",{src:"/assets/img/tree.png",alt:"Tree",className:"h-20 w-20 mx-auto mb-4 object-contain drop-shadow-lg"}):h.jsx(xp,{className:"h-20 w-20 mx-auto text-primary mb-4"}),h.jsx("h1",{className:"text-4xl font-bold text-foreground",children:"Chn Hng Bng"}),h.jsx("p",{className:"text-lg text-muted-foreground mt-2",children:"Anh/ch vui lng chn hng bng mun n tp v thi th."})]}),h.jsx("div",{className:"bg-card p-6 rounded-2xl shadow-lg",children:h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:n.map(a=>{const l=a.subjects.reduce((c,m)=>c+m.questions.length,0);return h.jsxs("button",{onClick:()=>e(a),className:"group w-full p-4 bg-background rounded-lg text-center hover:bg-primary/10 transition-all duration-300 transform hover:scale-105 focus:ring-4 focus:ring-ring focus:outline-none",children:[uj(a,r),h.jsx("h3",{className:"text-md font-bold text-primary",children:a.name}),h.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[a.subjects.length," mn - ",l," cu"]})]},a.id)})})})]})},dj=({onNameSubmit:n,onBack:e})=>{const[t,r]=Y.useState(""),a=l=>{l.preventDefault();const c=t.trim();n(c||"Hc vin")};return h.jsxs("div",{className:"w-full max-w-md mx-auto p-4 animate-slide-in-right",children:[h.jsxs("div",{className:"text-center mb-10",children:[h.jsx(WA,{className:"h-20 w-20 mx-auto text-primary mb-4"}),h.jsxs("div",{className:"relative flex justify-center items-center",children:[h.jsx("div",{className:"absolute left-0",children:h.jsx("button",{onClick:e,className:"bg-card/50 p-3 rounded-full shadow-md hover:bg-muted focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:ring-offset-background transition-all duration-300 transform hover:scale-110","aria-label":"Quay li",children:h.jsx(Ml,{className:"h-10 w-10 text-primary"})})}),h.jsx("h1",{className:"text-4xl font-bold text-foreground",children:"Thng tin ca anh/ch"})]}),h.jsx("p",{className:"text-lg text-muted-foreground mt-2",children:"Nhp tn  ti c th lu li tin  hc tp cho anh/ch."})]}),h.jsx("div",{className:"bg-card p-8 rounded-2xl shadow-lg",children:h.jsxs("form",{onSubmit:a,children:[h.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-card-foreground mb-2",children:"Tn ca anh/ch"}),h.jsx("input",{id:"name",type:"text",value:t,onChange:l=>r(l.target.value),placeholder:"V d: Nguyn Vn A (c th b trng)",className:"w-full px-4 py-3 bg-background border border-border rounded-lg text-foreground focus:outline-none focus:ring-2 focus:ring-ring transition-colors duration-300",autoFocus:!0}),h.jsx("button",{type:"submit",className:"mt-6 w-full bg-primary text-primary-foreground font-bold py-3 px-6 rounded-lg hover:bg-primary/90 focus:outline-none focus:ring-4 focus:ring-ring transition-all duration-300",children:"Xc nhn"})]})})]})},fj=({onModeSelect:n,licenseName:e,userName:t,onSwitchLicense:r})=>h.jsxs("div",{className:"w-full max-w-4xl mx-auto p-4 animate-slide-in-right",children:[h.jsxs("div",{className:"relative text-center mb-10",children:[h.jsx("div",{className:"absolute right-0 top-0",children:h.jsxs("button",{onClick:r,className:"flex items-center gap-1.5 text-xs font-medium text-muted-foreground hover:text-primary transition-all duration-300 py-1 px-2 rounded-md hover:bg-secondary",title:"Chn li hng bng",children:[h.jsx(JA,{className:"h-4 w-4"}),h.jsx("span",{children:"Chn li hng bng"})]})}),h.jsxs("h1",{className:"text-4xl font-bold text-foreground",children:["Cho anh/ch ",t,"!"]}),h.jsxs("p",{className:"text-lg text-muted-foreground mt-2",children:["Anh/ch ang hc hng bng ",h.jsx("span",{className:"font-semibold text-primary",children:e}),"."]}),h.jsx("p",{className:"text-lg text-muted-foreground mt-1",children:"Hy chn mt ch   bt u."})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("button",{onClick:()=>n("practice"),className:"group bg-card text-card-foreground p-8 rounded-2xl shadow-lg text-center hover:bg-primary/10 transition-all duration-300 transform hover:-translate-y-2 focus:outline-none focus:ring-4 focus:ring-ring",children:[h.jsx(m0,{className:"h-16 w-16 mx-auto text-primary mb-4 transition-transform group-hover:scale-110"}),h.jsx("h2",{className:"text-2xl font-bold text-card-foreground",children:"n tp"}),h.jsx("p",{className:"text-muted-foreground mt-2",children:"Luyn tp tng mn  nm vng kin thc."})]}),h.jsxs("button",{onClick:()=>n("online_exam"),className:"group bg-card text-card-foreground p-8 rounded-2xl shadow-lg text-center hover:bg-destructive/10 transition-all duration-300 transform hover:-translate-y-2 focus:outline-none focus:ring-4 focus:ring-ring",children:[h.jsx(tN,{className:"h-16 w-16 mx-auto text-destructive mb-4 transition-transform group-hover:scale-110"}),h.jsx("h2",{className:"text-2xl font-bold text-card-foreground",children:"Thi th"}),h.jsx("p",{className:"text-muted-foreground mt-2",children:"Lm bi thi 30 cu ngu nhin trong 45 pht."})]})]})]}),Lw=n=>{if(!n)return"";const e=new Date(n),t=e.getDate().toString().padStart(2,"0"),r=(e.getMonth()+1).toString().padStart(2,"0"),a=e.getHours().toString().padStart(2,"0"),l=e.getMinutes().toString().padStart(2,"0");return`(${t}/${r} ${a}:${l})`},mj=({subjects:n,progress:e,onSelect:t,onBack:r})=>h.jsxs("div",{className:"w-full max-w-2xl mx-auto p-4 animate-slide-in-right",children:[h.jsxs("div",{className:"relative text-center mb-10",children:[h.jsx("button",{onClick:r,className:"absolute left-0 top-1/2 -translate-y-1/2 bg-card/50 p-3 rounded-full shadow-md hover:bg-muted focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:ring-offset-background transition-all duration-300 transform hover:scale-110","aria-label":"Quay li",children:h.jsx(Ml,{className:"h-10 w-10 text-primary"})}),h.jsx(m0,{className:"h-20 w-20 mx-auto text-primary mb-4"}),h.jsx("h1",{className:"text-4xl font-bold text-foreground",children:"Chn Mn hc"}),h.jsx("p",{className:"text-lg text-muted-foreground mt-2",children:"Chn mt mn  bt u n tp."})]}),h.jsx("div",{className:"bg-card p-6 rounded-2xl shadow-lg",children:h.jsx("div",{className:"space-y-3",children:n.map(a=>{const l=e[a.id],c=l&&l.lastScore!==null;return h.jsxs("button",{onClick:()=>t(a),className:"w-full flex items-center justify-between p-5 bg-background rounded-lg text-left hover:bg-primary/10 transition-all duration-300 transform hover:scale-[1.02] focus:ring-4 focus:ring-ring focus:outline-none",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-bold text-primary",children:a.name}),h.jsxs("p",{className:"text-sm text-muted-foreground",children:[a.questions.length," cu hi"]})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[c&&h.jsxs("div",{className:"text-right text-sm",children:[h.jsxs("p",{className:"text-muted-foreground flex items-center justify-end",children:[h.jsx("span",{children:"Ln cui:"}),h.jsxs("span",{className:"font-semibold text-primary ml-1",children:[l.lastScore,"/",a.questions.length]}),l.lastScoreTimestamp&&h.jsx("span",{className:"ml-1.5 text-xs text-muted-foreground/80",children:Lw(l.lastScoreTimestamp)})]}),h.jsxs("p",{className:"text-muted-foreground flex items-center justify-end mt-0.5",children:[h.jsx("span",{children:"Cao nht:"}),h.jsxs("span",{className:"font-semibold text-success ml-1",children:[l.highScore,"/",a.questions.length]}),l.highScoreTimestamp&&h.jsx("span",{className:"ml-1.5 text-xs text-muted-foreground/80",children:Lw(l.highScoreTimestamp)})]})]}),h.jsx(XA,{className:"h-6 w-6 text-muted-foreground"})]})]},a.id)})})})]}),gj=({quiz:n,onFinish:e,onBack:t,initialIndex:r=0,initialAnswers:a={},onProgressUpdate:l})=>{const[c,m]=Y.useState(r),[g,y]=Y.useState(a);if(!n.questions||n.questions.length===0)return h.jsxs("div",{className:"w-full max-w-3xl mx-auto p-4 text-center",children:[h.jsx("h2",{className:"text-xl font-bold mb-4",children:"Cha c cu hi no trong ch  ny."}),h.jsx("button",{onClick:t,className:"bg-primary text-primary-foreground hover:bg-primary/90 py-2 px-4 rounded-lg",children:"Quay li"})]});const _=Y.useMemo(()=>n.questions[c],[n.questions,c]);if(!_)return h.jsxs("div",{className:"w-full max-w-3xl mx-auto p-4 text-center",children:[h.jsx("h2",{className:"text-xl font-bold mb-4",children:"C li xy ra khi ti cu hi."}),h.jsx("button",{onClick:t,className:"bg-primary text-primary-foreground py-2 px-4 rounded-lg",children:"Quay li"})]});const w=Y.useMemo(()=>g[_.id]!==void 0,[g,_.id]),E=Y.useMemo(()=>g[_.id]||null,[g,_.id]);Y.useEffect(()=>{l==null||l(c,0,g)},[c,g]);const S=()=>{e(g)},N=V=>{w||y(F=>({...F,[_.id]:V}))},M=()=>{c===n.questions.length-1?S():m(F=>F+1)},k=c/n.questions.length*100;return h.jsx("div",{className:"w-full max-w-3xl mx-auto p-4 md:p-6 animate-slide-in-right font-quiz-default",children:h.jsxs("div",{className:"bg-card text-card-foreground rounded-2xl shadow-xl p-6 md:p-8",children:[h.jsxs("div",{className:"mb-6",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4 relative",children:[h.jsx("button",{onClick:t,className:"absolute left-0 top-1/2 -translate-y-1/2 bg-background/50 p-3 rounded-full shadow-md hover:bg-muted focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 focus:ring-offset-card transition-all duration-300 transform hover:scale-110","aria-label":"Quay li",children:h.jsx(Ml,{className:"h-10 w-10"})}),h.jsx("h1",{className:"text-xl font-bold text-foreground text-center flex-grow",children:n.title}),h.jsx("button",{onClick:S,className:"bg-secondary text-secondary-foreground hover:bg-secondary/80 text-sm font-bold py-2 px-4 rounded-lg transition-colors duration-300",children:"Kt thc"})]}),h.jsx("div",{className:"w-full bg-secondary rounded-full h-2.5 mb-2",children:h.jsx("div",{className:"bg-primary h-2.5 rounded-full transition-all duration-500",style:{width:`${k}%`}})}),h.jsx("div",{className:"flex justify-between items-center text-sm text-muted-foreground",children:h.jsxs("span",{children:["Cu ",c+1," / ",n.questions.length]})})]}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-5 text-foreground",children:_.text}),_.image&&h.jsx("div",{className:"mb-6 rounded-lg overflow-hidden",children:h.jsx("img",{src:_.image,alt:"Cu hi",className:"w-full h-auto object-cover max-h-80"})}),h.jsx("div",{className:"space-y-3",children:_.answers.map(V=>{const F=E===V.id;let $="w-full text-left p-4 rounded-lg border-2 transition-all duration-300 flex items-center justify-between text-lg";const te=V.id===_.correctAnswerId;return w?te?$+=" bg-success/10 border-success text-success":F&&!te?$+=" bg-destructive/10 border-destructive text-destructive":$+=" border-border text-muted-foreground":F?$+=" bg-primary/10 border-primary ring-2 ring-primary text-primary-foreground":$+=" bg-background hover:bg-muted border-border text-foreground",h.jsxs("button",{onClick:()=>N(V.id),disabled:w,className:$,children:[h.jsx("span",{className:"flex-grow",children:V.text}),w&&h.jsxs(h.Fragment,{children:[te&&h.jsx(d0,{className:"h-6 w-6 text-success ml-3"}),F&&!te&&h.jsx(f0,{className:"h-6 w-6 text-destructive ml-3"})]})]},V.id)})}),h.jsx("div",{className:"mt-8",children:h.jsx("div",{className:"text-right",children:w?h.jsx("button",{onClick:M,className:"bg-success text-success-foreground font-bold py-3 px-8 rounded-lg hover:bg-success/90 transition-all duration-300 animate-slide-in-right",children:c===n.questions.length-1?"Hon thnh":"Cu tip theo"}):h.jsx("div",{className:"h-[48px]"})})})]})]})})},pj=n=>{const e=Math.floor(n/60),t=n%60;return`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},yj=({checked:n,onChange:e})=>h.jsx("div",{onClick:e,className:`w-[14px] h-[14px] border border-[#999] inline-block cursor-pointer bg-white relative ${n?"bg-[#333]":""}`,children:n&&h.jsx("div",{className:"absolute top-[2px] left-[2px] w-[8px] h-[8px] bg-[#333]"})}),vj=({quiz:n,onFinish:e,onBack:t,userName:r,selectedLicense:a,initialIndex:l=0,initialAnswers:c={},initialTime:m,onProgressUpdate:g})=>{const[y,_]=Y.useState(l),[w,E]=Y.useState(c),[S,N]=Y.useState(m!==void 0?m:n.timeLimit??3600),M=Y.useMemo(()=>n.questions[y],[n.questions,y]),k=Y.useRef(w);Y.useEffect(()=>{k.current=w,g==null||g(y,S,w)},[w]),Y.useEffect(()=>{g==null||g(y,S,w)},[y]),Y.useEffect(()=>{S%5===0&&(g==null||g(y,S,w))},[S]);const V=()=>{window.confirm("Anh/ch c chc chn mun thot khi bi thi khng? Mi tin trnh s b mt.")&&t()},F=Y.useCallback(()=>{const ue=k.current,le=n.questions.length-Object.keys(ue).length,I=le>0?`Anh/ch vn cn ${le} cu cha tr li. Anh/ch c chc chn mun np bi khng?`:"Anh/ch  hon thnh tt c cc cu hi. Anh/ch c mun np bi khng?";window.confirm(I)&&e(ue)},[n.questions.length,e]),$=Y.useRef(e);Y.useEffect(()=>{$.current=e},[e]),Y.useEffect(()=>{const ue=setInterval(()=>{N(le=>le>0?le-1:0)},1e3);return()=>clearInterval(ue)},[]),Y.useEffect(()=>{S===0&&(alert(" ht gi lm bi! H thng s t ng np bi ca anh/ch."),$.current(k.current))},[S]);const te=(ue,le)=>{E(I=>({...I,[ue]:le}))};return h.jsxs("div",{className:"w-full max-w-7xl mx-auto font-sans text-black shadow-lg animate-slide-in-right rounded-md",children:[h.jsx("div",{className:"h-3 bg-yellow-700 rounded-t-md border-b-2 border-yellow-900"}),h.jsxs("div",{className:"bg-white p-4",children:[h.jsxs("div",{className:"flex justify-between items-start pb-4 border-b border-gray-300",children:[h.jsxs("div",{className:"flex gap-4 items-center",children:[h.jsx("img",{src:"https://i.postimg.cc/8PDn1wfM/favicon.png",alt:"Avatar",className:"w-20 h-[100px] border border-gray-300 object-contain p-1"}),h.jsxs("div",{className:"text-sm",children:[h.jsx("p",{children:"S bo danh:"}),h.jsx("p",{children:"Ngy sinh:"}),h.jsxs("p",{className:"mt-2",children:["H tn: ",h.jsx("span",{className:"font-bold text-blue-700",children:r||"Hc vin"})]}),h.jsxs("p",{children:["Hng bng: ",h.jsx("span",{className:"font-bold text-blue-700",children:(a==null?void 0:a.name)||"Thuyn trng hng ba - T3"})]})]})]}),h.jsxs("div",{className:"flex items-start gap-4",children:[h.jsxs("div",{className:"bg-[#f0ad4e] text-black p-2 rounded-md text-sm w-48",children:[h.jsx("p",{className:"font-bold",children:"ang thi"}),h.jsx("p",{children:"Thi gian: 45 pht"}),h.jsx("p",{children:"B gi: 0 pht"}),h.jsxs("p",{children:["Cn li: ",h.jsx("span",{className:"font-bold",children:pj(S)})]})]}),h.jsx("button",{onClick:V,className:"text-sm text-gray-600 hover:text-red-500 font-semibold",children:"Thot"})]})]}),h.jsxs("div",{className:"flex mt-4 gap-4",children:[h.jsxs("div",{className:"flex-1 border border-gray-400 rounded-md p-4 flex flex-col justify-between min-h-[500px]",children:[h.jsxs("div",{children:[h.jsx("p",{className:"font-bold mb-4 border-b border-dashed border-gray-400 pb-2",children:"Ni dung cu hi"}),h.jsxs("p",{className:"font-bold text-red-600 mb-2",children:["Cu :",y+1]}),h.jsx("p",{className:"mb-4 font-semibold",children:M.text}),M.image&&h.jsx("div",{className:"mb-4 flex justify-start",children:h.jsx("img",{src:M.image,alt:"Hnh nh cu hi",className:"max-w-full h-auto max-h-60 object-contain border border-gray-300 rounded-md"})}),h.jsx("div",{className:"space-y-4",children:M.answers.map((ue,le)=>h.jsxs("div",{className:"flex items-start",children:[h.jsxs("span",{className:"font-bold mr-2 text-gray-700 min-w-[20px]",children:[String.fromCharCode(65+le),"."]}),h.jsx("p",{children:ue.text})]},ue.id))})]}),h.jsxs("div",{className:"flex justify-center gap-4 mt-8",children:[h.jsxs("button",{onClick:()=>_(ue=>Math.max(0,ue-1)),disabled:y===0,className:"bg-[#f0ad4e] text-black px-4 py-2 rounded-md border border-gray-400 flex items-center font-semibold hover:bg-yellow-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"w-5 h-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})}),"Tr li"]}),y<n.questions.length-1&&h.jsxs("button",{onClick:()=>_(ue=>Math.min(n.questions.length-1,ue+1)),className:"bg-[#f0ad4e] text-black px-4 py-2 rounded-md border border-gray-400 flex items-center font-semibold hover:bg-yellow-500 transition-colors",children:["Tip tc",h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"w-5 h-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})})]})]})]}),h.jsxs("div",{className:"w-[200px] flex-none flex flex-col",children:[h.jsx("div",{className:"border border-gray-300 rounded-md",children:h.jsxs("table",{className:"w-full border-collapse text-xs",children:[h.jsx("thead",{className:"sticky top-0 bg-[#f0ad4e] z-10",children:h.jsxs("tr",{children:[h.jsx("th",{className:"border border-gray-400 p-2",children:"Cu"}),h.jsx("th",{className:"border border-gray-400 p-2",children:"a"}),h.jsx("th",{className:"border border-gray-400 p-2",children:"b"}),h.jsx("th",{className:"border border-gray-400 p-2",children:"c"}),h.jsx("th",{className:"border border-gray-400 p-2",children:"d"})]})}),h.jsx("tbody",{children:n.questions.map((ue,le)=>h.jsxs("tr",{className:y===le?"bg-cyan-200":"hover:bg-gray-50",children:[h.jsxs("td",{className:`border border-gray-400 p-2 font-bold text-center cursor-pointer whitespace-nowrap ${y===le?"text-black":"text-gray-500"}`,onClick:()=>_(le),children:["Cu ",le+1]}),ue.answers.slice(0,4).map(I=>h.jsx("td",{className:"border border-gray-400 p-2 text-center",children:h.jsx(yj,{checked:w[ue.id]===I.id,onChange:()=>te(ue.id,I.id)})},I.id))]},ue.id))})]})}),h.jsx("div",{className:"text-center mt-4 pt-2 border-t border-gray-200",children:h.jsx("button",{onClick:F,className:"bg-[#337ab7] text-white px-8 py-2 rounded-md font-semibold hover:bg-blue-700 transition-colors w-full",children:"Np bi"})})]})]}),h.jsxs("div",{className:"mt-4 bg-[#005a9c] text-white p-4 rounded-b-md flex items-center gap-4 text-xs",children:[h.jsx("img",{src:"https://i.postimg.cc/8PDn1wfM/favicon.png",alt:"Logo",className:"h-16 w-16 object-contain"}),h.jsxs("div",{children:[h.jsx("p",{className:"font-bold",children:"CNG TY C PHN T VN V GIO DC NINH BNH"}),h.jsx("p",{children:"a ch: ng Triu Vit Vng, phng Hoa L, tnh Ninh Bnh "})]})]})]})]})},_j=({quiz:n,userAnswers:e,score:t,onRetry:r,onBack:a,userName:l})=>{const[c,m]=Y.useState("all"),[g]=Y.useState(()=>new Date),y=n.questions.length,_=t>=25,w=Y.useMemo(()=>new Intl.DateTimeFormat("vi-VN",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"}).format(g),[g]),E=Y.useMemo(()=>c==="incorrect"?n.questions.filter(S=>e[S.id]!==S.correctAnswerId):n.questions,[c,n.questions,e]);return h.jsxs("div",{className:"w-full max-w-4xl mx-auto p-4 animate-slide-in-right font-quiz-default",children:[h.jsxs("div",{className:"bg-card text-card-foreground rounded-2xl shadow-xl p-8 text-center mb-8",children:[h.jsx(px,{className:"h-24 w-24 mx-auto text-yellow-400 mb-4"}),h.jsx("h1",{className:"text-4xl font-bold text-foreground mb-2",children:"Kt qu Thi th"}),h.jsxs("div",{className:"my-4 text-muted-foreground",children:[h.jsxs("p",{className:"text-lg",children:["Th sinh: ",h.jsx("span",{className:"font-bold text-primary",children:l})]}),h.jsxs("p",{className:"text-sm",children:["Hon thnh lc: ",w]})]}),h.jsx("p",{className:`text-2xl font-bold mb-6 ${_?"text-success":"text-destructive"}`,children:_?"Chc mng, anh/ch  T!":"Rt tic, anh/ch KHNG T."}),h.jsxs("div",{className:`inline-block p-6 rounded-xl border ${_?"bg-success/10 border-success/20":"bg-destructive/10 border-destructive/20"}`,children:[h.jsxs("p",{className:`text-5xl font-extrabold ${_?"text-success":"text-destructive"}`,children:[t," / ",y]}),h.jsx("p",{className:"text-lg text-muted-foreground mt-1",children:"S cu ng"})]})]}),h.jsxs("div",{className:"bg-card text-card-foreground rounded-2xl shadow-xl p-8",children:[h.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6",children:[h.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Xem li bi lm"}),h.jsxs("div",{className:"flex items-center gap-2 mt-4 sm:mt-0",children:[h.jsx("button",{onClick:()=>m("all"),className:`px-4 py-2 text-sm font-semibold rounded-md transition-colors ${c==="all"?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground"}`,children:"Tt c"}),h.jsxs("button",{onClick:()=>m("incorrect"),className:`px-4 py-2 text-sm font-semibold rounded-md transition-colors ${c==="incorrect"?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground"}`,children:["Ch cu sai (",n.questions.length-t,")"]})]})]}),h.jsx("div",{className:"space-y-6 max-h-[50vh] overflow-y-auto pr-2",children:E.length>0?E.map((S,N)=>{const M=e[S.id],k=S.correctAnswerId;return h.jsxs("div",{className:"p-4 border-b border-border last:border-b-0",children:[h.jsxs("p",{className:"font-semibold text-lg mb-3 text-foreground",children:[h.jsxs("span",{className:"mr-2",children:["Cu ",n.questions.findIndex(V=>V.id===S.id)+1,":"]}),S.text]}),h.jsx("div",{className:"space-y-2",children:S.answers.map(V=>{const F=V.id===M,$=V.id===k;let te="flex items-center p-3 rounded-md text-sm ";return $?te+="bg-success/10 text-success":F?te+="bg-destructive/10 text-destructive":te+="bg-muted/50 text-muted-foreground",h.jsxs("div",{className:te,children:[$?h.jsx(d0,{className:"h-5 w-5 mr-3 text-success"}):F?h.jsx(f0,{className:"h-5 w-5 mr-3 text-destructive"}):h.jsx("div",{className:"w-5 h-5 mr-3"}),h.jsx("span",{children:V.text})]},V.id)})})]},S.id)}):h.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Tuyt vi! Anh/ch  tr li ng tt c cc cu hi."})})]}),h.jsxs("div",{className:"text-center mt-8 flex flex-col sm:flex-row justify-center items-center gap-4",children:[h.jsx("button",{onClick:a,className:"w-full sm:w-auto bg-primary text-primary-foreground font-bold py-3 px-8 rounded-lg hover:bg-primary/90 focus:outline-none focus:ring-4 focus:ring-ring transition-all duration-300 transform hover:scale-105",children:"Quay li"}),h.jsx("button",{onClick:r,className:"w-full sm:w-auto bg-secondary text-secondary-foreground font-bold py-3 px-8 rounded-lg hover:bg-muted focus:outline-none focus:ring-4 focus:ring-ring transition-colors duration-300",children:"Lm li bi thi"})]})]})},bj=({quiz:n,userAnswers:e,score:t,onRetry:r,onBack:a,userName:l})=>{const[c,m]=Y.useState("all"),[g]=Y.useState(()=>new Date),y=n.questions.length,_=y>0?Math.round(t/y*100):0,w=Y.useMemo(()=>new Intl.DateTimeFormat("vi-VN",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"}).format(g),[g]),E=Y.useMemo(()=>c==="incorrect"?n.questions.filter(S=>e[S.id]!==S.correctAnswerId):n.questions,[c,n.questions,e]);return h.jsxs("div",{className:"w-full max-w-4xl mx-auto p-4 animate-slide-in-right font-quiz-default",children:[h.jsxs("div",{className:"bg-card text-card-foreground rounded-2xl shadow-xl p-8 text-center mb-8",children:[h.jsx(px,{className:"h-24 w-24 mx-auto text-yellow-400 mb-4"}),h.jsx("h1",{className:"text-4xl font-bold text-foreground mb-2",children:"Kt qu n tp"}),h.jsxs("div",{className:"my-4 text-muted-foreground",children:[h.jsxs("p",{className:"text-lg",children:["Hc vin: ",h.jsx("span",{className:"font-bold text-primary",children:l})]}),h.jsxs("p",{className:"text-sm",children:["Hon thnh lc: ",w]})]}),h.jsxs("div",{className:"bg-primary/10 inline-block p-6 rounded-xl border border-primary/20 mt-4",children:[h.jsxs("p",{className:"text-5xl font-extrabold text-primary",children:[t," / ",y]}),h.jsxs("p",{className:"text-2xl font-semibold text-primary/80 mt-1",children:["(",_,"%)"]})]})]}),h.jsxs("div",{className:"bg-card text-card-foreground rounded-2xl shadow-xl p-8",children:[h.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6",children:[h.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Xem li bi lm"}),h.jsxs("div",{className:"flex items-center gap-2 mt-4 sm:mt-0",children:[h.jsx("button",{onClick:()=>m("all"),className:`px-4 py-2 text-sm font-semibold rounded-md transition-colors ${c==="all"?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground"}`,children:"Tt c"}),h.jsxs("button",{onClick:()=>m("incorrect"),className:`px-4 py-2 text-sm font-semibold rounded-md transition-colors ${c==="incorrect"?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground"}`,children:["Ch cu sai (",n.questions.length-t,")"]})]})]}),h.jsx("div",{className:"space-y-6 max-h-[50vh] overflow-y-auto pr-2",children:E.length>0?E.map((S,N)=>{const M=e[S.id],k=S.correctAnswerId;return h.jsxs("div",{className:"p-4 border-b border-border last:border-b-0",children:[h.jsxs("p",{className:"font-semibold text-lg mb-3 text-foreground",children:[h.jsxs("span",{className:"mr-2",children:["Cu ",n.questions.findIndex(V=>V.id===S.id)+1,":"]}),S.text]}),h.jsx("div",{className:"space-y-2",children:S.answers.map(V=>{const F=V.id===M,$=V.id===k;let te="flex items-center p-3 rounded-md text-sm ";return $?te+="bg-success/10 text-success":F?te+="bg-destructive/10 text-destructive":te+="bg-muted/50 text-muted-foreground",h.jsxs("div",{className:te,children:[$?h.jsx(d0,{className:"h-5 w-5 mr-3 text-success"}):F?h.jsx(f0,{className:"h-5 w-5 mr-3 text-destructive"}):h.jsx("div",{className:"w-5 h-5 mr-3"}),h.jsx("span",{children:V.text})]},V.id)})})]},S.id)}):h.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Tuyt vi! Anh/ch  tr li ng tt c cc cu hi."})})]}),h.jsxs("div",{className:"text-center mt-8 flex flex-col sm:flex-row justify-center items-center gap-4",children:[h.jsx("button",{onClick:a,className:"w-full sm:w-auto bg-primary text-primary-foreground font-bold py-3 px-8 rounded-lg hover:bg-primary/90 focus:outline-none focus:ring-4 focus:ring-ring transition-all duration-300 transform hover:scale-105",children:"Cc mn khc"}),h.jsx("button",{onClick:r,className:"w-full sm:w-auto bg-secondary text-secondary-foreground font-bold py-3 px-8 rounded-lg hover:bg-muted focus:outline-none focus:ring-4 focus:ring-ring transition-colors duration-300",children:"Lm li"})]})]})},wj="_card_ns310_3",xj="_header_ns310_45",Ej="_logoPlaceholder_ns310_69",Tj="_schoolName_ns310_97",Sj="_body_ns310_113",Aj="_cardTitle_ns310_135",Nj="_contentRow_ns310_157",Rj="_photoSection_ns310_169",Cj="_photoWrapper_ns310_179",Ij="_avatar_ns310_195",jj="_infoSection_ns310_209",kj="_infoRow_ns310_229",Oj="_label_ns310_239",Dj="_value_ns310_255",Mj="_valueHighlight_ns310_265",Pj="_footer_ns310_281",Vj="_barcode_ns310_299",mt={card:wj,header:xj,logoPlaceholder:Ej,schoolName:Tj,body:Sj,cardTitle:Aj,contentRow:Nj,photoSection:Rj,photoWrapper:Cj,avatar:Ij,infoSection:jj,infoRow:kj,label:Oj,value:Dj,valueHighlight:Mj,footer:Pj,barcode:Vj},Lj=({user:n})=>{const e=n.role!=="hoc_vien",t=e?"TH GIO VIN":"TH HC VIN",r=e?{background:"linear-gradient(135deg, #b91c1c 0%, #c2410c 100%)",borderBottom:"4px solid #fcd34d"}:{},a=e?{color:"#b91c1c",textShadow:"0px 1px 2px rgba(0,0,0,0.1)"}:{};return h.jsxs("div",{className:mt.card,style:e?{borderColor:"#fcd34d",boxShadow:"0 10px 25px -5px rgba(234, 88, 12, 0.3)"}:{},children:[h.jsxs("div",{className:mt.header,style:r,children:[h.jsx("div",{className:mt.logoPlaceholder,style:e?{color:"#fbbf24",background:"rgba(255,255,255,0.2)"}:{},children:h.jsx(Z6,{size:20})}),h.jsxs("div",{className:mt.schoolName,style:e?{color:"#fff",fontWeight:"800"}:{},children:["Cng ty C phn",h.jsx("br",{}),"T VN V GIO DC NINH BNH"]})]}),h.jsxs("div",{className:mt.body,children:[h.jsx("h2",{className:mt.cardTitle,style:a,children:t}),h.jsxs("div",{className:mt.contentRow,children:[h.jsx("div",{className:mt.photoSection,children:h.jsx("div",{className:mt.photoWrapper,style:e?{borderColor:"#fcd34d"}:{},children:h.jsx("img",{src:n.photoURL||"https://via.placeholder.com/150",alt:"Avatar",className:mt.avatar})})}),h.jsxs("div",{className:mt.infoSection,children:[h.jsxs("div",{className:mt.infoRow,children:[h.jsx("span",{className:mt.label,children:"H tn:"}),h.jsx("span",{className:`${mt.value} ${mt.valueHighlight}`,style:e?{color:"#b91c1c"}:{},children:n.full_name||"---"})]}),h.jsxs("div",{className:mt.infoRow,children:[h.jsx("span",{className:mt.label,children:"Ngy sinh: "}),h.jsxs("span",{className:mt.value,children:[" ",n.birthDate||" --/--/----"]})]}),e?h.jsxs("div",{className:mt.infoRow,children:[h.jsx("span",{className:mt.label,children:"Phng: "}),h.jsx("span",{className:mt.value,style:{fontWeight:"bold"},children:" Phng o to - T vn hnh my tu thy"})]}):h.jsxs("div",{className:mt.infoRow,children:[h.jsx("span",{className:mt.label,children:"Lp hc: "}),h.jsx("span",{className:mt.value,children:n.courseName||"Cha vo kha"})]}),h.jsxs("div",{className:mt.infoRow,children:[h.jsx("span",{className:mt.label,children:"a ch:"}),h.jsx("span",{className:mt.value,style:{fontSize:"0.9rem"},children:n.address||"---"})]})]})]})]}),h.jsxs("div",{className:mt.footer,style:e?{background:"#fef2f2",borderTop:"1px dashed #fca5a5"}:{},children:[h.jsx("div",{className:mt.barcode,style:e?{opacity:.8}:{}}),h.jsxs("div",{style:{position:"absolute",bottom:"5px",fontSize:"0.6rem",color:e?"#991b1b":"#718096"},children:["ID: ",n.id?n.id.substring(0,10).toUpperCase():"---"]})]})]})},Uj=({isOpen:n,onClose:e,notifications:t,userId:r,onMarkRead:a})=>{if(!n)return null;const l=async(c,m)=>{c.stopPropagation(),confirm("Bn c mun xa thng bo ny?")&&await P6(m.id,r)};return h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4 animate-fade-in",onClick:e,children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[80vh]",onClick:c=>c.stopPropagation(),children:[h.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-slate-700 flex justify-between items-center bg-gradient-to-r from-blue-500 to-indigo-600 text-white",children:[h.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[h.jsx(Eu,{})," Hp th thng bo"]}),h.jsx("button",{onClick:e,className:"hover:bg-white/20 p-2 rounded-full transition-colors",children:h.jsx(pl,{})})]}),h.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50 dark:bg-slate-900/50",children:t.length===0?h.jsxs("div",{className:"text-center py-10 text-gray-400",children:[h.jsx(X6,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),h.jsx("p",{children:"Cha c thng bo no."})]}):t.map(c=>{var g,y;const m=((g=c.readBy)==null?void 0:g.includes(r))||c.read;return h.jsxs("div",{onClick:()=>a(c.id),className:`p-4 rounded-xl border transition-all cursor-pointer relative overflow-hidden group
                                        ${m?"bg-white dark:bg-slate-800 border-gray-200 dark:border-slate-700 opacity-60":"bg-white dark:bg-slate-800 border-blue-200 dark:border-blue-500/50 shadow-md transform hover:-translate-y-1"}
                                    `,children:[!m&&h.jsx("div",{className:"absolute top-0 right-0 w-3 h-3 bg-red-500 rounded-full m-2 animate-pulse"}),h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("div",{className:`p-2 rounded-full flex-shrink-0 
                                            ${c.type==="special"?"bg-red-100 text-red-600 animate-pulse":c.type==="attention"?"bg-orange-100 text-orange-600":c.type==="system"?"bg-blue-100 text-blue-600":c.type==="class"?"bg-indigo-100 text-indigo-600":c.type==="reminder"?"bg-yellow-100 text-yellow-600":"bg-green-100 text-green-600"}
                                        `,children:h.jsx(Eu,{size:14})}),h.jsxs("div",{className:"flex-1",children:[h.jsxs("h3",{className:`font-bold text-sm mb-1 ${m?"text-gray-600 dark:text-gray-400":"text-gray-900 dark:text-white"}`,children:[c.title,(c.type==="special"||c.type==="attention")&&h.jsx("span",{className:"ml-2 text-[10px] uppercase border px-1 rounded bg-red-50 text-red-500 border-red-200",children:"Quan trng"})]}),h.jsx("p",{className:"text-xs text-gray-500 mb-2 line-clamp-3",children:c.message}),h.jsxs("div",{className:"flex justify-between items-center text-[10px] text-gray-400",children:[h.jsx("span",{children:c.senderName}),h.jsx("span",{children:(y=c.createdAt)!=null&&y.seconds?new Date(c.createdAt.seconds*1e3).toLocaleDateString("vi-VN"):"Va xong"})]})]}),h.jsx("button",{onClick:_=>l(_,c),className:"p-2 text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",title:"Xa thng bo",children:h.jsx(El,{size:12})})]})]},c.id)})})]})})},zj=({notification:n,userId:e,onDismiss:t,onOpenInbox:r})=>{const[a,l]=Y.useState(!1);return Y.useEffect(()=>{if(n&&!n.readBy.includes(e)&&(l(!0),n.type!=="system")){const c=setTimeout(()=>l(!1),8e3);return()=>clearTimeout(c)}},[n,e]),!n||!a?null:h.jsx("div",{className:"fixed top-20 right-4 z-40 max-w-sm w-full animate-slide-in-right cursor-pointer",onClick:r,children:h.jsxs("div",{className:`rounded-xl shadow-2xl border-l-4 p-4 flex items-start gap-3 relative overflow-hidden backdrop-blur-md bg-white/90 dark:bg-slate-800/90
                ${n.type==="system"?"border-red-500":"border-blue-500"}
            `,children:[h.jsx("button",{onClick:c=>{c.stopPropagation(),l(!1),t()},className:"absolute top-2 right-2 text-gray-400 hover:text-gray-600 p-1",children:h.jsx(pl,{size:12})}),h.jsx("div",{className:`p-2 rounded-full ${n.type==="system"?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600"}`,children:h.jsx(Eu,{})}),h.jsxs("div",{className:"flex-1 pr-6",children:[h.jsx("h4",{className:"font-bold text-sm text-gray-900 dark:text-white mb-1",children:n.title}),h.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300 line-clamp-2",children:n.message}),h.jsx("p",{className:"text-[10px] text-gray-400 mt-2",children:"Nhn  xem chi tit"})]})]})})},Bj=({userProfile:n,onStart:e,onHistoryClick:t,onClassClick:r})=>{const{theme:a}=Rn(),[l,c]=Y.useState([]),[m,g]=Y.useState(!1),[y,_]=Y.useState(0),[w,E]=Y.useState(null);Y.useEffect(()=>{(async()=>{if(n!=null&&n.id){const M=await M6(n.id,n.class);c(M);const k=M.filter(V=>!V.read);_(k.length),k.length>0&&E(k[0])}})()},[n]);const S=N=>{c(M=>M.map(k=>k.id===N?{...k,read:!0,readBy:[...k.readBy||[],n.id]}:k)),_(M=>Math.max(0,M-1)),(w==null?void 0:w.id)===N&&E(null)};return h.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 animate-slide-in-right",children:h.jsxs("div",{className:"w-full max-w-4xl grid grid-cols-1 md:grid-cols-2 gap-8 items-center",children:[h.jsxs("div",{className:"flex flex-col items-center",children:[h.jsx("div",{className:"w-full flex justify-end mb-4 md:mb-0 relative md:absolute md:top-4 md:right-4 gap-2",children:h.jsxs("button",{onClick:()=>g(!0),className:"bg-white/80 dark:bg-slate-800/80 p-3 rounded-full shadow-lg hover:scale-110 transition-transform relative",children:[h.jsx(Eu,{className:"text-xl text-yellow-500"}),y>0&&h.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold w-5 h-5 rounded-full flex items-center justify-center animate-bounce",children:y})]})}),h.jsx(Lj,{user:n})]}),h.jsx(Uj,{isOpen:m,onClose:()=>g(!1),notifications:l,userId:n.id,onMarkRead:S}),h.jsx(zj,{notification:w,userId:n.id,onDismiss:()=>E(null),onOpenInbox:()=>g(!0)}),h.jsxs("div",{className:"bg-card/90 backdrop-blur-sm p-8 rounded-2xl shadow-xl border border-border",children:[h.jsxs("h1",{className:"text-3xl font-bold text-primary mb-6 text-center",children:["Xin cho, ",n.full_name||"Hc vin","!"]}),h.jsx("p",{className:"text-muted-foreground text-center mb-8",children:"Chc bn c mt bui n tp hiu qu v t kt qu cao."}),h.jsx("div",{className:"space-y-4",children:h.jsxs("button",{onClick:e,className:"w-full bg-primary text-primary-foreground font-bold text-lg py-4 px-6 rounded-xl hover:bg-primary/90 focus:outline-none focus:ring-4 focus:ring-ring transition-all duration-300 transform hover:scale-105 flex items-center justify-center gap-3 shadow-lg",children:[h.jsx(m0,{className:"w-8 h-8"}),h.jsx("span",{children:"Vo n Tp / Thi Th"})]})})]})]})})},hf=async n=>{try{const e=Ht(xt(ke,"exam_results"),un("studentId","==",n));return(await bn(e)).docs.map(a=>{const l=a.data(),c=l.submitted_at||l.completedAt,m=c?c.toDate():new Date;return{id:a.id,...l,userId:l.studentId,completedAt:m}}).sort((a,l)=>l.completedAt.getTime()-a.completedAt.getTime())}catch(e){return console.error("Error fetching exam history:",e),[]}},qj=({userProfile:n,onBack:e})=>{const[t,r]=Y.useState([]),[a,l]=Y.useState(!0),[c,m]=Y.useState({});Y.useEffect(()=>{(async()=>{const E=await hf(n.id);E.sort((N,M)=>M.completedAt.getTime()-N.completedAt.getTime()),r(E),l(!1);const S=Array.from(new Set(E.filter(N=>N.roomId).map(N=>N.roomId)));if(S.length>0){const N={};await Promise.all(S.map(async M=>{try{const{doc:k,getDoc:V}=await Ls(async()=>{const{doc:te,getDoc:ue}=await Promise.resolve().then(()=>pE);return{doc:te,getDoc:ue}},void 0),{db:F}=await Ls(async()=>{const{db:te}=await Promise.resolve().then(()=>D6);return{db:te}},void 0),$=await V(k(F,"exam_rooms",M));$.exists()&&(N[M]=$.data())}catch(k){console.error(`Error fetching room ${M}`,k)}})),m(N)}})()},[n.id]);const g=w=>w.roomId?"Thi Trc Tuyn":w.quizId==="exam-quiz"||w.quizId==="thithu2"||w.type==="Thi th"?"Thi th":"n tp",y=w=>{switch(w){case"Thi Trc Tuyn":return"bg-red-100 text-red-800 border-red-200";case"Thi th":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-blue-100 text-blue-800 border-blue-200"}},_=w=>{if(w.roomId&&c[w.roomId]){const E=c[w.roomId];return`Phng thi ${E.name} / ${E.course_name||"T do"} / ${E.license_name||""}`}return w.quizTitle||(w.roomId?`Phng thi ${w.roomId}`:w.type)};return h.jsxs("div",{className:"w-full max-w-5xl mx-auto p-4 animate-slide-in-right",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsxs("h1",{className:"text-2xl font-bold text-foreground flex items-center gap-2",children:[h.jsx(ou,{className:"text-primary"}),"Lch s n tp & Thi"]}),h.jsx("button",{onClick:e,className:"bg-secondary text-secondary-foreground px-4 py-2 rounded-lg hover:bg-secondary/80 transition-colors shadow-sm",children:"Quay li"})]}),a?h.jsx("div",{className:"text-center p-8",children:h.jsx("p",{className:"text-muted-foreground",children:"ang ti d liu..."})}):t.length===0?h.jsx("div",{className:"text-center p-8 bg-card rounded-xl shadow-sm border border-border",children:h.jsx("p",{className:"text-muted-foreground",children:"Cha c lch s lm bi no."})}):h.jsx("div",{className:"bg-white dark:bg-card rounded-xl shadow-sm border border-border overflow-hidden",children:h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full text-left border-collapse",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"bg-muted/50 border-b border-border text-xs uppercase text-muted-foreground",children:[h.jsx("th",{className:"p-4 font-semibold",children:"Loi"}),h.jsx("th",{className:"p-4 font-semibold",children:"Bi thi"}),h.jsx("th",{className:"p-4 font-semibold text-center",children:"im s"}),h.jsx("th",{className:"p-4 font-semibold",children:"Gi np"})," ",h.jsx("th",{className:"p-4 font-semibold",children:"Ngy np"})]})}),h.jsx("tbody",{className:"divide-y divide-border",children:t.map(w=>{const E=g(w);return h.jsxs("tr",{className:"hover:bg-muted/30 transition-colors",children:[h.jsx("td",{className:"p-4 align-middle",children:h.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-medium border ${y(E)}`,children:E})}),h.jsx("td",{className:"p-4 align-middle font-medium text-foreground",children:_(w)}),h.jsxs("td",{className:"p-4 align-middle text-center",children:[h.jsx("span",{className:"font-bold text-primary",children:w.score}),h.jsxs("span",{className:"text-muted-foreground text-sm",children:[" / ",w.totalQuestions]})]}),h.jsx("td",{className:"p-4 align-middle text-sm",children:new Date(w.completedAt).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})}),h.jsx("td",{className:"p-4 align-middle text-sm text-muted-foreground",children:new Date(w.completedAt).toLocaleDateString("vi-VN")})]},w.id)})})]})})})]})},Hj=n=>{if(!n)return"Thnh vin";const e=n.toLowerCase().trim();return{admin:"Qun tr vin",quan_ly:"Qun l",lanh_dao:"Lnh o",giao_vien:"Gio vin",hoc_vien:"Hc vin",phu_huynh:"Ph huynh"}[e]||n},$j=({userProfile:n,onBack:e})=>{const[t,r]=Y.useState(null),[a,l]=Y.useState([]),[c,m]=Y.useState([]),[g,y]=Y.useState(!0),[_,w]=Y.useState("grid"),[E,S]=Y.useState({});return Y.useEffect(()=>{let N,M,k;return(async()=>{if(!n.id)return;const F=qt(ke,"users",n.id),$=await vu(F);if(!$.exists()){y(!1);return}const ue=$.data().courseId;if(!ue){y(!1);return}const le=qt(ke,"courses",ue);N=vl(le,I=>{if(I.exists()){const C={id:I.id,...I.data()};if(r(C),M&&M(),C.teacherIds&&C.teacherIds.length>0)try{const j=[...new Set(C.teacherIds.filter(R=>R&&R.trim()!==""))].slice(0,10);if(j.length>0){const R=Ht(xt(ke,"users"),un(Pf(),"in",j));M=vl(R,D=>{l(D.docs.map(L=>({uid:L.id,...L.data()})))})}else l([])}catch(j){console.error("Error creating teacher query:",j),l([])}else l([]);if(k)y(!1);else{const j=Ht(xt(ke,"users"),un("courseId","==",ue),un("role","==","hoc_vien"));k=vl(j,async R=>{const D=R.docs.map(O=>({uid:O.id,...O.data()}));m(D);const L={};await Promise.all(D.map(async O=>{try{const Fe=await hf(O.uid);if(Fe&&Fe.length>0){const et=Fe[0];L[O.uid]={type:et.quizTitle||et.type||"Bi thi",time:et.completedAt?et.completedAt.toLocaleString("vi-VN"):"--",score:`${et.score}/${et.totalQuestions} cu`}}else L[O.uid]={type:"--",time:"--",score:"--"}}catch(Fe){console.error(`Error fetching history for ${O.uid}`,Fe),L[O.uid]={type:"Li",time:"--",score:"--"}}})),S(L),y(!1)})}}else r(null),y(!1)})})(),()=>{N&&N(),M&&M(),k&&k()}},[n.id]),g?h.jsx("div",{className:"flex justify-center items-center h-screen",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600"})}):t?h.jsxs("div",{className:"w-full max-w-7xl mx-auto p-4 animate-slide-in-right",children:[h.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[h.jsxs("div",{children:[h.jsxs("button",{onClick:e,className:"flex items-center gap-2 text-sm text-gray-500 hover:text-blue-600 mb-2 transition-colors font-medium",children:[h.jsx(cf,{})," Quay li Dashboard"]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-2 rounded-lg",children:h.jsx(xl,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-cyan-500",children:t.name}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-0.5",children:t.description||"Cha c m t"})]})]})]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsxs("div",{className:"bg-white dark:bg-slate-800 px-4 py-2 rounded-xl shadow-sm border border-gray-100 dark:border-slate-700 flex items-center gap-3",children:[h.jsx("div",{className:"bg-green-100 p-2 rounded-full text-green-600",children:h.jsx(lu,{})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-xs text-gray-500",children:"Gio vin"}),h.jsx("p",{className:"font-bold text-lg",children:a.length})]})]}),h.jsxs("div",{className:"bg-white dark:bg-slate-800 px-4 py-2 rounded-xl shadow-sm border border-gray-100 dark:border-slate-700 flex items-center gap-3",children:[h.jsx("div",{className:"bg-blue-100 p-2 rounded-full text-blue-600",children:h.jsx(Tu,{})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-xs text-gray-500",children:"Hc vin"}),h.jsx("p",{className:"font-bold text-lg",children:c.length})]})]})]})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[h.jsx("div",{className:"lg:col-span-1 space-y-6",children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200 dark:border-slate-700 p-5 sticky top-20",children:[h.jsxs("h3",{className:"font-bold text-lg mb-4 flex items-center gap-2 text-gray-800 dark:text-white border-b pb-3 border-gray-100 dark:border-slate-700",children:[h.jsx(lu,{className:"text-green-500"})," i ng Gio vin"]}),h.jsxs("div",{className:"space-y-3",children:[a.map(N=>h.jsxs("div",{className:"flex items-center gap-3 p-2 hover:bg-gray-50 dark:hover:bg-slate-700/50 rounded-lg transition-colors group cursor-pointer",children:[h.jsxs("div",{className:"relative",children:[h.jsx("img",{src:N.photoURL||`https://ui-avatars.com/api/?name=${encodeURIComponent(N.fullName)}&background=random`,alt:N.fullName,className:"w-10 h-10 rounded-full object-cover border border-gray-200 dark:border-slate-600 group-hover:scale-105 transition-transform"}),t.headTeacherId===N.uid&&h.jsx("div",{className:"absolute -top-1 -right-1 bg-yellow-400 text-white rounded-full p-0.5 border-2 border-white",children:h.jsx(aT,{size:10})})]}),h.jsxs("div",{className:"min-w-0 flex-1",children:[h.jsx("p",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 truncate",children:N.fullName}),h.jsx("p",{className:"text-[11px] text-gray-400",children:Hj(N.role)}),t.headTeacherId===N.uid&&h.jsx("span",{className:"inline-flex items-center text-[10px] font-bold text-yellow-600",children:" GV Ch Nhim"})]})]},N.uid)),a.length===0&&h.jsx("p",{className:"text-sm text-gray-500 italic text-center py-4",children:"Cha c thng tin gio vin."})]})]})}),h.jsx("div",{className:"lg:col-span-3",children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200 dark:border-slate-700 p-6 min-h-[500px]",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[h.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-700 rounded-lg p-1",children:[h.jsx("button",{onClick:()=>w("grid"),className:`p-1.5 rounded ${_==="grid"?"bg-white dark:bg-slate-600 shadow text-blue-600":"text-gray-500 hover:text-blue-500"}`,title:"Dng li",children:h.jsx(cT,{})}),h.jsx("button",{onClick:()=>w("list"),className:`p-1.5 rounded ${_==="list"?"bg-white dark:bg-slate-600 shadow text-blue-600":"text-gray-500 hover:text-blue-500"}`,title:"Dng danh sch",children:h.jsx(oT,{})})]}),h.jsxs("span",{className:"text-sm px-2 py-0.5 bg-blue-100 text-blue-700 rounded-full font-medium",children:[c.length," thnh vin"]})]}),c.length===0?h.jsxs("div",{className:"text-center py-20 flex flex-col items-center",children:[h.jsx("div",{className:"bg-gray-100 dark:bg-slate-700 p-6 rounded-full mb-4",children:h.jsx(Tu,{className:"text-gray-300 w-12 h-12"})}),h.jsx("p",{className:"text-gray-500 font-medium",children:"Lp cha c hc vin no khc."})]}):_==="grid"?h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-5",children:c.map(N=>h.jsxs("div",{className:"bg-gray-50 dark:bg-slate-700/30 rounded-xl p-4 border border-gray-100 dark:border-slate-700 hover:shadow-md hover:border-blue-200 dark:hover:border-blue-500/30 transition-all duration-300 group relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-gradient-to-bl from-blue-100 to-transparent -mr-8 -mt-8 rounded-full opacity-50 group-hover:scale-150 transition-transform"}),h.jsxs("div",{className:"flex items-start gap-4 relative z-10",children:[h.jsxs("div",{className:"relative",children:[h.jsx("img",{src:N.photoURL||`https://ui-avatars.com/api/?name=${encodeURIComponent(N.fullName)}&background=random`,alt:N.fullName,className:"w-14 h-14 rounded-full object-cover border-2 border-white dark:border-slate-600 shadow-sm group-hover:border-blue-500 transition-colors"}),h.jsx("div",{className:"absolute bottom-0 right-0 w-3.5 h-3.5 bg-green-500 border-2 border-white rounded-full"})]}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("h4",{className:"font-bold text-gray-900 dark:text-gray-100 truncate group-hover:text-blue-600 transition-colors text-base",children:N.fullName}),h.jsxs("div",{className:"space-y-1.5 mt-2",children:[h.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1.5 bg-white dark:bg-slate-800 px-2 py-1 rounded border border-gray-100 dark:border-slate-600 w-fit",children:[h.jsx("span",{children:""})," ",N.birthDate||"--/--"]}),h.jsxs("p",{className:"text-xs text-gray-500 truncate flex items-center gap-1.5",title:N.address,children:[h.jsx("span",{children:""})," ",N.address||"Cha cp nht"]})]}),N.uid===n.id&&h.jsx("div",{className:"mt-2",children:h.jsx("span",{className:"text-[10px] font-bold text-teal-600 bg-teal-50 border border-teal-100 px-2 py-0.5 rounded-full",children:"L ti"})})]})]})]},N.uid))}):h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full text-sm text-left",children:[h.jsx("thead",{className:"text-xs text-gray-500 uppercase bg-gray-50 dark:bg-slate-700 dark:text-gray-300",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-4 py-3 rounded-l-lg",children:"Hc vin"}),h.jsx("th",{className:"px-4 py-3",children:"Ngy sinh"}),h.jsx("th",{className:"px-4 py-3",children:"Bi lm gn nht"}),h.jsx("th",{className:"px-4 py-3",children:"Thi gian"}),h.jsx("th",{className:"px-4 py-3 rounded-r-lg",children:"im"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-slate-700",children:c.map(N=>{const M=E[N.uid]||{type:"--",time:"--",score:"--"};return h.jsxs("tr",{className:"bg-white dark:bg-slate-800 hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors",children:[h.jsxs("td",{className:"px-4 py-3 font-medium text-gray-900 dark:text-white flex items-center gap-3",children:[h.jsx("img",{src:N.photoURL||`https://ui-avatars.com/api/?name=${encodeURIComponent(N.fullName)}`,className:"w-8 h-8 rounded-full border border-gray-200"}),h.jsxs("div",{children:[h.jsx("p",{children:N.fullName}),N.uid===n.id&&h.jsx("span",{className:"text-[10px] font-bold text-teal-600 border border-teal-100 bg-teal-50 px-1 rounded",children:"Ti"})]})]}),h.jsx("td",{className:"px-4 py-3 text-gray-500",children:N.birthDate||"--"}),h.jsx("td",{className:"px-4 py-3",children:h.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold
                                                        ${M.type.includes("n")?"bg-blue-100 text-blue-700":M.type.includes("Th")?"bg-purple-100 text-purple-700":M.type==="--"?"bg-gray-100 text-gray-500":"bg-red-100 text-red-700"}`,children:M.type})}),h.jsx("td",{className:"px-4 py-3 text-gray-500",children:M.time}),h.jsx("td",{className:"px-4 py-3 font-bold text-teal-600",children:M.score})]},N.uid)})})]})})]})})]})]}):h.jsxs("div",{className:"w-full max-w-5xl mx-auto p-4 animate-slide-in-right",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-3 bg-clip-text text-transparent bg-gradient-to-r from-teal-600 to-emerald-600",children:[h.jsx(xl,{className:"text-teal-600"})," Lp Ca Ti"]}),h.jsx("button",{onClick:e,className:"bg-gray-200 dark:bg-slate-700 text-gray-800 dark:text-gray-200 px-4 py-2 rounded-lg hover:bg-gray-300 dark:hover:bg-slate-600 transition-colors",children:"Quay li"})]}),h.jsx("div",{className:"text-center p-12 bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700 shadow-sm",children:h.jsx("p",{className:"text-gray-500",children:"Bn cha c phn lp."})})]})},Fj=n=>{switch(n){case"admin":return"Qun tr vin";case"lanh_dao":return"Lnh o";case"quan_ly":return"Qun l";case"giao_vien":return"Gio vin";case"hoc_vien":return"Hc vin";default:return n}},dp=n=>n==="admin"?10:n==="lanh_dao"?5:n==="quan_ly"?2:n==="giao_vien"?1:0,mr=n=>(n||"").toLowerCase(),Gj=({userProfile:n,onBack:e})=>{const[t,r]=Y.useState([]),[a,l]=Y.useState(null),[c,m]=Y.useState(!0),[g,y]=Y.useState({}),[_,w]=Y.useState(!0),[E,S]=Y.useState([]),[N,M]=Y.useState([]),[k,V]=Y.useState([]),[F,$]=Y.useState([]),[te,ue]=Y.useState({}),[le,I]=Y.useState(!1),[C,j]=Y.useState(!1),[R,D]=Y.useState(""),[L,O]=Y.useState(""),[Fe,et]=Y.useState(!1),[q,ce]=Y.useState(!1),[_e,De]=Y.useState(!1),[qe,U]=Y.useState(null),[ne,W]=Y.useState([]),[oe,fe]=Y.useState(!1),[Te,Me]=Y.useState({}),[tt,Je]=Y.useState(!1),[je,Ft]=Y.useState(null),[Ar,Nr]=Y.useState(!1),[nt,Qs]=Y.useState(!1),[Rr,Ys]=Y.useState(!1),[oi,Ct]=Y.useState(""),[Ot,Es]=Y.useState(""),[da,fo]=Y.useState(!1),[dn,os]=Y.useState(!1),[Ts,fa]=Y.useState(null),[Ss,mo]=Y.useState(""),[ma,ga]=Y.useState(""),[As,Hn]=Y.useState("system"),[Vt,On]=Y.useState(""),[At,pa]=Y.useState(!1),[Xs,ya]=Y.useState("list"),$n=dp(n.role)>=2,Ns=["admin","quan_ly","lanh_dao","giao_vien"].includes(n.role),Dt=dp(n.role)>=2,ls=dp(n.role)>=2,cs=z=>z.roomId?"Thi Trc Tuyn":z.quizId==="exam-quiz"||z.quizId==="thithu2"||z.type==="Thi th"||z.quizTitle&&z.quizTitle.includes("Thi th")?"Thi th":"n tp",Fn=z=>{switch(z){case"Thi Trc Tuyn":return"bg-red-100 text-red-800 border-red-200";case"Thi th":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-blue-100 text-blue-800 border-blue-200"}},Gl=z=>{if(z.roomId&&Te[z.roomId]){const pe=Te[z.roomId];return`Phng thi ${pe.name} / ${pe.course_name||"T do"} / ${pe.license_name||""}`}return z.quizTitle||(z.roomId?`Phng thi ${z.roomId}`:z.type)};Y.useEffect(()=>{(async()=>{try{const pe=Ht(xt(ke,"courses")),Le=(await bn(pe)).docs.map(lt=>({id:lt.id,...lt.data()}));r(Le);const Ce=new Set(Le.map(lt=>lt.headTeacherId).filter(Boolean)),st={};for(const lt of Array.from(Ce))if(lt)try{const Cn=await vu(qt(ke,"users",lt));Cn.exists()&&(st[lt]=Cn.data().fullName)}catch{}y(st)}catch(pe){console.error(pe)}finally{m(!1)}})()},[n]),Y.useEffect(()=>{if(!a)return;let z,pe;if(a.teacherIds&&a.teacherIds.length>0)try{const Le=[...new Set(a.teacherIds.filter(Ce=>Ce&&Ce.trim()!==""))].slice(0,10);if(Le.length>0){const Ce=Ht(xt(ke,"users"),un(Pf(),"in",Le));z=vl(Ce,st=>{M(st.docs.map(lt=>({uid:lt.id,...lt.data()})))})}else M([])}catch(Le){console.error("Teacher fetch error:",Le),M([])}else M([]);const Ie=Ht(xt(ke,"users"),un("courseId","==",a.id));return pe=vl(Ie,async Le=>{const Ce=Le.docs.map(lt=>({uid:lt.id,...lt.data()}));S(Ce);const st={};await Promise.all(Ce.map(async lt=>{try{const Cn=await hf(lt.uid);if(Cn&&Cn.length>0){const Rs=Cn[0];st[lt.uid]={type:Rs.quizTitle||Rs.type||"Bi thi",time:Rs.completedAt?Rs.completedAt.toLocaleString("vi-VN"):"--",score:`${Rs.score}/${Rs.totalQuestions} cu`,rawDate:Rs.completedAt}}else st[lt.uid]={type:"--",time:"--",score:"--"}}catch{st[lt.uid]={type:"Li",time:"--",score:"--"}}})),ue(st)}),()=>{z&&z(),pe&&pe()}},[a]),Y.useEffect(()=>{le&&(async()=>{const pe=Ht(xt(ke,"users"),un("role","in",["hoc_vien"])),Le=(await bn(pe)).docs.map(Ce=>({uid:Ce.id,...Ce.data()}));V(Le.filter(Ce=>Ce.courseId!==(a==null?void 0:a.id)||!Ce.courseId))})()},[le,a]),Y.useEffect(()=>{C&&(async()=>{const pe=Ht(xt(ke,"users"),un("role","in",["giao_vien","admin","quan_ly","lanh_dao"])),Le=(await bn(pe)).docs.map(Ce=>({uid:Ce.id,...Ce.data()}));$(Le.filter(Ce=>!((a==null?void 0:a.teacherIds)||[]).includes(Ce.uid)))})()},[C,a]),Y.useEffect(()=>{_e&&qe&&(fe(!0),(async()=>{const pe=await hf(qe.uid);pe.sort((Le,Ce)=>Ce.completedAt.getTime()-Le.completedAt.getTime()),W(pe);const Ie=Array.from(new Set(pe.filter(Le=>Le.roomId).map(Le=>Le.roomId)));if(Ie.length>0){const Le={};await Promise.all(Ie.map(async Ce=>{try{const st=await vu(qt(ke,"exam_rooms",Ce));st.exists()&&(Le[Ce]=st.data())}catch{}})),Me(Le)}fe(!1)})())},[_e,qe]);const go=async z=>{z.preventDefault();try{await _u(xt(ke,"courses"),{name:oi,description:Ot,teacherIds:[],createdAt:Lu(),createdBy:n.id}),Ys(!1),Ct(""),Es(""),window.location.reload()}catch(pe){console.error(pe)}},us=async z=>{if(!a)return;const pe=k.find(Ie=>Ie.uid===z);if(pe&&pe.courseId){alert(`Hc vin ny ang hc lp ${pe.courseName||pe.courseId}. Vui lng xa khi lp c trc khi thm vo lp mi.`);return}et(!0);try{await pr(qt(ke,"users",z),{courseId:a.id,courseName:a.name}),V(Ie=>Ie.filter(Le=>Le.uid!==z)),alert(` thm hc vin vo lp ${a.name}`)}catch(Ie){console.error(Ie),alert("Li khi thm hc vin.")}finally{et(!1)}},Cr=async z=>{if(a){ce(!0);try{const pe=qt(ke,"courses",a.id);await pr(pe,{teacherIds:fE(z),...da?{headTeacherId:z}:{}}),$(Ie=>Ie.filter(Le=>Le.uid!==z)),da&&l(Ie=>Ie?{...Ie,headTeacherId:z}:null),l(Ie=>Ie?{...Ie,teacherIds:[...Ie.teacherIds||[],z]}:null)}catch(pe){console.error(pe)}finally{ce(!1)}}},Kl=async z=>{if(a&&confirm("Bn c chc chn xo gio vin ny khi lp?"))try{const pe=qt(ke,"courses",a.id);await pr(pe,{teacherIds:mE(z),...a.headTeacherId===z?{headTeacherId:null}:{}}),l(Ie=>Ie?{...Ie,teacherIds:(Ie.teacherIds||[]).filter(Le=>Le!==z),headTeacherId:Ie.headTeacherId===z?void 0:Ie.headTeacherId}:null)}catch(pe){console.error("Error removing teacher:",pe)}},Ws=async z=>{if(confirm("Bn c chc chn mun xa hc vin ny khi lp?"))try{await pr(qt(ke,"users",z),{courseId:null,courseName:null})}catch(pe){console.error(pe)}},Ir=(z,pe,Ie)=>{fa({type:z,id:pe,name:Ie}),mo(""),ga(""),os(!0)},va=async z=>{if(z.preventDefault(),!(!Ts||!n.id)){pa(!0);try{const pe=Vt?new Date(Vt):null,Ie=As==="special"||As==="attention",Le=Ie?"all":Ts.type,Ce=Ie?null:Ts.id;await tT(Ss,ma,As,Le,Ce,n.id,n.full_name,pe),alert("Gi thng bo thnh cng!"),os(!1)}catch(pe){console.error(pe),alert("Li khi gi thng bo. C th thiu Index Firestore.")}finally{pa(!1)}}},jr=async()=>{if(je){Nr(!0);try{const z=pe=>pe===void 0?null:pe;await pr(qt(ke,"users",je.uid),{fullName:z(je.fullName),birthDate:z(je.birthDate),email:z(je.email),phoneNumber:z(je.phoneNumber),address:z(je.address),cccd:z(je.cccd),cccdDate:z(je.cccdDate),cccdPlace:z(je.cccdPlace),class:z(je.class),courseCode:z(je.courseCode),role:z(je.role)}),alert(" cp nht thng tin hc vin!"),Je(!1),Qs(!1)}catch(z){console.error("Error updating user:",z),alert("Li khi cp nht thng tin.")}finally{Nr(!1)}}};return a?h.jsxs("div",{className:"w-full max-w-7xl mx-auto p-4 animate-slide-in-right relative",children:[le&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:()=>I(!1),children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-4xl p-6 h-[80vh] flex flex-col relative",onClick:z=>z.stopPropagation(),children:[h.jsx("button",{onClick:()=>I(!1),className:"absolute top-4 right-4 bg-gray-100 dark:bg-slate-700 p-2 rounded-full border border-gray-200 dark:border-slate-600",children:h.jsx(pl,{})}),h.jsxs("h2",{className:"text-xl font-bold mb-4 text-gray-800 dark:text-white",children:["Thm Hc Vin vo ",a.name]}),h.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[h.jsxs("div",{className:"relative flex-1",children:[h.jsx(Xp,{className:"absolute left-3 top-3 text-gray-400"}),h.jsx("input",{className:"w-full pl-10 pr-4 py-2 border rounded-lg dark:bg-slate-700 focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Tm kim tn, email, st...",value:R,onChange:z=>D(z.target.value)})]}),h.jsxs("div",{className:"flex items-center gap-2 p-2 bg-blue-50 dark:bg-blue-900/30 rounded-lg border border-blue-100 dark:border-blue-800 px-4 cursor-pointer",onClick:()=>w(!_),children:[h.jsx("input",{type:"checkbox",checked:_,onChange:z=>w(z.target.checked),className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500"}),h.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-200 cursor-pointer select-none",children:"Ch hin hc vin cha c lp"})]})]}),h.jsxs("div",{className:"grid grid-cols-12 gap-2 text-xs font-bold text-gray-500 uppercase px-3 pb-2 border-b border-gray-100 dark:border-slate-700",children:[h.jsx("div",{className:"col-span-4",children:"Hc vin"}),h.jsx("div",{className:"col-span-2",children:"Ngy sinh/ST"}),h.jsx("div",{className:"col-span-3",children:"a ch/Qu qun"}),h.jsx("div",{className:"col-span-2",children:"Lp hin ti"}),h.jsx("div",{className:"col-span-1 text-center",children:"Thao tc"})]}),h.jsx("div",{className:"flex-1 overflow-y-auto pr-2 space-y-2 mt-2",children:k.filter(z=>{const pe=mr(z.fullName).includes(mr(R))||mr(z.email).includes(mr(R))||mr(z.phoneNumber).includes(mr(R)),Ie=_?!z.courseId:!0;return pe&&Ie}).map(z=>h.jsxs("div",{className:"grid grid-cols-12 gap-2 items-center p-3 bg-gray-50 dark:bg-slate-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-700 transition border border-transparent hover:border-gray-200 dark:hover:border-slate-600",children:[h.jsxs("div",{className:"col-span-4 flex items-center gap-3 overflow-hidden",children:[h.jsx("img",{src:z.photoURL||`https://ui-avatars.com/api/?name=${encodeURIComponent(z.fullName)}`,className:"w-10 h-10 rounded-full border border-gray-200 flex-shrink-0"}),h.jsxs("div",{className:"min-w-0",children:[h.jsx("p",{className:"font-bold text-sm truncate text-gray-900 dark:text-white",title:z.fullName,children:z.fullName}),h.jsx("p",{className:"text-xs text-gray-500 truncate",title:z.email,children:z.email})]})]}),h.jsxs("div",{className:"col-span-2 text-sm text-gray-700 dark:text-gray-300",children:[h.jsx("div",{className:"text-xs text-gray-500",children:z.birthDate||"--/--/----"}),h.jsx("div",{className:"font-medium",children:z.phoneNumber||"---"})]}),h.jsx("div",{className:"col-span-3 text-sm text-gray-700 dark:text-gray-300",children:h.jsx("p",{className:"line-clamp-2 text-xs",title:z.address||z.cccdPlace,children:z.address||z.cccdPlace||"---"})}),h.jsx("div",{className:"col-span-2 text-sm",children:z.courseName?h.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded-md text-xs font-semibold border border-yellow-200 truncate block text-center",title:z.courseName,children:z.courseName}):h.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-md text-xs font-semibold border border-green-200 block text-center",children:"Cha c"})}),h.jsx("div",{className:"col-span-1 flex justify-center",children:h.jsx("button",{onClick:()=>us(z.uid),disabled:Fe,className:"bg-blue-600 text-white p-2 rounded hover:bg-blue-700 disabled:opacity-50 shadow-sm transition-transform active:scale-95",title:"Thm vo lp",children:h.jsx(gl,{})})})]},z.uid))})]})}),C&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:()=>j(!1),children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-2xl p-6 h-[80vh] flex flex-col relative",onClick:z=>z.stopPropagation(),children:[h.jsx("button",{onClick:()=>j(!1),className:"absolute top-4 right-4 bg-gray-100 p-2 rounded-full",children:h.jsx(pl,{})}),h.jsx("h2",{className:"text-xl font-bold mb-4",children:"Thm Gio Vin"}),h.jsxs("div",{className:"flex items-center gap-2 p-2 bg-yellow-50 rounded mb-4",children:[h.jsx("input",{type:"checkbox",checked:da,onChange:z=>fo(z.target.checked),className:"w-5 h-5 text-yellow-600"}),h.jsx("label",{className:"text-sm font-medium",children:"t lm GVCN"})]}),h.jsxs("div",{className:"relative mb-4",children:[h.jsx(Xp,{className:"absolute left-3 top-3 text-gray-400"}),h.jsx("input",{className:"w-full pl-10 pr-4 py-2 border rounded dark:bg-slate-700",placeholder:"Tm kim gio vin...",value:L,onChange:z=>O(z.target.value)})]}),h.jsx("div",{className:"flex-1 overflow-y-auto pr-2 space-y-2",children:F.filter(z=>mr(z.fullName).includes(mr(L))||mr(z.email).includes(mr(L))).map(z=>h.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 dark:bg-slate-700/50 rounded-lg hover:bg-gray-100 transition",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("img",{src:z.photoURL||`https://ui-avatars.com/api/?name=${encodeURIComponent(z.fullName)}`,className:"w-10 h-10 rounded-full"}),h.jsxs("div",{children:[h.jsx("p",{className:"font-bold text-sm",children:z.fullName}),h.jsx("p",{className:"text-xs text-gray-500",children:z.email})]})]}),h.jsx("button",{onClick:()=>Cr(z.uid),disabled:q,className:"bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700 disabled:opacity-50 text-sm",children:"Thm"})]},z.uid))})]})}),_e&&qe&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:()=>De(!1),children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-5xl p-6 h-[80vh] flex flex-col relative",onClick:z=>z.stopPropagation(),children:[h.jsx("button",{onClick:()=>De(!1),className:"absolute top-4 right-4 bg-gray-100 dark:bg-slate-700 p-2 rounded-full",children:h.jsx(pl,{})}),h.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[h.jsx(ou,{className:"text-blue-500"})," Lch s lm bi: ",h.jsx("span",{className:"text-blue-600",children:qe.fullName})]}),h.jsx("div",{className:"flex-1 overflow-y-auto",children:oe?h.jsx("div",{className:"p-10 text-center text-gray-500",children:"ang ti lch s..."}):ne.length===0?h.jsx("div",{className:"p-10 text-center text-gray-500 italic",children:"Hc vin ny cha lm bi thi no."}):h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full text-left text-sm border-collapse",children:[h.jsx("thead",{className:"bg-gray-50 dark:bg-slate-700 sticky top-0 text-gray-500 uppercase text-xs",children:h.jsxs("tr",{children:[h.jsx("th",{className:"p-4 font-semibold",children:"Loi"}),h.jsx("th",{className:"p-4 font-semibold",children:"Bi thi"}),h.jsx("th",{className:"p-4 font-semibold text-center",children:"im s"}),h.jsx("th",{className:"p-4 font-semibold",children:"Gi np"}),h.jsx("th",{className:"p-4 font-semibold",children:"Ngy np"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-slate-700",children:ne.map(z=>{const pe=cs(z);return h.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors",children:[h.jsx("td",{className:"p-4 align-middle",children:h.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-bold border ${Fn(pe)}`,children:pe})}),h.jsx("td",{className:"p-4 align-middle font-medium text-gray-900 dark:text-gray-100",children:Gl(z)}),h.jsxs("td",{className:"p-4 align-middle text-center",children:[h.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:z.score}),h.jsxs("span",{className:"text-gray-400 text-xs",children:[" / ",z.totalQuestions]})]}),h.jsx("td",{className:"p-4 align-middle text-gray-500",children:new Date(z.completedAt).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})}),h.jsx("td",{className:"p-4 align-middle text-gray-500",children:new Date(z.completedAt).toLocaleDateString("vi-VN")})]},z.id)})})]})})})]})}),tt&&je&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:()=>Je(!1),children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-4xl p-6 relative animate-scale-up max-h-[90vh] overflow-y-auto",onClick:z=>z.stopPropagation(),children:[h.jsx("button",{onClick:()=>{Je(!1),Qs(!1)},className:"absolute top-4 right-4 bg-gray-100 dark:bg-slate-700 p-2 rounded-full hover:bg-gray-200 transition",children:h.jsx(pl,{})}),h.jsx("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-2 text-blue-700 dark:text-blue-400",children:nt?h.jsxs(h.Fragment,{children:[h.jsx(Jc,{className:"text-yellow-500"})," Cp Nht Thng Tin"]}):h.jsxs(h.Fragment,{children:[h.jsx(lu,{className:"text-blue-500"})," H S Hc Vin"]})}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"H v Tn"}),h.jsx("input",{className:`w-full p-2.5 border rounded-lg dark:bg-slate-700 ${nt?"focus:ring-2 focus:ring-blue-500":"bg-gray-50 border-transparent cursor-default"}`,value:je.fullName,readOnly:!nt,onChange:z=>Ft({...je,fullName:z.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"Ngy sinh"}),h.jsx("input",{type:"date",className:`w-full p-2.5 border rounded-lg dark:bg-slate-700 ${nt?"focus:ring-2 focus:ring-blue-500":"bg-gray-50 border-transparent cursor-default"}`,value:je.birthDate||"",readOnly:!nt,onChange:z=>Ft({...je,birthDate:z.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"Lp hc (Kha hc)"}),h.jsx("input",{className:"w-full p-2.5 border rounded-lg dark:bg-slate-700 bg-gray-50 border-transparent cursor-default",value:je.courseName||je.courseCode||"--",readOnly:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"Ngy cp CCCD"}),h.jsx("input",{type:nt?"date":"text",className:`w-full p-2.5 border rounded-lg dark:bg-slate-700 ${nt?"focus:ring-2 focus:ring-blue-500":"bg-gray-50 border-transparent cursor-default"}`,value:je.cccdDate||"",readOnly:!nt,onChange:z=>Ft({...je,cccdDate:z.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"a ch"}),h.jsx("input",{className:`w-full p-2.5 border rounded-lg dark:bg-slate-700 ${nt?"focus:ring-2 focus:ring-blue-500":"bg-gray-50 border-transparent cursor-default"}`,value:je.address||"",readOnly:!nt,onChange:z=>Ft({...je,address:z.target.value})})]})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"S in thoi"}),h.jsx("input",{className:`w-full p-2.5 border rounded-lg dark:bg-slate-700 ${nt?"focus:ring-2 focus:ring-blue-500":"bg-gray-50 border-transparent cursor-default"}`,value:je.phoneNumber||"",readOnly:!nt,onChange:z=>Ft({...je,phoneNumber:z.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"Lp hc (t in)"}),h.jsx("input",{className:`w-full p-2.5 border rounded-lg dark:bg-slate-700 ${nt?"focus:ring-2 focus:ring-blue-500":"bg-gray-50 border-transparent cursor-default"}`,value:je.class||"",placeholder:"V d: Th my k2",readOnly:!nt,onChange:z=>Ft({...je,class:z.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"S CCCD"}),h.jsx("input",{className:`w-full p-2.5 border rounded-lg dark:bg-slate-700 ${nt?"focus:ring-2 focus:ring-blue-500":"bg-gray-50 border-transparent cursor-default"}`,value:je.cccd||"",readOnly:!nt,onChange:z=>Ft({...je,cccd:z.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"Ni cp"}),h.jsx("input",{className:`w-full p-2.5 border rounded-lg dark:bg-slate-700 ${nt?"focus:ring-2 focus:ring-blue-500":"bg-gray-50 border-transparent cursor-default"}`,value:je.cccdPlace||"",readOnly:!nt,onChange:z=>Ft({...je,cccdPlace:z.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"Vai tr"}),h.jsxs("select",{className:`w-full p-2.5 border rounded-lg dark:bg-slate-700 ${nt?"focus:ring-2 focus:ring-blue-500":"bg-gray-50 border-transparent cursor-default appearance-none pointer-events-none"}`,value:je.role,disabled:!nt,onChange:z=>Ft({...je,role:z.target.value}),children:[h.jsx("option",{value:"hoc_vien",children:"Hc vin"}),h.jsx("option",{value:"student",children:"Hc sinh"}),h.jsx("option",{value:"teacher",children:"Gio vin"})]})]})]})]}),h.jsx("div",{className:"flex justify-end gap-3 mt-8 pt-4 border-t border-gray-100 dark:border-slate-700",children:nt?h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>Qs(!1),className:"px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 text-gray-700 font-medium",children:"Hy b"}),h.jsxs("button",{onClick:jr,disabled:Ar,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 shadow-lg font-medium transition-transform active:scale-95",children:[h.jsx(lT,{})," ",Ar?"ang lu...":"Lu Thay i"]})]}):h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>Je(!1),className:"px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 text-gray-700 font-medium",children:"ng"}),h.jsxs("button",{onClick:()=>Qs(!0),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 shadow-lg font-medium transition-transform active:scale-95",children:[h.jsx(Jc,{})," Chnh sa"]})]})})]})}),dn&&Ts&&h.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>os(!1),children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl p-6 w-full max-w-md animate-scale-up",onClick:z=>z.stopPropagation(),children:[h.jsxs("h2",{className:"text-2xl font-bold mb-4 flex items-center gap-2",children:[h.jsx(vd,{className:"text-yellow-500"})," Gi Thng Bo"]}),h.jsxs("p",{className:"text-sm text-gray-500 mb-6",children:["To: ",h.jsx("span",{className:"font-bold text-blue-600",children:Ts.name})]}),h.jsxs("form",{onSubmit:va,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi thng bo"}),h.jsxs("select",{className:"w-full px-4 py-2 border rounded-lg dark:bg-slate-700 outline-none focus:ring-2 focus:ring-blue-500",value:As,onChange:z=>Hn(z.target.value),children:[h.jsx("option",{value:"system",children:"Bnh thng"}),["admin","lanh_dao","quan_ly"].includes(n.role)&&h.jsxs(h.Fragment,{children:[h.jsx("option",{value:"attention",children:" Ch  (Chy ch vng)"}),h.jsx("option",{value:"special",children:" C BIT (Chy ch )"})]})]})]}),(As==="special"||As==="attention")&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hiu lc chy ch n"}),h.jsx("input",{type:"datetime-local",className:"w-full px-4 py-2 border rounded-lg dark:bg-slate-700 outline-none focus:ring-2 focus:ring-blue-500",value:Vt,onChange:z=>On(z.target.value),required:!0}),h.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Sau thi gian ny, thng bo s ngng chy ngang mn hnh."})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tiu "}),h.jsx("input",{className:"w-full px-4 py-2 border rounded-lg dark:bg-slate-700 focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Tiu ...",value:Ss,onChange:z=>mo(z.target.value),required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tin nhn"}),h.jsx("textarea",{className:"w-full px-4 py-2 border rounded-lg dark:bg-slate-700 h-24 focus:ring-2 focus:ring-blue-500 outline-none resize-none",placeholder:"Ni dung...",value:ma,onChange:z=>ga(z.target.value),required:!0})]}),h.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[h.jsx("button",{type:"button",onClick:()=>os(!1),className:"px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Hy"}),h.jsx("button",{type:"submit",disabled:At,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 shadow-lg font-medium",children:At?"ang gi...":"Gi Ngay"})]})]})]})}),h.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[h.jsxs("div",{children:[h.jsxs("button",{onClick:()=>l(null),className:"flex items-center gap-2 text-sm text-gray-500 hover:text-blue-600 mb-2 transition-colors font-medium",children:[h.jsx(cf,{})," Quay li danh sch"]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-2 rounded-lg",children:h.jsx(xl,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-cyan-500",children:a.name}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm mt-0.5",children:a.description})]})]})]}),h.jsx("div",{className:"flex gap-4",children:h.jsxs("button",{onClick:()=>Ir("class",a.name,a.name),className:"bg-gradient-to-r from-yellow-500 to-orange-500 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition flex items-center gap-2 font-medium",children:[h.jsx(vd,{})," Thng bo c lp"]})})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[h.jsx("div",{className:"lg:col-span-1 space-y-6",children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200 dark:border-slate-700 p-5 sticky top-20",children:[h.jsxs("div",{className:"flex justify-between items-center border-b pb-3 border-gray-100 dark:border-slate-700 mb-4",children:[h.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2 text-gray-800 dark:text-white",children:[h.jsx(lu,{className:"text-green-500"})," Gio vin"]}),Dt&&h.jsx("button",{onClick:()=>j(!0),className:"text-green-600 hover:bg-green-50 p-1.5 rounded-full transition-colors",children:h.jsx(gl,{size:14})})]}),h.jsxs("div",{className:"space-y-3",children:[N.map(z=>h.jsxs("div",{className:"flex items-center gap-3 p-2 hover:bg-gray-50 dark:hover:bg-slate-700/50 rounded-lg transition-colors group relative cursor-pointer",children:[h.jsxs("div",{className:"relative",children:[h.jsx("img",{src:z.photoURL||`https://ui-avatars.com/api/?name=${encodeURIComponent(z.fullName)}`,className:"w-10 h-10 rounded-full border border-gray-200"}),a.headTeacherId===z.uid&&h.jsx("div",{className:"absolute -top-1 -right-1 bg-yellow-400 text-white rounded-full p-0.5 border-2 border-white",children:h.jsx(aT,{size:10})})]}),h.jsxs("div",{className:"min-w-0 flex-1",children:[h.jsx("p",{className:"font-medium text-sm truncate text-gray-900 dark:text-gray-100",children:z.fullName}),h.jsx("p",{className:"text-[11px] text-gray-400 truncate",children:Fj(z.role)}),a.headTeacherId===z.uid&&h.jsx("span",{className:"text-[10px] font-bold text-yellow-600 bg-yellow-50 px-1.5 py-0.5 rounded border border-yellow-200 mt-1 inline-block",children:"GVCN"})]}),ls&&h.jsx("button",{onClick:pe=>{pe.stopPropagation(),Kl(z.uid)},className:"text-gray-400 hover:text-red-500 hover:bg-red-50 p-1.5 rounded opacity-0 group-hover:opacity-100 transition-all absolute right-2",title:"Xa gio vin",children:h.jsx(El,{size:12})})]},z.uid)),N.length===0&&h.jsx("p",{className:"text-sm text-gray-500 italic text-center py-4",children:"Cha c gio vin."})]})]})}),h.jsx("div",{className:"lg:col-span-3",children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200 dark:border-slate-700 p-6 min-h-[500px]",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-100 dark:border-slate-700",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsxs("h3",{className:"font-bold text-xl flex items-center gap-2 text-gray-800 dark:text-white",children:[h.jsx(Tu,{className:"text-blue-500"})," Hc vin (",E.length,")"]}),h.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-700 rounded-lg p-1 ml-4",children:[h.jsx("button",{onClick:()=>ya("grid"),className:`p-1.5 rounded ${Xs==="grid"?"bg-white dark:bg-slate-600 shadow text-blue-600":"text-gray-500 hover:text-blue-500"}`,title:"Dng li",children:h.jsx(cT,{})}),h.jsx("button",{onClick:()=>ya("list"),className:`p-1.5 rounded ${Xs==="list"?"bg-white dark:bg-slate-600 shadow text-blue-600":"text-gray-500 hover:text-blue-500"}`,title:"Dng danh sch",children:h.jsx(oT,{})})]})]}),Ns&&h.jsxs("button",{onClick:()=>I(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 hover:shadow-lg transition flex items-center gap-2 text-sm font-medium",children:[h.jsx(gl,{})," Thm Hc Vin"]})]}),Xs==="grid"?h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5",children:E.map(z=>{const pe=te[z.uid]||{score:"--"};return h.jsxs("div",{className:"bg-gray-50 dark:bg-slate-700/30 rounded-xl p-4 border border-gray-100 dark:border-slate-700 hover:shadow-md hover:border-blue-200 dark:hover:border-blue-500/30 transition-all duration-300 group relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-gradient-to-bl from-blue-100 to-transparent -mr-8 -mt-8 rounded-full opacity-50 group-hover:scale-150 transition-transform"}),h.jsxs("div",{className:"flex items-start gap-4 relative z-10",children:[h.jsx("div",{className:"relative",children:h.jsx("img",{src:z.photoURL||`https://ui-avatars.com/api/?name=${encodeURIComponent(z.fullName)}&background=random`,alt:z.fullName,className:"w-14 h-14 rounded-full object-cover border-2 border-white dark:border-slate-600 shadow-sm group-hover:border-blue-500 transition-colors"})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("h4",{className:"font-bold text-gray-900 dark:text-gray-100 truncate group-hover:text-blue-600 transition-colors text-base",children:z.fullName}),h.jsx("p",{className:"text-xs text-gray-500 truncate",children:z.email}),h.jsx("div",{className:"mt-2 pt-2 border-t border-gray-100 dark:border-slate-600 text-xs",children:h.jsxs("div",{className:"flex justify-between text-gray-500",children:[h.jsx("span",{children:"Kt qu mi:"}),h.jsx("span",{className:"font-bold text-teal-600",children:pe.score})]})}),h.jsxs("div",{className:"flex gap-2 mt-3 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity",children:[h.jsx("button",{onClick:()=>Ir("user",z.uid,z.fullName),className:"text-yellow-600 bg-yellow-50 hover:bg-yellow-100 p-1.5 rounded text-xs flex items-center gap-1",title:"Nhn tin",children:h.jsx(vd,{})}),h.jsx("button",{onClick:()=>{Ft(z),Je(!0)},className:"text-blue-600 bg-blue-50 hover:bg-blue-100 p-1.5 rounded text-xs flex items-center gap-1",title:"Sa thng tin",children:h.jsx(Jc,{})}),h.jsx("button",{onClick:()=>{U(z),De(!0)},className:"text-purple-600 bg-purple-50 hover:bg-purple-100 p-1.5 rounded text-xs flex items-center gap-1",title:"Xem lch s",children:h.jsx(ou,{})}),Ns&&h.jsx("button",{onClick:()=>Ws(z.uid),className:"text-red-600 bg-red-50 hover:bg-red-100 p-1.5 rounded text-xs flex items-center gap-1",title:"Xa",children:h.jsx(El,{})})]})]})]})]},z.uid)})}):h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full text-left text-sm",children:[h.jsx("thead",{className:"text-xs text-gray-500 uppercase bg-gray-50 dark:bg-slate-700 dark:text-gray-300",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-4 py-3 rounded-l-lg",children:"Hc vin"}),h.jsx("th",{className:"px-4 py-3",children:"Ngy sinh"}),h.jsx("th",{className:"px-4 py-3",children:"Bi lm gn nht"}),h.jsx("th",{className:"px-4 py-3",children:"Thi gian"}),h.jsx("th",{className:"px-4 py-3",children:"im"}),h.jsx("th",{className:"px-4 py-3 text-center rounded-r-lg",children:"Hnh ng"})]})}),h.jsxs("tbody",{className:"divide-y divide-gray-100 dark:divide-slate-700",children:[E.map(z=>{const pe=te[z.uid]||{type:"--",time:"--",score:"--"};return h.jsxs("tr",{className:"group hover:bg-gray-50 dark:hover:bg-slate-700/30 transition-colors",children:[h.jsxs("td",{className:"px-4 py-3 font-medium text-gray-900 dark:text-white flex items-center gap-3",children:[h.jsx("img",{src:z.photoURL||`https://ui-avatars.com/api/?name=${encodeURIComponent(z.fullName)}`,className:"w-8 h-8 rounded-full border border-gray-200"}),h.jsxs("div",{children:[h.jsx("p",{children:z.fullName}),h.jsx("p",{className:"text-xs text-gray-500 font-normal",children:z.email})]})]}),h.jsx("td",{className:"px-4 py-3 text-gray-500",children:z.birthDate||"--"}),h.jsx("td",{className:"px-4 py-3",children:h.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold
                                                        ${pe.type.includes("n")?"bg-blue-100 text-blue-700":pe.type.includes("Th")?"bg-purple-100 text-purple-700":pe.type==="--"?"bg-gray-100 text-gray-500":"bg-red-100 text-red-700"}`,children:pe.type})}),h.jsx("td",{className:"px-4 py-3 text-gray-500",children:pe.time}),h.jsx("td",{className:"px-4 py-3 font-bold text-teal-600",children:pe.score}),h.jsx("td",{className:"px-4 py-3 text-center",children:h.jsxs("div",{className:"flex items-center justify-center gap-2 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity",children:[h.jsx("button",{onClick:()=>Ir("user",z.uid,z.fullName),className:"text-yellow-500 hover:bg-yellow-50 p-2 rounded-lg transition",title:"Gi tin nhn",children:h.jsx(vd,{})}),h.jsx("button",{onClick:()=>{Ft(z),Je(!0)},className:"text-blue-500 hover:bg-blue-50 p-2 rounded-lg transition",title:"Sa thng tin",children:h.jsx(Jc,{})}),h.jsx("button",{onClick:()=>{U(z),De(!0)},className:"text-purple-500 hover:bg-purple-50 p-2 rounded-lg transition",title:"Xem lch s thi",children:h.jsx(ou,{})}),Ns&&h.jsx("button",{onClick:()=>Ws(z.uid),className:"text-red-400 hover:text-red-600 hover:bg-red-50 p-2 rounded-lg transition",title:"Xa khi lp",children:h.jsx(El,{})})]})})]},z.uid)}),E.length===0&&h.jsx("tr",{children:h.jsx("td",{colSpan:6,className:"text-center py-10 text-gray-400 italic",children:"Lp cha c hc vin no."})})]})]})})]})})]})]}):h.jsxs("div",{className:"w-full max-w-6xl mx-auto p-4 animate-slide-in-right relative",children:[Rr&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-md p-6",children:[h.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800 dark:text-white",children:"To Lp Hc Mi"}),h.jsxs("form",{onSubmit:go,className:"space-y-4",children:[h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",placeholder:"Tn lp",value:oi,onChange:z=>Ct(z.target.value),required:!0}),h.jsx("textarea",{className:"w-full p-2 border rounded dark:bg-slate-700",placeholder:"M t",value:Ot,onChange:z=>Es(z.target.value)}),h.jsxs("div",{className:"flex justify-end gap-2",children:[h.jsx("button",{type:"button",onClick:()=>Ys(!1),className:"px-4 py-2 bg-gray-200 rounded",children:"Hy"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-teal-600 text-white rounded",children:"To"})]})]})]})}),h.jsxs("div",{className:"flex justify-between items-center mb-8",children:[h.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-3 bg-clip-text text-transparent bg-gradient-to-r from-teal-600 to-emerald-600",children:[h.jsx(xl,{className:"text-teal-600"})," Qun l Lp hc"]}),h.jsx("button",{onClick:e,className:"bg-gray-200 dark:bg-slate-700 text-gray-800 dark:text-gray-200 px-4 py-2 rounded-lg hover:bg-gray-300 dark:hover:bg-slate-600 transition-colors",children:"Back Dashboard"})]}),c?h.jsx("div",{className:"p-20 text-center",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600 mx-auto"})}):t.length===0?h.jsxs("div",{className:"text-center p-12 bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700 shadow-sm",children:[h.jsx(xl,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),h.jsx("h3",{className:"text-xl font-bold text-gray-700 dark:text-gray-200 mb-2",children:"Cha c lp hc no"}),$n&&h.jsx("button",{onClick:()=>Ys(!0),className:"bg-teal-600 text-white px-6 py-2 rounded-lg hover:bg-teal-700 transition",children:"To Lp Ngay"})]}):h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[$n&&h.jsxs("div",{onClick:()=>Ys(!0),className:"bg-gradient-to-br from-teal-500 to-emerald-500 rounded-xl shadow-lg p-6 flex flex-col justify-center items-center text-white cursor-pointer hover:shadow-xl hover:scale-[1.02] transition-all duration-300 group",children:[h.jsx("div",{className:"bg-white/20 p-4 rounded-full mb-3 group-hover:bg-white/30 transition-colors",children:h.jsx(gl,{className:"w-8 h-8"})}),h.jsx("h3",{className:"font-bold text-lg",children:"Thm Lp Mi"})]}),t.map(z=>h.jsxs("div",{onClick:()=>l(z),className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200 dark:border-slate-700 overflow-hidden cursor-pointer hover:shadow-xl hover:-translate-y-1 transition-all duration-300 group flex flex-col",children:[h.jsxs("div",{className:"h-32 bg-gradient-to-r from-blue-600 to-cyan-500 relative flex items-center justify-center overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 bg-black/10 group-hover:bg-transparent transition-colors"}),h.jsx(Q6,{className:"text-white/30 w-20 h-20 transform -rotate-12 group-hover:scale-110 transition-transform duration-500"}),h.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/60 to-transparent",children:h.jsx("h3",{className:"font-bold text-xl text-white truncate",children:z.name})})]}),h.jsxs("div",{className:"p-5 flex-1 flex flex-col",children:[h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 line-clamp-2 mb-4 flex-1",children:z.description||"Cha c m t kha hc."}),h.jsxs("div",{className:"flex justify-between items-center text-sm font-medium pt-4 border-t border-gray-100 dark:border-slate-700",children:[h.jsxs("span",{className:"text-gray-500 flex items-center gap-1",children:[h.jsx(lu,{})," GVCN: ",z.headTeacherId?g[z.headTeacherId]||"...":"Cha c"]}),h.jsxs("span",{className:"text-blue-600 group-hover:underline flex items-center gap-1",children:["Chi tit ",h.jsx(cf,{className:"rotate-180"})]})]})]})]},z.id))]})]})},Uw=[{id:"admin",name:"Qun tr vin"},{id:"lanh_dao",name:"Lnh o"},{id:"quan_ly",name:"Qun l"},{id:"giao_vien",name:"Gio vin"},{id:"hoc_vien",name:"Hc vin"}],Kj=["giao_vien","lanh_dao","quan_ly"],Qj=({userProfile:n,onBack:e})=>{const[t,r]=Y.useState(n),[a,l]=Y.useState(!1),c=n.role!=="hoc_vien",[m,g]=Y.useState([]),[y,_]=Y.useState(!1),[w,E]=Y.useState([]),[S,N]=Y.useState(""),[M,k]=Y.useState("all");["admin","lanh_dao","quan_ly"].includes(n.role);const[V,F]=Y.useState(null),[$,te]=Y.useState(!1);Y.useEffect(()=>{c&&ue()},[c]),Y.useEffect(()=>{if(c){let R=m;if(M==="staff"?R=R.filter(D=>Kj.includes(D.role)):M==="hoc_vien"&&(R=R.filter(D=>D.role==="hoc_vien")),S.trim()){const D=S.toLowerCase();R=R.filter(L=>L.fullName.toLowerCase().includes(D)||L.email.toLowerCase().includes(D)||L.phoneNumber&&L.phoneNumber.includes(D))}E(R)}},[m,M,S,c]);const ue=async()=>{_(!0);try{const R=Ht(xt(ke,"users"),Hf("createdAt","desc")),L=(await bn(R)).docs.map(O=>({id:O.id,...O.data()}));g(L)}catch(R){console.error("Error fetching users:",R)}finally{_(!1)}},le=async R=>{R.preventDefault(),l(!0);try{const D=L=>L===void 0?null:L;await pr(qt(ke,"users",n.id),{fullName:D(t.full_name),phoneNumber:D(t.phoneNumber),birthDate:D(t.birthDate),address:D(t.address),cccd:D(t.cccd),cccdDate:D(t.cccdDate),cccdPlace:D(t.cccdPlace),class:D(t.class)}),alert("Cp nht thng tin thnh cng!")}catch(D){console.error(D),alert("Li khi lu thng tin.")}finally{l(!1)}},I=async R=>{if(confirm("Bn c chc chn mun xa ti khon ny?"))try{await ny(qt(ke,"users",R)),g(D=>D.filter(L=>L.id!==R))}catch(D){console.error(D),alert("Li khi xa.")}},C=async R=>{if(R.preventDefault(),!!V)try{await pr(qt(ke,"users",V.id),{fullName:V.fullName,phoneNumber:V.phoneNumber,birthDate:V.birthDate,role:V.role,class:V.class,cccd:V.cccd,cccdDate:V.cccdDate,cccdPlace:V.cccdPlace,address:V.address}),alert(" cp nht!"),te(!1),ue()}catch(D){console.error(D),alert("Li khi lu.")}},j=R=>{var D;return((D=Uw.find(L=>L.id===R))==null?void 0:D.name)||R};return h.jsxs("div",{className:"w-full max-w-7xl mx-auto p-4 animate-slide-in-right pb-20",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[h.jsx("button",{onClick:e,className:"p-2 bg-gray-100 dark:bg-slate-700 rounded-full hover:bg-gray-200",children:h.jsx(cf,{})}),h.jsxs("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[h.jsx(uf,{})," Ti khon ca ti"]})]}),h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-md p-6 mb-8 border border-gray-100 dark:border-slate-700",children:[h.jsx("h2",{className:"text-lg font-bold mb-4 text-blue-600 border-b pb-2",children:"Thng tin c nhn"}),h.jsxs("form",{onSubmit:le,className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"H v Tn"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:t.full_name,onChange:R=>r({...t,full_name:R.target.value}),required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"Email (Khng i)"}),h.jsx("input",{className:"w-full p-2 border rounded bg-gray-50 dark:bg-slate-900 text-gray-500",value:t.email||"",readOnly:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"Ngy sinh"}),h.jsx("input",{type:"date",className:"w-full p-2 border rounded dark:bg-slate-700",value:t.birthDate||"",onChange:R=>r({...t,birthDate:R.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"S in thoi"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:t.phoneNumber||"",onChange:R=>r({...t,phoneNumber:R.target.value})})]})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"S CCCD"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:t.cccd||"",onChange:R=>r({...t,cccd:R.target.value})})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"Ngy cp"}),h.jsx("input",{type:"date",className:"w-full p-2 border rounded dark:bg-slate-700",value:t.cccdDate||"",onChange:R=>r({...t,cccdDate:R.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"Ni cp"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:t.cccdPlace||"",onChange:R=>r({...t,cccdPlace:R.target.value})})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"a ch / Qu qun"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:t.address||"",onChange:R=>r({...t,address:R.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"Lp hc (t in)"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:t.class||"",onChange:R=>r({...t,class:R.target.value}),placeholder:"VD: Th my K2"})]})]}),h.jsx("div",{className:"md:col-span-2 flex justify-end mt-4",children:h.jsxs("button",{type:"submit",disabled:a,className:"flex items-center gap-2 bg-teal-600 text-white px-6 py-2 rounded-lg hover:bg-teal-700 transition shadow-md disabled:opacity-50",children:[h.jsx(lT,{})," ",a?"ang lu...":"Cp nht thng tin"]})})]})]}),c&&h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-md p-6 border border-gray-100 dark:border-slate-700 animate-fade-in-up",children:[h.jsxs("h2",{className:"text-xl font-bold mb-6 text-orange-600 border-b pb-2 flex items-center gap-2",children:[h.jsx(uf,{})," Qun l ngi dng cp di"]}),h.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6 justify-between items-center",children:[h.jsxs("div",{className:"relative flex-1 max-w-md w-full",children:[h.jsx(Xp,{className:"absolute left-3 top-3 text-gray-400"}),h.jsx("input",{className:"w-full pl-10 pr-4 py-2 border rounded-lg dark:bg-slate-700",placeholder:"Tm hc vin, gio vin...",value:S,onChange:R=>N(R.target.value)})]}),h.jsxs("select",{className:"p-2 border rounded-lg dark:bg-slate-700 flex-1 md:flex-none",value:M,onChange:R=>k(R.target.value),children:[h.jsx("option",{value:"all",children:"Tt c vai tr"}),h.jsx("option",{value:"staff",children:"Gio vin/Qun l"}),h.jsx("option",{value:"hoc_vien",children:"Hc vin"})]})]}),h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full text-left border-collapse min-w-[800px]",children:[h.jsx("thead",{className:"bg-gray-50 dark:bg-slate-900 text-sm uppercase text-gray-500 font-bold",children:h.jsxs("tr",{children:[h.jsx("th",{className:"p-3 border-b dark:border-slate-700",children:"H v Tn"}),h.jsx("th",{className:"p-3 border-b dark:border-slate-700",children:"Lp hc (Kha/Tn)"}),h.jsx("th",{className:"p-3 border-b dark:border-slate-700",children:"Lin h"}),h.jsx("th",{className:"p-3 border-b dark:border-slate-700",children:"Vai tr"}),h.jsx("th",{className:"p-3 border-b dark:border-slate-700 text-center",children:"Thao tc"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-slate-700",children:y?h.jsx("tr",{children:h.jsx("td",{colSpan:5,className:"p-4 text-center",children:"ang ti..."})}):w.length===0?h.jsx("tr",{children:h.jsx("td",{colSpan:5,className:"p-4 text-center italic text-gray-500",children:"Khng tm thy ngi dng."})}):w.map(R=>h.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-700/50 transition",children:[h.jsxs("td",{className:"p-3 font-medium text-gray-900 dark:text-white",children:[R.fullName,R.role==="hoc_vien"&&R.isVerified&&h.jsx(iT,{className:"inline ml-1 text-blue-500 text-xs"})]}),h.jsx("td",{className:"p-3 text-sm",children:R.courseName||R.courseId||"--"}),h.jsxs("td",{className:"p-3 text-sm",children:[h.jsx("div",{children:R.email}),h.jsx("div",{className:"text-xs text-gray-500",children:R.phoneNumber})]}),h.jsx("td",{className:"p-3",children:h.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${R.role==="hoc_vien"?"bg-blue-100 text-blue-800":"bg-orange-100 text-orange-800"}`,children:j(R.role)})}),h.jsxs("td",{className:"p-3 flex justify-center gap-2",children:[h.jsx("button",{onClick:()=>{F(R),te(!0)},className:"p-2 text-blue-600 hover:bg-blue-50 rounded",children:h.jsx(Jc,{})}),n.role==="admin"&&h.jsx("button",{onClick:()=>I(R.id),className:"p-2 text-red-600 hover:bg-red-50 rounded",children:h.jsx(El,{})})]})]},R.id))})]})})]}),$&&V&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:()=>te(!1),children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-2xl p-6 relative max-h-[90vh] overflow-y-auto",onClick:R=>R.stopPropagation(),children:[h.jsxs("h2",{className:"text-lg font-bold mb-4",children:["Sa ti khon: ",V.fullName]}),h.jsxs("form",{onSubmit:C,className:"space-y-4",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"H tn"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:V.fullName,onChange:R=>F({...V,fullName:R.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"ST"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:V.phoneNumber||"",onChange:R=>F({...V,phoneNumber:R.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"Ngy sinh"}),h.jsx("input",{type:"date",className:"w-full p-2 border rounded dark:bg-slate-700",value:V.birthDate||"",onChange:R=>F({...V,birthDate:R.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"Lp hc (t in)"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:V.class||"",onChange:R=>F({...V,class:R.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"CCCD"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:V.cccd||"",onChange:R=>F({...V,cccd:R.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"a ch"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:V.address||"",onChange:R=>F({...V,address:R.target.value})})]}),h.jsxs("div",{className:"col-span-2",children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"Vai tr"}),h.jsx("select",{className:"w-full p-2 border rounded dark:bg-slate-700",value:V.role,onChange:R=>F({...V,role:R.target.value}),children:Uw.map(R=>h.jsx("option",{value:R.id,children:R.name},R.id))})]})]}),h.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[h.jsx("button",{type:"button",onClick:()=>te(!1),className:"px-4 py-2 bg-gray-200 rounded",children:"Hy"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Lu"})]})]})]})})]})},Yj=({userProfile:n,onNavigate:e,onLogout:t})=>h.jsxs("div",{className:"fixed top-0 left-0 right-0 h-16 bg-white dark:bg-slate-900 border-b border-gray-200 dark:border-gray-800 z-40 px-4 shadow-sm flex items-center justify-between transition-colors duration-300",children:[h.jsxs("div",{className:"flex items-center gap-1 md:gap-4 overflow-x-auto no-scrollbar",children:[h.jsxs("button",{onClick:()=>e("dashboard"),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors whitespace-nowrap",children:[h.jsx(K6,{className:"text-blue-600 dark:text-blue-400"}),h.jsx("span",{className:"font-semibold text-sm md:text-base",children:"n tp"})]}),h.jsxs("a",{href:"/",className:"flex items-center gap-2 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors whitespace-nowrap decoration-0",children:[h.jsx(W6,{className:"text-teal-600 dark:text-teal-400"}),h.jsx("span",{className:"font-medium text-sm md:text-base",children:"Trang ch"})]}),h.jsxs("button",{onClick:()=>e("account"),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors whitespace-nowrap",children:[h.jsx(ej,{className:"text-orange-600 dark:text-orange-400"}),h.jsx("span",{className:"font-medium text-sm md:text-base",children:"Ti khon"})]}),n&&h.jsxs(h.Fragment,{children:[["admin","lanh_dao","quan_ly","giao_vien"].includes(n.role)?h.jsxs("button",{onClick:()=>e("class_management"),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors whitespace-nowrap",children:[h.jsx(xl,{className:"text-indigo-600 dark:text-indigo-400"}),h.jsx("span",{className:"font-medium text-sm md:text-base",children:"Qun l lp"})]}):h.jsxs("button",{onClick:()=>e("my_class"),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors whitespace-nowrap",children:[h.jsx(Mw,{className:"text-green-600 dark:text-green-400"}),h.jsx("span",{className:"font-medium text-sm md:text-base",children:"Lp ca ti"})]}),["admin","lanh_dao","quan_ly","giao_vien"].includes(n.role)&&h.jsxs("button",{onClick:()=>e("notification_mgmt"),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors whitespace-nowrap border-l border-gray-200 dark:border-gray-700 ml-2 pl-4",children:[h.jsx(Yf,{className:"text-red-500 animate-pulse-slow"}),h.jsx("span",{className:"font-bold text-sm md:text-base text-red-600 dark:text-red-400",children:"Qun l TB"})]}),h.jsxs("button",{onClick:()=>e("history"),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors whitespace-nowrap",children:[h.jsx(ou,{className:"text-purple-600 dark:text-purple-400"}),h.jsx("span",{className:"font-medium text-sm md:text-base",children:"Lch s"})]})]})]}),h.jsx("div",{className:"flex items-center gap-3 md:gap-4 ml-4 flex-shrink-0",children:n?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"hidden md:flex flex-col items-end",children:[h.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Xin cho,"}),h.jsx("span",{className:"text-sm font-bold text-gray-800 dark:text-white max-w-[150px] truncate",children:n.full_name})]}),h.jsx("div",{className:"md:hidden text-gray-700 dark:text-gray-200",children:h.jsx(Mw,{})}),h.jsx("div",{className:"h-8 w-[1px] bg-gray-300 dark:bg-gray-700 mx-1"}),h.jsxs("button",{onClick:t,className:"group flex items-center gap-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 px-3 py-2 rounded-full transition-colors",title:"ng xut",children:[h.jsx(J6,{className:"group-hover:translate-x-1 transition-transform"}),h.jsx("span",{className:"hidden md:inline font-medium text-sm",children:"Thot"})]})]}):h.jsx("button",{onClick:()=>e("login"),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-semibold text-sm transition-colors shadow-md",children:"ng nhp"})})]});var Wp=function(n,e){return Wp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])},Wp(n,e)};function uT(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Wp(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var df=function(){return df=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++){t=arguments[r];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},df.apply(this,arguments)};function $l(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(n);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(n,r[a])&&(t[r[a]]=n[r[a]]);return t}function hT(n,e,t,r){var a=arguments.length,l=a<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(n,e,t,r);else for(var m=n.length-1;m>=0;m--)(c=n[m])&&(l=(a<3?c(l):a>3?c(e,t,l):c(e,t))||l);return a>3&&l&&Object.defineProperty(e,t,l),l}function dT(n,e){return function(t,r){e(t,r,n)}}function fT(n,e,t,r,a,l){function c(V){if(V!==void 0&&typeof V!="function")throw new TypeError("Function expected");return V}for(var m=r.kind,g=m==="getter"?"get":m==="setter"?"set":"value",y=!e&&n?r.static?n:n.prototype:null,_=e||(y?Object.getOwnPropertyDescriptor(y,r.name):{}),w,E=!1,S=t.length-1;S>=0;S--){var N={};for(var M in r)N[M]=M==="access"?{}:r[M];for(var M in r.access)N.access[M]=r.access[M];N.addInitializer=function(V){if(E)throw new TypeError("Cannot add initializers after decoration has completed");l.push(c(V||null))};var k=(0,t[S])(m==="accessor"?{get:_.get,set:_.set}:_[g],N);if(m==="accessor"){if(k===void 0)continue;if(k===null||typeof k!="object")throw new TypeError("Object expected");(w=c(k.get))&&(_.get=w),(w=c(k.set))&&(_.set=w),(w=c(k.init))&&a.unshift(w)}else(w=c(k))&&(m==="field"?a.unshift(w):_[g]=w)}y&&Object.defineProperty(y,r.name,_),E=!0}function mT(n,e,t){for(var r=arguments.length>2,a=0;a<e.length;a++)t=r?e[a].call(n,t):e[a].call(n);return r?t:void 0}function gT(n){return typeof n=="symbol"?n:"".concat(n)}function pT(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function yT(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function ve(n,e,t,r){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function m(_){try{y(r.next(_))}catch(w){c(w)}}function g(_){try{y(r.throw(_))}catch(w){c(w)}}function y(_){_.done?l(_.value):a(_.value).then(m,g)}y((r=r.apply(n,e||[])).next())})}function vT(n,e){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},r,a,l,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=m(0),c.throw=m(1),c.return=m(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function m(y){return function(_){return g([y,_])}}function g(y){if(r)throw new TypeError("Generator is already executing.");for(;c&&(c=0,y[0]&&(t=0)),t;)try{if(r=1,a&&(l=y[0]&2?a.return:y[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,y[1])).done)return l;switch(a=0,l&&(y=[y[0]&2,l.value]),y[0]){case 0:case 1:l=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,a=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!l||y[1]>l[0]&&y[1]<l[3])){t.label=y[1];break}if(y[0]===6&&t.label<l[1]){t.label=l[1],l=y;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(y);break}l[2]&&t.ops.pop(),t.trys.pop();continue}y=e.call(n,t)}catch(_){y=[6,_],a=0}finally{r=l=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}var Xf=Object.create?(function(n,e,t,r){r===void 0&&(r=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,a)}):(function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]});function _T(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Xf(e,n,t)}function ff(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function hy(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),a,l=[],c;try{for(;(e===void 0||e-- >0)&&!(a=r.next()).done;)l.push(a.value)}catch(m){c={error:m}}finally{try{a&&!a.done&&(t=r.return)&&t.call(r)}finally{if(c)throw c.error}}return l}function bT(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(hy(arguments[e]));return n}function wT(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),a=0,e=0;e<t;e++)for(var l=arguments[e],c=0,m=l.length;c<m;c++,a++)r[a]=l[c];return r}function xT(n,e,t){if(t||arguments.length===2)for(var r=0,a=e.length,l;r<a;r++)(l||!(r in e))&&(l||(l=Array.prototype.slice.call(e,0,r)),l[r]=e[r]);return n.concat(l||Array.prototype.slice.call(e))}function Dl(n){return this instanceof Dl?(this.v=n,this):new Dl(n)}function ET(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),a,l=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),m("next"),m("throw"),m("return",c),a[Symbol.asyncIterator]=function(){return this},a;function c(S){return function(N){return Promise.resolve(N).then(S,w)}}function m(S,N){r[S]&&(a[S]=function(M){return new Promise(function(k,V){l.push([S,M,k,V])>1||g(S,M)})},N&&(a[S]=N(a[S])))}function g(S,N){try{y(r[S](N))}catch(M){E(l[0][3],M)}}function y(S){S.value instanceof Dl?Promise.resolve(S.value.v).then(_,w):E(l[0][2],S)}function _(S){g("next",S)}function w(S){g("throw",S)}function E(S,N){S(N),l.shift(),l.length&&g(l[0][0],l[0][1])}}function TT(n){var e,t;return e={},r("next"),r("throw",function(a){throw a}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(a,l){e[a]=n[a]?function(c){return(t=!t)?{value:Dl(n[a](c)),done:!1}:l?l(c):c}:l}}function ST(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof ff=="function"?ff(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(l){t[l]=n[l]&&function(c){return new Promise(function(m,g){c=n[l](c),a(m,g,c.done,c.value)})}}function a(l,c,m,g){Promise.resolve(g).then(function(y){l({value:y,done:m})},c)}}function AT(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var Xj=Object.create?(function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}):function(n,e){n.default=e},Jp=function(n){return Jp=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},Jp(n)};function NT(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t=Jp(n),r=0;r<t.length;r++)t[r]!=="default"&&Xf(e,n,t[r]);return Xj(e,n),e}function RT(n){return n&&n.__esModule?n:{default:n}}function CT(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}function IT(n,e,t,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!a:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(n,t):a?a.value=t:e.set(n,t),t}function jT(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function kT(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,a;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],t&&(a=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");a&&(r=function(){try{a.call(this)}catch(l){return Promise.reject(l)}}),n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e}var Wj=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r};function OT(n){function e(l){n.error=n.hasError?new Wj(l,n.error,"An error was suppressed during disposal."):l,n.hasError=!0}var t,r=0;function a(){for(;t=n.stack.pop();)try{if(!t.async&&r===1)return r=0,n.stack.push(t),Promise.resolve().then(a);if(t.dispose){var l=t.dispose.call(t.value);if(t.async)return r|=2,Promise.resolve(l).then(a,function(c){return e(c),a()})}else r|=1}catch(c){e(c)}if(r===1)return n.hasError?Promise.reject(n.error):Promise.resolve();if(n.hasError)throw n.error}return a()}function DT(n,e){return typeof n=="string"&&/^\.\.?\//.test(n)?n.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,r,a,l,c){return r?e?".jsx":".js":a&&(!l||!c)?t:a+l+"."+c.toLowerCase()+"js"}):n}const Jj={__extends:uT,__assign:df,__rest:$l,__decorate:hT,__param:dT,__esDecorate:fT,__runInitializers:mT,__propKey:gT,__setFunctionName:pT,__metadata:yT,__awaiter:ve,__generator:vT,__createBinding:Xf,__exportStar:_T,__values:ff,__read:hy,__spread:bT,__spreadArrays:wT,__spreadArray:xT,__await:Dl,__asyncGenerator:ET,__asyncDelegator:TT,__asyncValues:ST,__makeTemplateObject:AT,__importStar:NT,__importDefault:RT,__classPrivateFieldGet:CT,__classPrivateFieldSet:IT,__classPrivateFieldIn:jT,__addDisposableResource:kT,__disposeResources:OT,__rewriteRelativeImportExtension:DT},Zj=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:kT,get __assign(){return df},__asyncDelegator:TT,__asyncGenerator:ET,__asyncValues:ST,__await:Dl,__awaiter:ve,__classPrivateFieldGet:CT,__classPrivateFieldIn:jT,__classPrivateFieldSet:IT,__createBinding:Xf,__decorate:hT,__disposeResources:OT,__esDecorate:fT,__exportStar:_T,__extends:uT,__generator:vT,__importDefault:RT,__importStar:NT,__makeTemplateObject:AT,__metadata:yT,__param:dT,__propKey:gT,__read:hy,__rest:$l,__rewriteRelativeImportExtension:DT,__runInitializers:mT,__setFunctionName:pT,__spread:bT,__spreadArray:xT,__spreadArrays:wT,__values:ff,default:Jj},Symbol.toStringTag,{value:"Module"})),ek=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);class dy extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class tk extends dy{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class zw extends dy{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Bw extends dy{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Zp;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Zp||(Zp={}));class nk{constructor(e,{headers:t={},customFetch:r,region:a=Zp.Any}={}){this.url=e,this.headers=t,this.region=a,this.fetch=ek(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return ve(this,arguments,void 0,function*(t,r={}){var a;let l,c;try{const{headers:m,method:g,body:y,signal:_,timeout:w}=r;let E={},{region:S}=r;S||(S=this.region);const N=new URL(`${this.url}/${t}`);S&&S!=="any"&&(E["x-region"]=S,N.searchParams.set("forceFunctionRegion",S));let M;y&&(m&&!Object.prototype.hasOwnProperty.call(m,"Content-Type")||!m)?typeof Blob<"u"&&y instanceof Blob||y instanceof ArrayBuffer?(E["Content-Type"]="application/octet-stream",M=y):typeof y=="string"?(E["Content-Type"]="text/plain",M=y):typeof FormData<"u"&&y instanceof FormData?M=y:(E["Content-Type"]="application/json",M=JSON.stringify(y)):M=y;let k=_;w&&(c=new AbortController,l=setTimeout(()=>c.abort(),w),_?(k=c.signal,_.addEventListener("abort",()=>c.abort())):k=c.signal);const V=yield this.fetch(N.toString(),{method:g||"POST",headers:Object.assign(Object.assign(Object.assign({},E),this.headers),m),body:M,signal:k}).catch(ue=>{throw new tk(ue)}),F=V.headers.get("x-relay-error");if(F&&F==="true")throw new zw(V);if(!V.ok)throw new Bw(V);let $=((a=V.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),te;return $==="application/json"?te=yield V.json():$==="application/octet-stream"||$==="application/pdf"?te=yield V.blob():$==="text/event-stream"?te=V:$==="multipart/form-data"?te=yield V.formData():te=yield V.text(),{data:te,error:null,response:V}}catch(m){return{data:null,error:m,response:m instanceof Bw||m instanceof zw?m.context:void 0}}finally{l&&clearTimeout(l)}})}}var En={};const Fl=MA(Zj);var _d={},bd={},wd={},xd={},Ed={},Td={},qw;function MT(){if(qw)return Td;qw=1,Object.defineProperty(Td,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Td.default=n,Td}var Hw;function PT(){if(Hw)return Ed;Hw=1,Object.defineProperty(Ed,"__esModule",{value:!0});const e=Fl.__importDefault(MT());class t{constructor(a){var l,c;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=(l=a.shouldThrowOnError)!==null&&l!==void 0?l:!1,this.signal=a.signal,this.isMaybeSingle=(c=a.isMaybeSingle)!==null&&c!==void 0?c:!1,a.fetch?this.fetch=a.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,l){return this.headers=new Headers(this.headers),this.headers.set(a,l),this}then(a,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const c=this.fetch;let m=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async g=>{var y,_,w,E;let S=null,N=null,M=null,k=g.status,V=g.statusText;if(g.ok){if(this.method!=="HEAD"){const ue=await g.text();ue===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((y=this.headers.get("Accept"))===null||y===void 0)&&y.includes("application/vnd.pgrst.plan+text"))?N=ue:N=JSON.parse(ue))}const $=(_=this.headers.get("Prefer"))===null||_===void 0?void 0:_.match(/count=(exact|planned|estimated)/),te=(w=g.headers.get("content-range"))===null||w===void 0?void 0:w.split("/");$&&te&&te.length>1&&(M=parseInt(te[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(N)&&(N.length>1?(S={code:"PGRST116",details:`Results contain ${N.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},N=null,M=null,k=406,V="Not Acceptable"):N.length===1?N=N[0]:N=null)}else{const $=await g.text();try{S=JSON.parse($),Array.isArray(S)&&g.status===404&&(N=[],S=null,k=200,V="OK")}catch{g.status===404&&$===""?(k=204,V="No Content"):S={message:$}}if(S&&this.isMaybeSingle&&(!((E=S==null?void 0:S.details)===null||E===void 0)&&E.includes("0 rows"))&&(S=null,k=200,V="OK"),S&&this.shouldThrowOnError)throw new e.default(S)}return{error:S,data:N,count:M,status:k,statusText:V}});return this.shouldThrowOnError||(m=m.catch(g=>{var y,_,w,E,S,N;let M="";const k=g==null?void 0:g.cause;if(k){const V=(y=k==null?void 0:k.message)!==null&&y!==void 0?y:"",F=(_=k==null?void 0:k.code)!==null&&_!==void 0?_:"";M=`${(w=g==null?void 0:g.name)!==null&&w!==void 0?w:"FetchError"}: ${g==null?void 0:g.message}`,M+=`

Caused by: ${(E=k==null?void 0:k.name)!==null&&E!==void 0?E:"Error"}: ${V}`,F&&(M+=` (${F})`),k!=null&&k.stack&&(M+=`
${k.stack}`)}else M=(S=g==null?void 0:g.stack)!==null&&S!==void 0?S:"";return{error:{message:`${(N=g==null?void 0:g.name)!==null&&N!==void 0?N:"FetchError"}: ${g==null?void 0:g.message}`,details:M,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),m.then(a,l)}returns(){return this}overrideTypes(){return this}}return Ed.default=t,Ed}var $w;function VT(){if($w)return xd;$w=1,Object.defineProperty(xd,"__esModule",{value:!0});const e=Fl.__importDefault(PT());class t extends e.default{select(a){let l=!1;const c=(a??"*").split("").map(m=>/\s/.test(m)&&!l?"":(m==='"'&&(l=!l),m)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:l=!0,nullsFirst:c,foreignTable:m,referencedTable:g=m}={}){const y=g?`${g}.order`:"order",_=this.url.searchParams.get(y);return this.url.searchParams.set(y,`${_?`${_},`:""}${a}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:l,referencedTable:c=l}={}){const m=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(m,`${a}`),this}range(a,l,{foreignTable:c,referencedTable:m=c}={}){const g=typeof m>"u"?"offset":`${m}.offset`,y=typeof m>"u"?"limit":`${m}.limit`;return this.url.searchParams.set(g,`${a}`),this.url.searchParams.set(y,`${l-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:l=!1,settings:c=!1,buffers:m=!1,wal:g=!1,format:y="text"}={}){var _;const w=[a?"analyze":null,l?"verbose":null,c?"settings":null,m?"buffers":null,g?"wal":null].filter(Boolean).join("|"),E=(_=this.headers.get("Accept"))!==null&&_!==void 0?_:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${y}; for="${E}"; options=${w};`),y==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return xd.default=t,xd}var Fw;function fy(){if(Fw)return wd;Fw=1,Object.defineProperty(wd,"__esModule",{value:!0});const e=Fl.__importDefault(VT()),t=new RegExp("[,()]");class r extends e.default{eq(l,c){return this.url.searchParams.append(l,`eq.${c}`),this}neq(l,c){return this.url.searchParams.append(l,`neq.${c}`),this}gt(l,c){return this.url.searchParams.append(l,`gt.${c}`),this}gte(l,c){return this.url.searchParams.append(l,`gte.${c}`),this}lt(l,c){return this.url.searchParams.append(l,`lt.${c}`),this}lte(l,c){return this.url.searchParams.append(l,`lte.${c}`),this}like(l,c){return this.url.searchParams.append(l,`like.${c}`),this}likeAllOf(l,c){return this.url.searchParams.append(l,`like(all).{${c.join(",")}}`),this}likeAnyOf(l,c){return this.url.searchParams.append(l,`like(any).{${c.join(",")}}`),this}ilike(l,c){return this.url.searchParams.append(l,`ilike.${c}`),this}ilikeAllOf(l,c){return this.url.searchParams.append(l,`ilike(all).{${c.join(",")}}`),this}ilikeAnyOf(l,c){return this.url.searchParams.append(l,`ilike(any).{${c.join(",")}}`),this}regexMatch(l,c){return this.url.searchParams.append(l,`match.${c}`),this}regexIMatch(l,c){return this.url.searchParams.append(l,`imatch.${c}`),this}is(l,c){return this.url.searchParams.append(l,`is.${c}`),this}isDistinct(l,c){return this.url.searchParams.append(l,`isdistinct.${c}`),this}in(l,c){const m=Array.from(new Set(c)).map(g=>typeof g=="string"&&t.test(g)?`"${g}"`:`${g}`).join(",");return this.url.searchParams.append(l,`in.(${m})`),this}contains(l,c){return typeof c=="string"?this.url.searchParams.append(l,`cs.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cs.{${c.join(",")}}`):this.url.searchParams.append(l,`cs.${JSON.stringify(c)}`),this}containedBy(l,c){return typeof c=="string"?this.url.searchParams.append(l,`cd.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cd.{${c.join(",")}}`):this.url.searchParams.append(l,`cd.${JSON.stringify(c)}`),this}rangeGt(l,c){return this.url.searchParams.append(l,`sr.${c}`),this}rangeGte(l,c){return this.url.searchParams.append(l,`nxl.${c}`),this}rangeLt(l,c){return this.url.searchParams.append(l,`sl.${c}`),this}rangeLte(l,c){return this.url.searchParams.append(l,`nxr.${c}`),this}rangeAdjacent(l,c){return this.url.searchParams.append(l,`adj.${c}`),this}overlaps(l,c){return typeof c=="string"?this.url.searchParams.append(l,`ov.${c}`):this.url.searchParams.append(l,`ov.{${c.join(",")}}`),this}textSearch(l,c,{config:m,type:g}={}){let y="";g==="plain"?y="pl":g==="phrase"?y="ph":g==="websearch"&&(y="w");const _=m===void 0?"":`(${m})`;return this.url.searchParams.append(l,`${y}fts${_}.${c}`),this}match(l){return Object.entries(l).forEach(([c,m])=>{this.url.searchParams.append(c,`eq.${m}`)}),this}not(l,c,m){return this.url.searchParams.append(l,`not.${c}.${m}`),this}or(l,{foreignTable:c,referencedTable:m=c}={}){const g=m?`${m}.or`:"or";return this.url.searchParams.append(g,`(${l})`),this}filter(l,c,m){return this.url.searchParams.append(l,`${c}.${m}`),this}}return wd.default=r,wd}var Gw;function LT(){if(Gw)return bd;Gw=1,Object.defineProperty(bd,"__esModule",{value:!0});const e=Fl.__importDefault(fy());class t{constructor(a,{headers:l={},schema:c,fetch:m}){this.url=a,this.headers=new Headers(l),this.schema=c,this.fetch=m}select(a,l){const{head:c=!1,count:m}=l??{},g=c?"HEAD":"GET";let y=!1;const _=(a??"*").split("").map(w=>/\s/.test(w)&&!y?"":(w==='"'&&(y=!y),w)).join("");return this.url.searchParams.set("select",_),m&&this.headers.append("Prefer",`count=${m}`),new e.default({method:g,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:l,defaultToNull:c=!0}={}){var m;const g="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const y=a.reduce((_,w)=>_.concat(Object.keys(w)),[]);if(y.length>0){const _=[...new Set(y)].map(w=>`"${w}"`);this.url.searchParams.set("columns",_.join(","))}}return new e.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(m=this.fetch)!==null&&m!==void 0?m:fetch})}upsert(a,{onConflict:l,ignoreDuplicates:c=!1,count:m,defaultToNull:g=!0}={}){var y;const _="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),m&&this.headers.append("Prefer",`count=${m}`),g||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const w=a.reduce((E,S)=>E.concat(Object.keys(S)),[]);if(w.length>0){const E=[...new Set(w)].map(S=>`"${S}"`);this.url.searchParams.set("columns",E.join(","))}}return new e.default({method:_,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(y=this.fetch)!==null&&y!==void 0?y:fetch})}update(a,{count:l}={}){var c;const m="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:a}={}){var l;const c="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return bd.default=t,bd}var Kw;function sk(){if(Kw)return _d;Kw=1,Object.defineProperty(_d,"__esModule",{value:!0});const n=Fl,e=n.__importDefault(LT()),t=n.__importDefault(fy());class r{constructor(l,{headers:c={},schema:m,fetch:g}={}){this.url=l,this.headers=new Headers(c),this.schemaName=m,this.fetch=g}from(l){if(!l||typeof l!="string"||l.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const c=new URL(`${this.url}/${l}`);return new e.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new r(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:m=!1,get:g=!1,count:y}={}){var _;let w;const E=new URL(`${this.url}/rpc/${l}`);let S;m||g?(w=m?"HEAD":"GET",Object.entries(c).filter(([M,k])=>k!==void 0).map(([M,k])=>[M,Array.isArray(k)?`{${k.join(",")}}`:`${k}`]).forEach(([M,k])=>{E.searchParams.append(M,k)})):(w="POST",S=c);const N=new Headers(this.headers);return y&&N.set("Prefer",`count=${y}`),new t.default({method:w,url:E,headers:N,schema:this.schemaName,body:S,fetch:(_=this.fetch)!==null&&_!==void 0?_:fetch})}}return _d.default=r,_d}var Qw;function rk(){if(Qw)return En;Qw=1,Object.defineProperty(En,"__esModule",{value:!0}),En.PostgrestError=En.PostgrestBuilder=En.PostgrestTransformBuilder=En.PostgrestFilterBuilder=En.PostgrestQueryBuilder=En.PostgrestClient=void 0;const n=Fl,e=n.__importDefault(sk());En.PostgrestClient=e.default;const t=n.__importDefault(LT());En.PostgrestQueryBuilder=t.default;const r=n.__importDefault(fy());En.PostgrestFilterBuilder=r.default;const a=n.__importDefault(VT());En.PostgrestTransformBuilder=a.default;const l=n.__importDefault(PT());En.PostgrestBuilder=l.default;const c=n.__importDefault(MT());return En.PostgrestError=c.default,En.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:l.default,PostgrestError:c.default},En}var UT=rk();const zT=u0(UT),ik=DA({__proto__:null,default:zT},[UT]),{PostgrestClient:ak,PostgrestQueryBuilder:OD,PostgrestFilterBuilder:DD,PostgrestTransformBuilder:MD,PostgrestBuilder:PD,PostgrestError:VD}=zT||ik;class ok{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const r=t.node,a=parseInt(r.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const lk="2.86.0",ck=`realtime-js/${lk}`,BT="1.0.0",uk="2.0.0",Yw=BT,e0=1e4,hk=1e3,dk=100;var Ka;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Ka||(Ka={}));var sn;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(sn||(sn={}));var zs;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(zs||(zs={}));var t0;(function(n){n.websocket="websocket"})(t0||(t0={}));var Qa;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Qa||(Qa={}));class fk{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(r))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,r;const a=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(e){var t,r;const a=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:{},c=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,c)}_encodeUserBroadcastPush(e,t,r){var a,l;const c=e.topic,m=(a=e.ref)!==null&&a!==void 0?a:"",g=(l=e.join_ref)!==null&&l!==void 0?l:"",y=e.payload.event,_=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},w=Object.keys(_).length===0?"":JSON.stringify(_);if(g.length>255)throw new Error(`joinRef length ${g.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`ref length ${m.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`topic length ${c.length} exceeds maximum of 255`);if(y.length>255)throw new Error(`userEvent length ${y.length} exceeds maximum of 255`);if(w.length>255)throw new Error(`metadata length ${w.length} exceeds maximum of 255`);const E=this.USER_BROADCAST_PUSH_META_LENGTH+g.length+m.length+c.length+y.length+w.length,S=new ArrayBuffer(this.HEADER_LENGTH+E);let N=new DataView(S),M=0;N.setUint8(M++,this.KINDS.userBroadcastPush),N.setUint8(M++,g.length),N.setUint8(M++,m.length),N.setUint8(M++,c.length),N.setUint8(M++,y.length),N.setUint8(M++,w.length),N.setUint8(M++,t),Array.from(g,V=>N.setUint8(M++,V.charCodeAt(0))),Array.from(m,V=>N.setUint8(M++,V.charCodeAt(0))),Array.from(c,V=>N.setUint8(M++,V.charCodeAt(0))),Array.from(y,V=>N.setUint8(M++,V.charCodeAt(0))),Array.from(w,V=>N.setUint8(M++,V.charCodeAt(0)));var k=new Uint8Array(S.byteLength+r.byteLength);return k.set(new Uint8Array(S),0),k.set(new Uint8Array(r),S.byteLength),k.buffer}decode(e,t){if(this._isArrayBuffer(e)){let r=this._binaryDecode(e);return t(r)}if(typeof e=="string"){const r=JSON.parse(e),[a,l,c,m,g]=r;return t({join_ref:a,ref:l,topic:c,event:m,payload:g})}return t({})}_binaryDecode(e){const t=new DataView(e),r=t.getUint8(0),a=new TextDecoder;switch(r){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,a)}}_decodeUserBroadcast(e,t,r){const a=t.getUint8(1),l=t.getUint8(2),c=t.getUint8(3),m=t.getUint8(4);let g=this.HEADER_LENGTH+4;const y=r.decode(e.slice(g,g+a));g=g+a;const _=r.decode(e.slice(g,g+l));g=g+l;const w=r.decode(e.slice(g,g+c));g=g+c;const E=e.slice(g,e.byteLength),S=m===this.JSON_ENCODING?JSON.parse(r.decode(E)):E,N={type:this.BROADCAST_EVENT,event:_,payload:S};return c>0&&(N.meta=JSON.parse(w)),{join_ref:null,ref:null,topic:y,event:this.BROADCAST_EVENT,payload:N}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e==null?void 0:e.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([r])=>t.includes(r)))}}class qT{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var wt;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(wt||(wt={}));const Xw=(n,e,t={})=>{var r;const a=(r=t.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((l,c)=>(l[c]=mk(c,n,e,a),l),{}):{}},mk=(n,e,t,r)=>{const a=e.find(m=>m.name===n),l=a==null?void 0:a.type,c=t[n];return l&&!r.includes(l)?HT(l,c):n0(c)},HT=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return vk(e,t)}switch(n){case wt.bool:return gk(e);case wt.float4:case wt.float8:case wt.int2:case wt.int4:case wt.int8:case wt.numeric:case wt.oid:return pk(e);case wt.json:case wt.jsonb:return yk(e);case wt.timestamp:return _k(e);case wt.abstime:case wt.date:case wt.daterange:case wt.int4range:case wt.int8range:case wt.money:case wt.reltime:case wt.text:case wt.time:case wt.timestamptz:case wt.timetz:case wt.tsrange:case wt.tstzrange:return n0(e);default:return n0(e)}},n0=n=>n,gk=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},pk=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},yk=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},vk=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let l;const c=n.slice(1,t);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(m=>HT(e,m))}return n},_k=n=>typeof n=="string"?n.replace(" ","T"):n,$T=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class fp{constructor(e,t,r={},a=e0){this.channel=e,this.event=t,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ww;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Ww||(Ww={}));class cu{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:l,onLeave:c,onSync:m}=this.caller;this.joinRef=this.channel._joinRef(),this.state=cu.syncState(this.state,a,l,c),this.pendingDiffs.forEach(g=>{this.state=cu.syncDiff(this.state,g,l,c)}),this.pendingDiffs=[],m()}),this.channel._on(r.diff,{},a=>{const{onJoin:l,onLeave:c,onSync:m}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=cu.syncDiff(this.state,a,l,c),m())}),this.onJoin((a,l,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:c})}),this.onLeave((a,l,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,a){const l=this.cloneDeep(e),c=this.transformState(t),m={},g={};return this.map(l,(y,_)=>{c[y]||(g[y]=_)}),this.map(c,(y,_)=>{const w=l[y];if(w){const E=_.map(k=>k.presence_ref),S=w.map(k=>k.presence_ref),N=_.filter(k=>S.indexOf(k.presence_ref)<0),M=w.filter(k=>E.indexOf(k.presence_ref)<0);N.length>0&&(m[y]=N),M.length>0&&(g[y]=M)}else m[y]=_}),this.syncDiff(l,{joins:m,leaves:g},r,a)}static syncDiff(e,t,r,a){const{joins:l,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(l,(m,g)=>{var y;const _=(y=e[m])!==null&&y!==void 0?y:[];if(e[m]=this.cloneDeep(g),_.length>0){const w=e[m].map(S=>S.presence_ref),E=_.filter(S=>w.indexOf(S.presence_ref)<0);e[m].unshift(...E)}r(m,_,g)}),this.map(c,(m,g)=>{let y=e[m];if(!y)return;const _=g.map(w=>w.presence_ref);y=y.filter(w=>_.indexOf(w.presence_ref)<0),e[m]=y,a(m,y,g),y.length===0&&delete e[m]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const a=e[r];return"metas"in a?t[r]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[r]=a,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Jw;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Jw||(Jw={}));var uu;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(uu||(uu={}));var Xr;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(Xr||(Xr={}));class my{constructor(e,t={config:{}},r){var a,l;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=sn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new fp(this,zs.join,this.params,this.timeout),this.rejoinTimer=new qT(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=sn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=sn.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=sn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=sn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=sn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(zs.reply,{},(c,m)=>{this._trigger(this._replyEventName(m),c)}),this.presence=new cu(this),this.broadcastEndpointURL=$T(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,a,l;if(this.socket.isConnected()||this.socket.connect(),this.state==sn.closed){const{config:{broadcast:c,presence:m,private:g}}=this.params,y=(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(S=>S.filter))!==null&&a!==void 0?a:[],_=!!this.bindings[uu.PRESENCE]&&this.bindings[uu.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,w={},E={broadcast:c,presence:Object.assign(Object.assign({},m),{enabled:_}),postgres_changes:y,private:g};this.socket.accessTokenValue&&(w.access_token=this.socket.accessTokenValue),this._onError(S=>e==null?void 0:e(Xr.CHANNEL_ERROR,S)),this._onClose(()=>e==null?void 0:e(Xr.CLOSED)),this.updateJoinPayload(Object.assign({config:E},w)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:S})=>{var N;if(this.socket.setAuth(),S===void 0){e==null||e(Xr.SUBSCRIBED);return}else{const M=this.bindings.postgres_changes,k=(N=M==null?void 0:M.length)!==null&&N!==void 0?N:0,V=[];for(let F=0;F<k;F++){const $=M[F],{filter:{event:te,schema:ue,table:le,filter:I}}=$,C=S&&S[F];if(C&&C.event===te&&C.schema===ue&&C.table===le&&C.filter===I)V.push(Object.assign(Object.assign({},$),{id:C.id}));else{this.unsubscribe(),this.state=sn.errored,e==null||e(Xr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=V,e&&e(Xr.SUBSCRIBED);return}}).receive("error",S=>{this.state=sn.errored,e==null||e(Xr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(S).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Xr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===sn.joined&&e===uu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async httpSend(e,t,r={}){var a;const l=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(t==null)return Promise.reject("Payload is required for httpSend()");const c={method:"POST",headers:{Authorization:l,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},m=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);if(m.status===202)return{success:!0};let g=m.statusText;try{const y=await m.json();g=y.error||y.message||g}catch{}return Promise.reject(new Error(g))}async send(e,t={}){var r,a;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:c}=e,g={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const y=await this._fetchWithTimeout(this.broadcastEndpointURL,g,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=y.body)===null||a===void 0?void 0:a.cancel()),y.ok?"ok":"error"}catch(y){return y.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,m,g;const y=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((g=(m=(c=this.params)===null||c===void 0?void 0:c.config)===null||m===void 0?void 0:m.broadcast)===null||g===void 0)&&g.ack)&&l("ok"),y.receive("ok",()=>l("ok")),y.receive("error",()=>l("error")),y.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=sn.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(zs.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new fp(this,zs.leave,{},e),r.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=sn.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const a=new AbortController,l=setTimeout(()=>a.abort(),r),c=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(l),c}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new fp(this,e,t,r);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>dk){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var a,l;const c=e.toLocaleLowerCase(),{close:m,error:g,leave:y,join:_}=zs;if(r&&[m,g,y,_].indexOf(c)>=0&&r!==this._joinRef())return;let E=this._onMessage(c,t,r);if(t&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(S=>{var N,M,k;return((N=S.filter)===null||N===void 0?void 0:N.event)==="*"||((k=(M=S.filter)===null||M===void 0?void 0:M.event)===null||k===void 0?void 0:k.toLocaleLowerCase())===c}).map(S=>S.callback(E,r)):(l=this.bindings[c])===null||l===void 0||l.filter(S=>{var N,M,k,V,F,$;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in S){const te=S.id,ue=(N=S.filter)===null||N===void 0?void 0:N.event;return te&&((M=t.ids)===null||M===void 0?void 0:M.includes(te))&&(ue==="*"||(ue==null?void 0:ue.toLocaleLowerCase())===((k=t.data)===null||k===void 0?void 0:k.type.toLocaleLowerCase()))}else{const te=(F=(V=S==null?void 0:S.filter)===null||V===void 0?void 0:V.event)===null||F===void 0?void 0:F.toLocaleLowerCase();return te==="*"||te===(($=t==null?void 0:t.event)===null||$===void 0?void 0:$.toLocaleLowerCase())}else return S.type.toLocaleLowerCase()===c}).map(S=>{if(typeof E=="object"&&"ids"in E){const N=E.data,{schema:M,table:k,commit_timestamp:V,type:F,errors:$}=N;E=Object.assign(Object.assign({},{schema:M,table:k,commit_timestamp:V,eventType:F,new:{},old:{},errors:$}),this._getPayloadRecords(N))}S.callback(E,r)})}_isClosed(){return this.state===sn.closed}_isJoined(){return this.state===sn.joined}_isJoining(){return this.state===sn.joining}_isLeaving(){return this.state===sn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const a=e.toLocaleLowerCase(),l={type:a,filter:t,callback:r};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===r&&my.isEqual(a.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(zs.close,{},e)}_onError(e){this._on(zs.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=sn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Xw(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Xw(e.columns,e.old_record)),t}}const mp=()=>{},Sd={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},bk=[1e3,2e3,5e3,1e4],wk=1e4,xk=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Ek{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=e0,this.transport=null,this.heartbeatIntervalMs=Sd.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=mp,this.ref=0,this.reconnectTimer=null,this.vsn=Yw,this.logger=mp,this.conn=null,this.sendBuffer=[],this.serializer=new fk,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>a?(...l)=>a(...l):(...l)=>fetch(...l),!(!((r=t==null?void 0:t.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${t0.websocket}`,this.httpEndpoint=$T(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ok.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Ka.connecting:return Qa.Connecting;case Ka.open:return Qa.Open;case Ka.closing:return Qa.Closing;default:return Qa.Closed}}isConnected(){return this.connectionState()===Qa.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,a=this.getChannels().find(l=>l.topic===r);if(a)return a;{const l=new my(`realtime:${e}`,t,this);return this.channels.push(l),l}}push(e){const{topic:t,event:r,payload:a,ref:l}=e,c=()=>{this.encode(e,m=>{var g;(g=this.conn)===null||g===void 0||g.send(m)})};this.log("push",`${t} ${r} (${l})`,a),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(hk,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Sd.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(y){this.log("error","error in heartbeat callback",y)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:a,payload:l,ref:c}=t,m=c?`(${c})`:"",g=l.status||"";this.log("receive",`${g} ${r} ${a} ${m}`.trim(),l),this.channels.filter(y=>y._isMember(r)).forEach(y=>y._trigger(a,l,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Ka.open||this.conn.readyState===Ka.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(zs.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",a=new URLSearchParams(t);return`${e}${r}${a}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([xk],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const a={access_token:t,version:ck};t&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(zs.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new qT(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Sd.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,a,l,c,m,g,y,_,w,E,S;switch(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:e0,this.heartbeatIntervalMs=(a=e==null?void 0:e.heartbeatIntervalMs)!==null&&a!==void 0?a:Sd.HEARTBEAT_INTERVAL,this.worker=(l=e==null?void 0:e.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=e==null?void 0:e.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(m=e==null?void 0:e.heartbeatCallback)!==null&&m!==void 0?m:mp,this.vsn=(g=e==null?void 0:e.vsn)!==null&&g!==void 0?g:Yw,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(y=e==null?void 0:e.reconnectAfterMs)!==null&&y!==void 0?y:(N=>bk[N-1]||wk),this.vsn){case BT:this.encode=(_=e==null?void 0:e.encode)!==null&&_!==void 0?_:((N,M)=>M(JSON.stringify(N))),this.decode=(w=e==null?void 0:e.decode)!==null&&w!==void 0?w:((N,M)=>M(JSON.parse(N)));break;case uk:this.encode=(E=e==null?void 0:e.encode)!==null&&E!==void 0?E:this.serializer.encode.bind(this.serializer),this.decode=(S=e==null?void 0:e.decode)!==null&&S!==void 0?S:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Wf extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function It(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class Tk extends Wf{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class s0 extends Wf{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}const gy=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),Sk=()=>Response,r0=n=>{if(Array.isArray(n))return n.map(t=>r0(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const a=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[a]=r0(r)}),e},Ak=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},Nk=n=>!n||typeof n!="string"||n.length===0||n.length>100||n.trim()!==n||n.includes("/")||n.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(n),gp=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},Rk=(n,e,t)=>ve(void 0,void 0,void 0,function*(){const r=yield Sk();n instanceof r&&!(t!=null&&t.noResolveJson)?n.json().then(a=>{const l=n.status||500,c=(a==null?void 0:a.statusCode)||l+"";e(new Tk(gp(a),l,c))}).catch(a=>{e(new s0(gp(a),a))}):e(new s0(gp(n),n))}),Ck=(n,e,t,r)=>{const a={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||!r?a:(Ak(r)?(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),a.body=JSON.stringify(r)):a.body=r,e!=null&&e.duplex&&(a.duplex=e.duplex),Object.assign(Object.assign({},a),t))};function Hu(n,e,t,r,a,l){return ve(this,void 0,void 0,function*(){return new Promise((c,m)=>{n(t,Ck(e,r,a,l)).then(g=>{if(!g.ok)throw g;return r!=null&&r.noResolveJson?g:g.json()}).then(g=>c(g)).catch(g=>Rk(g,m,r))})})}function Su(n,e,t,r){return ve(this,void 0,void 0,function*(){return Hu(n,"GET",e,t,r)})}function Us(n,e,t,r,a){return ve(this,void 0,void 0,function*(){return Hu(n,"POST",e,r,a,t)})}function i0(n,e,t,r,a){return ve(this,void 0,void 0,function*(){return Hu(n,"PUT",e,r,a,t)})}function Ik(n,e,t,r){return ve(this,void 0,void 0,function*(){return Hu(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function py(n,e,t,r,a){return ve(this,void 0,void 0,function*(){return Hu(n,"DELETE",e,r,a,t)})}class jk{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return ve(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(It(e))return{data:null,error:e};throw e}})}}var FT;class kk{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[FT]="BlobDownloadBuilder",this.promise=null}asStream(){return new jk(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return ve(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(It(e))return{data:null,error:e};throw e}})}}FT=Symbol.toStringTag;const Ok={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Zw={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Dk{constructor(e,t={},r,a){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=gy(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,r,a){return ve(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},Zw),a);let m=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const g=c.metadata;typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),g&&l.append("metadata",this.encodeMetadata(g)),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.has("cacheControl")||l.append("cacheControl",c.cacheControl),g&&!l.has("metadata")&&l.append("metadata",this.encodeMetadata(g))):(l=r,m["cache-control"]=`max-age=${c.cacheControl}`,m["content-type"]=c.contentType,g&&(m["x-metadata"]=this.toBase64(this.encodeMetadata(g))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!c.duplex&&(c.duplex="half")),a!=null&&a.headers&&(m=Object.assign(Object.assign({},m),a.headers));const y=this._removeEmptyFolders(t),_=this._getFinalPath(y),w=yield(e=="PUT"?i0:Us)(this.fetch,`${this.url}/object/${_}`,l,Object.assign({headers:m},c!=null&&c.duplex?{duplex:c.duplex}:{}));return{data:{path:y,id:w.Id,fullPath:w.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(It(l))return{data:null,error:l};throw l}})}upload(e,t,r){return ve(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,a){return ve(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(e),c=this._getFinalPath(l),m=new URL(this.url+`/object/upload/sign/${c}`);m.searchParams.set("token",t);try{let g;const y=Object.assign({upsert:Zw.upsert},a),_=Object.assign(Object.assign({},this.headers),{"x-upsert":String(y.upsert)});typeof Blob<"u"&&r instanceof Blob?(g=new FormData,g.append("cacheControl",y.cacheControl),g.append("",r)):typeof FormData<"u"&&r instanceof FormData?(g=r,g.append("cacheControl",y.cacheControl)):(g=r,_["cache-control"]=`max-age=${y.cacheControl}`,_["content-type"]=y.contentType);const w=yield i0(this.fetch,m.toString(),g,{headers:_});return{data:{path:l,fullPath:w.Key},error:null}}catch(g){if(this.shouldThrowOnError)throw g;if(It(g))return{data:null,error:g};throw g}})}createSignedUploadUrl(e,t){return ve(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const a=Object.assign({},this.headers);t!=null&&t.upsert&&(a["x-upsert"]="true");const l=yield Us(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),c=new URL(this.url+l.url),m=c.searchParams.get("token");if(!m)throw new Wf("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:m},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(It(r))return{data:null,error:r};throw r}})}update(e,t,r){return ve(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return ve(this,void 0,void 0,function*(){try{return{data:yield Us(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(It(a))return{data:null,error:a};throw a}})}copy(e,t,r){return ve(this,void 0,void 0,function*(){try{return{data:{path:(yield Us(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(It(a))return{data:null,error:a};throw a}})}createSignedUrl(e,t,r){return ve(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),l=yield Us(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const c=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(It(a))return{data:null,error:a};throw a}})}createSignedUrls(e,t,r){return ve(this,void 0,void 0,function*(){try{const a=yield Us(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(It(a))return{data:null,error:a};throw a}})}download(e,t){const a=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),c=l?`?${l}`:"",m=this._getFinalPath(e),g=()=>Su(this.fetch,`${this.url}/${a}/${m}${c}`,{headers:this.headers,noResolveJson:!0});return new kk(g,this.shouldThrowOnError)}info(e){return ve(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield Su(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:r0(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(It(r))return{data:null,error:r};throw r}})}exists(e){return ve(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Ik(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(It(r)&&r instanceof s0){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),a=[],l=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";l!==""&&a.push(l);const m=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",g=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});g!==""&&a.push(g);let y=a.join("&");return y!==""&&(y=`?${y}`),{data:{publicUrl:encodeURI(`${this.url}/${m}/public/${r}${y}`)}}}remove(e){return ve(this,void 0,void 0,function*(){try{return{data:yield py(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}})}list(e,t,r){return ve(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},Ok),t),{prefix:e||""});return{data:yield Us(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(It(a))return{data:null,error:a};throw a}})}listV2(e,t){return ve(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield Us(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(It(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const GT="2.86.0",KT={"X-Client-Info":`storage-js/${GT}`};class Mk{constructor(e,t={},r,a){this.shouldThrowOnError=!1;const l=new URL(e);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},KT),t),this.fetch=gy(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return ve(this,void 0,void 0,function*(){try{const t=this.listBucketOptionsToQueryString(e);return{data:yield Su(this.fetch,`${this.url}/bucket${t}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}})}getBucket(e){return ve(this,void 0,void 0,function*(){try{return{data:yield Su(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}})}createBucket(e){return ve(this,arguments,void 0,function*(t,r={public:!1}){try{return{data:yield Us(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(It(a))return{data:null,error:a};throw a}})}updateBucket(e,t){return ve(this,void 0,void 0,function*(){try{return{data:yield i0(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(It(r))return{data:null,error:r};throw r}})}emptyBucket(e){return ve(this,void 0,void 0,function*(){try{return{data:yield Us(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}})}deleteBucket(e){return ve(this,void 0,void 0,function*(){try{return{data:yield py(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}})}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}}var Au=class extends Error{constructor(n,e){var t;super(n),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((t=e.icebergType)==null?void 0:t.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Pk(n,e,t){const r=new URL(e,n);if(t)for(const[a,l]of Object.entries(t))l!==void 0&&r.searchParams.set(a,l);return r.toString()}async function Vk(n){return!n||n.type==="none"?{}:n.type==="bearer"?{Authorization:`Bearer ${n.token}`}:n.type==="header"?{[n.name]:n.value}:n.type==="custom"?await n.getHeaders():{}}function Lk(n){const e=n.fetchImpl??globalThis.fetch;return{async request({method:t,path:r,query:a,body:l,headers:c}){const m=Pk(n.baseUrl,r,a),g=await Vk(n.auth),y=await e(m,{method:t,headers:{...l?{"Content-Type":"application/json"}:{},...g,...c},body:l?JSON.stringify(l):void 0}),_=await y.text(),w=(y.headers.get("content-type")||"").includes("application/json"),E=w&&_?JSON.parse(_):_;if(!y.ok){const S=w?E:void 0,N=S==null?void 0:S.error;throw new Au((N==null?void 0:N.message)??`Request failed with status ${y.status}`,{status:y.status,icebergType:N==null?void 0:N.type,icebergCode:N==null?void 0:N.code,details:S})}return{status:y.status,headers:y.headers,data:E}}}}function Ad(n){return n.join("")}var Uk=class{constructor(n,e=""){this.client=n,this.prefix=e}async listNamespaces(n){const e=n?{parent:Ad(n.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(r=>({namespace:r}))}async createNamespace(n,e){const t={namespace:n.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ad(n.namespace)}`})}async loadNamespaceMetadata(n){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ad(n.namespace)}`})).data.properties}}async namespaceExists(n){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ad(n.namespace)}`}),!0}catch(e){if(e instanceof Au&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(n,e){try{return await this.createNamespace(n,e)}catch(t){if(t instanceof Au&&t.status===409)return;throw t}}};function tl(n){return n.join("")}var zk=class{constructor(n,e="",t){this.client=n,this.prefix=e,this.accessDelegation=t}async listTables(n){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${tl(n.namespace)}/tables`})).data.identifiers}async createTable(n,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${tl(n.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(n,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${tl(n.namespace)}/tables/${n.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(n,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${tl(n.namespace)}/tables/${n.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(n){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${tl(n.namespace)}/tables/${n.name}`,headers:e})).data.metadata}async tableExists(n){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${tl(n.namespace)}/tables/${n.name}`,headers:e}),!0}catch(t){if(t instanceof Au&&t.status===404)return!1;throw t}}async createTableIfNotExists(n,e){try{return await this.createTable(n,e)}catch(t){if(t instanceof Au&&t.status===409)return await this.loadTable({namespace:n.namespace,name:e.name});throw t}}},Bk=class{constructor(n){var r;let e="v1";n.catalogName&&(e+=`/${n.catalogName}`);const t=n.baseUrl.endsWith("/")?n.baseUrl:`${n.baseUrl}/`;this.client=Lk({baseUrl:t,auth:n.auth,fetchImpl:n.fetch}),this.accessDelegation=(r=n.accessDelegation)==null?void 0:r.join(","),this.namespaceOps=new Uk(this.client,e),this.tableOps=new zk(this.client,e,this.accessDelegation)}async listNamespaces(n){return this.namespaceOps.listNamespaces(n)}async createNamespace(n,e){return this.namespaceOps.createNamespace(n,e)}async dropNamespace(n){await this.namespaceOps.dropNamespace(n)}async loadNamespaceMetadata(n){return this.namespaceOps.loadNamespaceMetadata(n)}async listTables(n){return this.tableOps.listTables(n)}async createTable(n,e){return this.tableOps.createTable(n,e)}async updateTable(n,e){return this.tableOps.updateTable(n,e)}async dropTable(n,e){await this.tableOps.dropTable(n,e)}async loadTable(n){return this.tableOps.loadTable(n)}async namespaceExists(n){return this.namespaceOps.namespaceExists(n)}async tableExists(n){return this.tableOps.tableExists(n)}async createNamespaceIfNotExists(n,e){return this.namespaceOps.createNamespaceIfNotExists(n,e)}async createTableIfNotExists(n,e){return this.tableOps.createTableIfNotExists(n,e)}};class qk{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},KT),t),this.fetch=gy(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return ve(this,void 0,void 0,function*(){try{return{data:yield Us(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}})}listBuckets(e){return ve(this,void 0,void 0,function*(){try{const t=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&t.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&t.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&t.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&t.set("sortOrder",e.sortOrder),e!=null&&e.search&&t.set("search",e.search);const r=t.toString(),a=r?`${this.url}/bucket?${r}`:`${this.url}/bucket`;return{data:yield Su(this.fetch,a,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}})}deleteBucket(e){return ve(this,void 0,void 0,function*(){try{return{data:yield py(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(It(t))return{data:null,error:t};throw t}})}from(e){if(!Nk(e))throw new Wf("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");return new Bk({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:()=>ve(this,void 0,void 0,function*(){return this.headers})},fetch:this.fetch})}}const yy={"X-Client-Info":`storage-js/${GT}`,"Content-Type":"application/json"};class QT extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function rs(n){return typeof n=="object"&&n!==null&&"__isStorageVectorsError"in n}class pp extends QT{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Hk extends QT{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}}var ex;(function(n){n.InternalError="InternalError",n.S3VectorConflictException="S3VectorConflictException",n.S3VectorNotFoundException="S3VectorNotFoundException",n.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",n.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",n.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(ex||(ex={}));const vy=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),$k=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},tx=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Fk=(n,e,t)=>ve(void 0,void 0,void 0,function*(){if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!(t!=null&&t.noResolveJson)){const a=n.status||500,l=n;if(typeof l.json=="function")l.json().then(c=>{const m=(c==null?void 0:c.statusCode)||(c==null?void 0:c.code)||a+"";e(new pp(tx(c),a,m))}).catch(()=>{const c=a+"",m=l.statusText||`HTTP ${a} error`;e(new pp(m,a,c))});else{const c=a+"",m=l.statusText||`HTTP ${a} error`;e(new pp(m,a,c))}}else e(new Hk(tx(n),n))}),Gk=(n,e,t,r)=>{const a={method:n,headers:(e==null?void 0:e.headers)||{}};return r?($k(r)?(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),a.body=JSON.stringify(r)):a.body=r,Object.assign(Object.assign({},a),t)):a};function Kk(n,e,t,r,a,l){return ve(this,void 0,void 0,function*(){return new Promise((c,m)=>{n(t,Gk(e,r,a,l)).then(g=>{if(!g.ok)throw g;if(r!=null&&r.noResolveJson)return g;const y=g.headers.get("content-type");return!y||!y.includes("application/json")?{}:g.json()}).then(g=>c(g)).catch(g=>Fk(g,m,r))})})}function is(n,e,t,r,a){return ve(this,void 0,void 0,function*(){return Kk(n,"POST",e,r,a,t)})}class Qk{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},yy),t),this.fetch=vy(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return ve(this,void 0,void 0,function*(){try{return{data:(yield is(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(rs(t))return{data:null,error:t};throw t}})}getIndex(e,t){return ve(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(rs(r))return{data:null,error:r};throw r}})}listIndexes(e){return ve(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(rs(t))return{data:null,error:t};throw t}})}deleteIndex(e,t){return ve(this,void 0,void 0,function*(){try{return{data:(yield is(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(rs(r))return{data:null,error:r};throw r}})}}class Yk{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},yy),t),this.fetch=vy(r)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return ve(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield is(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(rs(t))return{data:null,error:t};throw t}})}getVectors(e){return ve(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(rs(t))return{data:null,error:t};throw t}})}listVectors(e){return ve(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield is(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(rs(t))return{data:null,error:t};throw t}})}queryVectors(e){return ve(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(rs(t))return{data:null,error:t};throw t}})}deleteVectors(e){return ve(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield is(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(rs(t))return{data:null,error:t};throw t}})}}class Xk{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},yy),t),this.fetch=vy(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return ve(this,void 0,void 0,function*(){try{return{data:(yield is(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(rs(t))return{data:null,error:t};throw t}})}getBucket(e){return ve(this,void 0,void 0,function*(){try{return{data:yield is(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(rs(t))return{data:null,error:t};throw t}})}listBuckets(){return ve(this,arguments,void 0,function*(e={}){try{return{data:yield is(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(rs(t))return{data:null,error:t};throw t}})}deleteBucket(e){return ve(this,void 0,void 0,function*(){try{return{data:(yield is(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(rs(t))return{data:null,error:t};throw t}})}}class Wk extends Xk{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new Jk(this.url,this.headers,e,this.fetch)}createBucket(e){const t=Object.create(null,{createBucket:{get:()=>super.createBucket}});return ve(this,void 0,void 0,function*(){return t.createBucket.call(this,e)})}getBucket(e){const t=Object.create(null,{getBucket:{get:()=>super.getBucket}});return ve(this,void 0,void 0,function*(){return t.getBucket.call(this,e)})}listBuckets(){const e=Object.create(null,{listBuckets:{get:()=>super.listBuckets}});return ve(this,arguments,void 0,function*(t={}){return e.listBuckets.call(this,t)})}deleteBucket(e){const t=Object.create(null,{deleteBucket:{get:()=>super.deleteBucket}});return ve(this,void 0,void 0,function*(){return t.deleteBucket.call(this,e)})}}class Jk extends Qk{constructor(e,t,r,a){super(e,t,a),this.vectorBucketName=r}createIndex(e){const t=Object.create(null,{createIndex:{get:()=>super.createIndex}});return ve(this,void 0,void 0,function*(){return t.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return ve(this,arguments,void 0,function*(t={}){return e.listIndexes.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const t=Object.create(null,{getIndex:{get:()=>super.getIndex}});return ve(this,void 0,void 0,function*(){return t.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const t=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return ve(this,void 0,void 0,function*(){return t.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new Zk(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class Zk extends Yk{constructor(e,t,r,a,l){super(e,t,l),this.vectorBucketName=r,this.indexName=a}putVectors(e){const t=Object.create(null,{putVectors:{get:()=>super.putVectors}});return ve(this,void 0,void 0,function*(){return t.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const t=Object.create(null,{getVectors:{get:()=>super.getVectors}});return ve(this,void 0,void 0,function*(){return t.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return ve(this,arguments,void 0,function*(t={}){return e.listVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const t=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return ve(this,void 0,void 0,function*(){return t.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const t=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return ve(this,void 0,void 0,function*(){return t.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class eO extends Mk{constructor(e,t={},r,a){super(e,t,r,a)}from(e){return new Dk(this.url,this.headers,e,this.fetch)}get vectors(){return new Wk(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new qk(this.url+"/iceberg",this.headers,this.fetch)}}const tO="2.86.0";let Zc="";typeof Deno<"u"?Zc="deno":typeof document<"u"?Zc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Zc="react-native":Zc="node";const nO={"X-Client-Info":`supabase-js-${Zc}/${tO}`},sO={headers:nO},rO={schema:"public"},iO={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},aO={},oO=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),lO=()=>Headers,cO=(n,e,t)=>{const r=oO(t),a=lO();return async(l,c)=>{var m;const g=(m=await e())!==null&&m!==void 0?m:n;let y=new a(c==null?void 0:c.headers);return y.has("apikey")||y.set("apikey",n),y.has("Authorization")||y.set("Authorization",`Bearer ${g}`),r(l,Object.assign(Object.assign({},c),{headers:y}))}};function uO(n){return n.endsWith("/")?n:n+"/"}function hO(n,e){var t,r;const{db:a,auth:l,realtime:c,global:m}=n,{db:g,auth:y,realtime:_,global:w}=e,E={db:Object.assign(Object.assign({},g),a),auth:Object.assign(Object.assign({},y),l),realtime:Object.assign(Object.assign({},_),c),storage:{},global:Object.assign(Object.assign(Object.assign({},w),m),{headers:Object.assign(Object.assign({},(t=w==null?void 0:w.headers)!==null&&t!==void 0?t:{}),(r=m==null?void 0:m.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return n.accessToken?E.accessToken=n.accessToken:delete E.accessToken,E}function dO(n){const e=n==null?void 0:n.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(uO(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const YT="2.86.0",hl=30*1e3,a0=3,yp=a0*hl,fO="http://localhost:9999",mO="supabase.auth.token",gO={"X-Client-Info":`gotrue-js/${YT}`},o0="X-Supabase-Api-Version",XT={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},pO=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,yO=600*1e3;class Nu extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function we(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class vO extends Nu{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function _O(n){return we(n)&&n.name==="AuthApiError"}class Ya extends Nu{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class ha extends Nu{constructor(e,t,r,a){super(e,r,a),this.name=t,this.status=r}}class ts extends ha{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function bO(n){return we(n)&&n.name==="AuthSessionMissingError"}class nl extends ha{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Nd extends ha{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Rd extends ha{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function wO(n){return we(n)&&n.name==="AuthImplicitGrantRedirectError"}class nx extends ha{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class l0 extends ha{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function vp(n){return we(n)&&n.name==="AuthRetryableFetchError"}class sx extends ha{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class c0 extends ha{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const mf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),rx=` 	
\r=`.split(""),xO=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<rx.length;e+=1)n[rx[e].charCodeAt(0)]=-2;for(let e=0;e<mf.length;e+=1)n[mf[e].charCodeAt(0)]=e;return n})();function ix(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(mf[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(mf[r]),e.queuedBits-=6}}function WT(n,e,t){const r=xO[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function ax(n){const e=[],t=c=>{e.push(String.fromCodePoint(c))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=c=>{SO(c,r,t)};for(let c=0;c<n.length;c+=1)WT(n.charCodeAt(c),a,l);return e.join("")}function EO(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function TO(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|a)+65536,t+=1}EO(r,e)}}function SO(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Tl(n){const e=[],t={queue:0,queuedBits:0},r=a=>{e.push(a)};for(let a=0;a<n.length;a+=1)WT(n.charCodeAt(a),t,r);return new Uint8Array(e)}function AO(n){const e=[];return TO(n,t=>e.push(t)),new Uint8Array(e)}function Wa(n){const e=[],t={queue:0,queuedBits:0},r=a=>{e.push(a)};return n.forEach(a=>ix(a,t,r)),ix(null,t,r),e.join("")}function NO(n){return Math.round(Date.now()/1e3)+n}function RO(){return Symbol("auth-callback")}const vn=()=>typeof window<"u"&&typeof document<"u",Ha={tested:!1,writable:!1},JT=()=>{if(!vn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ha.tested)return Ha.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Ha.tested=!0,Ha.writable=!0}catch{Ha.tested=!0,Ha.writable=!1}return Ha.writable};function CO(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((a,l)=>{e[l]=a})}catch{}return t.searchParams.forEach((r,a)=>{e[a]=r}),e}const ZT=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),IO=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",dl=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},$a=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},zi=async(n,e)=>{await n.removeItem(e)};class Jf{constructor(){this.promise=new Jf.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Jf.promiseConstructor=Promise;function _p(n){const e=n.split(".");if(e.length!==3)throw new c0("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!pO.test(e[r]))throw new c0("JWT not in base64url format");return{header:JSON.parse(ax(e[0])),payload:JSON.parse(ax(e[1])),signature:Tl(e[2]),raw:{header:e[0],payload:e[1]}}}async function jO(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function kO(n,e){return new Promise((r,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await n(l);if(!e(l,null,c)){r(c);return}}catch(c){if(!e(l,c)){a(c);return}}})()})}function OO(n){return("0"+n.toString(16)).substr(-2)}function DO(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let a="";for(let l=0;l<56;l++)a+=t.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(e),Array.from(e,OO).join("")}async function MO(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(r);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function PO(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await MO(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function sl(n,e,t=!1){const r=DO();let a=r;t&&(a+="/PASSWORD_RECOVERY"),await dl(n,`${e}-code-verifier`,a);const l=await PO(r);return[l,r===l?"plain":"s256"]}const VO=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function LO(n){const e=n.headers.get(o0);if(!e||!e.match(VO))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function UO(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function zO(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const BO=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function rl(n){if(!BO.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function bp(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function qO(n,e){return new Proxy(n,{get:(t,r,a)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const l=r.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,r,a)}return!e.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,r,a)}})}function ox(n){return JSON.parse(JSON.stringify(n))}const Ga=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),HO=[502,503,504];async function lx(n){var e;if(!IO(n))throw new l0(Ga(n),0);if(HO.includes(n.status))throw new l0(Ga(n),n.status);let t;try{t=await n.json()}catch(l){throw new Ya(Ga(l),l)}let r;const a=LO(n);if(a&&a.getTime()>=XT["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new sx(Ga(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new ts}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new sx(Ga(t),n.status,t.weak_password.reasons);throw new vO(Ga(t),n.status||500,r)}const $O=(n,e,t,r)=>{const a={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),t))};async function Ae(n,e,t,r){var a;const l=Object.assign({},r==null?void 0:r.headers);l[o0]||(l[o0]=XT["2024-01-01"].name),r!=null&&r.jwt&&(l.Authorization=`Bearer ${r.jwt}`);const c=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(c.redirect_to=r.redirectTo);const m=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",g=await FO(n,e,t+m,{headers:l,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(g):{data:Object.assign({},g),error:null}}async function FO(n,e,t,r,a,l){const c=$O(e,r,a,l);let m;try{m=await n(t,Object.assign({},c))}catch(g){throw console.error(g),new l0(Ga(g),0)}if(m.ok||await lx(m),r!=null&&r.noResolveJson)return m;try{return await m.json()}catch(g){await lx(g)}}function Vs(n){var e;let t=null;QO(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=NO(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function cx(n){const e=Vs(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Fi(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function GO(n){return{data:n,error:null}}function KO(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:a,verification_type:l}=n,c=$l(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),m={action_link:e,email_otp:t,hashed_token:r,redirect_to:a,verification_type:l},g=Object.assign({},c);return{data:{properties:m,user:g},error:null}}function ux(n){return n}function QO(n){return n.access_token&&n.refresh_token&&n.expires_in}const wp=["global","local","others"];class YO{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=ZT(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=wp[0]){if(wp.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${wp.join(", ")}`);try{return await Ae(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(we(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await Ae(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Fi})}catch(r){if(we(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=$l(e,["options"]),a=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await Ae(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:KO,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(we(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Ae(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Fi})}catch(t){if(we(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,a,l,c,m,g;try{const y={nextPage:null,lastPage:0,total:0},_=await Ae(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(l=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:ux});if(_.error)throw _.error;const w=await _.json(),E=(c=_.headers.get("x-total-count"))!==null&&c!==void 0?c:0,S=(g=(m=_.headers.get("link"))===null||m===void 0?void 0:m.split(","))!==null&&g!==void 0?g:[];return S.length>0&&(S.forEach(N=>{const M=parseInt(N.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(N.split(";")[1].split("=")[1]);y[`${k}Page`]=M}),y.total=parseInt(E)),{data:Object.assign(Object.assign({},w),y),error:null}}catch(y){if(we(y))return{data:{users:[]},error:y};throw y}}async getUserById(e){rl(e);try{return await Ae(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Fi})}catch(t){if(we(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){rl(e);try{return await Ae(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Fi})}catch(r){if(we(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){rl(e);try{return await Ae(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Fi})}catch(r){if(we(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){rl(e.userId);try{const{data:t,error:r}=await Ae(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:t,error:r}}catch(t){if(we(t))return{data:null,error:t};throw t}}async _deleteFactor(e){rl(e.userId),rl(e.id);try{return{data:await Ae(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(we(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,r,a,l,c,m,g;try{const y={nextPage:null,lastPage:0,total:0},_=await Ae(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(l=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:ux});if(_.error)throw _.error;const w=await _.json(),E=(c=_.headers.get("x-total-count"))!==null&&c!==void 0?c:0,S=(g=(m=_.headers.get("link"))===null||m===void 0?void 0:m.split(","))!==null&&g!==void 0?g:[];return S.length>0&&(S.forEach(N=>{const M=parseInt(N.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(N.split(";")[1].split("=")[1]);y[`${k}Page`]=M}),y.total=parseInt(E)),{data:Object.assign(Object.assign({},w),y),error:null}}catch(y){if(we(y))return{data:{clients:[]},error:y};throw y}}async _createOAuthClient(e){try{return await Ae(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(we(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await Ae(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(we(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await Ae(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(we(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await Ae(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(we(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await Ae(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(we(t))return{data:null,error:t};throw t}}}function hx(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const il={debug:!!(globalThis&&JT()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class eS extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class XO extends eS{}async function WO(n,e,t){il.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),il.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){il.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,a.name);try{return await t()}finally{il.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,a.name)}}else{if(e===0)throw il.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new XO(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(il.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function JO(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function tS(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function ZO(n){return parseInt(n,16)}function eD(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function tD(n){var e;const{chainId:t,domain:r,expirationTime:a,issuedAt:l=new Date,nonce:c,notBefore:m,requestId:g,resources:y,scheme:_,uri:w,version:E}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!w)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(E!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${E}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const S=tS(n.address),N=_?`${_}://${r}`:r,M=n.statement?`${n.statement}
`:"",k=`${N} wants you to sign in with your Ethereum account:
${S}

${M}`;let V=`URI: ${w}
Version: ${E}
Chain ID: ${t}${c?`
Nonce: ${c}`:""}
Issued At: ${l.toISOString()}`;if(a&&(V+=`
Expiration Time: ${a.toISOString()}`),m&&(V+=`
Not Before: ${m.toISOString()}`),g&&(V+=`
Request ID: ${g}`),y){let F=`
Resources:`;for(const $ of y){if(!$||typeof $!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${$}`);F+=`
- ${$}`}V+=F}return`${k}
${V}`}class Zt extends Error{constructor({message:e,code:t,cause:r,name:a}){var l;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(l=a??(r instanceof Error?r.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=t}}class gf extends Zt{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function nD({error:n,options:e}){var t,r,a;const{publicKey:l}=e;if(!l)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Zt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=l.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new Zt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((r=l.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new Zt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Zt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new Zt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new Zt({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return l.pubKeyCredParams.filter(m=>m.type==="public-key").length===0?new Zt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new Zt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const c=window.location.hostname;if(nS(c)){if(l.rp.id!==c)return new Zt({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new Zt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new Zt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new Zt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new Zt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function sD({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Zt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new Zt({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const r=window.location.hostname;if(nS(r)){if(t.rpId!==r)return new Zt({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new Zt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new Zt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new Zt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class rD{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const iD=new rD;function aD(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:r}=n,a=$l(n,["challenge","user","excludeCredentials"]),l=Tl(e).buffer,c=Object.assign(Object.assign({},t),{id:Tl(t.id).buffer}),m=Object.assign(Object.assign({},a),{challenge:l,user:c});if(r&&r.length>0){m.excludeCredentials=new Array(r.length);for(let g=0;g<r.length;g++){const y=r[g];m.excludeCredentials[g]=Object.assign(Object.assign({},y),{id:Tl(y.id).buffer,type:y.type||"public-key",transports:y.transports})}}return m}function oD(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,r=$l(n,["challenge","allowCredentials"]),a=Tl(e).buffer,l=Object.assign(Object.assign({},r),{challenge:a});if(t&&t.length>0){l.allowCredentials=new Array(t.length);for(let c=0;c<t.length;c++){const m=t[c];l.allowCredentials[c]=Object.assign(Object.assign({},m),{id:Tl(m.id).buffer,type:m.type||"public-key",transports:m.transports})}}return l}function lD(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:Wa(new Uint8Array(n.response.attestationObject)),clientDataJSON:Wa(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function cD(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,r=n.getClientExtensionResults(),a=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:Wa(new Uint8Array(a.authenticatorData)),clientDataJSON:Wa(new Uint8Array(a.clientDataJSON)),signature:Wa(new Uint8Array(a.signature)),userHandle:a.userHandle?Wa(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function nS(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function dx(){var n,e;return!!(vn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator==null?void 0:navigator.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function uD(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new gf("Browser returned unexpected credential type",e)}:{data:null,error:new gf("Empty credential response",e)}}catch(e){return{data:null,error:nD({error:e,options:n})}}}async function hD(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new gf("Browser returned unexpected credential type",e)}:{data:null,error:new gf("Empty credential response",e)}}catch(e){return{data:null,error:sD({error:e,options:n})}}}const dD={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},fD={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function pf(...n){const e=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),t=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),r={};for(const a of n)if(a)for(const l in a){const c=a[l];if(c!==void 0)if(Array.isArray(c))r[l]=c;else if(t(c))r[l]=c;else if(e(c)){const m=r[l];e(m)?r[l]=pf(m,c):r[l]=pf(c)}else r[l]=c}return r}function mD(n,e){return pf(dD,n,e||{})}function gD(n,e){return pf(fD,n,e||{})}class pD{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:r,signal:a},l){try{const{data:c,error:m}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!c)return{data:null,error:m};const g=a??iD.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:y}=c.webauthn.credential_options.publicKey;y.name||(y.name=`${y.id}:${r}`),y.displayName||(y.displayName=y.name)}switch(c.webauthn.type){case"create":{const y=mD(c.webauthn.credential_options.publicKey,l==null?void 0:l.create),{data:_,error:w}=await uD({publicKey:y,signal:g});return _?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:_}},error:null}:{data:null,error:w}}case"request":{const y=gD(c.webauthn.credential_options.publicKey,l==null?void 0:l.request),{data:_,error:w}=await hD(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:y,signal:g}));return _?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:_}},error:null}:{data:null,error:w}}}}catch(c){return we(c)?{data:null,error:c}:{data:null,error:new Ya("Unexpected error in challenge",c)}}}async _verify({challengeId:e,factorId:t,webauthn:r}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},l){if(!t)return{data:null,error:new Nu("rpId is required for WebAuthn authentication")};try{if(!dx())return{data:null,error:new Ya("Browser does not support WebAuthn",null)};const{data:c,error:m}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:r},signal:a},{request:l});if(!c)return{data:null,error:m};const{webauthn:g}=c;return this._verify({factorId:e,challengeId:c.challengeId,webauthn:{type:g.type,rpId:t,rpOrigins:r,credential_response:g.credential_response}})}catch(c){return we(c)?{data:null,error:c}:{data:null,error:new Ya("Unexpected error in authenticate",c)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},l){if(!t)return{data:null,error:new Nu("rpId is required for WebAuthn registration")};try{if(!dx())return{data:null,error:new Ya("Browser does not support WebAuthn",null)};const{data:c,error:m}=await this._enroll({friendlyName:e});if(!c)return await this.client.mfa.listFactors().then(_=>{var w;return(w=_.data)===null||w===void 0?void 0:w.all.find(E=>E.factor_type==="webauthn"&&E.friendly_name===e&&E.status!=="unverified")}).then(_=>_?this.client.mfa.unenroll({factorId:_==null?void 0:_.id}):void 0),{data:null,error:m};const{data:g,error:y}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:t,rpOrigins:r},signal:a},{create:l});return g?this._verify({factorId:c.id,challengeId:g.challengeId,webauthn:{rpId:t,rpOrigins:r,type:g.webauthn.type,credential_response:g.webauthn.credential_response}}):{data:null,error:y}}catch(c){return we(c)?{data:null,error:c}:{data:null,error:new Ya("Unexpected error in register",c)}}}}JO();const yD={url:fO,storageKey:mO,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:gO,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function fx(n,e,t){return await t()}const al={};class Ru{get jwks(){var e,t;return(t=(e=al[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){al[this.storageKey]=Object.assign(Object.assign({},al[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=al[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){al[this.storageKey]=Object.assign(Object.assign({},al[this.storageKey]),{cachedAt:e})}constructor(e){var t,r,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},yD),e);if(this.storageKey=l.storageKey,this.instanceID=(t=Ru.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,Ru.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&vn()){const c=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(c),this.logDebugMessages&&console.trace(c)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new YO({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=ZT(l.fetch),this.lock=l.lock||fx,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,l.lock?this.lock=l.lock:vn()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=WO:this.lock=fx,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new pD(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:JT()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=hx(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=hx(this.memoryStorage)),vn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${YT}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},r="none";if(vn()&&(t=CO(window.location.href),this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce")),vn()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:l}=await this._getSessionFromURL(t,r);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),wO(l)){const g=(e=l.details)===null||e===void 0?void 0:e.code;if(g==="identity_already_exists"||g==="identity_not_found"||g==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:m}=a;return this._debug("#_initialize()","detected session in URL",c,"redirect type",m),await this._saveSession(c),setTimeout(async()=>{m==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return we(t)?this._returnResult({error:t}):this._returnResult({error:new Ya("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,a;try{const l=await Ae(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:Vs}),{data:c,error:m}=l;if(m||!c)return this._returnResult({data:{user:null,session:null},error:m});const g=c.session,y=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",g)),this._returnResult({data:{user:y,session:g},error:null})}catch(l){if(we(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(e){var t,r,a;try{let l;if("email"in e){const{email:_,password:w,options:E}=e;let S=null,N=null;this.flowType==="pkce"&&([S,N]=await sl(this.storage,this.storageKey)),l=await Ae(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E==null?void 0:E.emailRedirectTo,body:{email:_,password:w,data:(t=E==null?void 0:E.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken},code_challenge:S,code_challenge_method:N},xform:Vs})}else if("phone"in e){const{phone:_,password:w,options:E}=e;l=await Ae(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:_,password:w,data:(r=E==null?void 0:E.data)!==null&&r!==void 0?r:{},channel:(a=E==null?void 0:E.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken}},xform:Vs})}else throw new Nd("You must provide either an email or phone number and a password");const{data:c,error:m}=l;if(m||!c)return this._returnResult({data:{user:null,session:null},error:m});const g=c.session,y=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",g)),this._returnResult({data:{user:y,session:g},error:null})}catch(l){if(we(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(e){try{let t;if("email"in e){const{email:l,password:c,options:m}=e;t=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:cx})}else if("phone"in e){const{phone:l,password:c,options:m}=e;t=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:cx})}else throw new Nd("You must provide either an email or phone number and a password");const{data:r,error:a}=t;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!r||!r.session||!r.user){const l=new nl;return this._returnResult({data:{user:null,session:null},error:l})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(t){if(we(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,r,a,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,r,a,l,c,m,g,y,_,w,E;let S,N;if("message"in e)S=e.message,N=e.signature;else{const{chain:M,wallet:k,statement:V,options:F}=e;let $;if(vn())if(typeof k=="object")$=k;else{const j=window;if("ethereum"in j&&typeof j.ethereum=="object"&&"request"in j.ethereum&&typeof j.ethereum.request=="function")$=j.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!(F!=null&&F.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");$=k}const te=new URL((t=F==null?void 0:F.url)!==null&&t!==void 0?t:window.location.href),ue=await $.request({method:"eth_requestAccounts"}).then(j=>j).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!ue||ue.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const le=tS(ue[0]);let I=(r=F==null?void 0:F.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!I){const j=await $.request({method:"eth_chainId"});I=ZO(j)}const C={domain:te.host,address:le,statement:V,uri:te.href,version:"1",chainId:I,nonce:(a=F==null?void 0:F.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(c=(l=F==null?void 0:F.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(m=F==null?void 0:F.signInWithEthereum)===null||m===void 0?void 0:m.expirationTime,notBefore:(g=F==null?void 0:F.signInWithEthereum)===null||g===void 0?void 0:g.notBefore,requestId:(y=F==null?void 0:F.signInWithEthereum)===null||y===void 0?void 0:y.requestId,resources:(_=F==null?void 0:F.signInWithEthereum)===null||_===void 0?void 0:_.resources};S=tD(C),N=await $.request({method:"personal_sign",params:[eD(S),le]})}try{const{data:M,error:k}=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:S,signature:N},!((w=e.options)===null||w===void 0)&&w.captchaToken?{gotrue_meta_security:{captcha_token:(E=e.options)===null||E===void 0?void 0:E.captchaToken}}:null),xform:Vs});if(k)throw k;if(!M||!M.session||!M.user){const V=new nl;return this._returnResult({data:{user:null,session:null},error:V})}return M.session&&(await this._saveSession(M.session),await this._notifyAllSubscribers("SIGNED_IN",M.session)),this._returnResult({data:Object.assign({},M),error:k})}catch(M){if(we(M))return this._returnResult({data:{user:null,session:null},error:M});throw M}}async signInWithSolana(e){var t,r,a,l,c,m,g,y,_,w,E,S;let N,M;if("message"in e)N=e.message,M=e.signature;else{const{chain:k,wallet:V,statement:F,options:$}=e;let te;if(vn())if(typeof V=="object")te=V;else{const le=window;if("solana"in le&&typeof le.solana=="object"&&("signIn"in le.solana&&typeof le.solana.signIn=="function"||"signMessage"in le.solana&&typeof le.solana.signMessage=="function"))te=le.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof V!="object"||!($!=null&&$.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");te=V}const ue=new URL((t=$==null?void 0:$.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in te&&te.signIn){const le=await te.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},$==null?void 0:$.signInWithSolana),{version:"1",domain:ue.host,uri:ue.href}),F?{statement:F}:null));let I;if(Array.isArray(le)&&le[0]&&typeof le[0]=="object")I=le[0];else if(le&&typeof le=="object"&&"signedMessage"in le&&"signature"in le)I=le;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in I&&"signature"in I&&(typeof I.signedMessage=="string"||I.signedMessage instanceof Uint8Array)&&I.signature instanceof Uint8Array)N=typeof I.signedMessage=="string"?I.signedMessage:new TextDecoder().decode(I.signedMessage),M=I.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in te)||typeof te.signMessage!="function"||!("publicKey"in te)||typeof te!="object"||!te.publicKey||!("toBase58"in te.publicKey)||typeof te.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");N=[`${ue.host} wants you to sign in with your Solana account:`,te.publicKey.toBase58(),...F?["",F,""]:[""],"Version: 1",`URI: ${ue.href}`,`Issued At: ${(a=(r=$==null?void 0:$.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((l=$==null?void 0:$.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${$.signInWithSolana.notBefore}`]:[],...!((c=$==null?void 0:$.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${$.signInWithSolana.expirationTime}`]:[],...!((m=$==null?void 0:$.signInWithSolana)===null||m===void 0)&&m.chainId?[`Chain ID: ${$.signInWithSolana.chainId}`]:[],...!((g=$==null?void 0:$.signInWithSolana)===null||g===void 0)&&g.nonce?[`Nonce: ${$.signInWithSolana.nonce}`]:[],...!((y=$==null?void 0:$.signInWithSolana)===null||y===void 0)&&y.requestId?[`Request ID: ${$.signInWithSolana.requestId}`]:[],...!((w=(_=$==null?void 0:$.signInWithSolana)===null||_===void 0?void 0:_.resources)===null||w===void 0)&&w.length?["Resources",...$.signInWithSolana.resources.map(I=>`- ${I}`)]:[]].join(`
`);const le=await te.signMessage(new TextEncoder().encode(N),"utf8");if(!le||!(le instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");M=le}}try{const{data:k,error:V}=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:N,signature:Wa(M)},!((E=e.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(S=e.options)===null||S===void 0?void 0:S.captchaToken}}:null),xform:Vs});if(V)throw V;if(!k||!k.session||!k.user){const F=new nl;return this._returnResult({data:{user:null,session:null},error:F})}return k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),this._returnResult({data:Object.assign({},k),error:V})}catch(k){if(we(k))return this._returnResult({data:{user:null,session:null},error:k});throw k}}async _exchangeCodeForSession(e){const t=await $a(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(t??"").split("/");try{const{data:l,error:c}=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Vs});if(await zi(this.storage,`${this.storageKey}-code-verifier`),c)throw c;if(!l||!l.session||!l.user){const m=new nl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:m})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:c})}catch(l){if(we(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(e){try{const{options:t,provider:r,token:a,access_token:l,nonce:c}=e,m=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Vs}),{data:g,error:y}=m;if(y)return this._returnResult({data:{user:null,session:null},error:y});if(!g||!g.session||!g.user){const _=new nl;return this._returnResult({data:{user:null,session:null},error:_})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:g,error:y})}catch(t){if(we(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,r,a,l,c;try{if("email"in e){const{email:m,options:g}=e;let y=null,_=null;this.flowType==="pkce"&&([y,_]=await sl(this.storage,this.storageKey));const{error:w}=await Ae(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:m,data:(t=g==null?void 0:g.data)!==null&&t!==void 0?t:{},create_user:(r=g==null?void 0:g.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:y,code_challenge_method:_},redirectTo:g==null?void 0:g.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:w})}if("phone"in e){const{phone:m,options:g}=e,{data:y,error:_}=await Ae(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:m,data:(a=g==null?void 0:g.data)!==null&&a!==void 0?a:{},create_user:(l=g==null?void 0:g.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},channel:(c=g==null?void 0:g.channel)!==null&&c!==void 0?c:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:y==null?void 0:y.message_id},error:_})}throw new Nd("You must provide either an email or phone number.")}catch(m){if(we(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async verifyOtp(e){var t,r;try{let a,l;"options"in e&&(a=(t=e.options)===null||t===void 0?void 0:t.redirectTo,l=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:c,error:m}=await Ae(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:Vs});if(m)throw m;if(!c)throw new Error("An error occurred on token verification.");const g=c.session,y=c.user;return g!=null&&g.access_token&&(await this._saveSession(g),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",g)),this._returnResult({data:{user:y,session:g},error:null})}catch(a){if(we(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(e){var t,r,a,l,c;try{let m=null,g=null;this.flowType==="pkce"&&([m,g]=await sl(this.storage,this.storageKey));const y=await Ae(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:m,code_challenge_method:g}),headers:this.headers,xform:GO});return!((l=y.data)===null||l===void 0)&&l.url&&vn()&&!(!((c=e.options)===null||c===void 0)&&c.skipBrowserRedirect)&&window.location.assign(y.data.url),this._returnResult(y)}catch(m){if(we(m))return this._returnResult({data:null,error:m});throw m}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new ts;const{error:a}=await Ae(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(e){if(we(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:a,options:l}=e,{error:c}=await Ae(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}else if("phone"in e){const{phone:r,type:a,options:l}=e,{data:c,error:m}=await Ae(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:m})}throw new Nd("You must provide either an email or phone number and a type")}catch(t){if(we(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await $a(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<yp:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const c=await $a(this.userStorage,this.storageKey+"-user");c!=null&&c.user?e.user=c.user:e.user=bp()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};e.user=qO(e.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Ae(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Fi}):await this._useSession(async t=>{var r,a,l;const{data:c,error:m}=t;if(m)throw m;return!(!((r=c.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ts}:await Ae(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=c.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:Fi})})}catch(t){if(we(t))return bO(t)&&(await this._removeSession(),await zi(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:a,error:l}=r;if(l)throw l;if(!a.session)throw new ts;const c=a.session;let m=null,g=null;this.flowType==="pkce"&&e.email!=null&&([m,g]=await sl(this.storage,this.storageKey));const{data:y,error:_}=await Ae(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:m,code_challenge_method:g}),jwt:c.access_token,xform:Fi});if(_)throw _;return c.user=y.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),this._returnResult({data:{user:c.user},error:null})})}catch(r){if(we(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ts;const t=Date.now()/1e3;let r=t,a=!0,l=null;const{payload:c}=_p(e.access_token);if(c.exp&&(r=c.exp,a=r<=t),a){const{data:m,error:g}=await this._callRefreshToken(e.refresh_token);if(g)return this._returnResult({data:{user:null,session:null},error:g});if(!m)return{data:{user:null,session:null},error:null};l=m}else{const{data:m,error:g}=await this._getUser(e.access_token);if(g)throw g;l={access_token:e.access_token,refresh_token:e.refresh_token,user:m.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(t){if(we(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:c,error:m}=t;if(m)throw m;e=(r=c.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new ts;const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(we(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!vn())throw new Rd("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Rd(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new nx("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Rd("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new nx("No code detected.");const{data:F,error:$}=await this._exchangeCodeForSession(e.code);if($)throw $;const te=new URL(window.location.href);return te.searchParams.delete("code"),window.history.replaceState(window.history.state,"",te.toString()),{data:{session:F.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:l,refresh_token:c,expires_in:m,expires_at:g,token_type:y}=e;if(!l||!m||!c||!y)throw new Rd("No session defined in URL");const _=Math.round(Date.now()/1e3),w=parseInt(m);let E=_+w;g&&(E=parseInt(g));const S=E-_;S*1e3<=hl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${S}s, should have been closer to ${w}s`);const N=E-w;_-N>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",N,E,_):_-N<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",N,E,_);const{data:M,error:k}=await this._getUser(l);if(k)throw k;const V={provider_token:r,provider_refresh_token:a,access_token:l,expires_in:w,expires_at:E,refresh_token:c,token_type:y,user:M.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:V,redirectType:e.type},error:null})}catch(r){if(we(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await $a(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:a,error:l}=t;if(l)return this._returnResult({error:l});const c=(r=a.session)===null||r===void 0?void 0:r.access_token;if(c){const{error:m}=await this.admin.signOut(c,e);if(m&&!(_O(m)&&(m.status===404||m.status===401||m.status===403)))return this._returnResult({error:m})}return e!=="others"&&(await this._removeSession(),await zi(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=RO(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,a;try{const{data:{session:l},error:c}=t;if(c)throw c;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,t={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await sl(this.storage,this.storageKey,!0));try{return await Ae(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(we(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(we(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:r,error:a}=await this._useSession(async l=>{var c,m,g,y,_;const{data:w,error:E}=l;if(E)throw E;const S=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(m=e.options)===null||m===void 0?void 0:m.scopes,queryParams:(g=e.options)===null||g===void 0?void 0:g.queryParams,skipBrowserRedirect:!0});return await Ae(this.fetch,"GET",S,{headers:this.headers,jwt:(_=(y=w.session)===null||y===void 0?void 0:y.access_token)!==null&&_!==void 0?_:void 0})});if(a)throw a;return vn()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),this._returnResult({data:{provider:e.provider,url:r==null?void 0:r.url},error:null})}catch(r){if(we(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{const{error:a,data:{session:l}}=t;if(a)throw a;const{options:c,provider:m,token:g,access_token:y,nonce:_}=e,w=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=l==null?void 0:l.access_token)!==null&&r!==void 0?r:void 0,body:{provider:m,id_token:g,access_token:y,nonce:_,link_identity:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:Vs}),{data:E,error:S}=w;return S?this._returnResult({data:{user:null,session:null},error:S}):!E||!E.session||!E.user?this._returnResult({data:{user:null,session:null},error:new nl}):(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("USER_UPDATED",E.session)),this._returnResult({data:E,error:S}))}catch(a){if(we(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,a;const{data:l,error:c}=t;if(c)throw c;return await Ae(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(r=l.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(t){if(we(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await kO(async a=>(a>0&&await jO(200*Math.pow(2,a-1)),this._debug(t,"refreshing attempt",a),await Ae(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Vs})),(a,l)=>{const c=200*Math.pow(2,a);return l&&vp(l)&&Date.now()+c-r<hl})}catch(r){if(this._debug(t,"error",r),we(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),vn()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const a=await $a(this.storage,this.storageKey);if(a&&this.userStorage){let c=await $a(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:a.user},await dl(this.userStorage,this.storageKey+"-user",c)),a.user=(e=c==null?void 0:c.user)!==null&&e!==void 0?e:bp()}else if(a&&!a.user&&!a.user){const c=await $a(this.storage,this.storageKey+"-user");c&&(c!=null&&c.user)?(a.user=c.user,await zi(this.storage,this.storageKey+"-user"),await dl(this.storage,this.storageKey,a)):a.user=bp()}if(this._debug(r,"session from storage",a),!this._isValidSession(a)){this._debug(r,"session is not valid"),a!==null&&await this._removeSession();return}const l=((t=a.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<yp;if(this._debug(r,`session has${l?"":" not"} expired with margin of ${yp}s`),l){if(this.autoRefreshToken&&a.refresh_token){const{error:c}=await this._callRefreshToken(a.refresh_token);c&&(console.error(c),vp(c)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:m}=await this._getUser(a.access_token);!m&&(c!=null&&c.user)?(a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(r,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(r,"error",a),console.error(a);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new ts;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Jf;const{data:l,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!l.session)throw new ts;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const m={data:l.session,error:null};return this.refreshingDeferred.resolve(m),m}catch(l){if(this._debug(a,"error",l),we(l)){const c={data:null,error:l};return vp(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,t,r=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async m=>{try{await m.callback(e,t)}catch(g){l.push(g)}});if(await Promise.all(c),l.length>0){for(let m=0;m<l.length;m+=1)console.error(l[m]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await dl(this.userStorage,this.storageKey+"-user",{user:t.user});const a=Object.assign({},t);delete a.user;const l=ox(a);await dl(this.storage,this.storageKey,l)}else{const a=ox(t);await dl(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await zi(this.storage,this.storageKey),await zi(this.storage,this.storageKey+"-code-verifier"),await zi(this.storage,this.storageKey+"-user"),this.userStorage&&await zi(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&vn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),hl);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-e)/hl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${hl}ms, refresh threshold is ${a0} ticks`),a<=a0&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof eS)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!vn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const a=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[l,c]=await sl(this.storage,this.storageKey),m=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});a.push(m.toString())}if(r!=null&&r.queryParams){const l=new URLSearchParams(r.queryParams);a.push(l.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:a,error:l}=t;return l?this._returnResult({data:null,error:l}):await Ae(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(we(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,a;const{data:l,error:c}=t;if(c)return this._returnResult({data:null,error:c});const m=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:g,error:y}=await Ae(this.fetch,"POST",`${this.url}/factors`,{body:m,headers:this.headers,jwt:(r=l==null?void 0:l.session)===null||r===void 0?void 0:r.access_token});return y?this._returnResult({data:null,error:y}):(e.factorType==="totp"&&g.type==="totp"&&(!((a=g==null?void 0:g.totp)===null||a===void 0)&&a.qr_code)&&(g.totp.qr_code=`data:image/svg+xml;utf-8,${g.totp.qr_code}`),this._returnResult({data:g,error:null}))})}catch(t){if(we(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:a,error:l}=t;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?lD(e.webauthn.credential_response):cD(e.webauthn.credential_response)})}:{code:e.code}),{data:m,error:g}=await Ae(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:c,headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return g?this._returnResult({data:null,error:g}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+m.expires_in},m)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",m),this._returnResult({data:m,error:g}))})}catch(t){if(we(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:a,error:l}=t;if(l)return this._returnResult({data:null,error:l});const c=await Ae(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});if(c.error)return c;const{data:m}=c;if(m.type!=="webauthn")return{data:m,error:null};switch(m.webauthn.type){case"create":return{data:Object.assign(Object.assign({},m),{webauthn:Object.assign(Object.assign({},m.webauthn),{credential_options:Object.assign(Object.assign({},m.webauthn.credential_options),{publicKey:aD(m.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},m),{webauthn:Object.assign(Object.assign({},m.webauthn),{credential_options:Object.assign(Object.assign({},m.webauthn.credential_options),{publicKey:oD(m.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(we(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const a={all:[],phone:[],totp:[],webauthn:[]};for(const l of(e=t==null?void 0:t.factors)!==null&&e!==void 0?e:[])a.all.push(l),l.status==="verified"&&a[l.factor_type].push(l);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:r},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=_p(r.access_token);let c=null;l.aal&&(c=l.aal);let m=c;((t=(e=r.user.factors)===null||e===void 0?void 0:e.filter(_=>_.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(m="aal2");const y=l.amr||[];return{data:{currentLevel:c,nextLevel:m,currentAuthenticationMethods:y},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;return a?this._returnResult({data:null,error:a}):r?await Ae(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new ts})})}catch(t){if(we(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:a},error:l}=r;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new ts});const c=await Ae(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:m=>({data:m,error:null})});return c.data&&c.data.redirect_url&&vn()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(c.data.redirect_url),c})}catch(r){if(we(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:a},error:l}=r;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new ts});const c=await Ae(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:m=>({data:m,error:null})});return c.data&&c.data.redirect_url&&vn()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(c.data.redirect_url),c})}catch(r){if(we(r))return this._returnResult({data:null,error:r});throw r}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;return r?this._returnResult({data:null,error:r}):t?await Ae(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new ts})})}catch(e){if(we(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;return a?this._returnResult({data:null,error:a}):r?(await Ae(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new ts})})}catch(t){if(we(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(m=>m.kid===e);if(r)return r;const a=Date.now();if(r=this.jwks.keys.find(m=>m.kid===e),r&&this.jwks_cached_at+yO>a)return r;const{data:l,error:c}=await Ae(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=a,r=l.keys.find(m=>m.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:S,error:N}=await this.getSession();if(N||!S.session)return this._returnResult({data:null,error:N});r=S.session.access_token}const{header:a,payload:l,signature:c,raw:{header:m,payload:g}}=_p(r);t!=null&&t.allowExpired||UO(l.exp);const y=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!y){const{error:S}=await this.getUser(r);if(S)throw S;return{data:{claims:l,header:a,signature:c},error:null}}const _=zO(a.alg),w=await crypto.subtle.importKey("jwk",y,_,!0,["verify"]);if(!await crypto.subtle.verify(_,w,c,AO(`${m}.${g}`)))throw new c0("Invalid JWT signature");return{data:{claims:l,header:a,signature:c},error:null}}catch(r){if(we(r))return this._returnResult({data:null,error:r});throw r}}}Ru.nextInstanceID={};const vD=Ru;class _D extends vD{constructor(e){super(e)}}class bD{constructor(e,t,r){var a,l,c;this.supabaseUrl=e,this.supabaseKey=t;const m=dO(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",m),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",m),this.storageUrl=new URL("storage/v1",m),this.functionsUrl=new URL("functions/v1",m);const g=`sb-${m.hostname.split(".")[0]}-auth-token`,y={db:rO,realtime:aO,auth:Object.assign(Object.assign({},iO),{storageKey:g}),global:sO},_=hO(r??{},y);this.storageKey=(a=_.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(l=_.global.headers)!==null&&l!==void 0?l:{},_.accessToken?(this.accessToken=_.accessToken,this.auth=new Proxy({},{get:(w,E)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(E)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=_.auth)!==null&&c!==void 0?c:{},this.headers,_.global.fetch),this.fetch=cO(t,this._getAccessToken.bind(this),_.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},_.realtime)),this.accessToken&&this.accessToken().then(w=>this.realtime.setAuth(w)).catch(w=>console.warn("Failed to set initial Realtime auth token:",w)),this.rest=new ak(new URL("rest/v1",m).href,{headers:this.headers,schema:_.db.schema,fetch:this.fetch}),this.storage=new eO(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),_.accessToken||this._listenForAuthEvents()}get functions(){return new nk(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();const{data:r}=await this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:l,storageKey:c,flowType:m,lock:g,debug:y,throwOnError:_},w,E){const S={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new _D({url:this.authUrl.href,headers:Object.assign(Object.assign({},S),w),storageKey:c,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:l,flowType:m,lock:g,debug:y,throwOnError:_,fetch:E,hasCustomAuthorizationHeader:Object.keys(this.headers).some(N=>N.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Ek(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const wD=(n,e,t)=>new bD(n,e,t);function xD(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}xD()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const ED="https://hykypgxaegmufdothwbv.supabase.co",TD="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh5a3lwZ3hhZWdtdWZkb3Rod2J2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1NTE3NzMsImV4cCI6MjA3NzEyNzc3M30.Euzl2vfhHrxhgN-tfg2XftMaX9hEiJOorSJq16n2CRY",SD=wD(ED,TD),AD=(n,e)=>{const t=r=>{const a=r.match(/(\d+)$/);return a?parseInt(a[1],10):0};return t(n.id)-t(e.id)},ND=async()=>{const{data:n,error:e}=await SD.from("licenses").select(`
      id,
      name,
      display_order,
      subjects (
        id,
        name,
        display_order,
        questions (
          *,
          answers (
            id,
            text
          )
        )
      )
    `).order("display_order",{ascending:!0}).order("display_order",{foreignTable:"subjects",ascending:!0});if(e)throw console.error("Error fetching data from Supabase:",e),e;return n.map(r=>({id:r.id,name:r.name,subjects:r.subjects.map(a=>({id:a.id,name:a.name,questions:a.questions.sort(AD).map(l=>({id:l.id,text:l.text,image:l.image,correctAnswerId:l.correct_answer_id,answers:l.answers.map(c=>({id:c.id,text:c.text}))}))}))}))},me={WELCOME:"welcome",LOGIN:"login",DASHBOARD:"dashboard",LICENSE_SELECTION:"license_selection",NAME_INPUT:"name_input",MODE_SELECTION:"mode_selection",SUBJECT_SELECTION:"subject_selection",IN_QUIZ:"in_quiz",IN_ONLINE_EXAM:"in_online_exam",RESULT:"results",EXAM_RESULT:"exam_result",HISTORY:"history",MY_CLASS:"my_class",CLASS_MANAGEMENT:"class_management",REGISTER:"register",ACCOUNT:"account",NOTIFICATION_MGMT:"notification_mgmt"},RD=()=>{const[n,e]=Y.useState(me.WELCOME),[t,r]=Y.useState([]),[a,l]=Y.useState(null),[c,m]=Y.useState([]),[g,y]=Y.useState(null),[_,w]=Y.useState(null),[E,S]=Y.useState({}),[N,M]=Y.useState(0),[k,V]=Y.useState(""),[F,$]=Y.useState(null),[te,ue]=Y.useState(window.innerWidth<768),[le,I]=Y.useState(!1);Y.useEffect(()=>{const W=()=>{ue(window.innerWidth<768)};return window.addEventListener("resize",W),()=>window.removeEventListener("resize",W)},[]),Y.useEffect(()=>{(async()=>{try{const oe=await ND();r(oe)}catch(oe){console.error("Error loading licenses:",oe)}})()},[]),Y.useEffect(()=>{const W=F3(xu,async oe=>{if(oe){const fe=await sj(oe.uid);$(fe),V((fe==null?void 0:fe.full_name)||oe.displayName||""),Ls(async()=>{const{loadSession:Te,getLicensePreference:Me}=await import("./sessionService-CxCtOUx6.js");return{loadSession:Te,getLicensePreference:Me}},[]).then(({loadSession:Te,getLicensePreference:Me})=>{const tt=Te(oe.uid);if(tt){console.log("Restoring session...",tt),w(tt.quiz),S(tt.userAnswers),l(tt.selectedLicense),y(tt.selectedSubject),tt.mode==="online_exam"?e(me.IN_ONLINE_EXAM):e(me.IN_QUIZ);return}const Je=Me();if(Je){const je=t.find(Ft=>Ft.id===Je);je&&l(je),e(me.DASHBOARD)}else e(me.DASHBOARD)})}else $(null),V(""),e(me.WELCOME)});return()=>{W()}},[t]);const C=Y.useCallback((W,oe,fe,Te,Me)=>{!Te||!F||Ls(async()=>{const{saveSession:tt}=await import("./sessionService-CxCtOUx6.js");return{saveSession:tt}},[]).then(({saveSession:tt})=>{tt(F.id,Te,Me,fe,W,oe,a,g)})},[a,g,F]);Y.useEffect(()=>{if(n===me.IN_QUIZ||n===me.IN_ONLINE_EXAM){I(!1);return}F&&Ls(async()=>{const{loadSession:W}=await import("./sessionService-CxCtOUx6.js");return{loadSession:W}},[]).then(({loadSession:W})=>{const oe=W(F.id);I(!!oe)})},[n,F]);const j=()=>{Ls(async()=>{const{loadSession:W}=await import("./sessionService-CxCtOUx6.js");return{loadSession:W}},[]).then(({loadSession:W})=>{if(!F)return;const oe=W(F.id);oe&&(w(oe.quiz),S(oe.userAnswers),l(oe.selectedLicense),y(oe.selectedSubject),oe.mode==="online_exam"?e(me.IN_ONLINE_EXAM):e(me.IN_QUIZ))})},R=()=>{F?Ls(async()=>{const{getLicensePreference:W}=await import("./sessionService-CxCtOUx6.js");return{getLicensePreference:W}},[]).then(({getLicensePreference:W})=>{const oe=W();oe&&t.find(fe=>fe.id===oe)?(l(t.find(fe=>fe.id===oe)),e(me.DASHBOARD)):e(me.LICENSE_SELECTION)}):e(me.LICENSE_SELECTION)},D=()=>{e(me.LOGIN)},L=()=>{e(me.REGISTER)},O=async W=>{l(W),Ls(async()=>{const{saveLicensePreference:oe}=await import("./sessionService-CxCtOUx6.js");return{saveLicensePreference:oe}},[]).then(({saveLicensePreference:oe})=>{oe(W.id)}),e(F?me.MODE_SELECTION:me.NAME_INPUT)},Fe=W=>{V(W),e(me.MODE_SELECTION)},et=async W=>{W==="practice"?a&&(m(a.subjects),e(me.SUBJECT_SELECTION)):W==="online_exam"&&q()},q=async()=>{if(a){const fe=[...a.subjects.flatMap(Me=>Me.questions)].sort(()=>.5-Math.random()).slice(0,30),Te={id:"exam-"+Date.now(),title:` thi th ${a.name}`,questions:fe,timeLimit:1800};w(Te),S({}),e(me.IN_ONLINE_EXAM)}},ce=async W=>{y(W);const oe={id:W.id,title:W.name,questions:W.questions,timeLimit:0};w(oe),S({}),e(me.IN_QUIZ)},_e=W=>{if(_){Ls(async()=>{const{clearSession:fe}=await import("./sessionService-CxCtOUx6.js");return{clearSession:fe}},[]).then(({clearSession:fe})=>fe()),I(!1);let oe=0;if(_.questions.forEach(fe=>{W[fe.id]===fe.correctAnswerId&&oe++}),M(oe),S(W),n===me.IN_ONLINE_EXAM)F&&Pw(F.id,a.id,a.name,null,"Thi th",oe,30,_.timeLimit-0),e(me.EXAM_RESULT);else{if(F&&a){const fe=g?g.name:null;Pw(F.id,a.id,a.name,fe,"n tp",oe,_.questions.length,0)}e(me.RESULT)}}},De=()=>{n===me.EXAM_RESULT?q():g&&a&&ce(g)},qe=W=>{W==="dashboard"?e(F?me.DASHBOARD:me.WELCOME):W==="history"?e(me.HISTORY):W==="login"?e(me.LOGIN):W==="my_class"?e(me.MY_CLASS):W==="class_management"?e(me.CLASS_MANAGEMENT):W==="account"?e(me.ACCOUNT):W==="notification_mgmt"&&e(me.NOTIFICATION_MGMT)},U=async()=>{Ls(async()=>{const{clearSession:W}=await import("./sessionService-CxCtOUx6.js");return{clearSession:W}},[]).then(({clearSession:W})=>W()),await xu.signOut()},ne=()=>{switch(n){case me.WELCOME:return h.jsx(Vw,{onStart:R,onLoginClick:D,onRegisterClick:L});case me.LOGIN:return h.jsx(lj,{onBack:()=>e(me.WELCOME)});case me.REGISTER:return h.jsx(cj,{onBack:()=>e(me.WELCOME),onSuccess:()=>e(me.DASHBOARD)});case me.LICENSE_SELECTION:return h.jsx(hj,{licenses:t,onSelect:O,onBack:()=>e(me.WELCOME)});case me.NAME_INPUT:return h.jsx(dj,{onNameSubmit:Fe,onBack:()=>e(me.LICENSE_SELECTION)});case me.MODE_SELECTION:return h.jsx(fj,{onModeSelect:et,licenseName:(a==null?void 0:a.name)||"",userName:k,onSwitchLicense:()=>e(me.LICENSE_SELECTION)});case me.SUBJECT_SELECTION:return h.jsx(mj,{subjects:c,progress:{},onSelect:ce,onBack:()=>e(me.MODE_SELECTION)});case me.IN_QUIZ:return _?h.jsx(gj,{quiz:_,onFinish:_e,onBack:()=>e(me.SUBJECT_SELECTION),initialAnswers:E,initialIndex:(()=>{try{const W=localStorage.getItem("ontap_quiz_session");return W?JSON.parse(W).currentQuestionIndex:0}catch{return 0}})(),onProgressUpdate:(W,oe,fe)=>C(W,oe,fe,_,"practice")}):null;case me.IN_ONLINE_EXAM:return _?h.jsx(vj,{quiz:_,onFinish:_e,onBack:()=>e(me.MODE_SELECTION),userName:k,selectedLicense:a,initialAnswers:E,initialIndex:(()=>{try{const W=localStorage.getItem("ontap_quiz_session");return W?JSON.parse(W).currentQuestionIndex:0}catch{return 0}})(),initialTime:(()=>{try{const W=localStorage.getItem("ontap_quiz_session");return W?JSON.parse(W).timeLeft:void 0}catch{return}})(),onProgressUpdate:(W,oe,fe)=>C(W,oe,fe,_,"online_exam")}):null;case me.RESULT:return _?h.jsx(bj,{quiz:_,userAnswers:E,score:N,onRetry:De,onBack:()=>e(me.SUBJECT_SELECTION),userName:k}):null;case me.EXAM_RESULT:return _?h.jsx(_j,{quiz:_,userAnswers:E,score:N,onRetry:De,onBack:()=>e(me.MODE_SELECTION),userName:k}):null;case me.DASHBOARD:return h.jsx(Bj,{userProfile:F,onStart:()=>e(me.LICENSE_SELECTION),onHistoryClick:()=>e(me.HISTORY),onClassClick:()=>qe(F.role==="hoc_vien"?"my_class":"class_management")});case me.HISTORY:return h.jsx(qj,{userProfile:F,onBack:()=>e(me.DASHBOARD)});case me.MY_CLASS:return h.jsx($j,{userProfile:F,onBack:()=>e(me.DASHBOARD)});case me.CLASS_MANAGEMENT:return h.jsx(Gj,{userProfile:F,onBack:()=>e(me.DASHBOARD)});case me.ACCOUNT:return h.jsx(Qj,{userProfile:F,onBack:()=>e(me.DASHBOARD)});case me.NOTIFICATION_MGMT:return F?h.jsx(aj,{userProfile:F}):null;default:return h.jsx(Vw,{onStart:R,onLoginClick:D,onRegisterClick:L})}};return h.jsxs("div",{className:"min-h-screen bg-background text-foreground font-sans transition-colors duration-300 pt-16",children:[h.jsx(tj,{}),h.jsx(nj,{}),le&&h.jsxs("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-yellow-400 text-black px-6 py-3 rounded-full shadow-xl z-50 animate-bounce cursor-pointer hover:bg-yellow-500 font-bold flex items-center gap-2",onClick:j,children:[h.jsx("span",{children:" Bn ang c bi thi lm d!"}),h.jsx("span",{className:"underline",children:"Lm tip ngay"})]}),h.jsx(Yj,{userProfile:F,onNavigate:qe,onLogout:U}),ne()]})},CD=()=>h.jsxs(gx,{children:[h.jsx(rN,{}),h.jsx(RD,{}),h.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:h.jsx(sN,{})})]}),sS=document.getElementById("root");if(!sS)throw new Error("Could not find root element to mount to");const ID=GA.createRoot(sS);ID.render(h.jsx(Ki.StrictMode,{children:h.jsx(gx,{children:h.jsx(CD,{})})}));
