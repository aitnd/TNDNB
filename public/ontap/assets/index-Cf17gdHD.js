function dN(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in n)){const l=Object.getOwnPropertyDescriptor(r,a);l&&Object.defineProperty(n,a,l.get?l:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function w0(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function fN(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var a=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:function(){return n[r]}})}),t}var tp={exports:{}},nu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t1;function mN(){if(t1)return nu;t1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var f in a)f!=="key"&&(l[f]=a[f])}else l=a;return a=l.ref,{$$typeof:n,type:r,key:c,ref:a!==void 0?a:null,props:l}}return nu.Fragment=e,nu.jsx=t,nu.jsxs=t,nu}var n1;function gN(){return n1||(n1=1,tp.exports=mN()),tp.exports}var h=gN(),np={exports:{}},Le={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s1;function pN(){if(s1)return Le;s1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),w=Symbol.for("react.activity"),E=Symbol.iterator;function S(z){return z===null||typeof z!="object"?null:(z=E&&z[E]||z["@@iterator"],typeof z=="function"?z:null)}var j={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D=Object.assign,R={};function L(z,ne,W){this.props=z,this.context=ne,this.refs=R,this.updater=W||j}L.prototype.isReactComponent={},L.prototype.setState=function(z,ne){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,ne,"setState")},L.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function F(){}F.prototype=L.prototype;function B(z,ne,W){this.props=z,this.context=ne,this.refs=R,this.updater=W||j}var ee=B.prototype=new F;ee.constructor=B,D(ee,L.prototype),ee.isPureReactComponent=!0;var he=Array.isArray;function ue(){}var C={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function k(z,ne,W){var ie=W.ref;return{$$typeof:n,type:z,key:ne,ref:ie!==void 0?ie:null,props:W}}function U(z,ne){return k(z.type,ne,z.props)}function P(z){return typeof z=="object"&&z!==null&&z.$$typeof===n}function H(z){var ne={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(W){return ne[W]})}var A=/\/+/g;function me(z,ne){return typeof z=="object"&&z!==null&&z.key!=null?H(""+z.key):ne.toString(36)}function xe(z){switch(z.status){case"fulfilled":return z.value;case"rejected":throw z.reason;default:switch(typeof z.status=="string"?z.then(ue,ue):(z.status="pending",z.then(function(ne){z.status==="pending"&&(z.status="fulfilled",z.value=ne)},function(ne){z.status==="pending"&&(z.status="rejected",z.reason=ne)})),z.status){case"fulfilled":return z.value;case"rejected":throw z.reason}}throw z}function V(z,ne,W,ie,de){var Te=typeof z;(Te==="undefined"||Te==="boolean")&&(z=null);var Ie=!1;if(z===null)Ie=!0;else switch(Te){case"bigint":case"string":case"number":Ie=!0;break;case"object":switch(z.$$typeof){case n:case e:Ie=!0;break;case v:return Ie=z._init,V(Ie(z._payload),ne,W,ie,de)}}if(Ie)return de=de(z),Ie=ie===""?"."+me(z,0):ie,he(de)?(W="",Ie!=null&&(W=Ie.replace(A,"$&/")+"/"),V(de,ne,W,"",function(Me){return Me})):de!=null&&(P(de)&&(de=U(de,W+(de.key==null||z&&z.key===de.key?"":(""+de.key).replace(A,"$&/")+"/")+Ie)),ne.push(de)),1;Ie=0;var Je=ie===""?".":ie+":";if(he(z))for(var nt=0;nt<z.length;nt++)ie=z[nt],Te=Je+me(ie,nt),Ie+=V(ie,ne,W,Te,de);else if(nt=S(z),typeof nt=="function")for(z=nt.call(z),nt=0;!(ie=z.next()).done;)ie=ie.value,Te=Je+me(ie,nt++),Ie+=V(ie,ne,W,Te,de);else if(Te==="object"){if(typeof z.then=="function")return V(xe(z),ne,W,ie,de);throw ne=String(z),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.")}return Ie}function le(z,ne,W){if(z==null)return z;var ie=[],de=0;return V(z,ie,"","",function(Te){return ne.call(W,Te,de++)}),ie}function _e(z){if(z._status===-1){var ne=z._result;ne=ne(),ne.then(function(W){(z._status===0||z._status===-1)&&(z._status=1,z._result=W)},function(W){(z._status===0||z._status===-1)&&(z._status=2,z._result=W)}),z._status===-1&&(z._status=0,z._result=ne)}if(z._status===1)return z._result.default;throw z._result}var De=typeof reportError=="function"?reportError:function(z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ne=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof z=="object"&&z!==null&&typeof z.message=="string"?String(z.message):String(z),error:z});if(!window.dispatchEvent(ne))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",z);return}console.error(z)},$e={map:le,forEach:function(z,ne,W){le(z,function(){ne.apply(this,arguments)},W)},count:function(z){var ne=0;return le(z,function(){ne++}),ne},toArray:function(z){return le(z,function(ne){return ne})||[]},only:function(z){if(!P(z))throw Error("React.Children.only expected to receive a single React element child.");return z}};return Le.Activity=w,Le.Children=$e,Le.Component=L,Le.Fragment=t,Le.Profiler=a,Le.PureComponent=B,Le.StrictMode=r,Le.Suspense=g,Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,Le.__COMPILER_RUNTIME={__proto__:null,c:function(z){return C.H.useMemoCache(z)}},Le.cache=function(z){return function(){return z.apply(null,arguments)}},Le.cacheSignal=function(){return null},Le.cloneElement=function(z,ne,W){if(z==null)throw Error("The argument must be a React element, but you passed "+z+".");var ie=D({},z.props),de=z.key;if(ne!=null)for(Te in ne.key!==void 0&&(de=""+ne.key),ne)!I.call(ne,Te)||Te==="key"||Te==="__self"||Te==="__source"||Te==="ref"&&ne.ref===void 0||(ie[Te]=ne[Te]);var Te=arguments.length-2;if(Te===1)ie.children=W;else if(1<Te){for(var Ie=Array(Te),Je=0;Je<Te;Je++)Ie[Je]=arguments[Je+2];ie.children=Ie}return k(z.type,de,ie)},Le.createContext=function(z){return z={$$typeof:c,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null},z.Provider=z,z.Consumer={$$typeof:l,_context:z},z},Le.createElement=function(z,ne,W){var ie,de={},Te=null;if(ne!=null)for(ie in ne.key!==void 0&&(Te=""+ne.key),ne)I.call(ne,ie)&&ie!=="key"&&ie!=="__self"&&ie!=="__source"&&(de[ie]=ne[ie]);var Ie=arguments.length-2;if(Ie===1)de.children=W;else if(1<Ie){for(var Je=Array(Ie),nt=0;nt<Ie;nt++)Je[nt]=arguments[nt+2];de.children=Je}if(z&&z.defaultProps)for(ie in Ie=z.defaultProps,Ie)de[ie]===void 0&&(de[ie]=Ie[ie]);return k(z,Te,de)},Le.createRef=function(){return{current:null}},Le.forwardRef=function(z){return{$$typeof:f,render:z}},Le.isValidElement=P,Le.lazy=function(z){return{$$typeof:v,_payload:{_status:-1,_result:z},_init:_e}},Le.memo=function(z,ne){return{$$typeof:y,type:z,compare:ne===void 0?null:ne}},Le.startTransition=function(z){var ne=C.T,W={};C.T=W;try{var ie=z(),de=C.S;de!==null&&de(W,ie),typeof ie=="object"&&ie!==null&&typeof ie.then=="function"&&ie.then(ue,De)}catch(Te){De(Te)}finally{ne!==null&&W.types!==null&&(ne.types=W.types),C.T=ne}},Le.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},Le.use=function(z){return C.H.use(z)},Le.useActionState=function(z,ne,W){return C.H.useActionState(z,ne,W)},Le.useCallback=function(z,ne){return C.H.useCallback(z,ne)},Le.useContext=function(z){return C.H.useContext(z)},Le.useDebugValue=function(){},Le.useDeferredValue=function(z,ne){return C.H.useDeferredValue(z,ne)},Le.useEffect=function(z,ne){return C.H.useEffect(z,ne)},Le.useEffectEvent=function(z){return C.H.useEffectEvent(z)},Le.useId=function(){return C.H.useId()},Le.useImperativeHandle=function(z,ne,W){return C.H.useImperativeHandle(z,ne,W)},Le.useInsertionEffect=function(z,ne){return C.H.useInsertionEffect(z,ne)},Le.useLayoutEffect=function(z,ne){return C.H.useLayoutEffect(z,ne)},Le.useMemo=function(z,ne){return C.H.useMemo(z,ne)},Le.useOptimistic=function(z,ne){return C.H.useOptimistic(z,ne)},Le.useReducer=function(z,ne,W){return C.H.useReducer(z,ne,W)},Le.useRef=function(z){return C.H.useRef(z)},Le.useState=function(z){return C.H.useState(z)},Le.useSyncExternalStore=function(z,ne,W){return C.H.useSyncExternalStore(z,ne,W)},Le.useTransition=function(){return C.H.useTransition()},Le.version="19.2.0",Le}var r1;function x0(){return r1||(r1=1,np.exports=pN()),np.exports}var K=x0();const aa=w0(K);var sp={exports:{}},su={},rp={exports:{}},ip={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i1;function yN(){return i1||(i1=1,(function(n){function e(V,le){var _e=V.length;V.push(le);e:for(;0<_e;){var De=_e-1>>>1,$e=V[De];if(0<a($e,le))V[De]=le,V[_e]=$e,_e=De;else break e}}function t(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var le=V[0],_e=V.pop();if(_e!==le){V[0]=_e;e:for(var De=0,$e=V.length,z=$e>>>1;De<z;){var ne=2*(De+1)-1,W=V[ne],ie=ne+1,de=V[ie];if(0>a(W,_e))ie<$e&&0>a(de,W)?(V[De]=de,V[ie]=_e,De=ie):(V[De]=W,V[ne]=_e,De=ne);else if(ie<$e&&0>a(de,_e))V[De]=de,V[ie]=_e,De=ie;else break e}}return le}function a(V,le){var _e=V.sortIndex-le.sortIndex;return _e!==0?_e:V.id-le.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var c=Date,f=c.now();n.unstable_now=function(){return c.now()-f}}var g=[],y=[],v=1,w=null,E=3,S=!1,j=!1,D=!1,R=!1,L=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;function ee(V){for(var le=t(y);le!==null;){if(le.callback===null)r(y);else if(le.startTime<=V)r(y),le.sortIndex=le.expirationTime,e(g,le);else break;le=t(y)}}function he(V){if(D=!1,ee(V),!j)if(t(g)!==null)j=!0,ue||(ue=!0,H());else{var le=t(y);le!==null&&xe(he,le.startTime-V)}}var ue=!1,C=-1,I=5,k=-1;function U(){return R?!0:!(n.unstable_now()-k<I)}function P(){if(R=!1,ue){var V=n.unstable_now();k=V;var le=!0;try{e:{j=!1,D&&(D=!1,F(C),C=-1),S=!0;var _e=E;try{t:{for(ee(V),w=t(g);w!==null&&!(w.expirationTime>V&&U());){var De=w.callback;if(typeof De=="function"){w.callback=null,E=w.priorityLevel;var $e=De(w.expirationTime<=V);if(V=n.unstable_now(),typeof $e=="function"){w.callback=$e,ee(V),le=!0;break t}w===t(g)&&r(g),ee(V)}else r(g);w=t(g)}if(w!==null)le=!0;else{var z=t(y);z!==null&&xe(he,z.startTime-V),le=!1}}break e}finally{w=null,E=_e,S=!1}le=void 0}}finally{le?H():ue=!1}}}var H;if(typeof B=="function")H=function(){B(P)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,me=A.port2;A.port1.onmessage=P,H=function(){me.postMessage(null)}}else H=function(){L(P,0)};function xe(V,le){C=L(function(){V(n.unstable_now())},le)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(V){V.callback=null},n.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<V?Math.floor(1e3/V):5},n.unstable_getCurrentPriorityLevel=function(){return E},n.unstable_next=function(V){switch(E){case 1:case 2:case 3:var le=3;break;default:le=E}var _e=E;E=le;try{return V()}finally{E=_e}},n.unstable_requestPaint=function(){R=!0},n.unstable_runWithPriority=function(V,le){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var _e=E;E=V;try{return le()}finally{E=_e}},n.unstable_scheduleCallback=function(V,le,_e){var De=n.unstable_now();switch(typeof _e=="object"&&_e!==null?(_e=_e.delay,_e=typeof _e=="number"&&0<_e?De+_e:De):_e=De,V){case 1:var $e=-1;break;case 2:$e=250;break;case 5:$e=1073741823;break;case 4:$e=1e4;break;default:$e=5e3}return $e=_e+$e,V={id:v++,callback:le,priorityLevel:V,startTime:_e,expirationTime:$e,sortIndex:-1},_e>De?(V.sortIndex=_e,e(y,V),t(g)===null&&V===t(y)&&(D?(F(C),C=-1):D=!0,xe(he,_e-De))):(V.sortIndex=$e,e(g,V),j||S||(j=!0,ue||(ue=!0,H()))),V},n.unstable_shouldYield=U,n.unstable_wrapCallback=function(V){var le=E;return function(){var _e=E;E=le;try{return V.apply(this,arguments)}finally{E=_e}}}})(ip)),ip}var a1;function _N(){return a1||(a1=1,rp.exports=yN()),rp.exports}var ap={exports:{}},kn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o1;function vN(){if(o1)return kn;o1=1;var n=x0();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)y+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(g,y,v){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:w==null?null:""+w,children:g,containerInfo:y,implementation:v}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return kn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,kn.createPortal=function(g,y){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return l(g,y,null,v)},kn.flushSync=function(g){var y=c.T,v=r.p;try{if(c.T=null,r.p=2,g)return g()}finally{c.T=y,r.p=v,r.d.f()}},kn.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,r.d.C(g,y))},kn.prefetchDNS=function(g){typeof g=="string"&&r.d.D(g)},kn.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var v=y.as,w=f(v,y.crossOrigin),E=typeof y.integrity=="string"?y.integrity:void 0,S=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;v==="style"?r.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:w,integrity:E,fetchPriority:S}):v==="script"&&r.d.X(g,{crossOrigin:w,integrity:E,fetchPriority:S,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},kn.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var v=f(y.as,y.crossOrigin);r.d.M(g,{crossOrigin:v,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&r.d.M(g)},kn.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var v=y.as,w=f(v,y.crossOrigin);r.d.L(g,v,{crossOrigin:w,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},kn.preloadModule=function(g,y){if(typeof g=="string")if(y){var v=f(y.as,y.crossOrigin);r.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:v,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else r.d.m(g)},kn.requestFormReset=function(g){r.d.r(g)},kn.unstable_batchedUpdates=function(g,y){return g(y)},kn.useFormState=function(g,y,v){return c.H.useFormState(g,y,v)},kn.useFormStatus=function(){return c.H.useHostTransitionStatus()},kn.version="19.2.0",kn}var l1;function bN(){if(l1)return ap.exports;l1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),ap.exports=vN(),ap.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c1;function wN(){if(c1)return su;c1=1;var n=_N(),e=x0(),t=bN();function r(s){var i="https://react.dev/errors/"+s;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var i=s,o=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(o=i.return),s=i.return;while(s)}return i.tag===3?o:null}function c(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function f(s){if(s.tag===31){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function g(s){if(l(s)!==s)throw Error(r(188))}function y(s){var i=s.alternate;if(!i){if(i=l(s),i===null)throw Error(r(188));return i!==s?null:s}for(var o=s,u=i;;){var m=o.return;if(m===null)break;var p=m.alternate;if(p===null){if(u=m.return,u!==null){o=u;continue}break}if(m.child===p.child){for(p=m.child;p;){if(p===o)return g(m),s;if(p===u)return g(m),i;p=p.sibling}throw Error(r(188))}if(o.return!==u.return)o=m,u=p;else{for(var b=!1,T=m.child;T;){if(T===o){b=!0,o=m,u=p;break}if(T===u){b=!0,u=m,o=p;break}T=T.sibling}if(!b){for(T=p.child;T;){if(T===o){b=!0,o=p,u=m;break}if(T===u){b=!0,u=p,o=m;break}T=T.sibling}if(!b)throw Error(r(189))}}if(o.alternate!==u)throw Error(r(190))}if(o.tag!==3)throw Error(r(188));return o.stateNode.current===o?s:i}function v(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s;for(s=s.child;s!==null;){if(i=v(s),i!==null)return i;s=s.sibling}return null}var w=Object.assign,E=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),j=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),F=Symbol.for("react.consumer"),B=Symbol.for("react.context"),ee=Symbol.for("react.forward_ref"),he=Symbol.for("react.suspense"),ue=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function H(s){return s===null||typeof s!="object"?null:(s=P&&s[P]||s["@@iterator"],typeof s=="function"?s:null)}var A=Symbol.for("react.client.reference");function me(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===A?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case D:return"Fragment";case L:return"Profiler";case R:return"StrictMode";case he:return"Suspense";case ue:return"SuspenseList";case k:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case j:return"Portal";case B:return s.displayName||"Context";case F:return(s._context.displayName||"Context")+".Consumer";case ee:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case C:return i=s.displayName||null,i!==null?i:me(s.type)||"Memo";case I:i=s._payload,s=s._init;try{return me(s(i))}catch{}}return null}var xe=Array.isArray,V=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_e={pending:!1,data:null,method:null,action:null},De=[],$e=-1;function z(s){return{current:s}}function ne(s){0>$e||(s.current=De[$e],De[$e]=null,$e--)}function W(s,i){$e++,De[$e]=s.current,s.current=i}var ie=z(null),de=z(null),Te=z(null),Ie=z(null);function Je(s,i){switch(W(Te,i),W(de,s),W(ie,null),i.nodeType){case 9:case 11:s=(s=i.documentElement)&&(s=s.namespaceURI)?Tb(s):0;break;default:if(s=i.tagName,i=i.namespaceURI)i=Tb(i),s=Sb(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ne(ie),W(ie,s)}function nt(){ne(ie),ne(de),ne(Te)}function Me(s){s.memoizedState!==null&&W(Ie,s);var i=ie.current,o=Sb(i,s.type);i!==o&&(W(de,s),W(ie,o))}function mt(s){de.current===s&&(ne(ie),ne(de)),Ie.current===s&&(ne(Ie),Jc._currentValue=_e)}var Rn,rs;function Ze(s){if(Rn===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);Rn=i&&i[1]||"",rs=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Rn+s+rs}var Cn=!1;function zs(s,i){if(!s||Cn)return"";Cn=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(i){var ae=function(){throw Error()};if(Object.defineProperty(ae.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ae,[])}catch(Z){var X=Z}Reflect.construct(s,[],ae)}else{try{ae.call()}catch(Z){X=Z}s.call(ae.prototype)}}else{try{throw Error()}catch(Z){X=Z}(ae=s())&&typeof ae.catch=="function"&&ae.catch(function(){})}}catch(Z){if(Z&&X&&typeof Z.stack=="string")return[Z.stack,X.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=u.DetermineComponentFrameRoot(),b=p[0],T=p[1];if(b&&T){var M=b.split(`
`),Y=T.split(`
`);for(m=u=0;u<M.length&&!M[u].includes("DetermineComponentFrameRoot");)u++;for(;m<Y.length&&!Y[m].includes("DetermineComponentFrameRoot");)m++;if(u===M.length||m===Y.length)for(u=M.length-1,m=Y.length-1;1<=u&&0<=m&&M[u]!==Y[m];)m--;for(;1<=u&&0<=m;u--,m--)if(M[u]!==Y[m]){if(u!==1||m!==1)do if(u--,m--,0>m||M[u]!==Y[m]){var te=`
`+M[u].replace(" at new "," at ");return s.displayName&&te.includes("<anonymous>")&&(te=te.replace("<anonymous>",s.displayName)),te}while(1<=u&&0<=m);break}}}finally{Cn=!1,Error.prepareStackTrace=o}return(o=s?s.displayName||s.name:"")?Ze(o):""}function cr(s,i){switch(s.tag){case 26:case 27:case 5:return Ze(s.type);case 16:return Ze("Lazy");case 13:return s.child!==i&&i!==null?Ze("Suspense Fallback"):Ze("Suspense");case 19:return Ze("SuspenseList");case 0:case 15:return zs(s.type,!1);case 11:return zs(s.type.render,!1);case 1:return zs(s.type,!0);case 31:return Ze("Activity");default:return""}}function fi(s){try{var i="",o=null;do i+=cr(s,o),o=s,s=s.return;while(s);return i}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var jt=Object.prototype.hasOwnProperty,Lt=n.unstable_scheduleCallback,qs=n.unstable_cancelCallback,Aa=n.unstable_shouldYield,jo=n.unstable_requestPaint,bn=n.unstable_now,As=n.unstable_getCurrentPriorityLevel,Hs=n.unstable_ImmediatePriority,Na=n.unstable_UserBlockingPriority,$s=n.unstable_NormalPriority,ko=n.unstable_LowPriority,Ra=n.unstable_IdlePriority,Ca=n.log,Fs=n.unstable_setDisableYieldValue,is=null,$t=null;function Kn(s){if(typeof Ca=="function"&&Fs(s),$t&&typeof $t.setStrictMode=="function")try{$t.setStrictMode(is,s)}catch{}}var At=Math.clz32?Math.clz32:ja,Ia=Math.log,ur=Math.LN2;function ja(s){return s>>>=0,s===0?32:31-(Ia(s)/ur|0)|0}var In=256,Lr=262144,Vt=4194304;function Qn(s){var i=s&42;if(i!==0)return i;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function fn(s,i,o){var u=s.pendingLanes;if(u===0)return 0;var m=0,p=s.suspendedLanes,b=s.pingedLanes;s=s.warmLanes;var T=u&134217727;return T!==0?(u=T&~p,u!==0?m=Qn(u):(b&=T,b!==0?m=Qn(b):o||(o=T&~s,o!==0&&(m=Qn(o))))):(T=u&~p,T!==0?m=Qn(T):b!==0?m=Qn(b):o||(o=u&~s,o!==0&&(m=Qn(o)))),m===0?0:i!==0&&i!==m&&(i&p)===0&&(p=m&-m,o=i&-i,p>=o||p===32&&(o&4194048)!==0)?i:m}function as(s,i){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&i)===0}function mi(s,i){switch(s){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ka(){var s=Vt;return Vt<<=1,(Vt&62914560)===0&&(Vt=4194304),s}function zn(s){for(var i=[],o=0;31>o;o++)i.push(s);return i}function hr(s,i){s.pendingLanes|=i,i!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function dr(s,i,o,u,m,p){var b=s.pendingLanes;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=o,s.entangledLanes&=o,s.errorRecoveryDisabledLanes&=o,s.shellSuspendCounter=0;var T=s.entanglements,M=s.expirationTimes,Y=s.hiddenUpdates;for(o=b&~o;0<o;){var te=31-At(o),ae=1<<te;T[te]=0,M[te]=-1;var X=Y[te];if(X!==null)for(Y[te]=null,te=0;te<X.length;te++){var Z=X[te];Z!==null&&(Z.lane&=-536870913)}o&=~ae}u!==0&&fr(s,u,0),p!==0&&m===0&&s.tag!==0&&(s.suspendedLanes|=p&~(b&~i))}function fr(s,i,o){s.pendingLanes|=i,s.suspendedLanes&=~i;var u=31-At(i);s.entangledLanes|=i,s.entanglements[u]=s.entanglements[u]|1073741824|o&261930}function gi(s,i){var o=s.entangledLanes|=i;for(s=s.entanglements;o;){var u=31-At(o),m=1<<u;m&i|s[u]&i&&(s[u]|=i),o&=~m}}function pi(s,i){var o=i&-i;return o=(o&42)!==0?1:mr(o),(o&(s.suspendedLanes|i))!==0?0:o}function mr(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function os(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Oo(){var s=le.p;return s!==0?s:(s=window.event,s===void 0?32:Qb(s.type))}function ls(s,i){var o=le.p;try{return le.p=s,i()}finally{le.p=o}}var cs=Math.random().toString(36).slice(2),Ut="__reactFiber$"+cs,Xt="__reactProps$"+cs,Ns="__reactContainer$"+cs,yi="__reactEvents$"+cs,cc="__reactListeners$"+cs,Do="__reactHandles$"+cs,Mo="__reactResources$"+cs,Rs="__reactMarker$"+cs;function _i(s){delete s[Ut],delete s[Xt],delete s[yi],delete s[cc],delete s[Do]}function us(s){var i=s[Ut];if(i)return i;for(var o=s.parentNode;o;){if(i=o[Ns]||o[Ut]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(s=kb(s);s!==null;){if(o=s[Ut])return o;s=kb(s)}return i}s=o,o=s.parentNode}return null}function jn(s){if(s=s[Ut]||s[Ns]){var i=s.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return s}return null}function qn(s){var i=s.tag;if(i===5||i===26||i===27||i===6)return s.stateNode;throw Error(r(33))}function Cs(s){var i=s[Mo];return i||(i=s[Mo]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function kt(s){s[Rs]=!0}var vi=new Set,O={};function ce(s,i){Se(s,i),Se(s+"Capture",i)}function Se(s,i){for(O[s]=i,s=0;s<i.length;s++)vi.add(i[s])}var ze=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),qe={},ln={};function Nt(s){return jt.call(ln,s)?!0:jt.call(qe,s)?!1:ze.test(s)?ln[s]=!0:(qe[s]=!0,!1)}function Ot(s,i,o){if(Nt(i))if(o===null)s.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":s.removeAttribute(i);return;case"boolean":var u=i.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){s.removeAttribute(i);return}}s.setAttribute(i,""+o)}}function Ft(s,i,o){if(o===null)s.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(i);return}s.setAttribute(i,""+o)}}function Wt(s,i,o,u){if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttributeNS(i,o,""+u)}}function mn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function bi(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function uc(s,i,o){var u=Object.getOwnPropertyDescriptor(s.constructor.prototype,i);if(!s.hasOwnProperty(i)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var m=u.get,p=u.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return m.call(this)},set:function(b){o=""+b,p.call(this,b)}}),Object.defineProperty(s,i,{enumerable:u.enumerable}),{getValue:function(){return o},setValue:function(b){o=""+b},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function ct(s){if(!s._valueTracker){var i=bi(s)?"checked":"value";s._valueTracker=uc(s,i,""+s[i])}}function Oa(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var o=i.getValue(),u="";return s&&(u=bi(s)?s.checked?"true":"false":s.value),s=u,s!==o?(i.setValue(s),!0):!1}function gr(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Da=/[\n"\\]/g;function Yn(s){return s.replace(Da,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Po(s,i,o,u,m,p,b,T){s.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?s.type=b:s.removeAttribute("type"),i!=null?b==="number"?(i===0&&s.value===""||s.value!=i)&&(s.value=""+mn(i)):s.value!==""+mn(i)&&(s.value=""+mn(i)):b!=="submit"&&b!=="reset"||s.removeAttribute("value"),i!=null?hc(s,b,mn(i)):o!=null?hc(s,b,mn(o)):u!=null&&s.removeAttribute("value"),m==null&&p!=null&&(s.defaultChecked=!!p),m!=null&&(s.checked=m&&typeof m!="function"&&typeof m!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?s.name=""+mn(T):s.removeAttribute("name")}function sh(s,i,o,u,m,p,b,T){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(s.type=p),i!=null||o!=null){if(!(p!=="submit"&&p!=="reset"||i!=null)){ct(s);return}o=o!=null?""+mn(o):"",i=i!=null?""+mn(i):o,T||i===s.value||(s.value=i),s.defaultValue=i}u=u??m,u=typeof u!="function"&&typeof u!="symbol"&&!!u,s.checked=T?s.checked:!!u,s.defaultChecked=!!u,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(s.name=b),ct(s)}function hc(s,i,o){i==="number"&&gr(s.ownerDocument)===s||s.defaultValue===""+o||(s.defaultValue=""+o)}function wi(s,i,o,u){if(s=s.options,i){i={};for(var m=0;m<o.length;m++)i["$"+o[m]]=!0;for(o=0;o<s.length;o++)m=i.hasOwnProperty("$"+s[o].value),s[o].selected!==m&&(s[o].selected=m),m&&u&&(s[o].defaultSelected=!0)}else{for(o=""+mn(o),i=null,m=0;m<s.length;m++){if(s[m].value===o){s[m].selected=!0,u&&(s[m].defaultSelected=!0);return}i!==null||s[m].disabled||(i=s[m])}i!==null&&(i.selected=!0)}}function rh(s,i,o){if(i!=null&&(i=""+mn(i),i!==s.value&&(s.value=i),o==null)){s.defaultValue!==i&&(s.defaultValue=i);return}s.defaultValue=o!=null?""+mn(o):""}function xi(s,i,o,u){if(i==null){if(u!=null){if(o!=null)throw Error(r(92));if(xe(u)){if(1<u.length)throw Error(r(93));u=u[0]}o=u}o==null&&(o=""),i=o}o=mn(i),s.defaultValue=o,u=s.textContent,u===o&&u!==""&&u!==null&&(s.value=u),ct(s)}function Xn(s,i){if(i){var o=s.firstChild;if(o&&o===s.lastChild&&o.nodeType===3){o.nodeValue=i;return}}s.textContent=i}var ih=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function dc(s,i,o){var u=i.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?s.setProperty(i,""):i==="float"?s.cssFloat="":s[i]="":u?s.setProperty(i,o):typeof o!="number"||o===0||ih.has(i)?i==="float"?s.cssFloat=o:s[i]=(""+o).trim():s[i]=o+"px"}function fc(s,i,o){if(i!=null&&typeof i!="object")throw Error(r(62));if(s=s.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||i!=null&&i.hasOwnProperty(u)||(u.indexOf("--")===0?s.setProperty(u,""):u==="float"?s.cssFloat="":s[u]="");for(var m in i)u=i[m],i.hasOwnProperty(m)&&o[m]!==u&&dc(s,m,u)}else for(var p in i)i.hasOwnProperty(p)&&dc(s,p,i[p])}function Lo(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ah=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ei=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Vo(s){return Ei.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Gs(){}var mc=null;function Is(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ti=null,pr=null;function Ma(s){var i=jn(s);if(i&&(s=i.stateNode)){var o=s[Xt]||null;e:switch(s=i.stateNode,i.type){case"input":if(Po(s,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),i=o.name,o.type==="radio"&&i!=null){for(o=s;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Yn(""+i)+'"][type="radio"]'),i=0;i<o.length;i++){var u=o[i];if(u!==s&&u.form===s.form){var m=u[Xt]||null;if(!m)throw Error(r(90));Po(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(i=0;i<o.length;i++)u=o[i],u.form===s.form&&Oa(u)}break e;case"textarea":rh(s,o.value,o.defaultValue);break e;case"select":i=o.value,i!=null&&wi(s,!!o.multiple,i,!1)}}}var Uo=!1;function Si(s,i,o){if(Uo)return s(i,o);Uo=!0;try{var u=s(i);return u}finally{if(Uo=!1,(Ti!==null||pr!==null)&&(Zh(),Ti&&(i=Ti,s=pr,pr=Ti=null,Ma(i),s)))for(i=0;i<s.length;i++)Ma(s[i])}}function Ks(s,i){var o=s.stateNode;if(o===null)return null;var u=o[Xt]||null;if(u===null)return null;o=u[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(s=s.type,u=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!u;break e;default:s=!1}if(s)return null;if(o&&typeof o!="function")throw Error(r(231,i,typeof o));return o}var js=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pa=!1;if(js)try{var gt={};Object.defineProperty(gt,"passive",{get:function(){Pa=!0}}),window.addEventListener("test",gt,gt),window.removeEventListener("test",gt,gt)}catch{Pa=!1}var yr=null,gc=null,La=null;function pc(){if(La)return La;var s,i=gc,o=i.length,u,m="value"in yr?yr.value:yr.textContent,p=m.length;for(s=0;s<o&&i[s]===m[s];s++);var b=o-s;for(u=1;u<=b&&i[o-u]===m[p-u];u++);return La=m.slice(s,1<u?1-u:void 0)}function Va(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function Vr(){return!0}function Qs(){return!1}function wn(s){function i(o,u,m,p,b){this._reactName=o,this._targetInst=m,this.type=u,this.nativeEvent=p,this.target=b,this.currentTarget=null;for(var T in s)s.hasOwnProperty(T)&&(o=s[T],this[T]=o?o(p):p[T]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Vr:Qs,this.isPropagationStopped=Qs,this}return w(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Vr)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Vr)},persist:function(){},isPersistent:Vr}),i}var Ur={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_r=wn(Ur),Ai=w({},Ur,{view:0,detail:0}),yc=wn(Ai),Ni,Bo,vr,zo=w({},Ai,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ri,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==vr&&(vr&&s.type==="mousemove"?(Ni=s.screenX-vr.screenX,Bo=s.screenY-vr.screenY):Bo=Ni=0,vr=s),Ni)},movementY:function(s){return"movementY"in s?s.movementY:Bo}}),_c=wn(zo),Ua=w({},zo,{dataTransfer:0}),oh=wn(Ua),lh=w({},Ai,{relatedTarget:0}),Ba=wn(lh),vc=w({},Ur,{animationName:0,elapsedTime:0,pseudoElement:0}),ch=wn(vc),qo=w({},Ur,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),uh=wn(qo),hh=w({},Ur,{data:0}),br=wn(hh),dh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gh(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=mh[s])?!!i[s]:!1}function Ri(){return gh}var Hn=w({},Ai,{key:function(s){if(s.key){var i=dh[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Va(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?fh[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ri,charCode:function(s){return s.type==="keypress"?Va(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Va(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),ph=wn(Hn),yh=w({},zo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Br=wn(yh),d=w({},Ai,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ri}),_=wn(d),x=w({},Ur,{propertyName:0,elapsedTime:0,pseudoElement:0}),N=wn(x),G=w({},zo,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),J=wn(G),fe=w({},Ur,{newState:0,oldState:0}),Ue=wn(fe),Gt=[9,13,27,32],it=js&&"CompositionEvent"in window,Rt=null;js&&"documentMode"in document&&(Rt=document.documentMode);var ks=js&&"TextEvent"in window&&!Rt,wr=js&&(!it||Rt&&8<Rt&&11>=Rt),Ys=" ",Xs=!1;function za(s,i){switch(s){case"keyup":return Gt.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ho(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var $o=!1;function PS(s,i){switch(s){case"compositionend":return Ho(i);case"keypress":return i.which!==32?null:(Xs=!0,Ys);case"textInput":return s=i.data,s===Ys&&Xs?null:s;default:return null}}function LS(s,i){if($o)return s==="compositionend"||!it&&za(s,i)?(s=pc(),La=gc=yr=null,$o=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return wr&&i.locale!=="ko"?null:i.data;default:return null}}var VS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function My(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!VS[s.type]:i==="textarea"}function Py(s,i,o,u){Ti?pr?pr.push(u):pr=[u]:Ti=u,i=ad(i,"onChange"),0<i.length&&(o=new _r("onChange","change",null,o,u),s.push({event:o,listeners:i}))}var bc=null,wc=null;function US(s){_b(s,0)}function _h(s){var i=qn(s);if(Oa(i))return s}function Ly(s,i){if(s==="change")return i}var Vy=!1;if(js){var lm;if(js){var cm="oninput"in document;if(!cm){var Uy=document.createElement("div");Uy.setAttribute("oninput","return;"),cm=typeof Uy.oninput=="function"}lm=cm}else lm=!1;Vy=lm&&(!document.documentMode||9<document.documentMode)}function By(){bc&&(bc.detachEvent("onpropertychange",zy),wc=bc=null)}function zy(s){if(s.propertyName==="value"&&_h(wc)){var i=[];Py(i,wc,s,Is(s)),Si(US,i)}}function BS(s,i,o){s==="focusin"?(By(),bc=i,wc=o,bc.attachEvent("onpropertychange",zy)):s==="focusout"&&By()}function zS(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return _h(wc)}function qS(s,i){if(s==="click")return _h(i)}function HS(s,i){if(s==="input"||s==="change")return _h(i)}function $S(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var hs=typeof Object.is=="function"?Object.is:$S;function xc(s,i){if(hs(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var o=Object.keys(s),u=Object.keys(i);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var m=o[u];if(!jt.call(i,m)||!hs(s[m],i[m]))return!1}return!0}function qy(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Hy(s,i){var o=qy(s);s=0;for(var u;o;){if(o.nodeType===3){if(u=s+o.textContent.length,s<=i&&u>=i)return{node:o,offset:i-s};s=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=qy(o)}}function $y(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?$y(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function Fy(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var i=gr(s.document);i instanceof s.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)s=i.contentWindow;else break;i=gr(s.document)}return i}function um(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}var FS=js&&"documentMode"in document&&11>=document.documentMode,Fo=null,hm=null,Ec=null,dm=!1;function Gy(s,i,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;dm||Fo==null||Fo!==gr(u)||(u=Fo,"selectionStart"in u&&um(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Ec&&xc(Ec,u)||(Ec=u,u=ad(hm,"onSelect"),0<u.length&&(i=new _r("onSelect","select",null,i,o),s.push({event:i,listeners:u}),i.target=Fo)))}function qa(s,i){var o={};return o[s.toLowerCase()]=i.toLowerCase(),o["Webkit"+s]="webkit"+i,o["Moz"+s]="moz"+i,o}var Go={animationend:qa("Animation","AnimationEnd"),animationiteration:qa("Animation","AnimationIteration"),animationstart:qa("Animation","AnimationStart"),transitionrun:qa("Transition","TransitionRun"),transitionstart:qa("Transition","TransitionStart"),transitioncancel:qa("Transition","TransitionCancel"),transitionend:qa("Transition","TransitionEnd")},fm={},Ky={};js&&(Ky=document.createElement("div").style,"AnimationEvent"in window||(delete Go.animationend.animation,delete Go.animationiteration.animation,delete Go.animationstart.animation),"TransitionEvent"in window||delete Go.transitionend.transition);function Ha(s){if(fm[s])return fm[s];if(!Go[s])return s;var i=Go[s],o;for(o in i)if(i.hasOwnProperty(o)&&o in Ky)return fm[s]=i[o];return s}var Qy=Ha("animationend"),Yy=Ha("animationiteration"),Xy=Ha("animationstart"),GS=Ha("transitionrun"),KS=Ha("transitionstart"),QS=Ha("transitioncancel"),Wy=Ha("transitionend"),Jy=new Map,mm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");mm.push("scrollEnd");function Ws(s,i){Jy.set(s,i),ce(i,[s])}var vh=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Os=[],Ko=0,gm=0;function bh(){for(var s=Ko,i=gm=Ko=0;i<s;){var o=Os[i];Os[i++]=null;var u=Os[i];Os[i++]=null;var m=Os[i];Os[i++]=null;var p=Os[i];if(Os[i++]=null,u!==null&&m!==null){var b=u.pending;b===null?m.next=m:(m.next=b.next,b.next=m),u.pending=m}p!==0&&Zy(o,m,p)}}function wh(s,i,o,u){Os[Ko++]=s,Os[Ko++]=i,Os[Ko++]=o,Os[Ko++]=u,gm|=u,s.lanes|=u,s=s.alternate,s!==null&&(s.lanes|=u)}function pm(s,i,o,u){return wh(s,i,o,u),xh(s)}function $a(s,i){return wh(s,null,null,i),xh(s)}function Zy(s,i,o){s.lanes|=o;var u=s.alternate;u!==null&&(u.lanes|=o);for(var m=!1,p=s.return;p!==null;)p.childLanes|=o,u=p.alternate,u!==null&&(u.childLanes|=o),p.tag===22&&(s=p.stateNode,s===null||s._visibility&1||(m=!0)),s=p,p=p.return;return s.tag===3?(p=s.stateNode,m&&i!==null&&(m=31-At(o),s=p.hiddenUpdates,u=s[m],u===null?s[m]=[i]:u.push(i),i.lane=o|536870912),p):null}function xh(s){if(50<Fc)throw Fc=0,Sg=null,Error(r(185));for(var i=s.return;i!==null;)s=i,i=s.return;return s.tag===3?s.stateNode:null}var Qo={};function YS(s,i,o,u){this.tag=s,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ds(s,i,o,u){return new YS(s,i,o,u)}function ym(s){return s=s.prototype,!(!s||!s.isReactComponent)}function zr(s,i){var o=s.alternate;return o===null?(o=ds(s.tag,i,s.key,s.mode),o.elementType=s.elementType,o.type=s.type,o.stateNode=s.stateNode,o.alternate=s,s.alternate=o):(o.pendingProps=i,o.type=s.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=s.flags&65011712,o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,i=s.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=s.sibling,o.index=s.index,o.ref=s.ref,o.refCleanup=s.refCleanup,o}function e_(s,i){s.flags&=65011714;var o=s.alternate;return o===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,i=o.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),s}function Eh(s,i,o,u,m,p){var b=0;if(u=s,typeof s=="function")ym(s)&&(b=1);else if(typeof s=="string")b=eN(s,o,ie.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case k:return s=ds(31,o,i,m),s.elementType=k,s.lanes=p,s;case D:return Fa(o.children,m,p,i);case R:b=8,m|=24;break;case L:return s=ds(12,o,i,m|2),s.elementType=L,s.lanes=p,s;case he:return s=ds(13,o,i,m),s.elementType=he,s.lanes=p,s;case ue:return s=ds(19,o,i,m),s.elementType=ue,s.lanes=p,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case B:b=10;break e;case F:b=9;break e;case ee:b=11;break e;case C:b=14;break e;case I:b=16,u=null;break e}b=29,o=Error(r(130,s===null?"null":typeof s,"")),u=null}return i=ds(b,o,i,m),i.elementType=s,i.type=u,i.lanes=p,i}function Fa(s,i,o,u){return s=ds(7,s,u,i),s.lanes=o,s}function _m(s,i,o){return s=ds(6,s,null,i),s.lanes=o,s}function t_(s){var i=ds(18,null,null,0);return i.stateNode=s,i}function vm(s,i,o){return i=ds(4,s.children!==null?s.children:[],s.key,i),i.lanes=o,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}var n_=new WeakMap;function Ds(s,i){if(typeof s=="object"&&s!==null){var o=n_.get(s);return o!==void 0?o:(i={value:s,source:i,stack:fi(i)},n_.set(s,i),i)}return{value:s,source:i,stack:fi(i)}}var Yo=[],Xo=0,Th=null,Tc=0,Ms=[],Ps=0,Ci=null,xr=1,Er="";function qr(s,i){Yo[Xo++]=Tc,Yo[Xo++]=Th,Th=s,Tc=i}function s_(s,i,o){Ms[Ps++]=xr,Ms[Ps++]=Er,Ms[Ps++]=Ci,Ci=s;var u=xr;s=Er;var m=32-At(u)-1;u&=~(1<<m),o+=1;var p=32-At(i)+m;if(30<p){var b=m-m%5;p=(u&(1<<b)-1).toString(32),u>>=b,m-=b,xr=1<<32-At(i)+m|o<<m|u,Er=p+s}else xr=1<<p|o<<m|u,Er=s}function bm(s){s.return!==null&&(qr(s,1),s_(s,1,0))}function wm(s){for(;s===Th;)Th=Yo[--Xo],Yo[Xo]=null,Tc=Yo[--Xo],Yo[Xo]=null;for(;s===Ci;)Ci=Ms[--Ps],Ms[Ps]=null,Er=Ms[--Ps],Ms[Ps]=null,xr=Ms[--Ps],Ms[Ps]=null}function r_(s,i){Ms[Ps++]=xr,Ms[Ps++]=Er,Ms[Ps++]=Ci,xr=i.id,Er=i.overflow,Ci=s}var xn=null,Tt=null,et=!1,Ii=null,Ls=!1,xm=Error(r(519));function ji(s){var i=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Sc(Ds(i,s)),xm}function i_(s){var i=s.stateNode,o=s.type,u=s.memoizedProps;switch(i[Ut]=s,i[Xt]=u,o){case"dialog":Ge("cancel",i),Ge("close",i);break;case"iframe":case"object":case"embed":Ge("load",i);break;case"video":case"audio":for(o=0;o<Kc.length;o++)Ge(Kc[o],i);break;case"source":Ge("error",i);break;case"img":case"image":case"link":Ge("error",i),Ge("load",i);break;case"details":Ge("toggle",i);break;case"input":Ge("invalid",i),sh(i,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Ge("invalid",i);break;case"textarea":Ge("invalid",i),xi(i,u.value,u.defaultValue,u.children)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||i.textContent===""+o||u.suppressHydrationWarning===!0||xb(i.textContent,o)?(u.popover!=null&&(Ge("beforetoggle",i),Ge("toggle",i)),u.onScroll!=null&&Ge("scroll",i),u.onScrollEnd!=null&&Ge("scrollend",i),u.onClick!=null&&(i.onclick=Gs),i=!0):i=!1,i||ji(s,!0)}function a_(s){for(xn=s.return;xn;)switch(xn.tag){case 5:case 31:case 13:Ls=!1;return;case 27:case 3:Ls=!0;return;default:xn=xn.return}}function Wo(s){if(s!==xn)return!1;if(!et)return a_(s),et=!0,!1;var i=s.tag,o;if((o=i!==3&&i!==27)&&((o=i===5)&&(o=s.type,o=!(o!=="form"&&o!=="button")||Bg(s.type,s.memoizedProps)),o=!o),o&&Tt&&ji(s),a_(s),i===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Tt=jb(s)}else if(i===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));Tt=jb(s)}else i===27?(i=Tt,Fi(s.type)?(s=Fg,Fg=null,Tt=s):Tt=i):Tt=xn?Us(s.stateNode.nextSibling):null;return!0}function Ga(){Tt=xn=null,et=!1}function Em(){var s=Ii;return s!==null&&(es===null?es=s:es.push.apply(es,s),Ii=null),s}function Sc(s){Ii===null?Ii=[s]:Ii.push(s)}var Tm=z(null),Ka=null,Hr=null;function ki(s,i,o){W(Tm,i._currentValue),i._currentValue=o}function $r(s){s._currentValue=Tm.current,ne(Tm)}function Sm(s,i,o){for(;s!==null;){var u=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,u!==null&&(u.childLanes|=i)):u!==null&&(u.childLanes&i)!==i&&(u.childLanes|=i),s===o)break;s=s.return}}function Am(s,i,o,u){var m=s.child;for(m!==null&&(m.return=s);m!==null;){var p=m.dependencies;if(p!==null){var b=m.child;p=p.firstContext;e:for(;p!==null;){var T=p;p=m;for(var M=0;M<i.length;M++)if(T.context===i[M]){p.lanes|=o,T=p.alternate,T!==null&&(T.lanes|=o),Sm(p.return,o,s),u||(b=null);break e}p=T.next}}else if(m.tag===18){if(b=m.return,b===null)throw Error(r(341));b.lanes|=o,p=b.alternate,p!==null&&(p.lanes|=o),Sm(b,o,s),b=null}else b=m.child;if(b!==null)b.return=m;else for(b=m;b!==null;){if(b===s){b=null;break}if(m=b.sibling,m!==null){m.return=b.return,b=m;break}b=b.return}m=b}}function Jo(s,i,o,u){s=null;for(var m=i,p=!1;m!==null;){if(!p){if((m.flags&524288)!==0)p=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var b=m.alternate;if(b===null)throw Error(r(387));if(b=b.memoizedProps,b!==null){var T=m.type;hs(m.pendingProps.value,b.value)||(s!==null?s.push(T):s=[T])}}else if(m===Ie.current){if(b=m.alternate,b===null)throw Error(r(387));b.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(s!==null?s.push(Jc):s=[Jc])}m=m.return}s!==null&&Am(i,s,o,u),i.flags|=262144}function Sh(s){for(s=s.firstContext;s!==null;){if(!hs(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Qa(s){Ka=s,Hr=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function En(s){return o_(Ka,s)}function Ah(s,i){return Ka===null&&Qa(s),o_(s,i)}function o_(s,i){var o=i._currentValue;if(i={context:i,memoizedValue:o,next:null},Hr===null){if(s===null)throw Error(r(308));Hr=i,s.dependencies={lanes:0,firstContext:i},s.flags|=524288}else Hr=Hr.next=i;return o}var XS=typeof AbortController<"u"?AbortController:function(){var s=[],i=this.signal={aborted:!1,addEventListener:function(o,u){s.push(u)}};this.abort=function(){i.aborted=!0,s.forEach(function(o){return o()})}},WS=n.unstable_scheduleCallback,JS=n.unstable_NormalPriority,Jt={$$typeof:B,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Nm(){return{controller:new XS,data:new Map,refCount:0}}function Ac(s){s.refCount--,s.refCount===0&&WS(JS,function(){s.controller.abort()})}var Nc=null,Rm=0,Zo=0,el=null;function ZS(s,i){if(Nc===null){var o=Nc=[];Rm=0,Zo=jg(),el={status:"pending",value:void 0,then:function(u){o.push(u)}}}return Rm++,i.then(l_,l_),i}function l_(){if(--Rm===0&&Nc!==null){el!==null&&(el.status="fulfilled");var s=Nc;Nc=null,Zo=0,el=null;for(var i=0;i<s.length;i++)(0,s[i])()}}function eA(s,i){var o=[],u={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return s.then(function(){u.status="fulfilled",u.value=i;for(var m=0;m<o.length;m++)(0,o[m])(i)},function(m){for(u.status="rejected",u.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),u}var c_=V.S;V.S=function(s,i){Gv=bn(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&ZS(s,i),c_!==null&&c_(s,i)};var Ya=z(null);function Cm(){var s=Ya.current;return s!==null?s:bt.pooledCache}function Nh(s,i){i===null?W(Ya,Ya.current):W(Ya,i.pool)}function u_(){var s=Cm();return s===null?null:{parent:Jt._currentValue,pool:s}}var tl=Error(r(460)),Im=Error(r(474)),Rh=Error(r(542)),Ch={then:function(){}};function h_(s){return s=s.status,s==="fulfilled"||s==="rejected"}function d_(s,i,o){switch(o=s[o],o===void 0?s.push(i):o!==i&&(i.then(Gs,Gs),i=o),i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,m_(s),s;default:if(typeof i.status=="string")i.then(Gs,Gs);else{if(s=bt,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=i,s.status="pending",s.then(function(u){if(i.status==="pending"){var m=i;m.status="fulfilled",m.value=u}},function(u){if(i.status==="pending"){var m=i;m.status="rejected",m.reason=u}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw s=i.reason,m_(s),s}throw Wa=i,tl}}function Xa(s){try{var i=s._init;return i(s._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Wa=o,tl):o}}var Wa=null;function f_(){if(Wa===null)throw Error(r(459));var s=Wa;return Wa=null,s}function m_(s){if(s===tl||s===Rh)throw Error(r(483))}var nl=null,Rc=0;function Ih(s){var i=Rc;return Rc+=1,nl===null&&(nl=[]),d_(nl,s,i)}function Cc(s,i){i=i.props.ref,s.ref=i!==void 0?i:null}function jh(s,i){throw i.$$typeof===E?Error(r(525)):(s=Object.prototype.toString.call(i),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s)))}function g_(s){function i($,q){if(s){var Q=$.deletions;Q===null?($.deletions=[q],$.flags|=16):Q.push(q)}}function o($,q){if(!s)return null;for(;q!==null;)i($,q),q=q.sibling;return null}function u($){for(var q=new Map;$!==null;)$.key!==null?q.set($.key,$):q.set($.index,$),$=$.sibling;return q}function m($,q){return $=zr($,q),$.index=0,$.sibling=null,$}function p($,q,Q){return $.index=Q,s?(Q=$.alternate,Q!==null?(Q=Q.index,Q<q?($.flags|=67108866,q):Q):($.flags|=67108866,q)):($.flags|=1048576,q)}function b($){return s&&$.alternate===null&&($.flags|=67108866),$}function T($,q,Q,se){return q===null||q.tag!==6?(q=_m(Q,$.mode,se),q.return=$,q):(q=m(q,Q),q.return=$,q)}function M($,q,Q,se){var Ne=Q.type;return Ne===D?te($,q,Q.props.children,se,Q.key):q!==null&&(q.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===I&&Xa(Ne)===q.type)?(q=m(q,Q.props),Cc(q,Q),q.return=$,q):(q=Eh(Q.type,Q.key,Q.props,null,$.mode,se),Cc(q,Q),q.return=$,q)}function Y($,q,Q,se){return q===null||q.tag!==4||q.stateNode.containerInfo!==Q.containerInfo||q.stateNode.implementation!==Q.implementation?(q=vm(Q,$.mode,se),q.return=$,q):(q=m(q,Q.children||[]),q.return=$,q)}function te($,q,Q,se,Ne){return q===null||q.tag!==7?(q=Fa(Q,$.mode,se,Ne),q.return=$,q):(q=m(q,Q),q.return=$,q)}function ae($,q,Q){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return q=_m(""+q,$.mode,Q),q.return=$,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case S:return Q=Eh(q.type,q.key,q.props,null,$.mode,Q),Cc(Q,q),Q.return=$,Q;case j:return q=vm(q,$.mode,Q),q.return=$,q;case I:return q=Xa(q),ae($,q,Q)}if(xe(q)||H(q))return q=Fa(q,$.mode,Q,null),q.return=$,q;if(typeof q.then=="function")return ae($,Ih(q),Q);if(q.$$typeof===B)return ae($,Ah($,q),Q);jh($,q)}return null}function X($,q,Q,se){var Ne=q!==null?q.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Ne!==null?null:T($,q,""+Q,se);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case S:return Q.key===Ne?M($,q,Q,se):null;case j:return Q.key===Ne?Y($,q,Q,se):null;case I:return Q=Xa(Q),X($,q,Q,se)}if(xe(Q)||H(Q))return Ne!==null?null:te($,q,Q,se,null);if(typeof Q.then=="function")return X($,q,Ih(Q),se);if(Q.$$typeof===B)return X($,q,Ah($,Q),se);jh($,Q)}return null}function Z($,q,Q,se,Ne){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return $=$.get(Q)||null,T(q,$,""+se,Ne);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case S:return $=$.get(se.key===null?Q:se.key)||null,M(q,$,se,Ne);case j:return $=$.get(se.key===null?Q:se.key)||null,Y(q,$,se,Ne);case I:return se=Xa(se),Z($,q,Q,se,Ne)}if(xe(se)||H(se))return $=$.get(Q)||null,te(q,$,se,Ne,null);if(typeof se.then=="function")return Z($,q,Q,Ih(se),Ne);if(se.$$typeof===B)return Z($,q,Q,Ah(q,se),Ne);jh(q,se)}return null}function ve($,q,Q,se){for(var Ne=null,st=null,we=q,He=q=0,Qe=null;we!==null&&He<Q.length;He++){we.index>He?(Qe=we,we=null):Qe=we.sibling;var rt=X($,we,Q[He],se);if(rt===null){we===null&&(we=Qe);break}s&&we&&rt.alternate===null&&i($,we),q=p(rt,q,He),st===null?Ne=rt:st.sibling=rt,st=rt,we=Qe}if(He===Q.length)return o($,we),et&&qr($,He),Ne;if(we===null){for(;He<Q.length;He++)we=ae($,Q[He],se),we!==null&&(q=p(we,q,He),st===null?Ne=we:st.sibling=we,st=we);return et&&qr($,He),Ne}for(we=u(we);He<Q.length;He++)Qe=Z(we,$,He,Q[He],se),Qe!==null&&(s&&Qe.alternate!==null&&we.delete(Qe.key===null?He:Qe.key),q=p(Qe,q,He),st===null?Ne=Qe:st.sibling=Qe,st=Qe);return s&&we.forEach(function(Xi){return i($,Xi)}),et&&qr($,He),Ne}function Ce($,q,Q,se){if(Q==null)throw Error(r(151));for(var Ne=null,st=null,we=q,He=q=0,Qe=null,rt=Q.next();we!==null&&!rt.done;He++,rt=Q.next()){we.index>He?(Qe=we,we=null):Qe=we.sibling;var Xi=X($,we,rt.value,se);if(Xi===null){we===null&&(we=Qe);break}s&&we&&Xi.alternate===null&&i($,we),q=p(Xi,q,He),st===null?Ne=Xi:st.sibling=Xi,st=Xi,we=Qe}if(rt.done)return o($,we),et&&qr($,He),Ne;if(we===null){for(;!rt.done;He++,rt=Q.next())rt=ae($,rt.value,se),rt!==null&&(q=p(rt,q,He),st===null?Ne=rt:st.sibling=rt,st=rt);return et&&qr($,He),Ne}for(we=u(we);!rt.done;He++,rt=Q.next())rt=Z(we,$,He,rt.value,se),rt!==null&&(s&&rt.alternate!==null&&we.delete(rt.key===null?He:rt.key),q=p(rt,q,He),st===null?Ne=rt:st.sibling=rt,st=rt);return s&&we.forEach(function(hN){return i($,hN)}),et&&qr($,He),Ne}function _t($,q,Q,se){if(typeof Q=="object"&&Q!==null&&Q.type===D&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case S:e:{for(var Ne=Q.key;q!==null;){if(q.key===Ne){if(Ne=Q.type,Ne===D){if(q.tag===7){o($,q.sibling),se=m(q,Q.props.children),se.return=$,$=se;break e}}else if(q.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===I&&Xa(Ne)===q.type){o($,q.sibling),se=m(q,Q.props),Cc(se,Q),se.return=$,$=se;break e}o($,q);break}else i($,q);q=q.sibling}Q.type===D?(se=Fa(Q.props.children,$.mode,se,Q.key),se.return=$,$=se):(se=Eh(Q.type,Q.key,Q.props,null,$.mode,se),Cc(se,Q),se.return=$,$=se)}return b($);case j:e:{for(Ne=Q.key;q!==null;){if(q.key===Ne)if(q.tag===4&&q.stateNode.containerInfo===Q.containerInfo&&q.stateNode.implementation===Q.implementation){o($,q.sibling),se=m(q,Q.children||[]),se.return=$,$=se;break e}else{o($,q);break}else i($,q);q=q.sibling}se=vm(Q,$.mode,se),se.return=$,$=se}return b($);case I:return Q=Xa(Q),_t($,q,Q,se)}if(xe(Q))return ve($,q,Q,se);if(H(Q)){if(Ne=H(Q),typeof Ne!="function")throw Error(r(150));return Q=Ne.call(Q),Ce($,q,Q,se)}if(typeof Q.then=="function")return _t($,q,Ih(Q),se);if(Q.$$typeof===B)return _t($,q,Ah($,Q),se);jh($,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,q!==null&&q.tag===6?(o($,q.sibling),se=m(q,Q),se.return=$,$=se):(o($,q),se=_m(Q,$.mode,se),se.return=$,$=se),b($)):o($,q)}return function($,q,Q,se){try{Rc=0;var Ne=_t($,q,Q,se);return nl=null,Ne}catch(we){if(we===tl||we===Rh)throw we;var st=ds(29,we,null,$.mode);return st.lanes=se,st.return=$,st}finally{}}}var Ja=g_(!0),p_=g_(!1),Oi=!1;function jm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function km(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Di(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Mi(s,i,o){var u=s.updateQueue;if(u===null)return null;if(u=u.shared,(at&2)!==0){var m=u.pending;return m===null?i.next=i:(i.next=m.next,m.next=i),u.pending=i,i=xh(s),Zy(s,null,o),i}return wh(s,u,i,o),xh(s)}function Ic(s,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194048)!==0)){var u=i.lanes;u&=s.pendingLanes,o|=u,i.lanes=o,gi(s,o)}}function Om(s,i){var o=s.updateQueue,u=s.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var m=null,p=null;if(o=o.firstBaseUpdate,o!==null){do{var b={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};p===null?m=p=b:p=p.next=b,o=o.next}while(o!==null);p===null?m=p=i:p=p.next=i}else m=p=i;o={baseState:u.baseState,firstBaseUpdate:m,lastBaseUpdate:p,shared:u.shared,callbacks:u.callbacks},s.updateQueue=o;return}s=o.lastBaseUpdate,s===null?o.firstBaseUpdate=i:s.next=i,o.lastBaseUpdate=i}var Dm=!1;function jc(){if(Dm){var s=el;if(s!==null)throw s}}function kc(s,i,o,u){Dm=!1;var m=s.updateQueue;Oi=!1;var p=m.firstBaseUpdate,b=m.lastBaseUpdate,T=m.shared.pending;if(T!==null){m.shared.pending=null;var M=T,Y=M.next;M.next=null,b===null?p=Y:b.next=Y,b=M;var te=s.alternate;te!==null&&(te=te.updateQueue,T=te.lastBaseUpdate,T!==b&&(T===null?te.firstBaseUpdate=Y:T.next=Y,te.lastBaseUpdate=M))}if(p!==null){var ae=m.baseState;b=0,te=Y=M=null,T=p;do{var X=T.lane&-536870913,Z=X!==T.lane;if(Z?(Ke&X)===X:(u&X)===X){X!==0&&X===Zo&&(Dm=!0),te!==null&&(te=te.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});e:{var ve=s,Ce=T;X=i;var _t=o;switch(Ce.tag){case 1:if(ve=Ce.payload,typeof ve=="function"){ae=ve.call(_t,ae,X);break e}ae=ve;break e;case 3:ve.flags=ve.flags&-65537|128;case 0:if(ve=Ce.payload,X=typeof ve=="function"?ve.call(_t,ae,X):ve,X==null)break e;ae=w({},ae,X);break e;case 2:Oi=!0}}X=T.callback,X!==null&&(s.flags|=64,Z&&(s.flags|=8192),Z=m.callbacks,Z===null?m.callbacks=[X]:Z.push(X))}else Z={lane:X,tag:T.tag,payload:T.payload,callback:T.callback,next:null},te===null?(Y=te=Z,M=ae):te=te.next=Z,b|=X;if(T=T.next,T===null){if(T=m.shared.pending,T===null)break;Z=T,T=Z.next,Z.next=null,m.lastBaseUpdate=Z,m.shared.pending=null}}while(!0);te===null&&(M=ae),m.baseState=M,m.firstBaseUpdate=Y,m.lastBaseUpdate=te,p===null&&(m.shared.lanes=0),Bi|=b,s.lanes=b,s.memoizedState=ae}}function y_(s,i){if(typeof s!="function")throw Error(r(191,s));s.call(i)}function __(s,i){var o=s.callbacks;if(o!==null)for(s.callbacks=null,s=0;s<o.length;s++)y_(o[s],i)}var sl=z(null),kh=z(0);function v_(s,i){s=Zr,W(kh,s),W(sl,i),Zr=s|i.baseLanes}function Mm(){W(kh,Zr),W(sl,sl.current)}function Pm(){Zr=kh.current,ne(sl),ne(kh)}var fs=z(null),Vs=null;function Pi(s){var i=s.alternate;W(Kt,Kt.current&1),W(fs,s),Vs===null&&(i===null||sl.current!==null||i.memoizedState!==null)&&(Vs=s)}function Lm(s){W(Kt,Kt.current),W(fs,s),Vs===null&&(Vs=s)}function b_(s){s.tag===22?(W(Kt,Kt.current),W(fs,s),Vs===null&&(Vs=s)):Li()}function Li(){W(Kt,Kt.current),W(fs,fs.current)}function ms(s){ne(fs),Vs===s&&(Vs=null),ne(Kt)}var Kt=z(0);function Oh(s){for(var i=s;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Hg(o)||$g(o)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Fr=0,Be=null,pt=null,Zt=null,Dh=!1,rl=!1,Za=!1,Mh=0,Oc=0,il=null,tA=0;function Bt(){throw Error(r(321))}function Vm(s,i){if(i===null)return!1;for(var o=0;o<i.length&&o<s.length;o++)if(!hs(s[o],i[o]))return!1;return!0}function Um(s,i,o,u,m,p){return Fr=p,Be=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,V.H=s===null||s.memoizedState===null?sv:eg,Za=!1,p=o(u,m),Za=!1,rl&&(p=x_(i,o,u,m)),w_(s),p}function w_(s){V.H=Pc;var i=pt!==null&&pt.next!==null;if(Fr=0,Zt=pt=Be=null,Dh=!1,Oc=0,il=null,i)throw Error(r(300));s===null||en||(s=s.dependencies,s!==null&&Sh(s)&&(en=!0))}function x_(s,i,o,u){Be=s;var m=0;do{if(rl&&(il=null),Oc=0,rl=!1,25<=m)throw Error(r(301));if(m+=1,Zt=pt=null,s.updateQueue!=null){var p=s.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}V.H=rv,p=i(o,u)}while(rl);return p}function nA(){var s=V.H,i=s.useState()[0];return i=typeof i.then=="function"?Dc(i):i,s=s.useState()[0],(pt!==null?pt.memoizedState:null)!==s&&(Be.flags|=1024),i}function Bm(){var s=Mh!==0;return Mh=0,s}function zm(s,i,o){i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~o}function qm(s){if(Dh){for(s=s.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}Dh=!1}Fr=0,Zt=pt=Be=null,rl=!1,Oc=Mh=0,il=null}function $n(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zt===null?Be.memoizedState=Zt=s:Zt=Zt.next=s,Zt}function Qt(){if(pt===null){var s=Be.alternate;s=s!==null?s.memoizedState:null}else s=pt.next;var i=Zt===null?Be.memoizedState:Zt.next;if(i!==null)Zt=i,pt=s;else{if(s===null)throw Be.alternate===null?Error(r(467)):Error(r(310));pt=s,s={memoizedState:pt.memoizedState,baseState:pt.baseState,baseQueue:pt.baseQueue,queue:pt.queue,next:null},Zt===null?Be.memoizedState=Zt=s:Zt=Zt.next=s}return Zt}function Ph(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Dc(s){var i=Oc;return Oc+=1,il===null&&(il=[]),s=d_(il,s,i),i=Be,(Zt===null?i.memoizedState:Zt.next)===null&&(i=i.alternate,V.H=i===null||i.memoizedState===null?sv:eg),s}function Lh(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Dc(s);if(s.$$typeof===B)return En(s)}throw Error(r(438,String(s)))}function Hm(s){var i=null,o=Be.updateQueue;if(o!==null&&(i=o.memoCache),i==null){var u=Be.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(i={data:u.data.map(function(m){return m.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),o===null&&(o=Ph(),Be.updateQueue=o),o.memoCache=i,o=i.data[i.index],o===void 0)for(o=i.data[i.index]=Array(s),u=0;u<s;u++)o[u]=U;return i.index++,o}function Gr(s,i){return typeof i=="function"?i(s):i}function Vh(s){var i=Qt();return $m(i,pt,s)}function $m(s,i,o){var u=s.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=o;var m=s.baseQueue,p=u.pending;if(p!==null){if(m!==null){var b=m.next;m.next=p.next,p.next=b}i.baseQueue=m=p,u.pending=null}if(p=s.baseState,m===null)s.memoizedState=p;else{i=m.next;var T=b=null,M=null,Y=i,te=!1;do{var ae=Y.lane&-536870913;if(ae!==Y.lane?(Ke&ae)===ae:(Fr&ae)===ae){var X=Y.revertLane;if(X===0)M!==null&&(M=M.next={lane:0,revertLane:0,gesture:null,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null}),ae===Zo&&(te=!0);else if((Fr&X)===X){Y=Y.next,X===Zo&&(te=!0);continue}else ae={lane:0,revertLane:Y.revertLane,gesture:null,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},M===null?(T=M=ae,b=p):M=M.next=ae,Be.lanes|=X,Bi|=X;ae=Y.action,Za&&o(p,ae),p=Y.hasEagerState?Y.eagerState:o(p,ae)}else X={lane:ae,revertLane:Y.revertLane,gesture:Y.gesture,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},M===null?(T=M=X,b=p):M=M.next=X,Be.lanes|=ae,Bi|=ae;Y=Y.next}while(Y!==null&&Y!==i);if(M===null?b=p:M.next=T,!hs(p,s.memoizedState)&&(en=!0,te&&(o=el,o!==null)))throw o;s.memoizedState=p,s.baseState=b,s.baseQueue=M,u.lastRenderedState=p}return m===null&&(u.lanes=0),[s.memoizedState,u.dispatch]}function Fm(s){var i=Qt(),o=i.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=s;var u=o.dispatch,m=o.pending,p=i.memoizedState;if(m!==null){o.pending=null;var b=m=m.next;do p=s(p,b.action),b=b.next;while(b!==m);hs(p,i.memoizedState)||(en=!0),i.memoizedState=p,i.baseQueue===null&&(i.baseState=p),o.lastRenderedState=p}return[p,u]}function E_(s,i,o){var u=Be,m=Qt(),p=et;if(p){if(o===void 0)throw Error(r(407));o=o()}else o=i();var b=!hs((pt||m).memoizedState,o);if(b&&(m.memoizedState=o,en=!0),m=m.queue,Qm(A_.bind(null,u,m,s),[s]),m.getSnapshot!==i||b||Zt!==null&&Zt.memoizedState.tag&1){if(u.flags|=2048,al(9,{destroy:void 0},S_.bind(null,u,m,o,i),null),bt===null)throw Error(r(349));p||(Fr&127)!==0||T_(u,i,o)}return o}function T_(s,i,o){s.flags|=16384,s={getSnapshot:i,value:o},i=Be.updateQueue,i===null?(i=Ph(),Be.updateQueue=i,i.stores=[s]):(o=i.stores,o===null?i.stores=[s]:o.push(s))}function S_(s,i,o,u){i.value=o,i.getSnapshot=u,N_(i)&&R_(s)}function A_(s,i,o){return o(function(){N_(i)&&R_(s)})}function N_(s){var i=s.getSnapshot;s=s.value;try{var o=i();return!hs(s,o)}catch{return!0}}function R_(s){var i=$a(s,2);i!==null&&ts(i,s,2)}function Gm(s){var i=$n();if(typeof s=="function"){var o=s;if(s=o(),Za){Kn(!0);try{o()}finally{Kn(!1)}}}return i.memoizedState=i.baseState=s,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gr,lastRenderedState:s},i}function C_(s,i,o,u){return s.baseState=o,$m(s,pt,typeof u=="function"?u:Gr)}function sA(s,i,o,u,m){if(zh(s))throw Error(r(485));if(s=i.action,s!==null){var p={payload:m,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){p.listeners.push(b)}};V.T!==null?o(!0):p.isTransition=!1,u(p),o=i.pending,o===null?(p.next=i.pending=p,I_(i,p)):(p.next=o.next,i.pending=o.next=p)}}function I_(s,i){var o=i.action,u=i.payload,m=s.state;if(i.isTransition){var p=V.T,b={};V.T=b;try{var T=o(m,u),M=V.S;M!==null&&M(b,T),j_(s,i,T)}catch(Y){Km(s,i,Y)}finally{p!==null&&b.types!==null&&(p.types=b.types),V.T=p}}else try{p=o(m,u),j_(s,i,p)}catch(Y){Km(s,i,Y)}}function j_(s,i,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){k_(s,i,u)},function(u){return Km(s,i,u)}):k_(s,i,o)}function k_(s,i,o){i.status="fulfilled",i.value=o,O_(i),s.state=o,i=s.pending,i!==null&&(o=i.next,o===i?s.pending=null:(o=o.next,i.next=o,I_(s,o)))}function Km(s,i,o){var u=s.pending;if(s.pending=null,u!==null){u=u.next;do i.status="rejected",i.reason=o,O_(i),i=i.next;while(i!==u)}s.action=null}function O_(s){s=s.listeners;for(var i=0;i<s.length;i++)(0,s[i])()}function D_(s,i){return i}function M_(s,i){if(et){var o=bt.formState;if(o!==null){e:{var u=Be;if(et){if(Tt){t:{for(var m=Tt,p=Ls;m.nodeType!==8;){if(!p){m=null;break t}if(m=Us(m.nextSibling),m===null){m=null;break t}}p=m.data,m=p==="F!"||p==="F"?m:null}if(m){Tt=Us(m.nextSibling),u=m.data==="F!";break e}}ji(u)}u=!1}u&&(i=o[0])}}return o=$n(),o.memoizedState=o.baseState=i,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:D_,lastRenderedState:i},o.queue=u,o=ev.bind(null,Be,u),u.dispatch=o,u=Gm(!1),p=Zm.bind(null,Be,!1,u.queue),u=$n(),m={state:i,dispatch:null,action:s,pending:null},u.queue=m,o=sA.bind(null,Be,m,p,o),m.dispatch=o,u.memoizedState=s,[i,o,!1]}function P_(s){var i=Qt();return L_(i,pt,s)}function L_(s,i,o){if(i=$m(s,i,D_)[0],s=Vh(Gr)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var u=Dc(i)}catch(b){throw b===tl?Rh:b}else u=i;i=Qt();var m=i.queue,p=m.dispatch;return o!==i.memoizedState&&(Be.flags|=2048,al(9,{destroy:void 0},rA.bind(null,m,o),null)),[u,p,s]}function rA(s,i){s.action=i}function V_(s){var i=Qt(),o=pt;if(o!==null)return L_(i,o,s);Qt(),i=i.memoizedState,o=Qt();var u=o.queue.dispatch;return o.memoizedState=s,[i,u,!1]}function al(s,i,o,u){return s={tag:s,create:o,deps:u,inst:i,next:null},i=Be.updateQueue,i===null&&(i=Ph(),Be.updateQueue=i),o=i.lastEffect,o===null?i.lastEffect=s.next=s:(u=o.next,o.next=s,s.next=u,i.lastEffect=s),s}function U_(){return Qt().memoizedState}function Uh(s,i,o,u){var m=$n();Be.flags|=s,m.memoizedState=al(1|i,{destroy:void 0},o,u===void 0?null:u)}function Bh(s,i,o,u){var m=Qt();u=u===void 0?null:u;var p=m.memoizedState.inst;pt!==null&&u!==null&&Vm(u,pt.memoizedState.deps)?m.memoizedState=al(i,p,o,u):(Be.flags|=s,m.memoizedState=al(1|i,p,o,u))}function B_(s,i){Uh(8390656,8,s,i)}function Qm(s,i){Bh(2048,8,s,i)}function iA(s){Be.flags|=4;var i=Be.updateQueue;if(i===null)i=Ph(),Be.updateQueue=i,i.events=[s];else{var o=i.events;o===null?i.events=[s]:o.push(s)}}function z_(s){var i=Qt().memoizedState;return iA({ref:i,nextImpl:s}),function(){if((at&2)!==0)throw Error(r(440));return i.impl.apply(void 0,arguments)}}function q_(s,i){return Bh(4,2,s,i)}function H_(s,i){return Bh(4,4,s,i)}function $_(s,i){if(typeof i=="function"){s=s();var o=i(s);return function(){typeof o=="function"?o():i(null)}}if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function F_(s,i,o){o=o!=null?o.concat([s]):null,Bh(4,4,$_.bind(null,i,s),o)}function Ym(){}function G_(s,i){var o=Qt();i=i===void 0?null:i;var u=o.memoizedState;return i!==null&&Vm(i,u[1])?u[0]:(o.memoizedState=[s,i],s)}function K_(s,i){var o=Qt();i=i===void 0?null:i;var u=o.memoizedState;if(i!==null&&Vm(i,u[1]))return u[0];if(u=s(),Za){Kn(!0);try{s()}finally{Kn(!1)}}return o.memoizedState=[u,i],u}function Xm(s,i,o){return o===void 0||(Fr&1073741824)!==0&&(Ke&261930)===0?s.memoizedState=i:(s.memoizedState=o,s=Qv(),Be.lanes|=s,Bi|=s,o)}function Q_(s,i,o,u){return hs(o,i)?o:sl.current!==null?(s=Xm(s,o,u),hs(s,i)||(en=!0),s):(Fr&42)===0||(Fr&1073741824)!==0&&(Ke&261930)===0?(en=!0,s.memoizedState=o):(s=Qv(),Be.lanes|=s,Bi|=s,i)}function Y_(s,i,o,u,m){var p=le.p;le.p=p!==0&&8>p?p:8;var b=V.T,T={};V.T=T,Zm(s,!1,i,o);try{var M=m(),Y=V.S;if(Y!==null&&Y(T,M),M!==null&&typeof M=="object"&&typeof M.then=="function"){var te=eA(M,u);Mc(s,i,te,ys(s))}else Mc(s,i,u,ys(s))}catch(ae){Mc(s,i,{then:function(){},status:"rejected",reason:ae},ys())}finally{le.p=p,b!==null&&T.types!==null&&(b.types=T.types),V.T=b}}function aA(){}function Wm(s,i,o,u){if(s.tag!==5)throw Error(r(476));var m=X_(s).queue;Y_(s,m,i,_e,o===null?aA:function(){return W_(s),o(u)})}function X_(s){var i=s.memoizedState;if(i!==null)return i;i={memoizedState:_e,baseState:_e,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gr,lastRenderedState:_e},next:null};var o={};return i.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gr,lastRenderedState:o},next:null},s.memoizedState=i,s=s.alternate,s!==null&&(s.memoizedState=i),i}function W_(s){var i=X_(s);i.next===null&&(i=s.alternate.memoizedState),Mc(s,i.next.queue,{},ys())}function Jm(){return En(Jc)}function J_(){return Qt().memoizedState}function Z_(){return Qt().memoizedState}function oA(s){for(var i=s.return;i!==null;){switch(i.tag){case 24:case 3:var o=ys();s=Di(o);var u=Mi(i,s,o);u!==null&&(ts(u,i,o),Ic(u,i,o)),i={cache:Nm()},s.payload=i;return}i=i.return}}function lA(s,i,o){var u=ys();o={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},zh(s)?tv(i,o):(o=pm(s,i,o,u),o!==null&&(ts(o,s,u),nv(o,i,u)))}function ev(s,i,o){var u=ys();Mc(s,i,o,u)}function Mc(s,i,o,u){var m={lane:u,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(zh(s))tv(i,m);else{var p=s.alternate;if(s.lanes===0&&(p===null||p.lanes===0)&&(p=i.lastRenderedReducer,p!==null))try{var b=i.lastRenderedState,T=p(b,o);if(m.hasEagerState=!0,m.eagerState=T,hs(T,b))return wh(s,i,m,0),bt===null&&bh(),!1}catch{}finally{}if(o=pm(s,i,m,u),o!==null)return ts(o,s,u),nv(o,i,u),!0}return!1}function Zm(s,i,o,u){if(u={lane:2,revertLane:jg(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},zh(s)){if(i)throw Error(r(479))}else i=pm(s,o,u,2),i!==null&&ts(i,s,2)}function zh(s){var i=s.alternate;return s===Be||i!==null&&i===Be}function tv(s,i){rl=Dh=!0;var o=s.pending;o===null?i.next=i:(i.next=o.next,o.next=i),s.pending=i}function nv(s,i,o){if((o&4194048)!==0){var u=i.lanes;u&=s.pendingLanes,o|=u,i.lanes=o,gi(s,o)}}var Pc={readContext:En,use:Lh,useCallback:Bt,useContext:Bt,useEffect:Bt,useImperativeHandle:Bt,useLayoutEffect:Bt,useInsertionEffect:Bt,useMemo:Bt,useReducer:Bt,useRef:Bt,useState:Bt,useDebugValue:Bt,useDeferredValue:Bt,useTransition:Bt,useSyncExternalStore:Bt,useId:Bt,useHostTransitionStatus:Bt,useFormState:Bt,useActionState:Bt,useOptimistic:Bt,useMemoCache:Bt,useCacheRefresh:Bt};Pc.useEffectEvent=Bt;var sv={readContext:En,use:Lh,useCallback:function(s,i){return $n().memoizedState=[s,i===void 0?null:i],s},useContext:En,useEffect:B_,useImperativeHandle:function(s,i,o){o=o!=null?o.concat([s]):null,Uh(4194308,4,$_.bind(null,i,s),o)},useLayoutEffect:function(s,i){return Uh(4194308,4,s,i)},useInsertionEffect:function(s,i){Uh(4,2,s,i)},useMemo:function(s,i){var o=$n();i=i===void 0?null:i;var u=s();if(Za){Kn(!0);try{s()}finally{Kn(!1)}}return o.memoizedState=[u,i],u},useReducer:function(s,i,o){var u=$n();if(o!==void 0){var m=o(i);if(Za){Kn(!0);try{o(i)}finally{Kn(!1)}}}else m=i;return u.memoizedState=u.baseState=m,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:m},u.queue=s,s=s.dispatch=lA.bind(null,Be,s),[u.memoizedState,s]},useRef:function(s){var i=$n();return s={current:s},i.memoizedState=s},useState:function(s){s=Gm(s);var i=s.queue,o=ev.bind(null,Be,i);return i.dispatch=o,[s.memoizedState,o]},useDebugValue:Ym,useDeferredValue:function(s,i){var o=$n();return Xm(o,s,i)},useTransition:function(){var s=Gm(!1);return s=Y_.bind(null,Be,s.queue,!0,!1),$n().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,i,o){var u=Be,m=$n();if(et){if(o===void 0)throw Error(r(407));o=o()}else{if(o=i(),bt===null)throw Error(r(349));(Ke&127)!==0||T_(u,i,o)}m.memoizedState=o;var p={value:o,getSnapshot:i};return m.queue=p,B_(A_.bind(null,u,p,s),[s]),u.flags|=2048,al(9,{destroy:void 0},S_.bind(null,u,p,o,i),null),o},useId:function(){var s=$n(),i=bt.identifierPrefix;if(et){var o=Er,u=xr;o=(u&~(1<<32-At(u)-1)).toString(32)+o,i="_"+i+"R_"+o,o=Mh++,0<o&&(i+="H"+o.toString(32)),i+="_"}else o=tA++,i="_"+i+"r_"+o.toString(32)+"_";return s.memoizedState=i},useHostTransitionStatus:Jm,useFormState:M_,useActionState:M_,useOptimistic:function(s){var i=$n();i.memoizedState=i.baseState=s;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=o,i=Zm.bind(null,Be,!0,o),o.dispatch=i,[s,i]},useMemoCache:Hm,useCacheRefresh:function(){return $n().memoizedState=oA.bind(null,Be)},useEffectEvent:function(s){var i=$n(),o={impl:s};return i.memoizedState=o,function(){if((at&2)!==0)throw Error(r(440));return o.impl.apply(void 0,arguments)}}},eg={readContext:En,use:Lh,useCallback:G_,useContext:En,useEffect:Qm,useImperativeHandle:F_,useInsertionEffect:q_,useLayoutEffect:H_,useMemo:K_,useReducer:Vh,useRef:U_,useState:function(){return Vh(Gr)},useDebugValue:Ym,useDeferredValue:function(s,i){var o=Qt();return Q_(o,pt.memoizedState,s,i)},useTransition:function(){var s=Vh(Gr)[0],i=Qt().memoizedState;return[typeof s=="boolean"?s:Dc(s),i]},useSyncExternalStore:E_,useId:J_,useHostTransitionStatus:Jm,useFormState:P_,useActionState:P_,useOptimistic:function(s,i){var o=Qt();return C_(o,pt,s,i)},useMemoCache:Hm,useCacheRefresh:Z_};eg.useEffectEvent=z_;var rv={readContext:En,use:Lh,useCallback:G_,useContext:En,useEffect:Qm,useImperativeHandle:F_,useInsertionEffect:q_,useLayoutEffect:H_,useMemo:K_,useReducer:Fm,useRef:U_,useState:function(){return Fm(Gr)},useDebugValue:Ym,useDeferredValue:function(s,i){var o=Qt();return pt===null?Xm(o,s,i):Q_(o,pt.memoizedState,s,i)},useTransition:function(){var s=Fm(Gr)[0],i=Qt().memoizedState;return[typeof s=="boolean"?s:Dc(s),i]},useSyncExternalStore:E_,useId:J_,useHostTransitionStatus:Jm,useFormState:V_,useActionState:V_,useOptimistic:function(s,i){var o=Qt();return pt!==null?C_(o,pt,s,i):(o.baseState=s,[s,o.queue.dispatch])},useMemoCache:Hm,useCacheRefresh:Z_};rv.useEffectEvent=z_;function tg(s,i,o,u){i=s.memoizedState,o=o(u,i),o=o==null?i:w({},i,o),s.memoizedState=o,s.lanes===0&&(s.updateQueue.baseState=o)}var ng={enqueueSetState:function(s,i,o){s=s._reactInternals;var u=ys(),m=Di(u);m.payload=i,o!=null&&(m.callback=o),i=Mi(s,m,u),i!==null&&(ts(i,s,u),Ic(i,s,u))},enqueueReplaceState:function(s,i,o){s=s._reactInternals;var u=ys(),m=Di(u);m.tag=1,m.payload=i,o!=null&&(m.callback=o),i=Mi(s,m,u),i!==null&&(ts(i,s,u),Ic(i,s,u))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var o=ys(),u=Di(o);u.tag=2,i!=null&&(u.callback=i),i=Mi(s,u,o),i!==null&&(ts(i,s,o),Ic(i,s,o))}};function iv(s,i,o,u,m,p,b){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(u,p,b):i.prototype&&i.prototype.isPureReactComponent?!xc(o,u)||!xc(m,p):!0}function av(s,i,o,u){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,u),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,u),i.state!==s&&ng.enqueueReplaceState(i,i.state,null)}function eo(s,i){var o=i;if("ref"in i){o={};for(var u in i)u!=="ref"&&(o[u]=i[u])}if(s=s.defaultProps){o===i&&(o=w({},o));for(var m in s)o[m]===void 0&&(o[m]=s[m])}return o}function ov(s){vh(s)}function lv(s){console.error(s)}function cv(s){vh(s)}function qh(s,i){try{var o=s.onUncaughtError;o(i.value,{componentStack:i.stack})}catch(u){setTimeout(function(){throw u})}}function uv(s,i,o){try{var u=s.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function sg(s,i,o){return o=Di(o),o.tag=3,o.payload={element:null},o.callback=function(){qh(s,i)},o}function hv(s){return s=Di(s),s.tag=3,s}function dv(s,i,o,u){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var p=u.value;s.payload=function(){return m(p)},s.callback=function(){uv(i,o,u)}}var b=o.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(s.callback=function(){uv(i,o,u),typeof m!="function"&&(zi===null?zi=new Set([this]):zi.add(this));var T=u.stack;this.componentDidCatch(u.value,{componentStack:T!==null?T:""})})}function cA(s,i,o,u,m){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(i=o.alternate,i!==null&&Jo(i,o,m,!0),o=fs.current,o!==null){switch(o.tag){case 31:case 13:return Vs===null?ed():o.alternate===null&&zt===0&&(zt=3),o.flags&=-257,o.flags|=65536,o.lanes=m,u===Ch?o.flags|=16384:(i=o.updateQueue,i===null?o.updateQueue=new Set([u]):i.add(u),Rg(s,u,m)),!1;case 22:return o.flags|=65536,u===Ch?o.flags|=16384:(i=o.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=i):(o=i.retryQueue,o===null?i.retryQueue=new Set([u]):o.add(u)),Rg(s,u,m)),!1}throw Error(r(435,o.tag))}return Rg(s,u,m),ed(),!1}if(et)return i=fs.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=m,u!==xm&&(s=Error(r(422),{cause:u}),Sc(Ds(s,o)))):(u!==xm&&(i=Error(r(423),{cause:u}),Sc(Ds(i,o))),s=s.current.alternate,s.flags|=65536,m&=-m,s.lanes|=m,u=Ds(u,o),m=sg(s.stateNode,u,m),Om(s,m),zt!==4&&(zt=2)),!1;var p=Error(r(520),{cause:u});if(p=Ds(p,o),$c===null?$c=[p]:$c.push(p),zt!==4&&(zt=2),i===null)return!0;u=Ds(u,o),o=i;do{switch(o.tag){case 3:return o.flags|=65536,s=m&-m,o.lanes|=s,s=sg(o.stateNode,u,s),Om(o,s),!1;case 1:if(i=o.type,p=o.stateNode,(o.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(zi===null||!zi.has(p))))return o.flags|=65536,m&=-m,o.lanes|=m,m=hv(m),dv(m,s,o,u),Om(o,m),!1}o=o.return}while(o!==null);return!1}var rg=Error(r(461)),en=!1;function Tn(s,i,o,u){i.child=s===null?p_(i,null,o,u):Ja(i,s.child,o,u)}function fv(s,i,o,u,m){o=o.render;var p=i.ref;if("ref"in u){var b={};for(var T in u)T!=="ref"&&(b[T]=u[T])}else b=u;return Qa(i),u=Um(s,i,o,b,p,m),T=Bm(),s!==null&&!en?(zm(s,i,m),Kr(s,i,m)):(et&&T&&bm(i),i.flags|=1,Tn(s,i,u,m),i.child)}function mv(s,i,o,u,m){if(s===null){var p=o.type;return typeof p=="function"&&!ym(p)&&p.defaultProps===void 0&&o.compare===null?(i.tag=15,i.type=p,gv(s,i,p,u,m)):(s=Eh(o.type,null,u,i,i.mode,m),s.ref=i.ref,s.return=i,i.child=s)}if(p=s.child,!dg(s,m)){var b=p.memoizedProps;if(o=o.compare,o=o!==null?o:xc,o(b,u)&&s.ref===i.ref)return Kr(s,i,m)}return i.flags|=1,s=zr(p,u),s.ref=i.ref,s.return=i,i.child=s}function gv(s,i,o,u,m){if(s!==null){var p=s.memoizedProps;if(xc(p,u)&&s.ref===i.ref)if(en=!1,i.pendingProps=u=p,dg(s,m))(s.flags&131072)!==0&&(en=!0);else return i.lanes=s.lanes,Kr(s,i,m)}return ig(s,i,o,u,m)}function pv(s,i,o,u){var m=u.children,p=s!==null?s.memoizedState:null;if(s===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((i.flags&128)!==0){if(p=p!==null?p.baseLanes|o:o,s!==null){for(u=i.child=s.child,m=0;u!==null;)m=m|u.lanes|u.childLanes,u=u.sibling;u=m&~p}else u=0,i.child=null;return yv(s,i,p,o,u)}if((o&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},s!==null&&Nh(i,p!==null?p.cachePool:null),p!==null?v_(i,p):Mm(),b_(i);else return u=i.lanes=536870912,yv(s,i,p!==null?p.baseLanes|o:o,o,u)}else p!==null?(Nh(i,p.cachePool),v_(i,p),Li(),i.memoizedState=null):(s!==null&&Nh(i,null),Mm(),Li());return Tn(s,i,m,o),i.child}function Lc(s,i){return s!==null&&s.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function yv(s,i,o,u,m){var p=Cm();return p=p===null?null:{parent:Jt._currentValue,pool:p},i.memoizedState={baseLanes:o,cachePool:p},s!==null&&Nh(i,null),Mm(),b_(i),s!==null&&Jo(s,i,u,!0),i.childLanes=m,null}function Hh(s,i){return i=Fh({mode:i.mode,children:i.children},s.mode),i.ref=s.ref,s.child=i,i.return=s,i}function _v(s,i,o){return Ja(i,s.child,null,o),s=Hh(i,i.pendingProps),s.flags|=2,ms(i),i.memoizedState=null,s}function uA(s,i,o){var u=i.pendingProps,m=(i.flags&128)!==0;if(i.flags&=-129,s===null){if(et){if(u.mode==="hidden")return s=Hh(i,u),i.lanes=536870912,Lc(null,s);if(Lm(i),(s=Tt)?(s=Ib(s,Ls),s=s!==null&&s.data==="&"?s:null,s!==null&&(i.memoizedState={dehydrated:s,treeContext:Ci!==null?{id:xr,overflow:Er}:null,retryLane:536870912,hydrationErrors:null},o=t_(s),o.return=i,i.child=o,xn=i,Tt=null)):s=null,s===null)throw ji(i);return i.lanes=536870912,null}return Hh(i,u)}var p=s.memoizedState;if(p!==null){var b=p.dehydrated;if(Lm(i),m)if(i.flags&256)i.flags&=-257,i=_v(s,i,o);else if(i.memoizedState!==null)i.child=s.child,i.flags|=128,i=null;else throw Error(r(558));else if(en||Jo(s,i,o,!1),m=(o&s.childLanes)!==0,en||m){if(u=bt,u!==null&&(b=pi(u,o),b!==0&&b!==p.retryLane))throw p.retryLane=b,$a(s,b),ts(u,s,b),rg;ed(),i=_v(s,i,o)}else s=p.treeContext,Tt=Us(b.nextSibling),xn=i,et=!0,Ii=null,Ls=!1,s!==null&&r_(i,s),i=Hh(i,u),i.flags|=4096;return i}return s=zr(s.child,{mode:u.mode,children:u.children}),s.ref=i.ref,i.child=s,s.return=i,s}function $h(s,i){var o=i.ref;if(o===null)s!==null&&s.ref!==null&&(i.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(r(284));(s===null||s.ref!==o)&&(i.flags|=4194816)}}function ig(s,i,o,u,m){return Qa(i),o=Um(s,i,o,u,void 0,m),u=Bm(),s!==null&&!en?(zm(s,i,m),Kr(s,i,m)):(et&&u&&bm(i),i.flags|=1,Tn(s,i,o,m),i.child)}function vv(s,i,o,u,m,p){return Qa(i),i.updateQueue=null,o=x_(i,u,o,m),w_(s),u=Bm(),s!==null&&!en?(zm(s,i,p),Kr(s,i,p)):(et&&u&&bm(i),i.flags|=1,Tn(s,i,o,p),i.child)}function bv(s,i,o,u,m){if(Qa(i),i.stateNode===null){var p=Qo,b=o.contextType;typeof b=="object"&&b!==null&&(p=En(b)),p=new o(u,p),i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=ng,i.stateNode=p,p._reactInternals=i,p=i.stateNode,p.props=u,p.state=i.memoizedState,p.refs={},jm(i),b=o.contextType,p.context=typeof b=="object"&&b!==null?En(b):Qo,p.state=i.memoizedState,b=o.getDerivedStateFromProps,typeof b=="function"&&(tg(i,o,b,u),p.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(b=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),b!==p.state&&ng.enqueueReplaceState(p,p.state,null),kc(i,u,p,m),jc(),p.state=i.memoizedState),typeof p.componentDidMount=="function"&&(i.flags|=4194308),u=!0}else if(s===null){p=i.stateNode;var T=i.memoizedProps,M=eo(o,T);p.props=M;var Y=p.context,te=o.contextType;b=Qo,typeof te=="object"&&te!==null&&(b=En(te));var ae=o.getDerivedStateFromProps;te=typeof ae=="function"||typeof p.getSnapshotBeforeUpdate=="function",T=i.pendingProps!==T,te||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(T||Y!==b)&&av(i,p,u,b),Oi=!1;var X=i.memoizedState;p.state=X,kc(i,u,p,m),jc(),Y=i.memoizedState,T||X!==Y||Oi?(typeof ae=="function"&&(tg(i,o,ae,u),Y=i.memoizedState),(M=Oi||iv(i,o,M,u,X,Y,b))?(te||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(i.flags|=4194308)):(typeof p.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=u,i.memoizedState=Y),p.props=u,p.state=Y,p.context=b,u=M):(typeof p.componentDidMount=="function"&&(i.flags|=4194308),u=!1)}else{p=i.stateNode,km(s,i),b=i.memoizedProps,te=eo(o,b),p.props=te,ae=i.pendingProps,X=p.context,Y=o.contextType,M=Qo,typeof Y=="object"&&Y!==null&&(M=En(Y)),T=o.getDerivedStateFromProps,(Y=typeof T=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(b!==ae||X!==M)&&av(i,p,u,M),Oi=!1,X=i.memoizedState,p.state=X,kc(i,u,p,m),jc();var Z=i.memoizedState;b!==ae||X!==Z||Oi||s!==null&&s.dependencies!==null&&Sh(s.dependencies)?(typeof T=="function"&&(tg(i,o,T,u),Z=i.memoizedState),(te=Oi||iv(i,o,te,u,X,Z,M)||s!==null&&s.dependencies!==null&&Sh(s.dependencies))?(Y||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(u,Z,M),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(u,Z,M)),typeof p.componentDidUpdate=="function"&&(i.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof p.componentDidUpdate!="function"||b===s.memoizedProps&&X===s.memoizedState||(i.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||b===s.memoizedProps&&X===s.memoizedState||(i.flags|=1024),i.memoizedProps=u,i.memoizedState=Z),p.props=u,p.state=Z,p.context=M,u=te):(typeof p.componentDidUpdate!="function"||b===s.memoizedProps&&X===s.memoizedState||(i.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||b===s.memoizedProps&&X===s.memoizedState||(i.flags|=1024),u=!1)}return p=u,$h(s,i),u=(i.flags&128)!==0,p||u?(p=i.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:p.render(),i.flags|=1,s!==null&&u?(i.child=Ja(i,s.child,null,m),i.child=Ja(i,null,o,m)):Tn(s,i,o,m),i.memoizedState=p.state,s=i.child):s=Kr(s,i,m),s}function wv(s,i,o,u){return Ga(),i.flags|=256,Tn(s,i,o,u),i.child}var ag={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function og(s){return{baseLanes:s,cachePool:u_()}}function lg(s,i,o){return s=s!==null?s.childLanes&~o:0,i&&(s|=ps),s}function xv(s,i,o){var u=i.pendingProps,m=!1,p=(i.flags&128)!==0,b;if((b=p)||(b=s!==null&&s.memoizedState===null?!1:(Kt.current&2)!==0),b&&(m=!0,i.flags&=-129),b=(i.flags&32)!==0,i.flags&=-33,s===null){if(et){if(m?Pi(i):Li(),(s=Tt)?(s=Ib(s,Ls),s=s!==null&&s.data!=="&"?s:null,s!==null&&(i.memoizedState={dehydrated:s,treeContext:Ci!==null?{id:xr,overflow:Er}:null,retryLane:536870912,hydrationErrors:null},o=t_(s),o.return=i,i.child=o,xn=i,Tt=null)):s=null,s===null)throw ji(i);return $g(s)?i.lanes=32:i.lanes=536870912,null}var T=u.children;return u=u.fallback,m?(Li(),m=i.mode,T=Fh({mode:"hidden",children:T},m),u=Fa(u,m,o,null),T.return=i,u.return=i,T.sibling=u,i.child=T,u=i.child,u.memoizedState=og(o),u.childLanes=lg(s,b,o),i.memoizedState=ag,Lc(null,u)):(Pi(i),cg(i,T))}var M=s.memoizedState;if(M!==null&&(T=M.dehydrated,T!==null)){if(p)i.flags&256?(Pi(i),i.flags&=-257,i=ug(s,i,o)):i.memoizedState!==null?(Li(),i.child=s.child,i.flags|=128,i=null):(Li(),T=u.fallback,m=i.mode,u=Fh({mode:"visible",children:u.children},m),T=Fa(T,m,o,null),T.flags|=2,u.return=i,T.return=i,u.sibling=T,i.child=u,Ja(i,s.child,null,o),u=i.child,u.memoizedState=og(o),u.childLanes=lg(s,b,o),i.memoizedState=ag,i=Lc(null,u));else if(Pi(i),$g(T)){if(b=T.nextSibling&&T.nextSibling.dataset,b)var Y=b.dgst;b=Y,u=Error(r(419)),u.stack="",u.digest=b,Sc({value:u,source:null,stack:null}),i=ug(s,i,o)}else if(en||Jo(s,i,o,!1),b=(o&s.childLanes)!==0,en||b){if(b=bt,b!==null&&(u=pi(b,o),u!==0&&u!==M.retryLane))throw M.retryLane=u,$a(s,u),ts(b,s,u),rg;Hg(T)||ed(),i=ug(s,i,o)}else Hg(T)?(i.flags|=192,i.child=s.child,i=null):(s=M.treeContext,Tt=Us(T.nextSibling),xn=i,et=!0,Ii=null,Ls=!1,s!==null&&r_(i,s),i=cg(i,u.children),i.flags|=4096);return i}return m?(Li(),T=u.fallback,m=i.mode,M=s.child,Y=M.sibling,u=zr(M,{mode:"hidden",children:u.children}),u.subtreeFlags=M.subtreeFlags&65011712,Y!==null?T=zr(Y,T):(T=Fa(T,m,o,null),T.flags|=2),T.return=i,u.return=i,u.sibling=T,i.child=u,Lc(null,u),u=i.child,T=s.child.memoizedState,T===null?T=og(o):(m=T.cachePool,m!==null?(M=Jt._currentValue,m=m.parent!==M?{parent:M,pool:M}:m):m=u_(),T={baseLanes:T.baseLanes|o,cachePool:m}),u.memoizedState=T,u.childLanes=lg(s,b,o),i.memoizedState=ag,Lc(s.child,u)):(Pi(i),o=s.child,s=o.sibling,o=zr(o,{mode:"visible",children:u.children}),o.return=i,o.sibling=null,s!==null&&(b=i.deletions,b===null?(i.deletions=[s],i.flags|=16):b.push(s)),i.child=o,i.memoizedState=null,o)}function cg(s,i){return i=Fh({mode:"visible",children:i},s.mode),i.return=s,s.child=i}function Fh(s,i){return s=ds(22,s,null,i),s.lanes=0,s}function ug(s,i,o){return Ja(i,s.child,null,o),s=cg(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function Ev(s,i,o){s.lanes|=i;var u=s.alternate;u!==null&&(u.lanes|=i),Sm(s.return,i,o)}function hg(s,i,o,u,m,p){var b=s.memoizedState;b===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:m,treeForkCount:p}:(b.isBackwards=i,b.rendering=null,b.renderingStartTime=0,b.last=u,b.tail=o,b.tailMode=m,b.treeForkCount=p)}function Tv(s,i,o){var u=i.pendingProps,m=u.revealOrder,p=u.tail;u=u.children;var b=Kt.current,T=(b&2)!==0;if(T?(b=b&1|2,i.flags|=128):b&=1,W(Kt,b),Tn(s,i,u,o),u=et?Tc:0,!T&&s!==null&&(s.flags&128)!==0)e:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Ev(s,o,i);else if(s.tag===19)Ev(s,o,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(m){case"forwards":for(o=i.child,m=null;o!==null;)s=o.alternate,s!==null&&Oh(s)===null&&(m=o),o=o.sibling;o=m,o===null?(m=i.child,i.child=null):(m=o.sibling,o.sibling=null),hg(i,!1,m,o,p,u);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=i.child,i.child=null;m!==null;){if(s=m.alternate,s!==null&&Oh(s)===null){i.child=m;break}s=m.sibling,m.sibling=o,o=m,m=s}hg(i,!0,o,null,p,u);break;case"together":hg(i,!1,null,null,void 0,u);break;default:i.memoizedState=null}return i.child}function Kr(s,i,o){if(s!==null&&(i.dependencies=s.dependencies),Bi|=i.lanes,(o&i.childLanes)===0)if(s!==null){if(Jo(s,i,o,!1),(o&i.childLanes)===0)return null}else return null;if(s!==null&&i.child!==s.child)throw Error(r(153));if(i.child!==null){for(s=i.child,o=zr(s,s.pendingProps),i.child=o,o.return=i;s.sibling!==null;)s=s.sibling,o=o.sibling=zr(s,s.pendingProps),o.return=i;o.sibling=null}return i.child}function dg(s,i){return(s.lanes&i)!==0?!0:(s=s.dependencies,!!(s!==null&&Sh(s)))}function hA(s,i,o){switch(i.tag){case 3:Je(i,i.stateNode.containerInfo),ki(i,Jt,s.memoizedState.cache),Ga();break;case 27:case 5:Me(i);break;case 4:Je(i,i.stateNode.containerInfo);break;case 10:ki(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,Lm(i),null;break;case 13:var u=i.memoizedState;if(u!==null)return u.dehydrated!==null?(Pi(i),i.flags|=128,null):(o&i.child.childLanes)!==0?xv(s,i,o):(Pi(i),s=Kr(s,i,o),s!==null?s.sibling:null);Pi(i);break;case 19:var m=(s.flags&128)!==0;if(u=(o&i.childLanes)!==0,u||(Jo(s,i,o,!1),u=(o&i.childLanes)!==0),m){if(u)return Tv(s,i,o);i.flags|=128}if(m=i.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),W(Kt,Kt.current),u)break;return null;case 22:return i.lanes=0,pv(s,i,o,i.pendingProps);case 24:ki(i,Jt,s.memoizedState.cache)}return Kr(s,i,o)}function Sv(s,i,o){if(s!==null)if(s.memoizedProps!==i.pendingProps)en=!0;else{if(!dg(s,o)&&(i.flags&128)===0)return en=!1,hA(s,i,o);en=(s.flags&131072)!==0}else en=!1,et&&(i.flags&1048576)!==0&&s_(i,Tc,i.index);switch(i.lanes=0,i.tag){case 16:e:{var u=i.pendingProps;if(s=Xa(i.elementType),i.type=s,typeof s=="function")ym(s)?(u=eo(s,u),i.tag=1,i=bv(null,i,s,u,o)):(i.tag=0,i=ig(null,i,s,u,o));else{if(s!=null){var m=s.$$typeof;if(m===ee){i.tag=11,i=fv(null,i,s,u,o);break e}else if(m===C){i.tag=14,i=mv(null,i,s,u,o);break e}}throw i=me(s)||s,Error(r(306,i,""))}}return i;case 0:return ig(s,i,i.type,i.pendingProps,o);case 1:return u=i.type,m=eo(u,i.pendingProps),bv(s,i,u,m,o);case 3:e:{if(Je(i,i.stateNode.containerInfo),s===null)throw Error(r(387));u=i.pendingProps;var p=i.memoizedState;m=p.element,km(s,i),kc(i,u,null,o);var b=i.memoizedState;if(u=b.cache,ki(i,Jt,u),u!==p.cache&&Am(i,[Jt],o,!0),jc(),u=b.element,p.isDehydrated)if(p={element:u,isDehydrated:!1,cache:b.cache},i.updateQueue.baseState=p,i.memoizedState=p,i.flags&256){i=wv(s,i,u,o);break e}else if(u!==m){m=Ds(Error(r(424)),i),Sc(m),i=wv(s,i,u,o);break e}else{switch(s=i.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Tt=Us(s.firstChild),xn=i,et=!0,Ii=null,Ls=!0,o=p_(i,null,u,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(Ga(),u===m){i=Kr(s,i,o);break e}Tn(s,i,u,o)}i=i.child}return i;case 26:return $h(s,i),s===null?(o=Pb(i.type,null,i.pendingProps,null))?i.memoizedState=o:et||(o=i.type,s=i.pendingProps,u=od(Te.current).createElement(o),u[Ut]=i,u[Xt]=s,Sn(u,o,s),kt(u),i.stateNode=u):i.memoizedState=Pb(i.type,s.memoizedProps,i.pendingProps,s.memoizedState),null;case 27:return Me(i),s===null&&et&&(u=i.stateNode=Ob(i.type,i.pendingProps,Te.current),xn=i,Ls=!0,m=Tt,Fi(i.type)?(Fg=m,Tt=Us(u.firstChild)):Tt=m),Tn(s,i,i.pendingProps.children,o),$h(s,i),s===null&&(i.flags|=4194304),i.child;case 5:return s===null&&et&&((m=u=Tt)&&(u=zA(u,i.type,i.pendingProps,Ls),u!==null?(i.stateNode=u,xn=i,Tt=Us(u.firstChild),Ls=!1,m=!0):m=!1),m||ji(i)),Me(i),m=i.type,p=i.pendingProps,b=s!==null?s.memoizedProps:null,u=p.children,Bg(m,p)?u=null:b!==null&&Bg(m,b)&&(i.flags|=32),i.memoizedState!==null&&(m=Um(s,i,nA,null,null,o),Jc._currentValue=m),$h(s,i),Tn(s,i,u,o),i.child;case 6:return s===null&&et&&((s=o=Tt)&&(o=qA(o,i.pendingProps,Ls),o!==null?(i.stateNode=o,xn=i,Tt=null,s=!0):s=!1),s||ji(i)),null;case 13:return xv(s,i,o);case 4:return Je(i,i.stateNode.containerInfo),u=i.pendingProps,s===null?i.child=Ja(i,null,u,o):Tn(s,i,u,o),i.child;case 11:return fv(s,i,i.type,i.pendingProps,o);case 7:return Tn(s,i,i.pendingProps,o),i.child;case 8:return Tn(s,i,i.pendingProps.children,o),i.child;case 12:return Tn(s,i,i.pendingProps.children,o),i.child;case 10:return u=i.pendingProps,ki(i,i.type,u.value),Tn(s,i,u.children,o),i.child;case 9:return m=i.type._context,u=i.pendingProps.children,Qa(i),m=En(m),u=u(m),i.flags|=1,Tn(s,i,u,o),i.child;case 14:return mv(s,i,i.type,i.pendingProps,o);case 15:return gv(s,i,i.type,i.pendingProps,o);case 19:return Tv(s,i,o);case 31:return uA(s,i,o);case 22:return pv(s,i,o,i.pendingProps);case 24:return Qa(i),u=En(Jt),s===null?(m=Cm(),m===null&&(m=bt,p=Nm(),m.pooledCache=p,p.refCount++,p!==null&&(m.pooledCacheLanes|=o),m=p),i.memoizedState={parent:u,cache:m},jm(i),ki(i,Jt,m)):((s.lanes&o)!==0&&(km(s,i),kc(i,null,null,o),jc()),m=s.memoizedState,p=i.memoizedState,m.parent!==u?(m={parent:u,cache:u},i.memoizedState=m,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=m),ki(i,Jt,u)):(u=p.cache,ki(i,Jt,u),u!==m.cache&&Am(i,[Jt],o,!0))),Tn(s,i,i.pendingProps.children,o),i.child;case 29:throw i.pendingProps}throw Error(r(156,i.tag))}function Qr(s){s.flags|=4}function fg(s,i,o,u,m){if((i=(s.mode&32)!==0)&&(i=!1),i){if(s.flags|=16777216,(m&335544128)===m)if(s.stateNode.complete)s.flags|=8192;else if(Jv())s.flags|=8192;else throw Wa=Ch,Im}else s.flags&=-16777217}function Av(s,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!zb(i))if(Jv())s.flags|=8192;else throw Wa=Ch,Im}function Gh(s,i){i!==null&&(s.flags|=4),s.flags&16384&&(i=s.tag!==22?ka():536870912,s.lanes|=i,ul|=i)}function Vc(s,i){if(!et)switch(s.tailMode){case"hidden":i=s.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?s.tail=null:o.sibling=null;break;case"collapsed":o=s.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:u.sibling=null}}function St(s){var i=s.alternate!==null&&s.alternate.child===s.child,o=0,u=0;if(i)for(var m=s.child;m!==null;)o|=m.lanes|m.childLanes,u|=m.subtreeFlags&65011712,u|=m.flags&65011712,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)o|=m.lanes|m.childLanes,u|=m.subtreeFlags,u|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=u,s.childLanes=o,i}function dA(s,i,o){var u=i.pendingProps;switch(wm(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return St(i),null;case 1:return St(i),null;case 3:return o=i.stateNode,u=null,s!==null&&(u=s.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),$r(Jt),nt(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(s===null||s.child===null)&&(Wo(i)?Qr(i):s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Em())),St(i),null;case 26:var m=i.type,p=i.memoizedState;return s===null?(Qr(i),p!==null?(St(i),Av(i,p)):(St(i),fg(i,m,null,u,o))):p?p!==s.memoizedState?(Qr(i),St(i),Av(i,p)):(St(i),i.flags&=-16777217):(s=s.memoizedProps,s!==u&&Qr(i),St(i),fg(i,m,s,u,o)),null;case 27:if(mt(i),o=Te.current,m=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==u&&Qr(i);else{if(!u){if(i.stateNode===null)throw Error(r(166));return St(i),null}s=ie.current,Wo(i)?i_(i):(s=Ob(m,u,o),i.stateNode=s,Qr(i))}return St(i),null;case 5:if(mt(i),m=i.type,s!==null&&i.stateNode!=null)s.memoizedProps!==u&&Qr(i);else{if(!u){if(i.stateNode===null)throw Error(r(166));return St(i),null}if(p=ie.current,Wo(i))i_(i);else{var b=od(Te.current);switch(p){case 1:p=b.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:p=b.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":p=b.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":p=b.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":p=b.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof u.is=="string"?b.createElement("select",{is:u.is}):b.createElement("select"),u.multiple?p.multiple=!0:u.size&&(p.size=u.size);break;default:p=typeof u.is=="string"?b.createElement(m,{is:u.is}):b.createElement(m)}}p[Ut]=i,p[Xt]=u;e:for(b=i.child;b!==null;){if(b.tag===5||b.tag===6)p.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===i)break e;for(;b.sibling===null;){if(b.return===null||b.return===i)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}i.stateNode=p;e:switch(Sn(p,m,u),m){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Qr(i)}}return St(i),fg(i,i.type,s===null?null:s.memoizedProps,i.pendingProps,o),null;case 6:if(s&&i.stateNode!=null)s.memoizedProps!==u&&Qr(i);else{if(typeof u!="string"&&i.stateNode===null)throw Error(r(166));if(s=Te.current,Wo(i)){if(s=i.stateNode,o=i.memoizedProps,u=null,m=xn,m!==null)switch(m.tag){case 27:case 5:u=m.memoizedProps}s[Ut]=i,s=!!(s.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||xb(s.nodeValue,o)),s||ji(i,!0)}else s=od(s).createTextNode(u),s[Ut]=i,i.stateNode=s}return St(i),null;case 31:if(o=i.memoizedState,s===null||s.memoizedState!==null){if(u=Wo(i),o!==null){if(s===null){if(!u)throw Error(r(318));if(s=i.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(557));s[Ut]=i}else Ga(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;St(i),s=!1}else o=Em(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=o),s=!0;if(!s)return i.flags&256?(ms(i),i):(ms(i),null);if((i.flags&128)!==0)throw Error(r(558))}return St(i),null;case 13:if(u=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(m=Wo(i),u!==null&&u.dehydrated!==null){if(s===null){if(!m)throw Error(r(318));if(m=i.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(r(317));m[Ut]=i}else Ga(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;St(i),m=!1}else m=Em(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=m),m=!0;if(!m)return i.flags&256?(ms(i),i):(ms(i),null)}return ms(i),(i.flags&128)!==0?(i.lanes=o,i):(o=u!==null,s=s!==null&&s.memoizedState!==null,o&&(u=i.child,m=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(m=u.alternate.memoizedState.cachePool.pool),p=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(p=u.memoizedState.cachePool.pool),p!==m&&(u.flags|=2048)),o!==s&&o&&(i.child.flags|=8192),Gh(i,i.updateQueue),St(i),null);case 4:return nt(),s===null&&Mg(i.stateNode.containerInfo),St(i),null;case 10:return $r(i.type),St(i),null;case 19:if(ne(Kt),u=i.memoizedState,u===null)return St(i),null;if(m=(i.flags&128)!==0,p=u.rendering,p===null)if(m)Vc(u,!1);else{if(zt!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(p=Oh(s),p!==null){for(i.flags|=128,Vc(u,!1),s=p.updateQueue,i.updateQueue=s,Gh(i,s),i.subtreeFlags=0,s=o,o=i.child;o!==null;)e_(o,s),o=o.sibling;return W(Kt,Kt.current&1|2),et&&qr(i,u.treeForkCount),i.child}s=s.sibling}u.tail!==null&&bn()>Wh&&(i.flags|=128,m=!0,Vc(u,!1),i.lanes=4194304)}else{if(!m)if(s=Oh(p),s!==null){if(i.flags|=128,m=!0,s=s.updateQueue,i.updateQueue=s,Gh(i,s),Vc(u,!0),u.tail===null&&u.tailMode==="hidden"&&!p.alternate&&!et)return St(i),null}else 2*bn()-u.renderingStartTime>Wh&&o!==536870912&&(i.flags|=128,m=!0,Vc(u,!1),i.lanes=4194304);u.isBackwards?(p.sibling=i.child,i.child=p):(s=u.last,s!==null?s.sibling=p:i.child=p,u.last=p)}return u.tail!==null?(s=u.tail,u.rendering=s,u.tail=s.sibling,u.renderingStartTime=bn(),s.sibling=null,o=Kt.current,W(Kt,m?o&1|2:o&1),et&&qr(i,u.treeForkCount),s):(St(i),null);case 22:case 23:return ms(i),Pm(),u=i.memoizedState!==null,s!==null?s.memoizedState!==null!==u&&(i.flags|=8192):u&&(i.flags|=8192),u?(o&536870912)!==0&&(i.flags&128)===0&&(St(i),i.subtreeFlags&6&&(i.flags|=8192)):St(i),o=i.updateQueue,o!==null&&Gh(i,o.retryQueue),o=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),u=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),u!==o&&(i.flags|=2048),s!==null&&ne(Ya),null;case 24:return o=null,s!==null&&(o=s.memoizedState.cache),i.memoizedState.cache!==o&&(i.flags|=2048),$r(Jt),St(i),null;case 25:return null;case 30:return null}throw Error(r(156,i.tag))}function fA(s,i){switch(wm(i),i.tag){case 1:return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return $r(Jt),nt(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 26:case 27:case 5:return mt(i),null;case 31:if(i.memoizedState!==null){if(ms(i),i.alternate===null)throw Error(r(340));Ga()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 13:if(ms(i),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(r(340));Ga()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return ne(Kt),null;case 4:return nt(),null;case 10:return $r(i.type),null;case 22:case 23:return ms(i),Pm(),s!==null&&ne(Ya),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 24:return $r(Jt),null;case 25:return null;default:return null}}function Nv(s,i){switch(wm(i),i.tag){case 3:$r(Jt),nt();break;case 26:case 27:case 5:mt(i);break;case 4:nt();break;case 31:i.memoizedState!==null&&ms(i);break;case 13:ms(i);break;case 19:ne(Kt);break;case 10:$r(i.type);break;case 22:case 23:ms(i),Pm(),s!==null&&ne(Ya);break;case 24:$r(Jt)}}function Uc(s,i){try{var o=i.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var m=u.next;o=m;do{if((o.tag&s)===s){u=void 0;var p=o.create,b=o.inst;u=p(),b.destroy=u}o=o.next}while(o!==m)}}catch(T){ht(i,i.return,T)}}function Vi(s,i,o){try{var u=i.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var p=m.next;u=p;do{if((u.tag&s)===s){var b=u.inst,T=b.destroy;if(T!==void 0){b.destroy=void 0,m=i;var M=o,Y=T;try{Y()}catch(te){ht(m,M,te)}}}u=u.next}while(u!==p)}}catch(te){ht(i,i.return,te)}}function Rv(s){var i=s.updateQueue;if(i!==null){var o=s.stateNode;try{__(i,o)}catch(u){ht(s,s.return,u)}}}function Cv(s,i,o){o.props=eo(s.type,s.memoizedProps),o.state=s.memoizedState;try{o.componentWillUnmount()}catch(u){ht(s,i,u)}}function Bc(s,i){try{var o=s.ref;if(o!==null){switch(s.tag){case 26:case 27:case 5:var u=s.stateNode;break;case 30:u=s.stateNode;break;default:u=s.stateNode}typeof o=="function"?s.refCleanup=o(u):o.current=u}}catch(m){ht(s,i,m)}}function Tr(s,i){var o=s.ref,u=s.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(m){ht(s,i,m)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){ht(s,i,m)}else o.current=null}function Iv(s){var i=s.type,o=s.memoizedProps,u=s.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(m){ht(s,s.return,m)}}function mg(s,i,o){try{var u=s.stateNode;MA(u,s.type,o,i),u[Xt]=i}catch(m){ht(s,s.return,m)}}function jv(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Fi(s.type)||s.tag===4}function gg(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||jv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Fi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function pg(s,i,o){var u=s.tag;if(u===5||u===6)s=s.stateNode,i?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(s,i):(i=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,i.appendChild(s),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=Gs));else if(u!==4&&(u===27&&Fi(s.type)&&(o=s.stateNode,i=null),s=s.child,s!==null))for(pg(s,i,o),s=s.sibling;s!==null;)pg(s,i,o),s=s.sibling}function Kh(s,i,o){var u=s.tag;if(u===5||u===6)s=s.stateNode,i?o.insertBefore(s,i):o.appendChild(s);else if(u!==4&&(u===27&&Fi(s.type)&&(o=s.stateNode),s=s.child,s!==null))for(Kh(s,i,o),s=s.sibling;s!==null;)Kh(s,i,o),s=s.sibling}function kv(s){var i=s.stateNode,o=s.memoizedProps;try{for(var u=s.type,m=i.attributes;m.length;)i.removeAttributeNode(m[0]);Sn(i,u,o),i[Ut]=s,i[Xt]=o}catch(p){ht(s,s.return,p)}}var Yr=!1,tn=!1,yg=!1,Ov=typeof WeakSet=="function"?WeakSet:Set,gn=null;function mA(s,i){if(s=s.containerInfo,Vg=md,s=Fy(s),um(s)){if("selectionStart"in s)var o={start:s.selectionStart,end:s.selectionEnd};else e:{o=(o=s.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var m=u.anchorOffset,p=u.focusNode;u=u.focusOffset;try{o.nodeType,p.nodeType}catch{o=null;break e}var b=0,T=-1,M=-1,Y=0,te=0,ae=s,X=null;t:for(;;){for(var Z;ae!==o||m!==0&&ae.nodeType!==3||(T=b+m),ae!==p||u!==0&&ae.nodeType!==3||(M=b+u),ae.nodeType===3&&(b+=ae.nodeValue.length),(Z=ae.firstChild)!==null;)X=ae,ae=Z;for(;;){if(ae===s)break t;if(X===o&&++Y===m&&(T=b),X===p&&++te===u&&(M=b),(Z=ae.nextSibling)!==null)break;ae=X,X=ae.parentNode}ae=Z}o=T===-1||M===-1?null:{start:T,end:M}}else o=null}o=o||{start:0,end:0}}else o=null;for(Ug={focusedElem:s,selectionRange:o},md=!1,gn=i;gn!==null;)if(i=gn,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,gn=s;else for(;gn!==null;){switch(i=gn,p=i.alternate,s=i.flags,i.tag){case 0:if((s&4)!==0&&(s=i.updateQueue,s=s!==null?s.events:null,s!==null))for(o=0;o<s.length;o++)m=s[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&p!==null){s=void 0,o=i,m=p.memoizedProps,p=p.memoizedState,u=o.stateNode;try{var ve=eo(o.type,m);s=u.getSnapshotBeforeUpdate(ve,p),u.__reactInternalSnapshotBeforeUpdate=s}catch(Ce){ht(o,o.return,Ce)}}break;case 3:if((s&1024)!==0){if(s=i.stateNode.containerInfo,o=s.nodeType,o===9)qg(s);else if(o===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":qg(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=i.sibling,s!==null){s.return=i.return,gn=s;break}gn=i.return}}function Dv(s,i,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:Wr(s,o),u&4&&Uc(5,o);break;case 1:if(Wr(s,o),u&4)if(s=o.stateNode,i===null)try{s.componentDidMount()}catch(b){ht(o,o.return,b)}else{var m=eo(o.type,i.memoizedProps);i=i.memoizedState;try{s.componentDidUpdate(m,i,s.__reactInternalSnapshotBeforeUpdate)}catch(b){ht(o,o.return,b)}}u&64&&Rv(o),u&512&&Bc(o,o.return);break;case 3:if(Wr(s,o),u&64&&(s=o.updateQueue,s!==null)){if(i=null,o.child!==null)switch(o.child.tag){case 27:case 5:i=o.child.stateNode;break;case 1:i=o.child.stateNode}try{__(s,i)}catch(b){ht(o,o.return,b)}}break;case 27:i===null&&u&4&&kv(o);case 26:case 5:Wr(s,o),i===null&&u&4&&Iv(o),u&512&&Bc(o,o.return);break;case 12:Wr(s,o);break;case 31:Wr(s,o),u&4&&Lv(s,o);break;case 13:Wr(s,o),u&4&&Vv(s,o),u&64&&(s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(o=EA.bind(null,o),HA(s,o))));break;case 22:if(u=o.memoizedState!==null||Yr,!u){i=i!==null&&i.memoizedState!==null||tn,m=Yr;var p=tn;Yr=u,(tn=i)&&!p?Jr(s,o,(o.subtreeFlags&8772)!==0):Wr(s,o),Yr=m,tn=p}break;case 30:break;default:Wr(s,o)}}function Mv(s){var i=s.alternate;i!==null&&(s.alternate=null,Mv(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&_i(i)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Ct=null,Wn=!1;function Xr(s,i,o){for(o=o.child;o!==null;)Pv(s,i,o),o=o.sibling}function Pv(s,i,o){if($t&&typeof $t.onCommitFiberUnmount=="function")try{$t.onCommitFiberUnmount(is,o)}catch{}switch(o.tag){case 26:tn||Tr(o,i),Xr(s,i,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:tn||Tr(o,i);var u=Ct,m=Wn;Fi(o.type)&&(Ct=o.stateNode,Wn=!1),Xr(s,i,o),Yc(o.stateNode),Ct=u,Wn=m;break;case 5:tn||Tr(o,i);case 6:if(u=Ct,m=Wn,Ct=null,Xr(s,i,o),Ct=u,Wn=m,Ct!==null)if(Wn)try{(Ct.nodeType===9?Ct.body:Ct.nodeName==="HTML"?Ct.ownerDocument.body:Ct).removeChild(o.stateNode)}catch(p){ht(o,i,p)}else try{Ct.removeChild(o.stateNode)}catch(p){ht(o,i,p)}break;case 18:Ct!==null&&(Wn?(s=Ct,Rb(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,o.stateNode),_l(s)):Rb(Ct,o.stateNode));break;case 4:u=Ct,m=Wn,Ct=o.stateNode.containerInfo,Wn=!0,Xr(s,i,o),Ct=u,Wn=m;break;case 0:case 11:case 14:case 15:Vi(2,o,i),tn||Vi(4,o,i),Xr(s,i,o);break;case 1:tn||(Tr(o,i),u=o.stateNode,typeof u.componentWillUnmount=="function"&&Cv(o,i,u)),Xr(s,i,o);break;case 21:Xr(s,i,o);break;case 22:tn=(u=tn)||o.memoizedState!==null,Xr(s,i,o),tn=u;break;default:Xr(s,i,o)}}function Lv(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{_l(s)}catch(o){ht(i,i.return,o)}}}function Vv(s,i){if(i.memoizedState===null&&(s=i.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{_l(s)}catch(o){ht(i,i.return,o)}}function gA(s){switch(s.tag){case 31:case 13:case 19:var i=s.stateNode;return i===null&&(i=s.stateNode=new Ov),i;case 22:return s=s.stateNode,i=s._retryCache,i===null&&(i=s._retryCache=new Ov),i;default:throw Error(r(435,s.tag))}}function Qh(s,i){var o=gA(s);i.forEach(function(u){if(!o.has(u)){o.add(u);var m=TA.bind(null,s,u);u.then(m,m)}})}function Jn(s,i){var o=i.deletions;if(o!==null)for(var u=0;u<o.length;u++){var m=o[u],p=s,b=i,T=b;e:for(;T!==null;){switch(T.tag){case 27:if(Fi(T.type)){Ct=T.stateNode,Wn=!1;break e}break;case 5:Ct=T.stateNode,Wn=!1;break e;case 3:case 4:Ct=T.stateNode.containerInfo,Wn=!0;break e}T=T.return}if(Ct===null)throw Error(r(160));Pv(p,b,m),Ct=null,Wn=!1,p=m.alternate,p!==null&&(p.return=null),m.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)Uv(i,s),i=i.sibling}var Js=null;function Uv(s,i){var o=s.alternate,u=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Jn(i,s),Zn(s),u&4&&(Vi(3,s,s.return),Uc(3,s),Vi(5,s,s.return));break;case 1:Jn(i,s),Zn(s),u&512&&(tn||o===null||Tr(o,o.return)),u&64&&Yr&&(s=s.updateQueue,s!==null&&(u=s.callbacks,u!==null&&(o=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var m=Js;if(Jn(i,s),Zn(s),u&512&&(tn||o===null||Tr(o,o.return)),u&4){var p=o!==null?o.memoizedState:null;if(u=s.memoizedState,o===null)if(u===null)if(s.stateNode===null){e:{u=s.type,o=s.memoizedProps,m=m.ownerDocument||m;t:switch(u){case"title":p=m.getElementsByTagName("title")[0],(!p||p[Rs]||p[Ut]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=m.createElement(u),m.head.insertBefore(p,m.querySelector("head > title"))),Sn(p,u,o),p[Ut]=s,kt(p),u=p;break e;case"link":var b=Ub("link","href",m).get(u+(o.href||""));if(b){for(var T=0;T<b.length;T++)if(p=b[T],p.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&p.getAttribute("rel")===(o.rel==null?null:o.rel)&&p.getAttribute("title")===(o.title==null?null:o.title)&&p.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){b.splice(T,1);break t}}p=m.createElement(u),Sn(p,u,o),m.head.appendChild(p);break;case"meta":if(b=Ub("meta","content",m).get(u+(o.content||""))){for(T=0;T<b.length;T++)if(p=b[T],p.getAttribute("content")===(o.content==null?null:""+o.content)&&p.getAttribute("name")===(o.name==null?null:o.name)&&p.getAttribute("property")===(o.property==null?null:o.property)&&p.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&p.getAttribute("charset")===(o.charSet==null?null:o.charSet)){b.splice(T,1);break t}}p=m.createElement(u),Sn(p,u,o),m.head.appendChild(p);break;default:throw Error(r(468,u))}p[Ut]=s,kt(p),u=p}s.stateNode=u}else Bb(m,s.type,s.stateNode);else s.stateNode=Vb(m,u,s.memoizedProps);else p!==u?(p===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):p.count--,u===null?Bb(m,s.type,s.stateNode):Vb(m,u,s.memoizedProps)):u===null&&s.stateNode!==null&&mg(s,s.memoizedProps,o.memoizedProps)}break;case 27:Jn(i,s),Zn(s),u&512&&(tn||o===null||Tr(o,o.return)),o!==null&&u&4&&mg(s,s.memoizedProps,o.memoizedProps);break;case 5:if(Jn(i,s),Zn(s),u&512&&(tn||o===null||Tr(o,o.return)),s.flags&32){m=s.stateNode;try{Xn(m,"")}catch(ve){ht(s,s.return,ve)}}u&4&&s.stateNode!=null&&(m=s.memoizedProps,mg(s,m,o!==null?o.memoizedProps:m)),u&1024&&(yg=!0);break;case 6:if(Jn(i,s),Zn(s),u&4){if(s.stateNode===null)throw Error(r(162));u=s.memoizedProps,o=s.stateNode;try{o.nodeValue=u}catch(ve){ht(s,s.return,ve)}}break;case 3:if(ud=null,m=Js,Js=ld(i.containerInfo),Jn(i,s),Js=m,Zn(s),u&4&&o!==null&&o.memoizedState.isDehydrated)try{_l(i.containerInfo)}catch(ve){ht(s,s.return,ve)}yg&&(yg=!1,Bv(s));break;case 4:u=Js,Js=ld(s.stateNode.containerInfo),Jn(i,s),Zn(s),Js=u;break;case 12:Jn(i,s),Zn(s);break;case 31:Jn(i,s),Zn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Qh(s,u)));break;case 13:Jn(i,s),Zn(s),s.child.flags&8192&&s.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Xh=bn()),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Qh(s,u)));break;case 22:m=s.memoizedState!==null;var M=o!==null&&o.memoizedState!==null,Y=Yr,te=tn;if(Yr=Y||m,tn=te||M,Jn(i,s),tn=te,Yr=Y,Zn(s),u&8192)e:for(i=s.stateNode,i._visibility=m?i._visibility&-2:i._visibility|1,m&&(o===null||M||Yr||tn||to(s)),o=null,i=s;;){if(i.tag===5||i.tag===26){if(o===null){M=o=i;try{if(p=M.stateNode,m)b=p.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{T=M.stateNode;var ae=M.memoizedProps.style,X=ae!=null&&ae.hasOwnProperty("display")?ae.display:null;T.style.display=X==null||typeof X=="boolean"?"":(""+X).trim()}}catch(ve){ht(M,M.return,ve)}}}else if(i.tag===6){if(o===null){M=i;try{M.stateNode.nodeValue=m?"":M.memoizedProps}catch(ve){ht(M,M.return,ve)}}}else if(i.tag===18){if(o===null){M=i;try{var Z=M.stateNode;m?Cb(Z,!0):Cb(M.stateNode,!1)}catch(ve){ht(M,M.return,ve)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===s)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;o===i&&(o=null),i=i.return}o===i&&(o=null),i.sibling.return=i.return,i=i.sibling}u&4&&(u=s.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,Qh(s,o))));break;case 19:Jn(i,s),Zn(s),u&4&&(u=s.updateQueue,u!==null&&(s.updateQueue=null,Qh(s,u)));break;case 30:break;case 21:break;default:Jn(i,s),Zn(s)}}function Zn(s){var i=s.flags;if(i&2){try{for(var o,u=s.return;u!==null;){if(jv(u)){o=u;break}u=u.return}if(o==null)throw Error(r(160));switch(o.tag){case 27:var m=o.stateNode,p=gg(s);Kh(s,p,m);break;case 5:var b=o.stateNode;o.flags&32&&(Xn(b,""),o.flags&=-33);var T=gg(s);Kh(s,T,b);break;case 3:case 4:var M=o.stateNode.containerInfo,Y=gg(s);pg(s,Y,M);break;default:throw Error(r(161))}}catch(te){ht(s,s.return,te)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function Bv(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var i=s;Bv(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),s=s.sibling}}function Wr(s,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)Dv(s,i.alternate,i),i=i.sibling}function to(s){for(s=s.child;s!==null;){var i=s;switch(i.tag){case 0:case 11:case 14:case 15:Vi(4,i,i.return),to(i);break;case 1:Tr(i,i.return);var o=i.stateNode;typeof o.componentWillUnmount=="function"&&Cv(i,i.return,o),to(i);break;case 27:Yc(i.stateNode);case 26:case 5:Tr(i,i.return),to(i);break;case 22:i.memoizedState===null&&to(i);break;case 30:to(i);break;default:to(i)}s=s.sibling}}function Jr(s,i,o){for(o=o&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var u=i.alternate,m=s,p=i,b=p.flags;switch(p.tag){case 0:case 11:case 15:Jr(m,p,o),Uc(4,p);break;case 1:if(Jr(m,p,o),u=p,m=u.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(Y){ht(u,u.return,Y)}if(u=p,m=u.updateQueue,m!==null){var T=u.stateNode;try{var M=m.shared.hiddenCallbacks;if(M!==null)for(m.shared.hiddenCallbacks=null,m=0;m<M.length;m++)y_(M[m],T)}catch(Y){ht(u,u.return,Y)}}o&&b&64&&Rv(p),Bc(p,p.return);break;case 27:kv(p);case 26:case 5:Jr(m,p,o),o&&u===null&&b&4&&Iv(p),Bc(p,p.return);break;case 12:Jr(m,p,o);break;case 31:Jr(m,p,o),o&&b&4&&Lv(m,p);break;case 13:Jr(m,p,o),o&&b&4&&Vv(m,p);break;case 22:p.memoizedState===null&&Jr(m,p,o),Bc(p,p.return);break;case 30:break;default:Jr(m,p,o)}i=i.sibling}}function _g(s,i){var o=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(o=s.memoizedState.cachePool.pool),s=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==o&&(s!=null&&s.refCount++,o!=null&&Ac(o))}function vg(s,i){s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Ac(s))}function Zs(s,i,o,u){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)zv(s,i,o,u),i=i.sibling}function zv(s,i,o,u){var m=i.flags;switch(i.tag){case 0:case 11:case 15:Zs(s,i,o,u),m&2048&&Uc(9,i);break;case 1:Zs(s,i,o,u);break;case 3:Zs(s,i,o,u),m&2048&&(s=null,i.alternate!==null&&(s=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==s&&(i.refCount++,s!=null&&Ac(s)));break;case 12:if(m&2048){Zs(s,i,o,u),s=i.stateNode;try{var p=i.memoizedProps,b=p.id,T=p.onPostCommit;typeof T=="function"&&T(b,i.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(M){ht(i,i.return,M)}}else Zs(s,i,o,u);break;case 31:Zs(s,i,o,u);break;case 13:Zs(s,i,o,u);break;case 23:break;case 22:p=i.stateNode,b=i.alternate,i.memoizedState!==null?p._visibility&2?Zs(s,i,o,u):zc(s,i):p._visibility&2?Zs(s,i,o,u):(p._visibility|=2,ol(s,i,o,u,(i.subtreeFlags&10256)!==0||!1)),m&2048&&_g(b,i);break;case 24:Zs(s,i,o,u),m&2048&&vg(i.alternate,i);break;default:Zs(s,i,o,u)}}function ol(s,i,o,u,m){for(m=m&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var p=s,b=i,T=o,M=u,Y=b.flags;switch(b.tag){case 0:case 11:case 15:ol(p,b,T,M,m),Uc(8,b);break;case 23:break;case 22:var te=b.stateNode;b.memoizedState!==null?te._visibility&2?ol(p,b,T,M,m):zc(p,b):(te._visibility|=2,ol(p,b,T,M,m)),m&&Y&2048&&_g(b.alternate,b);break;case 24:ol(p,b,T,M,m),m&&Y&2048&&vg(b.alternate,b);break;default:ol(p,b,T,M,m)}i=i.sibling}}function zc(s,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var o=s,u=i,m=u.flags;switch(u.tag){case 22:zc(o,u),m&2048&&_g(u.alternate,u);break;case 24:zc(o,u),m&2048&&vg(u.alternate,u);break;default:zc(o,u)}i=i.sibling}}var qc=8192;function ll(s,i,o){if(s.subtreeFlags&qc)for(s=s.child;s!==null;)qv(s,i,o),s=s.sibling}function qv(s,i,o){switch(s.tag){case 26:ll(s,i,o),s.flags&qc&&s.memoizedState!==null&&tN(o,Js,s.memoizedState,s.memoizedProps);break;case 5:ll(s,i,o);break;case 3:case 4:var u=Js;Js=ld(s.stateNode.containerInfo),ll(s,i,o),Js=u;break;case 22:s.memoizedState===null&&(u=s.alternate,u!==null&&u.memoizedState!==null?(u=qc,qc=16777216,ll(s,i,o),qc=u):ll(s,i,o));break;default:ll(s,i,o)}}function Hv(s){var i=s.alternate;if(i!==null&&(s=i.child,s!==null)){i.child=null;do i=s.sibling,s.sibling=null,s=i;while(s!==null)}}function Hc(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var u=i[o];gn=u,Fv(u,s)}Hv(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)$v(s),s=s.sibling}function $v(s){switch(s.tag){case 0:case 11:case 15:Hc(s),s.flags&2048&&Vi(9,s,s.return);break;case 3:Hc(s);break;case 12:Hc(s);break;case 22:var i=s.stateNode;s.memoizedState!==null&&i._visibility&2&&(s.return===null||s.return.tag!==13)?(i._visibility&=-3,Yh(s)):Hc(s);break;default:Hc(s)}}function Yh(s){var i=s.deletions;if((s.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var u=i[o];gn=u,Fv(u,s)}Hv(s)}for(s=s.child;s!==null;){switch(i=s,i.tag){case 0:case 11:case 15:Vi(8,i,i.return),Yh(i);break;case 22:o=i.stateNode,o._visibility&2&&(o._visibility&=-3,Yh(i));break;default:Yh(i)}s=s.sibling}}function Fv(s,i){for(;gn!==null;){var o=gn;switch(o.tag){case 0:case 11:case 15:Vi(8,o,i);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Ac(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,gn=u;else e:for(o=s;gn!==null;){u=gn;var m=u.sibling,p=u.return;if(Mv(u),u===o){gn=null;break e}if(m!==null){m.return=p,gn=m;break e}gn=p}}}var pA={getCacheForType:function(s){var i=En(Jt),o=i.data.get(s);return o===void 0&&(o=s(),i.data.set(s,o)),o},cacheSignal:function(){return En(Jt).controller.signal}},yA=typeof WeakMap=="function"?WeakMap:Map,at=0,bt=null,Fe=null,Ke=0,ut=0,gs=null,Ui=!1,cl=!1,bg=!1,Zr=0,zt=0,Bi=0,no=0,wg=0,ps=0,ul=0,$c=null,es=null,xg=!1,Xh=0,Gv=0,Wh=1/0,Jh=null,zi=null,cn=0,qi=null,hl=null,ei=0,Eg=0,Tg=null,Kv=null,Fc=0,Sg=null;function ys(){return(at&2)!==0&&Ke!==0?Ke&-Ke:V.T!==null?jg():Oo()}function Qv(){if(ps===0)if((Ke&536870912)===0||et){var s=Lr;Lr<<=1,(Lr&3932160)===0&&(Lr=262144),ps=s}else ps=536870912;return s=fs.current,s!==null&&(s.flags|=32),ps}function ts(s,i,o){(s===bt&&(ut===2||ut===9)||s.cancelPendingCommit!==null)&&(dl(s,0),Hi(s,Ke,ps,!1)),hr(s,o),((at&2)===0||s!==bt)&&(s===bt&&((at&2)===0&&(no|=o),zt===4&&Hi(s,Ke,ps,!1)),Sr(s))}function Yv(s,i,o){if((at&6)!==0)throw Error(r(327));var u=!o&&(i&127)===0&&(i&s.expiredLanes)===0||as(s,i),m=u?bA(s,i):Ng(s,i,!0),p=u;do{if(m===0){cl&&!u&&Hi(s,i,0,!1);break}else{if(o=s.current.alternate,p&&!_A(o)){m=Ng(s,i,!1),p=!1;continue}if(m===2){if(p=i,s.errorRecoveryDisabledLanes&p)var b=0;else b=s.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){i=b;e:{var T=s;m=$c;var M=T.current.memoizedState.isDehydrated;if(M&&(dl(T,b).flags|=256),b=Ng(T,b,!1),b!==2){if(bg&&!M){T.errorRecoveryDisabledLanes|=p,no|=p,m=4;break e}p=es,es=m,p!==null&&(es===null?es=p:es.push.apply(es,p))}m=b}if(p=!1,m!==2)continue}}if(m===1){dl(s,0),Hi(s,i,0,!0);break}e:{switch(u=s,p=m,p){case 0:case 1:throw Error(r(345));case 4:if((i&4194048)!==i)break;case 6:Hi(u,i,ps,!Ui);break e;case 2:es=null;break;case 3:case 5:break;default:throw Error(r(329))}if((i&62914560)===i&&(m=Xh+300-bn(),10<m)){if(Hi(u,i,ps,!Ui),fn(u,0,!0)!==0)break e;ei=i,u.timeoutHandle=Ab(Xv.bind(null,u,o,es,Jh,xg,i,ps,no,ul,Ui,p,"Throttled",-0,0),m);break e}Xv(u,o,es,Jh,xg,i,ps,no,ul,Ui,p,null,-0,0)}}break}while(!0);Sr(s)}function Xv(s,i,o,u,m,p,b,T,M,Y,te,ae,X,Z){if(s.timeoutHandle=-1,ae=i.subtreeFlags,ae&8192||(ae&16785408)===16785408){ae={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Gs},qv(i,p,ae);var ve=(p&62914560)===p?Xh-bn():(p&4194048)===p?Gv-bn():0;if(ve=nN(ae,ve),ve!==null){ei=p,s.cancelPendingCommit=ve(rb.bind(null,s,i,p,o,u,m,b,T,M,te,ae,null,X,Z)),Hi(s,p,b,!Y);return}}rb(s,i,p,o,u,m,b,T,M)}function _A(s){for(var i=s;;){var o=i.tag;if((o===0||o===11||o===15)&&i.flags&16384&&(o=i.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var m=o[u],p=m.getSnapshot;m=m.value;try{if(!hs(p(),m))return!1}catch{return!1}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Hi(s,i,o,u){i&=~wg,i&=~no,s.suspendedLanes|=i,s.pingedLanes&=~i,u&&(s.warmLanes|=i),u=s.expirationTimes;for(var m=i;0<m;){var p=31-At(m),b=1<<p;u[p]=-1,m&=~b}o!==0&&fr(s,o,i)}function Zh(){return(at&6)===0?(Gc(0),!1):!0}function Ag(){if(Fe!==null){if(ut===0)var s=Fe.return;else s=Fe,Hr=Ka=null,qm(s),nl=null,Rc=0,s=Fe;for(;s!==null;)Nv(s.alternate,s),s=s.return;Fe=null}}function dl(s,i){var o=s.timeoutHandle;o!==-1&&(s.timeoutHandle=-1,VA(o)),o=s.cancelPendingCommit,o!==null&&(s.cancelPendingCommit=null,o()),ei=0,Ag(),bt=s,Fe=o=zr(s.current,null),Ke=i,ut=0,gs=null,Ui=!1,cl=as(s,i),bg=!1,ul=ps=wg=no=Bi=zt=0,es=$c=null,xg=!1,(i&8)!==0&&(i|=i&32);var u=s.entangledLanes;if(u!==0)for(s=s.entanglements,u&=i;0<u;){var m=31-At(u),p=1<<m;i|=s[m],u&=~p}return Zr=i,bh(),o}function Wv(s,i){Be=null,V.H=Pc,i===tl||i===Rh?(i=f_(),ut=3):i===Im?(i=f_(),ut=4):ut=i===rg?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,gs=i,Fe===null&&(zt=1,qh(s,Ds(i,s.current)))}function Jv(){var s=fs.current;return s===null?!0:(Ke&4194048)===Ke?Vs===null:(Ke&62914560)===Ke||(Ke&536870912)!==0?s===Vs:!1}function Zv(){var s=V.H;return V.H=Pc,s===null?Pc:s}function eb(){var s=V.A;return V.A=pA,s}function ed(){zt=4,Ui||(Ke&4194048)!==Ke&&fs.current!==null||(cl=!0),(Bi&134217727)===0&&(no&134217727)===0||bt===null||Hi(bt,Ke,ps,!1)}function Ng(s,i,o){var u=at;at|=2;var m=Zv(),p=eb();(bt!==s||Ke!==i)&&(Jh=null,dl(s,i)),i=!1;var b=zt;e:do try{if(ut!==0&&Fe!==null){var T=Fe,M=gs;switch(ut){case 8:Ag(),b=6;break e;case 3:case 2:case 9:case 6:fs.current===null&&(i=!0);var Y=ut;if(ut=0,gs=null,fl(s,T,M,Y),o&&cl){b=0;break e}break;default:Y=ut,ut=0,gs=null,fl(s,T,M,Y)}}vA(),b=zt;break}catch(te){Wv(s,te)}while(!0);return i&&s.shellSuspendCounter++,Hr=Ka=null,at=u,V.H=m,V.A=p,Fe===null&&(bt=null,Ke=0,bh()),b}function vA(){for(;Fe!==null;)tb(Fe)}function bA(s,i){var o=at;at|=2;var u=Zv(),m=eb();bt!==s||Ke!==i?(Jh=null,Wh=bn()+500,dl(s,i)):cl=as(s,i);e:do try{if(ut!==0&&Fe!==null){i=Fe;var p=gs;t:switch(ut){case 1:ut=0,gs=null,fl(s,i,p,1);break;case 2:case 9:if(h_(p)){ut=0,gs=null,nb(i);break}i=function(){ut!==2&&ut!==9||bt!==s||(ut=7),Sr(s)},p.then(i,i);break e;case 3:ut=7;break e;case 4:ut=5;break e;case 7:h_(p)?(ut=0,gs=null,nb(i)):(ut=0,gs=null,fl(s,i,p,7));break;case 5:var b=null;switch(Fe.tag){case 26:b=Fe.memoizedState;case 5:case 27:var T=Fe;if(b?zb(b):T.stateNode.complete){ut=0,gs=null;var M=T.sibling;if(M!==null)Fe=M;else{var Y=T.return;Y!==null?(Fe=Y,td(Y)):Fe=null}break t}}ut=0,gs=null,fl(s,i,p,5);break;case 6:ut=0,gs=null,fl(s,i,p,6);break;case 8:Ag(),zt=6;break e;default:throw Error(r(462))}}wA();break}catch(te){Wv(s,te)}while(!0);return Hr=Ka=null,V.H=u,V.A=m,at=o,Fe!==null?0:(bt=null,Ke=0,bh(),zt)}function wA(){for(;Fe!==null&&!Aa();)tb(Fe)}function tb(s){var i=Sv(s.alternate,s,Zr);s.memoizedProps=s.pendingProps,i===null?td(s):Fe=i}function nb(s){var i=s,o=i.alternate;switch(i.tag){case 15:case 0:i=vv(o,i,i.pendingProps,i.type,void 0,Ke);break;case 11:i=vv(o,i,i.pendingProps,i.type.render,i.ref,Ke);break;case 5:qm(i);default:Nv(o,i),i=Fe=e_(i,Zr),i=Sv(o,i,Zr)}s.memoizedProps=s.pendingProps,i===null?td(s):Fe=i}function fl(s,i,o,u){Hr=Ka=null,qm(i),nl=null,Rc=0;var m=i.return;try{if(cA(s,m,i,o,Ke)){zt=1,qh(s,Ds(o,s.current)),Fe=null;return}}catch(p){if(m!==null)throw Fe=m,p;zt=1,qh(s,Ds(o,s.current)),Fe=null;return}i.flags&32768?(et||u===1?s=!0:cl||(Ke&536870912)!==0?s=!1:(Ui=s=!0,(u===2||u===9||u===3||u===6)&&(u=fs.current,u!==null&&u.tag===13&&(u.flags|=16384))),sb(i,s)):td(i)}function td(s){var i=s;do{if((i.flags&32768)!==0){sb(i,Ui);return}s=i.return;var o=dA(i.alternate,i,Zr);if(o!==null){Fe=o;return}if(i=i.sibling,i!==null){Fe=i;return}Fe=i=s}while(i!==null);zt===0&&(zt=5)}function sb(s,i){do{var o=fA(s.alternate,s);if(o!==null){o.flags&=32767,Fe=o;return}if(o=s.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!i&&(s=s.sibling,s!==null)){Fe=s;return}Fe=s=o}while(s!==null);zt=6,Fe=null}function rb(s,i,o,u,m,p,b,T,M){s.cancelPendingCommit=null;do nd();while(cn!==0);if((at&6)!==0)throw Error(r(327));if(i!==null){if(i===s.current)throw Error(r(177));if(p=i.lanes|i.childLanes,p|=gm,dr(s,o,p,b,T,M),s===bt&&(Fe=bt=null,Ke=0),hl=i,qi=s,ei=o,Eg=p,Tg=m,Kv=u,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,SA($s,function(){return cb(),null})):(s.callbackNode=null,s.callbackPriority=0),u=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||u){u=V.T,V.T=null,m=le.p,le.p=2,b=at,at|=4;try{mA(s,i,o)}finally{at=b,le.p=m,V.T=u}}cn=1,ib(),ab(),ob()}}function ib(){if(cn===1){cn=0;var s=qi,i=hl,o=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||o){o=V.T,V.T=null;var u=le.p;le.p=2;var m=at;at|=4;try{Uv(i,s);var p=Ug,b=Fy(s.containerInfo),T=p.focusedElem,M=p.selectionRange;if(b!==T&&T&&T.ownerDocument&&$y(T.ownerDocument.documentElement,T)){if(M!==null&&um(T)){var Y=M.start,te=M.end;if(te===void 0&&(te=Y),"selectionStart"in T)T.selectionStart=Y,T.selectionEnd=Math.min(te,T.value.length);else{var ae=T.ownerDocument||document,X=ae&&ae.defaultView||window;if(X.getSelection){var Z=X.getSelection(),ve=T.textContent.length,Ce=Math.min(M.start,ve),_t=M.end===void 0?Ce:Math.min(M.end,ve);!Z.extend&&Ce>_t&&(b=_t,_t=Ce,Ce=b);var $=Hy(T,Ce),q=Hy(T,_t);if($&&q&&(Z.rangeCount!==1||Z.anchorNode!==$.node||Z.anchorOffset!==$.offset||Z.focusNode!==q.node||Z.focusOffset!==q.offset)){var Q=ae.createRange();Q.setStart($.node,$.offset),Z.removeAllRanges(),Ce>_t?(Z.addRange(Q),Z.extend(q.node,q.offset)):(Q.setEnd(q.node,q.offset),Z.addRange(Q))}}}}for(ae=[],Z=T;Z=Z.parentNode;)Z.nodeType===1&&ae.push({element:Z,left:Z.scrollLeft,top:Z.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<ae.length;T++){var se=ae[T];se.element.scrollLeft=se.left,se.element.scrollTop=se.top}}md=!!Vg,Ug=Vg=null}finally{at=m,le.p=u,V.T=o}}s.current=i,cn=2}}function ab(){if(cn===2){cn=0;var s=qi,i=hl,o=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||o){o=V.T,V.T=null;var u=le.p;le.p=2;var m=at;at|=4;try{Dv(s,i.alternate,i)}finally{at=m,le.p=u,V.T=o}}cn=3}}function ob(){if(cn===4||cn===3){cn=0,jo();var s=qi,i=hl,o=ei,u=Kv;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?cn=5:(cn=0,hl=qi=null,lb(s,s.pendingLanes));var m=s.pendingLanes;if(m===0&&(zi=null),os(o),i=i.stateNode,$t&&typeof $t.onCommitFiberRoot=="function")try{$t.onCommitFiberRoot(is,i,void 0,(i.current.flags&128)===128)}catch{}if(u!==null){i=V.T,m=le.p,le.p=2,V.T=null;try{for(var p=s.onRecoverableError,b=0;b<u.length;b++){var T=u[b];p(T.value,{componentStack:T.stack})}}finally{V.T=i,le.p=m}}(ei&3)!==0&&nd(),Sr(s),m=s.pendingLanes,(o&261930)!==0&&(m&42)!==0?s===Sg?Fc++:(Fc=0,Sg=s):Fc=0,Gc(0)}}function lb(s,i){(s.pooledCacheLanes&=i)===0&&(i=s.pooledCache,i!=null&&(s.pooledCache=null,Ac(i)))}function nd(){return ib(),ab(),ob(),cb()}function cb(){if(cn!==5)return!1;var s=qi,i=Eg;Eg=0;var o=os(ei),u=V.T,m=le.p;try{le.p=32>o?32:o,V.T=null,o=Tg,Tg=null;var p=qi,b=ei;if(cn=0,hl=qi=null,ei=0,(at&6)!==0)throw Error(r(331));var T=at;if(at|=4,$v(p.current),zv(p,p.current,b,o),at=T,Gc(0,!1),$t&&typeof $t.onPostCommitFiberRoot=="function")try{$t.onPostCommitFiberRoot(is,p)}catch{}return!0}finally{le.p=m,V.T=u,lb(s,i)}}function ub(s,i,o){i=Ds(o,i),i=sg(s.stateNode,i,2),s=Mi(s,i,2),s!==null&&(hr(s,2),Sr(s))}function ht(s,i,o){if(s.tag===3)ub(s,s,o);else for(;i!==null;){if(i.tag===3){ub(i,s,o);break}else if(i.tag===1){var u=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(zi===null||!zi.has(u))){s=Ds(o,s),o=hv(2),u=Mi(i,o,2),u!==null&&(dv(o,u,i,s),hr(u,2),Sr(u));break}}i=i.return}}function Rg(s,i,o){var u=s.pingCache;if(u===null){u=s.pingCache=new yA;var m=new Set;u.set(i,m)}else m=u.get(i),m===void 0&&(m=new Set,u.set(i,m));m.has(o)||(bg=!0,m.add(o),s=xA.bind(null,s,i,o),i.then(s,s))}function xA(s,i,o){var u=s.pingCache;u!==null&&u.delete(i),s.pingedLanes|=s.suspendedLanes&o,s.warmLanes&=~o,bt===s&&(Ke&o)===o&&(zt===4||zt===3&&(Ke&62914560)===Ke&&300>bn()-Xh?(at&2)===0&&dl(s,0):wg|=o,ul===Ke&&(ul=0)),Sr(s)}function hb(s,i){i===0&&(i=ka()),s=$a(s,i),s!==null&&(hr(s,i),Sr(s))}function EA(s){var i=s.memoizedState,o=0;i!==null&&(o=i.retryLane),hb(s,o)}function TA(s,i){var o=0;switch(s.tag){case 31:case 13:var u=s.stateNode,m=s.memoizedState;m!==null&&(o=m.retryLane);break;case 19:u=s.stateNode;break;case 22:u=s.stateNode._retryCache;break;default:throw Error(r(314))}u!==null&&u.delete(i),hb(s,o)}function SA(s,i){return Lt(s,i)}var sd=null,ml=null,Cg=!1,rd=!1,Ig=!1,$i=0;function Sr(s){s!==ml&&s.next===null&&(ml===null?sd=ml=s:ml=ml.next=s),rd=!0,Cg||(Cg=!0,NA())}function Gc(s,i){if(!Ig&&rd){Ig=!0;do for(var o=!1,u=sd;u!==null;){if(s!==0){var m=u.pendingLanes;if(m===0)var p=0;else{var b=u.suspendedLanes,T=u.pingedLanes;p=(1<<31-At(42|s)+1)-1,p&=m&~(b&~T),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(o=!0,gb(u,p))}else p=Ke,p=fn(u,u===bt?p:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(p&3)===0||as(u,p)||(o=!0,gb(u,p));u=u.next}while(o);Ig=!1}}function AA(){db()}function db(){rd=Cg=!1;var s=0;$i!==0&&LA()&&(s=$i);for(var i=bn(),o=null,u=sd;u!==null;){var m=u.next,p=fb(u,i);p===0?(u.next=null,o===null?sd=m:o.next=m,m===null&&(ml=o)):(o=u,(s!==0||(p&3)!==0)&&(rd=!0)),u=m}cn!==0&&cn!==5||Gc(s),$i!==0&&($i=0)}function fb(s,i){for(var o=s.suspendedLanes,u=s.pingedLanes,m=s.expirationTimes,p=s.pendingLanes&-62914561;0<p;){var b=31-At(p),T=1<<b,M=m[b];M===-1?((T&o)===0||(T&u)!==0)&&(m[b]=mi(T,i)):M<=i&&(s.expiredLanes|=T),p&=~T}if(i=bt,o=Ke,o=fn(s,s===i?o:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u=s.callbackNode,o===0||s===i&&(ut===2||ut===9)||s.cancelPendingCommit!==null)return u!==null&&u!==null&&qs(u),s.callbackNode=null,s.callbackPriority=0;if((o&3)===0||as(s,o)){if(i=o&-o,i===s.callbackPriority)return i;switch(u!==null&&qs(u),os(o)){case 2:case 8:o=Na;break;case 32:o=$s;break;case 268435456:o=Ra;break;default:o=$s}return u=mb.bind(null,s),o=Lt(o,u),s.callbackPriority=i,s.callbackNode=o,i}return u!==null&&u!==null&&qs(u),s.callbackPriority=2,s.callbackNode=null,2}function mb(s,i){if(cn!==0&&cn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var o=s.callbackNode;if(nd()&&s.callbackNode!==o)return null;var u=Ke;return u=fn(s,s===bt?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),u===0?null:(Yv(s,u,i),fb(s,bn()),s.callbackNode!=null&&s.callbackNode===o?mb.bind(null,s):null)}function gb(s,i){if(nd())return null;Yv(s,i,!0)}function NA(){UA(function(){(at&6)!==0?Lt(Hs,AA):db()})}function jg(){if($i===0){var s=Zo;s===0&&(s=In,In<<=1,(In&261888)===0&&(In=256)),$i=s}return $i}function pb(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Vo(""+s)}function yb(s,i){var o=i.ownerDocument.createElement("input");return o.name=i.name,o.value=i.value,s.id&&o.setAttribute("form",s.id),i.parentNode.insertBefore(o,i),s=new FormData(s),o.parentNode.removeChild(o),s}function RA(s,i,o,u,m){if(i==="submit"&&o&&o.stateNode===m){var p=pb((m[Xt]||null).action),b=u.submitter;b&&(i=(i=b[Xt]||null)?pb(i.formAction):b.getAttribute("formAction"),i!==null&&(p=i,b=null));var T=new _r("action","action",null,u,m);s.push({event:T,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if($i!==0){var M=b?yb(m,b):new FormData(m);Wm(o,{pending:!0,data:M,method:m.method,action:p},null,M)}}else typeof p=="function"&&(T.preventDefault(),M=b?yb(m,b):new FormData(m),Wm(o,{pending:!0,data:M,method:m.method,action:p},p,M))},currentTarget:m}]})}}for(var kg=0;kg<mm.length;kg++){var Og=mm[kg],CA=Og.toLowerCase(),IA=Og[0].toUpperCase()+Og.slice(1);Ws(CA,"on"+IA)}Ws(Qy,"onAnimationEnd"),Ws(Yy,"onAnimationIteration"),Ws(Xy,"onAnimationStart"),Ws("dblclick","onDoubleClick"),Ws("focusin","onFocus"),Ws("focusout","onBlur"),Ws(GS,"onTransitionRun"),Ws(KS,"onTransitionStart"),Ws(QS,"onTransitionCancel"),Ws(Wy,"onTransitionEnd"),Se("onMouseEnter",["mouseout","mouseover"]),Se("onMouseLeave",["mouseout","mouseover"]),Se("onPointerEnter",["pointerout","pointerover"]),Se("onPointerLeave",["pointerout","pointerover"]),ce("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ce("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ce("onBeforeInput",["compositionend","keypress","textInput","paste"]),ce("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ce("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ce("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Kc));function _b(s,i){i=(i&4)!==0;for(var o=0;o<s.length;o++){var u=s[o],m=u.event;u=u.listeners;e:{var p=void 0;if(i)for(var b=u.length-1;0<=b;b--){var T=u[b],M=T.instance,Y=T.currentTarget;if(T=T.listener,M!==p&&m.isPropagationStopped())break e;p=T,m.currentTarget=Y;try{p(m)}catch(te){vh(te)}m.currentTarget=null,p=M}else for(b=0;b<u.length;b++){if(T=u[b],M=T.instance,Y=T.currentTarget,T=T.listener,M!==p&&m.isPropagationStopped())break e;p=T,m.currentTarget=Y;try{p(m)}catch(te){vh(te)}m.currentTarget=null,p=M}}}}function Ge(s,i){var o=i[yi];o===void 0&&(o=i[yi]=new Set);var u=s+"__bubble";o.has(u)||(vb(i,s,2,!1),o.add(u))}function Dg(s,i,o){var u=0;i&&(u|=4),vb(o,s,u,i)}var id="_reactListening"+Math.random().toString(36).slice(2);function Mg(s){if(!s[id]){s[id]=!0,vi.forEach(function(o){o!=="selectionchange"&&(jA.has(o)||Dg(o,!1,s),Dg(o,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[id]||(i[id]=!0,Dg("selectionchange",!1,i))}}function vb(s,i,o,u){switch(Qb(i)){case 2:var m=iN;break;case 8:m=aN;break;default:m=Xg}o=m.bind(null,i,o,s),m=void 0,!Pa||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(m=!0),u?m!==void 0?s.addEventListener(i,o,{capture:!0,passive:m}):s.addEventListener(i,o,!0):m!==void 0?s.addEventListener(i,o,{passive:m}):s.addEventListener(i,o,!1)}function Pg(s,i,o,u,m){var p=u;if((i&1)===0&&(i&2)===0&&u!==null)e:for(;;){if(u===null)return;var b=u.tag;if(b===3||b===4){var T=u.stateNode.containerInfo;if(T===m)break;if(b===4)for(b=u.return;b!==null;){var M=b.tag;if((M===3||M===4)&&b.stateNode.containerInfo===m)return;b=b.return}for(;T!==null;){if(b=us(T),b===null)return;if(M=b.tag,M===5||M===6||M===26||M===27){u=p=b;continue e}T=T.parentNode}}u=u.return}Si(function(){var Y=p,te=Is(o),ae=[];e:{var X=Jy.get(s);if(X!==void 0){var Z=_r,ve=s;switch(s){case"keypress":if(Va(o)===0)break e;case"keydown":case"keyup":Z=ph;break;case"focusin":ve="focus",Z=Ba;break;case"focusout":ve="blur",Z=Ba;break;case"beforeblur":case"afterblur":Z=Ba;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Z=_c;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Z=oh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Z=_;break;case Qy:case Yy:case Xy:Z=ch;break;case Wy:Z=N;break;case"scroll":case"scrollend":Z=yc;break;case"wheel":Z=J;break;case"copy":case"cut":case"paste":Z=uh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Z=Br;break;case"toggle":case"beforetoggle":Z=Ue}var Ce=(i&4)!==0,_t=!Ce&&(s==="scroll"||s==="scrollend"),$=Ce?X!==null?X+"Capture":null:X;Ce=[];for(var q=Y,Q;q!==null;){var se=q;if(Q=se.stateNode,se=se.tag,se!==5&&se!==26&&se!==27||Q===null||$===null||(se=Ks(q,$),se!=null&&Ce.push(Qc(q,se,Q))),_t)break;q=q.return}0<Ce.length&&(X=new Z(X,ve,null,o,te),ae.push({event:X,listeners:Ce}))}}if((i&7)===0){e:{if(X=s==="mouseover"||s==="pointerover",Z=s==="mouseout"||s==="pointerout",X&&o!==mc&&(ve=o.relatedTarget||o.fromElement)&&(us(ve)||ve[Ns]))break e;if((Z||X)&&(X=te.window===te?te:(X=te.ownerDocument)?X.defaultView||X.parentWindow:window,Z?(ve=o.relatedTarget||o.toElement,Z=Y,ve=ve?us(ve):null,ve!==null&&(_t=l(ve),Ce=ve.tag,ve!==_t||Ce!==5&&Ce!==27&&Ce!==6)&&(ve=null)):(Z=null,ve=Y),Z!==ve)){if(Ce=_c,se="onMouseLeave",$="onMouseEnter",q="mouse",(s==="pointerout"||s==="pointerover")&&(Ce=Br,se="onPointerLeave",$="onPointerEnter",q="pointer"),_t=Z==null?X:qn(Z),Q=ve==null?X:qn(ve),X=new Ce(se,q+"leave",Z,o,te),X.target=_t,X.relatedTarget=Q,se=null,us(te)===Y&&(Ce=new Ce($,q+"enter",ve,o,te),Ce.target=Q,Ce.relatedTarget=_t,se=Ce),_t=se,Z&&ve)t:{for(Ce=kA,$=Z,q=ve,Q=0,se=$;se;se=Ce(se))Q++;se=0;for(var Ne=q;Ne;Ne=Ce(Ne))se++;for(;0<Q-se;)$=Ce($),Q--;for(;0<se-Q;)q=Ce(q),se--;for(;Q--;){if($===q||q!==null&&$===q.alternate){Ce=$;break t}$=Ce($),q=Ce(q)}Ce=null}else Ce=null;Z!==null&&bb(ae,X,Z,Ce,!1),ve!==null&&_t!==null&&bb(ae,_t,ve,Ce,!0)}}e:{if(X=Y?qn(Y):window,Z=X.nodeName&&X.nodeName.toLowerCase(),Z==="select"||Z==="input"&&X.type==="file")var st=Ly;else if(My(X))if(Vy)st=HS;else{st=zS;var we=BS}else Z=X.nodeName,!Z||Z.toLowerCase()!=="input"||X.type!=="checkbox"&&X.type!=="radio"?Y&&Lo(Y.elementType)&&(st=Ly):st=qS;if(st&&(st=st(s,Y))){Py(ae,st,o,te);break e}we&&we(s,X,Y),s==="focusout"&&Y&&X.type==="number"&&Y.memoizedProps.value!=null&&hc(X,"number",X.value)}switch(we=Y?qn(Y):window,s){case"focusin":(My(we)||we.contentEditable==="true")&&(Fo=we,hm=Y,Ec=null);break;case"focusout":Ec=hm=Fo=null;break;case"mousedown":dm=!0;break;case"contextmenu":case"mouseup":case"dragend":dm=!1,Gy(ae,o,te);break;case"selectionchange":if(FS)break;case"keydown":case"keyup":Gy(ae,o,te)}var He;if(it)e:{switch(s){case"compositionstart":var Qe="onCompositionStart";break e;case"compositionend":Qe="onCompositionEnd";break e;case"compositionupdate":Qe="onCompositionUpdate";break e}Qe=void 0}else $o?za(s,o)&&(Qe="onCompositionEnd"):s==="keydown"&&o.keyCode===229&&(Qe="onCompositionStart");Qe&&(wr&&o.locale!=="ko"&&($o||Qe!=="onCompositionStart"?Qe==="onCompositionEnd"&&$o&&(He=pc()):(yr=te,gc="value"in yr?yr.value:yr.textContent,$o=!0)),we=ad(Y,Qe),0<we.length&&(Qe=new br(Qe,s,null,o,te),ae.push({event:Qe,listeners:we}),He?Qe.data=He:(He=Ho(o),He!==null&&(Qe.data=He)))),(He=ks?PS(s,o):LS(s,o))&&(Qe=ad(Y,"onBeforeInput"),0<Qe.length&&(we=new br("onBeforeInput","beforeinput",null,o,te),ae.push({event:we,listeners:Qe}),we.data=He)),RA(ae,s,Y,o,te)}_b(ae,i)})}function Qc(s,i,o){return{instance:s,listener:i,currentTarget:o}}function ad(s,i){for(var o=i+"Capture",u=[];s!==null;){var m=s,p=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||p===null||(m=Ks(s,o),m!=null&&u.unshift(Qc(s,m,p)),m=Ks(s,i),m!=null&&u.push(Qc(s,m,p))),s.tag===3)return u;s=s.return}return[]}function kA(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function bb(s,i,o,u,m){for(var p=i._reactName,b=[];o!==null&&o!==u;){var T=o,M=T.alternate,Y=T.stateNode;if(T=T.tag,M!==null&&M===u)break;T!==5&&T!==26&&T!==27||Y===null||(M=Y,m?(Y=Ks(o,p),Y!=null&&b.unshift(Qc(o,Y,M))):m||(Y=Ks(o,p),Y!=null&&b.push(Qc(o,Y,M)))),o=o.return}b.length!==0&&s.push({event:i,listeners:b})}var OA=/\r\n?/g,DA=/\u0000|\uFFFD/g;function wb(s){return(typeof s=="string"?s:""+s).replace(OA,`
`).replace(DA,"")}function xb(s,i){return i=wb(i),wb(s)===i}function yt(s,i,o,u,m,p){switch(o){case"children":typeof u=="string"?i==="body"||i==="textarea"&&u===""||Xn(s,u):(typeof u=="number"||typeof u=="bigint")&&i!=="body"&&Xn(s,""+u);break;case"className":Ft(s,"class",u);break;case"tabIndex":Ft(s,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Ft(s,o,u);break;case"style":fc(s,u,p);break;case"data":if(i!=="object"){Ft(s,"data",u);break}case"src":case"href":if(u===""&&(i!=="a"||o!=="href")){s.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(o);break}u=Vo(""+u),s.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){s.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(o==="formAction"?(i!=="input"&&yt(s,i,"name",m.name,m,null),yt(s,i,"formEncType",m.formEncType,m,null),yt(s,i,"formMethod",m.formMethod,m,null),yt(s,i,"formTarget",m.formTarget,m,null)):(yt(s,i,"encType",m.encType,m,null),yt(s,i,"method",m.method,m,null),yt(s,i,"target",m.target,m,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){s.removeAttribute(o);break}u=Vo(""+u),s.setAttribute(o,u);break;case"onClick":u!=null&&(s.onclick=Gs);break;case"onScroll":u!=null&&Ge("scroll",s);break;case"onScrollEnd":u!=null&&Ge("scrollend",s);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(r(61));if(o=u.__html,o!=null){if(m.children!=null)throw Error(r(60));s.innerHTML=o}}break;case"multiple":s.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":s.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){s.removeAttribute("xlink:href");break}o=Vo(""+u),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(o,""+u):s.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(o,""):s.removeAttribute(o);break;case"capture":case"download":u===!0?s.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?s.setAttribute(o,u):s.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?s.setAttribute(o,u):s.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?s.removeAttribute(o):s.setAttribute(o,u);break;case"popover":Ge("beforetoggle",s),Ge("toggle",s),Ot(s,"popover",u);break;case"xlinkActuate":Wt(s,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Wt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Wt(s,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Wt(s,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Wt(s,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Wt(s,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Wt(s,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Wt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Wt(s,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Ot(s,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=ah.get(o)||o,Ot(s,o,u))}}function Lg(s,i,o,u,m,p){switch(o){case"style":fc(s,u,p);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(r(61));if(o=u.__html,o!=null){if(m.children!=null)throw Error(r(60));s.innerHTML=o}}break;case"children":typeof u=="string"?Xn(s,u):(typeof u=="number"||typeof u=="bigint")&&Xn(s,""+u);break;case"onScroll":u!=null&&Ge("scroll",s);break;case"onScrollEnd":u!=null&&Ge("scrollend",s);break;case"onClick":u!=null&&(s.onclick=Gs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!O.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),i=o.slice(2,m?o.length-7:void 0),p=s[Xt]||null,p=p!=null?p[o]:null,typeof p=="function"&&s.removeEventListener(i,p,m),typeof u=="function")){typeof p!="function"&&p!==null&&(o in s?s[o]=null:s.hasAttribute(o)&&s.removeAttribute(o)),s.addEventListener(i,u,m);break e}o in s?s[o]=u:u===!0?s.setAttribute(o,""):Ot(s,o,u)}}}function Sn(s,i,o){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ge("error",s),Ge("load",s);var u=!1,m=!1,p;for(p in o)if(o.hasOwnProperty(p)){var b=o[p];if(b!=null)switch(p){case"src":u=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:yt(s,i,p,b,o,null)}}m&&yt(s,i,"srcSet",o.srcSet,o,null),u&&yt(s,i,"src",o.src,o,null);return;case"input":Ge("invalid",s);var T=p=b=m=null,M=null,Y=null;for(u in o)if(o.hasOwnProperty(u)){var te=o[u];if(te!=null)switch(u){case"name":m=te;break;case"type":b=te;break;case"checked":M=te;break;case"defaultChecked":Y=te;break;case"value":p=te;break;case"defaultValue":T=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(r(137,i));break;default:yt(s,i,u,te,o,null)}}sh(s,p,T,M,Y,b,m,!1);return;case"select":Ge("invalid",s),u=b=p=null;for(m in o)if(o.hasOwnProperty(m)&&(T=o[m],T!=null))switch(m){case"value":p=T;break;case"defaultValue":b=T;break;case"multiple":u=T;default:yt(s,i,m,T,o,null)}i=p,o=b,s.multiple=!!u,i!=null?wi(s,!!u,i,!1):o!=null&&wi(s,!!u,o,!0);return;case"textarea":Ge("invalid",s),p=m=u=null;for(b in o)if(o.hasOwnProperty(b)&&(T=o[b],T!=null))switch(b){case"value":u=T;break;case"defaultValue":m=T;break;case"children":p=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(r(91));break;default:yt(s,i,b,T,o,null)}xi(s,u,m,p);return;case"option":for(M in o)if(o.hasOwnProperty(M)&&(u=o[M],u!=null))switch(M){case"selected":s.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:yt(s,i,M,u,o,null)}return;case"dialog":Ge("beforetoggle",s),Ge("toggle",s),Ge("cancel",s),Ge("close",s);break;case"iframe":case"object":Ge("load",s);break;case"video":case"audio":for(u=0;u<Kc.length;u++)Ge(Kc[u],s);break;case"image":Ge("error",s),Ge("load",s);break;case"details":Ge("toggle",s);break;case"embed":case"source":case"link":Ge("error",s),Ge("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Y in o)if(o.hasOwnProperty(Y)&&(u=o[Y],u!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:yt(s,i,Y,u,o,null)}return;default:if(Lo(i)){for(te in o)o.hasOwnProperty(te)&&(u=o[te],u!==void 0&&Lg(s,i,te,u,o,void 0));return}}for(T in o)o.hasOwnProperty(T)&&(u=o[T],u!=null&&yt(s,i,T,u,o,null))}function MA(s,i,o,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,p=null,b=null,T=null,M=null,Y=null,te=null;for(Z in o){var ae=o[Z];if(o.hasOwnProperty(Z)&&ae!=null)switch(Z){case"checked":break;case"value":break;case"defaultValue":M=ae;default:u.hasOwnProperty(Z)||yt(s,i,Z,null,u,ae)}}for(var X in u){var Z=u[X];if(ae=o[X],u.hasOwnProperty(X)&&(Z!=null||ae!=null))switch(X){case"type":p=Z;break;case"name":m=Z;break;case"checked":Y=Z;break;case"defaultChecked":te=Z;break;case"value":b=Z;break;case"defaultValue":T=Z;break;case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(r(137,i));break;default:Z!==ae&&yt(s,i,X,Z,u,ae)}}Po(s,b,T,M,Y,te,p,m);return;case"select":Z=b=T=X=null;for(p in o)if(M=o[p],o.hasOwnProperty(p)&&M!=null)switch(p){case"value":break;case"multiple":Z=M;default:u.hasOwnProperty(p)||yt(s,i,p,null,u,M)}for(m in u)if(p=u[m],M=o[m],u.hasOwnProperty(m)&&(p!=null||M!=null))switch(m){case"value":X=p;break;case"defaultValue":T=p;break;case"multiple":b=p;default:p!==M&&yt(s,i,m,p,u,M)}i=T,o=b,u=Z,X!=null?wi(s,!!o,X,!1):!!u!=!!o&&(i!=null?wi(s,!!o,i,!0):wi(s,!!o,o?[]:"",!1));return;case"textarea":Z=X=null;for(T in o)if(m=o[T],o.hasOwnProperty(T)&&m!=null&&!u.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:yt(s,i,T,null,u,m)}for(b in u)if(m=u[b],p=o[b],u.hasOwnProperty(b)&&(m!=null||p!=null))switch(b){case"value":X=m;break;case"defaultValue":Z=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(r(91));break;default:m!==p&&yt(s,i,b,m,u,p)}rh(s,X,Z);return;case"option":for(var ve in o)if(X=o[ve],o.hasOwnProperty(ve)&&X!=null&&!u.hasOwnProperty(ve))switch(ve){case"selected":s.selected=!1;break;default:yt(s,i,ve,null,u,X)}for(M in u)if(X=u[M],Z=o[M],u.hasOwnProperty(M)&&X!==Z&&(X!=null||Z!=null))switch(M){case"selected":s.selected=X&&typeof X!="function"&&typeof X!="symbol";break;default:yt(s,i,M,X,u,Z)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ce in o)X=o[Ce],o.hasOwnProperty(Ce)&&X!=null&&!u.hasOwnProperty(Ce)&&yt(s,i,Ce,null,u,X);for(Y in u)if(X=u[Y],Z=o[Y],u.hasOwnProperty(Y)&&X!==Z&&(X!=null||Z!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(r(137,i));break;default:yt(s,i,Y,X,u,Z)}return;default:if(Lo(i)){for(var _t in o)X=o[_t],o.hasOwnProperty(_t)&&X!==void 0&&!u.hasOwnProperty(_t)&&Lg(s,i,_t,void 0,u,X);for(te in u)X=u[te],Z=o[te],!u.hasOwnProperty(te)||X===Z||X===void 0&&Z===void 0||Lg(s,i,te,X,u,Z);return}}for(var $ in o)X=o[$],o.hasOwnProperty($)&&X!=null&&!u.hasOwnProperty($)&&yt(s,i,$,null,u,X);for(ae in u)X=u[ae],Z=o[ae],!u.hasOwnProperty(ae)||X===Z||X==null&&Z==null||yt(s,i,ae,X,u,Z)}function Eb(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function PA(){if(typeof performance.getEntriesByType=="function"){for(var s=0,i=0,o=performance.getEntriesByType("resource"),u=0;u<o.length;u++){var m=o[u],p=m.transferSize,b=m.initiatorType,T=m.duration;if(p&&T&&Eb(b)){for(b=0,T=m.responseEnd,u+=1;u<o.length;u++){var M=o[u],Y=M.startTime;if(Y>T)break;var te=M.transferSize,ae=M.initiatorType;te&&Eb(ae)&&(M=M.responseEnd,b+=te*(M<T?1:(T-Y)/(M-Y)))}if(--u,i+=8*(p+b)/(m.duration/1e3),s++,10<s)break}}if(0<s)return i/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Vg=null,Ug=null;function od(s){return s.nodeType===9?s:s.ownerDocument}function Tb(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Sb(s,i){if(s===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&i==="foreignObject"?0:s}function Bg(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var zg=null;function LA(){var s=window.event;return s&&s.type==="popstate"?s===zg?!1:(zg=s,!0):(zg=null,!1)}var Ab=typeof setTimeout=="function"?setTimeout:void 0,VA=typeof clearTimeout=="function"?clearTimeout:void 0,Nb=typeof Promise=="function"?Promise:void 0,UA=typeof queueMicrotask=="function"?queueMicrotask:typeof Nb<"u"?function(s){return Nb.resolve(null).then(s).catch(BA)}:Ab;function BA(s){setTimeout(function(){throw s})}function Fi(s){return s==="head"}function Rb(s,i){var o=i,u=0;do{var m=o.nextSibling;if(s.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(u===0){s.removeChild(m),_l(i);return}u--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")u++;else if(o==="html")Yc(s.ownerDocument.documentElement);else if(o==="head"){o=s.ownerDocument.head,Yc(o);for(var p=o.firstChild;p;){var b=p.nextSibling,T=p.nodeName;p[Rs]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&p.rel.toLowerCase()==="stylesheet"||o.removeChild(p),p=b}}else o==="body"&&Yc(s.ownerDocument.body);o=m}while(o);_l(i)}function Cb(s,i){var o=s;s=0;do{var u=o.nextSibling;if(o.nodeType===1?i?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(i?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),u&&u.nodeType===8)if(o=u.data,o==="/$"){if(s===0)break;s--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||s++;o=u}while(o)}function qg(s){var i=s.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var o=i;switch(i=i.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":qg(o),_i(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}s.removeChild(o)}}function zA(s,i,o,u){for(;s.nodeType===1;){var m=o;if(s.nodeName.toLowerCase()!==i.toLowerCase()){if(!u&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(u){if(!s[Rs])switch(i){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(p=s.getAttribute("rel"),p==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(p!==m.rel||s.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||s.getAttribute("title")!==(m.title==null?null:m.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(p=s.getAttribute("src"),(p!==(m.src==null?null:m.src)||s.getAttribute("type")!==(m.type==null?null:m.type)||s.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&p&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(i==="input"&&s.type==="hidden"){var p=m.name==null?null:""+m.name;if(m.type==="hidden"&&s.getAttribute("name")===p)return s}else return s;if(s=Us(s.nextSibling),s===null)break}return null}function qA(s,i,o){if(i==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=Us(s.nextSibling),s===null))return null;return s}function Ib(s,i){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!i||(s=Us(s.nextSibling),s===null))return null;return s}function Hg(s){return s.data==="$?"||s.data==="$~"}function $g(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function HA(s,i){var o=s.ownerDocument;if(s.data==="$~")s._reactRetry=i;else if(s.data!=="$?"||o.readyState!=="loading")i();else{var u=function(){i(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),s._reactRetry=u}}function Us(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return s}var Fg=null;function jb(s){s=s.nextSibling;for(var i=0;s;){if(s.nodeType===8){var o=s.data;if(o==="/$"||o==="/&"){if(i===0)return Us(s.nextSibling);i--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||i++}s=s.nextSibling}return null}function kb(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var o=s.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(i===0)return s;i--}else o!=="/$"&&o!=="/&"||i++}s=s.previousSibling}return null}function Ob(s,i,o){switch(i=od(o),s){case"html":if(s=i.documentElement,!s)throw Error(r(452));return s;case"head":if(s=i.head,!s)throw Error(r(453));return s;case"body":if(s=i.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Yc(s){for(var i=s.attributes;i.length;)s.removeAttributeNode(i[0]);_i(s)}var Bs=new Map,Db=new Set;function ld(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ti=le.d;le.d={f:$A,r:FA,D:GA,C:KA,L:QA,m:YA,X:WA,S:XA,M:JA};function $A(){var s=ti.f(),i=Zh();return s||i}function FA(s){var i=jn(s);i!==null&&i.tag===5&&i.type==="form"?W_(i):ti.r(s)}var gl=typeof document>"u"?null:document;function Mb(s,i,o){var u=gl;if(u&&typeof i=="string"&&i){var m=Yn(i);m='link[rel="'+s+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),Db.has(m)||(Db.add(m),s={rel:s,crossOrigin:o,href:i},u.querySelector(m)===null&&(i=u.createElement("link"),Sn(i,"link",s),kt(i),u.head.appendChild(i)))}}function GA(s){ti.D(s),Mb("dns-prefetch",s,null)}function KA(s,i){ti.C(s,i),Mb("preconnect",s,i)}function QA(s,i,o){ti.L(s,i,o);var u=gl;if(u&&s&&i){var m='link[rel="preload"][as="'+Yn(i)+'"]';i==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+Yn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+Yn(o.imageSizes)+'"]')):m+='[href="'+Yn(s)+'"]';var p=m;switch(i){case"style":p=pl(s);break;case"script":p=yl(s)}Bs.has(p)||(s=w({rel:"preload",href:i==="image"&&o&&o.imageSrcSet?void 0:s,as:i},o),Bs.set(p,s),u.querySelector(m)!==null||i==="style"&&u.querySelector(Xc(p))||i==="script"&&u.querySelector(Wc(p))||(i=u.createElement("link"),Sn(i,"link",s),kt(i),u.head.appendChild(i)))}}function YA(s,i){ti.m(s,i);var o=gl;if(o&&s){var u=i&&typeof i.as=="string"?i.as:"script",m='link[rel="modulepreload"][as="'+Yn(u)+'"][href="'+Yn(s)+'"]',p=m;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=yl(s)}if(!Bs.has(p)&&(s=w({rel:"modulepreload",href:s},i),Bs.set(p,s),o.querySelector(m)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Wc(p)))return}u=o.createElement("link"),Sn(u,"link",s),kt(u),o.head.appendChild(u)}}}function XA(s,i,o){ti.S(s,i,o);var u=gl;if(u&&s){var m=Cs(u).hoistableStyles,p=pl(s);i=i||"default";var b=m.get(p);if(!b){var T={loading:0,preload:null};if(b=u.querySelector(Xc(p)))T.loading=5;else{s=w({rel:"stylesheet",href:s,"data-precedence":i},o),(o=Bs.get(p))&&Gg(s,o);var M=b=u.createElement("link");kt(M),Sn(M,"link",s),M._p=new Promise(function(Y,te){M.onload=Y,M.onerror=te}),M.addEventListener("load",function(){T.loading|=1}),M.addEventListener("error",function(){T.loading|=2}),T.loading|=4,cd(b,i,u)}b={type:"stylesheet",instance:b,count:1,state:T},m.set(p,b)}}}function WA(s,i){ti.X(s,i);var o=gl;if(o&&s){var u=Cs(o).hoistableScripts,m=yl(s),p=u.get(m);p||(p=o.querySelector(Wc(m)),p||(s=w({src:s,async:!0},i),(i=Bs.get(m))&&Kg(s,i),p=o.createElement("script"),kt(p),Sn(p,"link",s),o.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(m,p))}}function JA(s,i){ti.M(s,i);var o=gl;if(o&&s){var u=Cs(o).hoistableScripts,m=yl(s),p=u.get(m);p||(p=o.querySelector(Wc(m)),p||(s=w({src:s,async:!0,type:"module"},i),(i=Bs.get(m))&&Kg(s,i),p=o.createElement("script"),kt(p),Sn(p,"link",s),o.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},u.set(m,p))}}function Pb(s,i,o,u){var m=(m=Te.current)?ld(m):null;if(!m)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(i=pl(o.href),o=Cs(m).hoistableStyles,u=o.get(i),u||(u={type:"style",instance:null,count:0,state:null},o.set(i,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){s=pl(o.href);var p=Cs(m).hoistableStyles,b=p.get(s);if(b||(m=m.ownerDocument||m,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(s,b),(p=m.querySelector(Xc(s)))&&!p._p&&(b.instance=p,b.state.loading=5),Bs.has(s)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Bs.set(s,o),p||ZA(m,s,o,b.state))),i&&u===null)throw Error(r(528,""));return b}if(i&&u!==null)throw Error(r(529,""));return null;case"script":return i=o.async,o=o.src,typeof o=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=yl(o),o=Cs(m).hoistableScripts,u=o.get(i),u||(u={type:"script",instance:null,count:0,state:null},o.set(i,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function pl(s){return'href="'+Yn(s)+'"'}function Xc(s){return'link[rel="stylesheet"]['+s+"]"}function Lb(s){return w({},s,{"data-precedence":s.precedence,precedence:null})}function ZA(s,i,o,u){s.querySelector('link[rel="preload"][as="style"]['+i+"]")?u.loading=1:(i=s.createElement("link"),u.preload=i,i.addEventListener("load",function(){return u.loading|=1}),i.addEventListener("error",function(){return u.loading|=2}),Sn(i,"link",o),kt(i),s.head.appendChild(i))}function yl(s){return'[src="'+Yn(s)+'"]'}function Wc(s){return"script[async]"+s}function Vb(s,i,o){if(i.count++,i.instance===null)switch(i.type){case"style":var u=s.querySelector('style[data-href~="'+Yn(o.href)+'"]');if(u)return i.instance=u,kt(u),u;var m=w({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(s.ownerDocument||s).createElement("style"),kt(u),Sn(u,"style",m),cd(u,o.precedence,s),i.instance=u;case"stylesheet":m=pl(o.href);var p=s.querySelector(Xc(m));if(p)return i.state.loading|=4,i.instance=p,kt(p),p;u=Lb(o),(m=Bs.get(m))&&Gg(u,m),p=(s.ownerDocument||s).createElement("link"),kt(p);var b=p;return b._p=new Promise(function(T,M){b.onload=T,b.onerror=M}),Sn(p,"link",u),i.state.loading|=4,cd(p,o.precedence,s),i.instance=p;case"script":return p=yl(o.src),(m=s.querySelector(Wc(p)))?(i.instance=m,kt(m),m):(u=o,(m=Bs.get(p))&&(u=w({},o),Kg(u,m)),s=s.ownerDocument||s,m=s.createElement("script"),kt(m),Sn(m,"link",u),s.head.appendChild(m),i.instance=m);case"void":return null;default:throw Error(r(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(u=i.instance,i.state.loading|=4,cd(u,o.precedence,s));return i.instance}function cd(s,i,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=u.length?u[u.length-1]:null,p=m,b=0;b<u.length;b++){var T=u[b];if(T.dataset.precedence===i)p=T;else if(p!==m)break}p?p.parentNode.insertBefore(s,p.nextSibling):(i=o.nodeType===9?o.head:o,i.insertBefore(s,i.firstChild))}function Gg(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.title==null&&(s.title=i.title)}function Kg(s,i){s.crossOrigin==null&&(s.crossOrigin=i.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=i.referrerPolicy),s.integrity==null&&(s.integrity=i.integrity)}var ud=null;function Ub(s,i,o){if(ud===null){var u=new Map,m=ud=new Map;m.set(o,u)}else m=ud,u=m.get(o),u||(u=new Map,m.set(o,u));if(u.has(s))return u;for(u.set(s,null),o=o.getElementsByTagName(s),m=0;m<o.length;m++){var p=o[m];if(!(p[Rs]||p[Ut]||s==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var b=p.getAttribute(i)||"";b=s+b;var T=u.get(b);T?T.push(p):u.set(b,[p])}}return u}function Bb(s,i,o){s=s.ownerDocument||s,s.head.insertBefore(o,i==="title"?s.querySelector("head > title"):null)}function eN(s,i,o){if(o===1||i.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return s=i.disabled,typeof i.precedence=="string"&&s==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function zb(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function tN(s,i,o,u){if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=pl(u.href),p=i.querySelector(Xc(m));if(p){i=p._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(s.count++,s=hd.bind(s),i.then(s,s)),o.state.loading|=4,o.instance=p,kt(p);return}p=i.ownerDocument||i,u=Lb(u),(m=Bs.get(m))&&Gg(u,m),p=p.createElement("link"),kt(p);var b=p;b._p=new Promise(function(T,M){b.onload=T,b.onerror=M}),Sn(p,"link",u),o.instance=p}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(s.count++,o=hd.bind(s),i.addEventListener("load",o),i.addEventListener("error",o))}}var Qg=0;function nN(s,i){return s.stylesheets&&s.count===0&&fd(s,s.stylesheets),0<s.count||0<s.imgCount?function(o){var u=setTimeout(function(){if(s.stylesheets&&fd(s,s.stylesheets),s.unsuspend){var p=s.unsuspend;s.unsuspend=null,p()}},6e4+i);0<s.imgBytes&&Qg===0&&(Qg=62500*PA());var m=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&fd(s,s.stylesheets),s.unsuspend)){var p=s.unsuspend;s.unsuspend=null,p()}},(s.imgBytes>Qg?50:800)+i);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(u),clearTimeout(m)}}:null}function hd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)fd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var dd=null;function fd(s,i){s.stylesheets=null,s.unsuspend!==null&&(s.count++,dd=new Map,i.forEach(sN,s),dd=null,hd.call(s))}function sN(s,i){if(!(i.state.loading&4)){var o=dd.get(s);if(o)var u=o.get(null);else{o=new Map,dd.set(s,o);for(var m=s.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<m.length;p++){var b=m[p];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(o.set(b.dataset.precedence,b),u=b)}u&&o.set(null,u)}m=i.instance,b=m.getAttribute("data-precedence"),p=o.get(b)||u,p===u&&o.set(null,m),o.set(b,m),this.count++,u=hd.bind(this),m.addEventListener("load",u),m.addEventListener("error",u),p?p.parentNode.insertBefore(m,p.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(m,s.firstChild)),i.state.loading|=4}}var Jc={$$typeof:B,Provider:null,Consumer:null,_currentValue:_e,_currentValue2:_e,_threadCount:0};function rN(s,i,o,u,m,p,b,T,M){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=zn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zn(0),this.hiddenUpdates=zn(null),this.identifierPrefix=u,this.onUncaughtError=m,this.onCaughtError=p,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=M,this.incompleteTransitions=new Map}function qb(s,i,o,u,m,p,b,T,M,Y,te,ae){return s=new rN(s,i,o,b,M,Y,te,ae,T),i=1,p===!0&&(i|=24),p=ds(3,null,null,i),s.current=p,p.stateNode=s,i=Nm(),i.refCount++,s.pooledCache=i,i.refCount++,p.memoizedState={element:u,isDehydrated:o,cache:i},jm(p),s}function Hb(s){return s?(s=Qo,s):Qo}function $b(s,i,o,u,m,p){m=Hb(m),u.context===null?u.context=m:u.pendingContext=m,u=Di(i),u.payload={element:o},p=p===void 0?null:p,p!==null&&(u.callback=p),o=Mi(s,u,i),o!==null&&(ts(o,s,i),Ic(o,s,i))}function Fb(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var o=s.retryLane;s.retryLane=o!==0&&o<i?o:i}}function Yg(s,i){Fb(s,i),(s=s.alternate)&&Fb(s,i)}function Gb(s){if(s.tag===13||s.tag===31){var i=$a(s,67108864);i!==null&&ts(i,s,67108864),Yg(s,67108864)}}function Kb(s){if(s.tag===13||s.tag===31){var i=ys();i=mr(i);var o=$a(s,i);o!==null&&ts(o,s,i),Yg(s,i)}}var md=!0;function iN(s,i,o,u){var m=V.T;V.T=null;var p=le.p;try{le.p=2,Xg(s,i,o,u)}finally{le.p=p,V.T=m}}function aN(s,i,o,u){var m=V.T;V.T=null;var p=le.p;try{le.p=8,Xg(s,i,o,u)}finally{le.p=p,V.T=m}}function Xg(s,i,o,u){if(md){var m=Wg(u);if(m===null)Pg(s,i,u,gd,o),Yb(s,u);else if(lN(m,s,i,o,u))u.stopPropagation();else if(Yb(s,u),i&4&&-1<oN.indexOf(s)){for(;m!==null;){var p=jn(m);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var b=Qn(p.pendingLanes);if(b!==0){var T=p;for(T.pendingLanes|=2,T.entangledLanes|=2;b;){var M=1<<31-At(b);T.entanglements[1]|=M,b&=~M}Sr(p),(at&6)===0&&(Wh=bn()+500,Gc(0))}}break;case 31:case 13:T=$a(p,2),T!==null&&ts(T,p,2),Zh(),Yg(p,2)}if(p=Wg(u),p===null&&Pg(s,i,u,gd,o),p===m)break;m=p}m!==null&&u.stopPropagation()}else Pg(s,i,u,null,o)}}function Wg(s){return s=Is(s),Jg(s)}var gd=null;function Jg(s){if(gd=null,s=us(s),s!==null){var i=l(s);if(i===null)s=null;else{var o=i.tag;if(o===13){if(s=c(i),s!==null)return s;s=null}else if(o===31){if(s=f(i),s!==null)return s;s=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null)}}return gd=s,null}function Qb(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(As()){case Hs:return 2;case Na:return 8;case $s:case ko:return 32;case Ra:return 268435456;default:return 32}default:return 32}}var Zg=!1,Gi=null,Ki=null,Qi=null,Zc=new Map,eu=new Map,Yi=[],oN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Yb(s,i){switch(s){case"focusin":case"focusout":Gi=null;break;case"dragenter":case"dragleave":Ki=null;break;case"mouseover":case"mouseout":Qi=null;break;case"pointerover":case"pointerout":Zc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":eu.delete(i.pointerId)}}function tu(s,i,o,u,m,p){return s===null||s.nativeEvent!==p?(s={blockedOn:i,domEventName:o,eventSystemFlags:u,nativeEvent:p,targetContainers:[m]},i!==null&&(i=jn(i),i!==null&&Gb(i)),s):(s.eventSystemFlags|=u,i=s.targetContainers,m!==null&&i.indexOf(m)===-1&&i.push(m),s)}function lN(s,i,o,u,m){switch(i){case"focusin":return Gi=tu(Gi,s,i,o,u,m),!0;case"dragenter":return Ki=tu(Ki,s,i,o,u,m),!0;case"mouseover":return Qi=tu(Qi,s,i,o,u,m),!0;case"pointerover":var p=m.pointerId;return Zc.set(p,tu(Zc.get(p)||null,s,i,o,u,m)),!0;case"gotpointercapture":return p=m.pointerId,eu.set(p,tu(eu.get(p)||null,s,i,o,u,m)),!0}return!1}function Xb(s){var i=us(s.target);if(i!==null){var o=l(i);if(o!==null){if(i=o.tag,i===13){if(i=c(o),i!==null){s.blockedOn=i,ls(s.priority,function(){Kb(o)});return}}else if(i===31){if(i=f(o),i!==null){s.blockedOn=i,ls(s.priority,function(){Kb(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){s.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}s.blockedOn=null}function pd(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var o=Wg(s.nativeEvent);if(o===null){o=s.nativeEvent;var u=new o.constructor(o.type,o);mc=u,o.target.dispatchEvent(u),mc=null}else return i=jn(o),i!==null&&Gb(i),s.blockedOn=o,!1;i.shift()}return!0}function Wb(s,i,o){pd(s)&&o.delete(i)}function cN(){Zg=!1,Gi!==null&&pd(Gi)&&(Gi=null),Ki!==null&&pd(Ki)&&(Ki=null),Qi!==null&&pd(Qi)&&(Qi=null),Zc.forEach(Wb),eu.forEach(Wb)}function yd(s,i){s.blockedOn===i&&(s.blockedOn=null,Zg||(Zg=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,cN)))}var _d=null;function Jb(s){_d!==s&&(_d=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){_d===s&&(_d=null);for(var i=0;i<s.length;i+=3){var o=s[i],u=s[i+1],m=s[i+2];if(typeof u!="function"){if(Jg(u||o)===null)continue;break}var p=jn(o);p!==null&&(s.splice(i,3),i-=3,Wm(p,{pending:!0,data:m,method:o.method,action:u},u,m))}}))}function _l(s){function i(M){return yd(M,s)}Gi!==null&&yd(Gi,s),Ki!==null&&yd(Ki,s),Qi!==null&&yd(Qi,s),Zc.forEach(i),eu.forEach(i);for(var o=0;o<Yi.length;o++){var u=Yi[o];u.blockedOn===s&&(u.blockedOn=null)}for(;0<Yi.length&&(o=Yi[0],o.blockedOn===null);)Xb(o),o.blockedOn===null&&Yi.shift();if(o=(s.ownerDocument||s).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var m=o[u],p=o[u+1],b=m[Xt]||null;if(typeof p=="function")b||Jb(o);else if(b){var T=null;if(p&&p.hasAttribute("formAction")){if(m=p,b=p[Xt]||null)T=b.formAction;else if(Jg(m)!==null)continue}else T=b.action;typeof T=="function"?o[u+1]=T:(o.splice(u,3),u-=3),Jb(o)}}}function Zb(){function s(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(b){return m=b})},focusReset:"manual",scroll:"manual"})}function i(){m!==null&&(m(),m=null),u||setTimeout(o,20)}function o(){if(!u&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,m=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(o,100),function(){u=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),m!==null&&(m(),m=null)}}}function ep(s){this._internalRoot=s}vd.prototype.render=ep.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(r(409));var o=i.current,u=ys();$b(o,u,s,i,null,null)},vd.prototype.unmount=ep.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;$b(s.current,2,null,s,null,null),Zh(),i[Ns]=null}};function vd(s){this._internalRoot=s}vd.prototype.unstable_scheduleHydration=function(s){if(s){var i=Oo();s={blockedOn:null,target:s,priority:i};for(var o=0;o<Yi.length&&i!==0&&i<Yi[o].priority;o++);Yi.splice(o,0,s),o===0&&Xb(s)}};var e1=e.version;if(e1!=="19.2.0")throw Error(r(527,e1,"19.2.0"));le.findDOMNode=function(s){var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=y(i),s=s!==null?v(s):null,s=s===null?null:s.stateNode,s};var uN={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bd.isDisabled&&bd.supportsFiber)try{is=bd.inject(uN),$t=bd}catch{}}return su.createRoot=function(s,i){if(!a(s))throw Error(r(299));var o=!1,u="",m=ov,p=lv,b=cv;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(u=i.identifierPrefix),i.onUncaughtError!==void 0&&(m=i.onUncaughtError),i.onCaughtError!==void 0&&(p=i.onCaughtError),i.onRecoverableError!==void 0&&(b=i.onRecoverableError)),i=qb(s,1,!1,null,null,o,u,null,m,p,b,Zb),s[Ns]=i.current,Mg(s),new ep(i)},su.hydrateRoot=function(s,i,o){if(!a(s))throw Error(r(299));var u=!1,m="",p=ov,b=lv,T=cv,M=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(p=o.onUncaughtError),o.onCaughtError!==void 0&&(b=o.onCaughtError),o.onRecoverableError!==void 0&&(T=o.onRecoverableError),o.formState!==void 0&&(M=o.formState)),i=qb(s,1,!0,i,o??null,u,m,M,p,b,T,Zb),i.context=Hb(null),o=i.current,u=ys(),u=mr(u),m=Di(u),m.callback=null,Mi(o,m,u),o=u,i.current.lanes=o,hr(i,o),Sr(i),s[Ns]=i.current,Mg(s),new vd(i)},su.version="19.2.0",su}var u1;function xN(){if(u1)return sp.exports;u1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),sp.exports=wN(),sp.exports}var EN=xN();const TN=w0(EN),SN="modulepreload",AN=function(n){return"/ontap/"+n},h1={},Mn=function(e,t,r){let a=Promise.resolve();if(t&&t.length>0){let c=function(y){return Promise.all(y.map(v=>Promise.resolve(v).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),g=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));a=c(t.map(y=>{if(y=AN(y),y in h1)return;h1[y]=!0;const v=y.endsWith(".css"),w=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${w}`))return;const E=document.createElement("link");if(E.rel=v?"stylesheet":SN,v||(E.as="script"),E.crossOrigin="",E.href=y,g&&E.setAttribute("nonce",g),document.head.appendChild(E),v)return new Promise((S,j)=>{E.addEventListener("load",S),E.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${y}`)))})}))}function l(c){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=c,window.dispatchEvent(f),!f.defaultPrevented)throw c}return a.then(c=>{for(const f of c||[])f.status==="rejected"&&l(f.reason);return e().catch(l)})},jx=K.createContext(void 0),kx=({children:n})=>{const[e,t]=K.useState("light");K.useEffect(()=>{let l=localStorage.getItem("theme");(!l||l==="noel")&&(l="light",localStorage.setItem("theme","light")),t(l),document.documentElement.setAttribute("data-theme",l)},[]);const r=a=>{t(a),document.documentElement.setAttribute("data-theme",a),localStorage.setItem("theme",a)};return h.jsx(jx.Provider,{value:{theme:e,setTheme:r},children:n})},Bn=()=>{const n=K.useContext(jx);if(n===void 0)throw new Error("useTheme must be used within a ThemeProvider");return n},NN=n=>h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm.25 4.5a.75.75 0 00-1.5 0v5.337a2.25 2.25 0 00-1.5 2.063v.75a.75.75 0 001.5 0v-.75a.75.75 0 01.75-.75h.75a.75.75 0 01.75.75v.75a.75.75 0 001.5 0v-.75a2.25 2.25 0 00-1.5-2.063V6.75z"}),h.jsx("path",{d:"M6.163 15.25a.75.75 0 011.06-1.06l1.25 1.25a.75.75 0 01-1.06 1.06l-1.25-1.25zm10.617 0a.75.75 0 011.06 1.06l-1.25 1.25a.75.75 0 01-1.06 1.06l1.25-1.25z"})]}),E0=n=>{const{theme:e}=Bn();return e==="noel"?h.jsx("img",{src:"/assets/img/ball.png",alt:"Check",...n,className:`${n.className} object-contain`}):h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:h.jsx("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z",clipRule:"evenodd"})})},T0=n=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:h.jsx("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-1.72 6.97a.75.75 0 10-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 101.06 1.06L12 13.06l1.72 1.72a.75.75 0 101.06-1.06L13.06 12l1.72-1.72a.75.75 0 10-1.06-1.06L12 10.94l-1.72-1.72z",clipRule:"evenodd"})}),Jl=n=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:h.jsx("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-4.28 9.22a.75.75 0 000 1.06l3 3a.75.75 0 101.06-1.06L10.81 12l1.47-1.47a.75.75 0 10-1.06-1.06l-3 3z",clipRule:"evenodd"})}),RN=n=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:h.jsx("path",{fillRule:"evenodd",d:"M16.28 11.47a.75.75 0 010 1.06l-3 3a.75.75 0 01-1.06-1.06L14.44 12l-2.22-2.22a.75.75 0 011.06-1.06l3 3z",clipRule:"evenodd"})}),CN=n=>{const{theme:e}=Bn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/J0JwWn5p/Mattahan-Buuf-One-of-those-ugly-pens-you-just-find-lying-around-128.png",alt:"Pen Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/celebrate.png",alt:"Santa",...n,className:`${n.className} object-contain`}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{d:"M12.75 12.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0z"}),h.jsx("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zM9 12a3 3 0 116 0 3 3 0 01-6 0zm-2.121 4.212a.75.75 0 01.688-1.228 5.253 5.253 0 018.866 0 .75.75 0 11-.688 1.228 3.753 3.753 0 00-7.49 0z",clipRule:"evenodd"})]})},IN=n=>h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:h.jsx("path",{fillRule:"evenodd",d:"M4.755 10.059a7.5 7.5 0 0112.548-3.364l1.903 1.903h-4.5a.75.75 0 000 1.5h6a.75.75 0 00.75-.75V4.5a.75.75 0 00-1.5 0v2.253a9 9 0 00-15.06 4.042.75.75 0 00.75.75h1.5a.75.75 0 00.75-.75zM19.245 13.941a7.5 7.5 0 01-12.548 3.364l-1.903-1.903h4.5a.75.75 0 000-1.5h-6a.75.75 0 00-.75.75v6a.75.75 0 001.5 0v-2.253a9 9 0 0015.06-4.042.75.75 0 00-.75-.75h-1.5a.75.75 0 00-.75.75z",clipRule:"evenodd"})}),ql=n=>{const{theme:e}=Bn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/xjbVmxDW/Oxygen-Icons-org-Oxygen-Categories-applications-education-university-256.png",alt:"Graduation Cap Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/home.png",alt:"Home Icon",...n,className:`${n.className} object-contain`}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{d:"M12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2zm0 2a8 8 0 100 16 8 8 0 000-16zm0 3a5 5 0 110 10 5 5 0 010-10zm0 2a3 3 0 100 6 3 3 0 000-6z"}),h.jsx("path",{d:"M12 3v2m0 14v2M3 12h2m14 0h-2m-8-8L6.414 5.414m11.172 11.172L16.243 15.12m0-9.706l-1.121 1.121M5.414 17.586L6.536 16.464"})]})},kp=n=>{const{theme:e}=Bn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/66GxZjxN/school-114359.png",alt:"School Bag Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/bell.png",alt:"Bell Icon",...n,className:`${n.className} object-contain`}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{d:"M12 2a1 1 0 011 1v7.683a4.502 4.502 0 012.722 2.054 3 3 0 01-1.33 3.963 3.003 3.003 0 01-4.783-3.963A4.502 4.502 0 0111 10.683V3a1 1 0 011-1zm-3.5 10a1.5 1.5 0 100 3 1.5 1.5 0 000-3zm7 0a1.5 1.5 0 100 3 1.5 1.5 0 000-3z"}),h.jsx("path",{d:"M12 22a8.956 8.956 0 01-6-2.583V18h12v1.417A8.956 8.956 0 0112 22z"})]})},jN=n=>{const{theme:e}=Bn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/h47RmyWN/Mattahan-Buuf-They-reply-technosorcery-128.png",alt:"Wrench Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/gift4.png",alt:"Gift Icon",...n,className:`${n.className} object-contain`}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{fillRule:"evenodd",d:"M9.528 1.718a.75.75 0 01.162.819A8.97 8.97 0 009 6a9 9 0 009 9 8.97 8.97 0 003.463-.69.75.75 0 01.981.981A10.503 10.503 0 0112 21a10.5 10.5 0 01-10.5-10.5c0-4.368 2.667-8.162 6.43-9.742a.75.75 0 01.819.162z",clipRule:"evenodd"}),h.jsx("path",{d:"M12.75 9a.75.75 0 00-1.5 0v2.25H9a.75.75 0 000 1.5h2.25V15a.75.75 0 001.5 0v-2.25H15a.75.75 0 000-1.5h-2.25V9z"})]})},kN=n=>{const{theme:e}=Bn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/zvWm1BFk/book-512x512-35977.png",alt:"Book Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/hat.png",alt:"Hat Icon",...n,className:`${n.className} object-contain`}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{d:"M12 2L3 8v2h18V8l-9-6zm-1.5 10a1.5 1.5 0 100 3 1.5 1.5 0 000-3zm3 0a1.5 1.5 0 100 3 1.5 1.5 0 000-3z"}),h.jsx("path",{d:"M4 14v6h16v-6H4zm6 2h4v2h-4v-2z"})]})},d1=n=>{const{theme:e}=Bn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/2yvpf67d/Mattahan-Buuf-A-Proper-Journal-Icon-128.png",alt:"Journal Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/gift5.png",alt:"Gift Icon",...n,className:`${n.className} object-contain`}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{fillRule:"evenodd",d:"M12 2a10 10 0 100 20 10 10 0 000-20zM4 12a8 8 0 1116 0 8 8 0 01-16 0z",clipRule:"evenodd"}),h.jsx("path",{d:"M16.95 7.05l-1.414 1.414-2.122-2.122 1.414-1.414 2.122 2.122zm-9.9 9.9l1.414-1.414 2.122 2.122-1.414 1.414-2.122-2.122zm9.9 0l-1.414-1.414-2.122 2.122 1.414 1.414 2.122-2.122zm-9.9-9.9l1.414 1.414-2.122 2.122L5.636 9.172l2.122-2.122z"})]})},f1=n=>{const{theme:e}=Bn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/2yvpf67d/Mattahan-Buuf-A-Proper-Journal-Icon-128.png",alt:"Journal Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/star-gold.png",alt:"Star Icon",...n,className:`${n.className} object-contain`}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{fillRule:"evenodd",d:"M8.25 2.25A.75.75 0 019 3v.257a3.75 3.75 0 013 0V3a.75.75 0 011.5 0v.257a3.75 3.75 0 013 0V3a.75.75 0 01.75.75h-.008v.016c.361.32.622.754.74 1.232A23.953 23.953 0 0112 6c-2.305 0-4.52-.42-6.502-1.195a2.5 2.5 0 01.74-1.232H6a.75.75 0 01.75-.75h1.5zm-2.784 4.542a25.474 25.474 0 0013.068 0 .75.75 0 01.443.923 23.92 23.92 0 01-13.954 0 .75.75 0 01.443-.923zM8.25 10.5a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5a.75.75 0 01.75-.75zm3.75 0a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5a.75.75 0 01.75-.75zm3.75 0a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5a.75.75 0 01.75-.75z",clipRule:"evenodd"}),h.jsx("path",{d:"M4.145 9.421a.75.75 0 01.558-.923 25.483 25.483 0 0114.594 0 .75.75 0 01.558.923l-.36.99a25.01 25.01 0 01-14.832 0l-.36-.99z"}),h.jsx("path",{fillRule:"evenodd",d:"M3 15.75A2.25 2.25 0 015.25 13.5h13.5A2.25 2.25 0 0121 15.75v3A2.25 2.25 0 0118.75 21H5.25A2.25 2.25 0 013 18.75v-3z",clipRule:"evenodd"})]})},Ox=n=>{const{theme:e}=Bn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/xjbVmxDW/Oxygen-Icons-org-Oxygen-Categories-applications-education-university-256.png",alt:"Graduation Cap Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/star-gold.png",alt:"Gold Star Icon",...n,className:`${n.className} object-contain`}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{fillRule:"evenodd",d:"M11.25 4.5A.75.75 0 0112 5.25v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 0111.25 4.5zM12.75 6a.75.75 0 00-1.5 0v1.5a.75.75 0 001.5 0V6zM11.25 7.5A.75.75 0 0112 8.25v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 0111.25 7.5zM12.75 9a.75.75 0 00-1.5 0v1.5a.75.75 0 001.5 0V9z",clipRule:"evenodd"}),h.jsx("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zM6.262 6.072a8.25 8.25 0 1011.476 11.476A8.25 8.25 0 006.262 6.072zM12 18.75a.75.75 0 01-.75-.75V15a.75.75 0 011.5 0v3a.75.75 0 01-.75.75z",clipRule:"evenodd"}),h.jsx("path",{d:"M14.25 12a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"})]})},S0=n=>{const{theme:e}=Bn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/FFJXSWXv/study-learning-knowledge-education-book-notebook-icon-256768.png",alt:"Book and Glasses Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/gift1.png",alt:"Gift Icon",...n,className:`${n.className} object-contain`}):h.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:[h.jsx("path",{d:"M11.25 4.533A9.708 9.708 0 006 3.75c-1.052 0-2.062.18-3 .512V17.25a8.987 8.987 0 013.75-.82V9.75a.75.75 0 011.5 0v7.5a.75.75 0 01-1.5 0V15a6.726 6.726 0 00-3-.585V18.75C3.393 18.932 3.69 19.1 4 19.29c2.023.784 4.18 1.093 6.364 1.294a.75.75 0 00.872-.725V4.534z"}),h.jsx("path",{d:"M12.75 4.533V19.86a.75.75 0 00.872.725 49.33 49.33 0 006.364-1.294c.31-.19.607-.358.914-.54V5.25c-1.084-.308-2.18-.46-3.25-.46-1.637 0-3.235.32-4.75.922V4.534z"})]})},ON=n=>{const{theme:e}=Bn();return e==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/kG8rd4vv/Limpa-Curriculum-Vitae-Education-256.png",alt:"Blackboard Icon",...n}):e==="noel"?h.jsx("img",{src:"/assets/img/gift2.png",alt:"Gift Icon",...n,className:`${n.className} object-contain`}):h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",...n,children:h.jsx("path",{fillRule:"evenodd",d:"M2.25 6a3 3 0 013-3h13.5a3 3 0 013 3v12a3 3 0 01-3-3H5.25a3 3 0 01-3-3V6zm3.75 3a.75.75 0 01.75-.75h10.5a.75.75 0 010 1.5H7.5a.75.75 0 01-.75-.75zM7.5 12a.75.75 0 000 1.5h6a.75.75 0 000-1.5h-6z",clipRule:"evenodd"})})},DN=[{name:"light",label:"Sng",color:"bg-white"},{name:"dark",label:"Ti",color:"bg-slate-900"},{name:"noel",label:"Ging Sinh",color:"bg-[#8B0000]"},{name:"modern",label:"Hin i",color:"bg-indigo-600"},{name:"classic",label:"C in",color:"bg-[#6F6049]"},{name:"sunrise",label:"Bnh Minh",color:"bg-orange-500"},{name:"tri-an",label:"Tri n",color:"bg-red-400"}],MN=()=>{const[n,e]=K.useState(!1),{theme:t,setTheme:r}=Bn(),a=l=>{r(l),e(!1)};return h.jsxs("div",{className:"relative",children:[n&&h.jsx("div",{className:"absolute bottom-full right-0 mb-2 w-40 rounded-lg border border-border bg-card p-2 shadow-2xl flex flex-col gap-1 animate-slide-in-right",children:DN.map(l=>h.jsxs("button",{onClick:()=>a(l.name),className:`w-full text-left px-3 py-2 text-sm font-semibold rounded-md flex items-center gap-3 transition-colors ${t===l.name?"bg-primary/20 text-primary":"text-card-foreground hover:bg-secondary"}`,children:[h.jsx("span",{className:`w-4 h-4 rounded-full ${l.color} border border-white/20`}),l.label]},l.name))}),h.jsx("button",{onClick:()=>e(!n),className:"flex h-10 w-10 items-center justify-center rounded-lg bg-secondary text-secondary-foreground shadow-sm transition-colors hover:bg-muted focus:outline-none focus:ring-2 focus:ring-ring","aria-label":"Change theme",children:h.jsx(NN,{className:"h-6 w-6"})})]})},PN=()=>{const n=["gift1.png","bell.png","star-gold.png","ball.png","gift2.png","gift3.png","gift4.png","gift5.png"],{theme:e}=Bn();return e!=="noel"?null:h.jsxs(h.Fragment,{children:[h.jsx("style",{dangerouslySetInnerHTML:{__html:`
        /* === PHN 5: HIU NG TUYT & QU RI === */
        .snowflakes {
            position: fixed; top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 9999;
        }
        
        .snowflake {
            color: #fff;
            font-size: 1.2em;
            font-family: Arial, sans-serif;
            text-shadow: 0 0 3px rgba(255,255,255,0.8); /* Tuyt pht sng nh */
            position: fixed;
            top: -10%;
            z-index: 9999;
            user-select: none;
            cursor: default;
            animation-name: snowflakes-fall, snowflakes-shake;
            animation-timing-function: linear, ease-in-out;
            animation-iteration-count: infinite, infinite;
            animation-play-state: running, running;
        }

        .snowflake-img img {
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3));
            width: 30px; 
            height: auto;
            opacity: 0.9;
        }

        @keyframes snowflakes-fall {
            0% { top: -10%; }
            100% { top: 100%; }
        }
        @keyframes snowflakes-shake {
            0% { transform: translateX(0px) rotate(0deg); }
            50% { transform: translateX(80px) rotate(180deg); }
            100% { transform: translateX(0px) rotate(360deg); }
        }

        /* Cu hnh ri ngu nhin */
        .snowflake:nth-of-type(1) { left: 1%; animation-duration: 12s, 4s; animation-delay: 0s, 0s; }
        .snowflake:nth-of-type(2) { left: 5%; animation-duration: 15s, 6s; animation-delay: 1s, 1s; }
        .snowflake:nth-of-type(3) { left: 10%; animation-duration: 10s, 3s; animation-delay: 2s, 0.5s; }
        .snowflake:nth-of-type(4) { left: 15%; animation-duration: 18s, 5s; animation-delay: 4s, 2s; }
        .snowflake:nth-of-type(5) { left: 20%; animation-duration: 11s, 4s; animation-delay: 2s, 2s; }
        .snowflake:nth-of-type(6) { left: 25%; animation-duration: 14s, 7s; animation-delay: 6s, 3s; }
        .snowflake:nth-of-type(7) { left: 30%; animation-duration: 16s, 5s; animation-delay: 3s, 2s; }
        .snowflake:nth-of-type(8) { left: 35%; animation-duration: 13s, 4s; animation-delay: 1s, 1s; }
        .snowflake:nth-of-type(9) { left: 40%; animation-duration: 17s, 6s; animation-delay: 0s, 0s; }
        .snowflake:nth-of-type(10) { left: 45%; animation-duration: 9s, 3s; animation-delay: 5s, 1.5s; }
        .snowflake:nth-of-type(11) { left: 50%; animation-duration: 14s, 5s; animation-delay: 2s, 3s; }
        .snowflake:nth-of-type(12) { left: 55%; animation-duration: 11s, 4s; animation-delay: 4s, 1s; }
        .snowflake:nth-of-type(13) { left: 60%; animation-duration: 19s, 7s; animation-delay: 1s, 2s; }
        .snowflake:nth-of-type(14) { left: 65%; animation-duration: 12s, 3s; animation-delay: 3s, 0s; }
        .snowflake:nth-of-type(15) { left: 70%; animation-duration: 15s, 6s; animation-delay: 5s, 4s; }
        .snowflake:nth-of-type(16) { left: 75%; animation-duration: 10s, 4s; animation-delay: 0s, 2s; }
        .snowflake:nth-of-type(17) { left: 80%; animation-duration: 16s, 5s; animation-delay: 2s, 1s; }
        .snowflake:nth-of-type(18) { left: 85%; animation-duration: 13s, 4s; animation-delay: 4s, 3s; }
        .snowflake:nth-of-type(19) { left: 90%; animation-duration: 18s, 6s; animation-delay: 1s, 2s; }
        .snowflake:nth-of-type(20) { left: 95%; animation-duration: 11s, 3s; animation-delay: 3s, 0s; }
        
        .snowflake:nth-of-type(21) { left: 2%; animation-duration: 13s, 5s; animation-delay: 5s, 1s; }
        .snowflake:nth-of-type(22) { left: 8%; animation-duration: 10s, 3s; animation-delay: 2s, 4s; }
        .snowflake:nth-of-type(23) { left: 12%; animation-duration: 16s, 6s; animation-delay: 1s, 2s; }
        .snowflake:nth-of-type(24) { left: 18%; animation-duration: 12s, 4s; animation-delay: 6s, 0s; }
        .snowflake:nth-of-type(25) { left: 22%; animation-duration: 14s, 5s; animation-delay: 0s, 3s; }
        .snowflake:nth-of-type(26) { left: 28%; animation-duration: 11s, 3s; animation-delay: 4s, 2s; }
        .snowflake:nth-of-type(27) { left: 32%; animation-duration: 19s, 7s; animation-delay: 2s, 1s; }
        .snowflake:nth-of-type(28) { left: 38%; animation-duration: 15s, 6s; animation-delay: 5s, 5s; }
        .snowflake:nth-of-type(29) { left: 42%; animation-duration: 12s, 4s; animation-delay: 1s, 0s; }
        .snowflake:nth-of-type(30) { left: 48%; animation-duration: 17s, 5s; animation-delay: 3s, 2s; }
        .snowflake:nth-of-type(31) { left: 52%; animation-duration: 9s, 3s; animation-delay: 0s, 3s; }
        .snowflake:nth-of-type(32) { left: 58%; animation-duration: 14s, 6s; animation-delay: 4s, 1s; }
        .snowflake:nth-of-type(33) { left: 62%; animation-duration: 11s, 4s; animation-delay: 2s, 4s; }
        .snowflake:nth-of-type(34) { left: 68%; animation-duration: 16s, 5s; animation-delay: 6s, 0s; }
        .snowflake:nth-of-type(35) { left: 72%; animation-duration: 13s, 3s; animation-delay: 1s, 2s; }
        .snowflake:nth-of-type(36) { left: 78%; animation-duration: 18s, 7s; animation-delay: 5s, 1s; }
        .snowflake:nth-of-type(37) { left: 82%; animation-duration: 10s, 4s; animation-delay: 2s, 3s; }
        .snowflake:nth-of-type(38) { left: 88%; animation-duration: 15s, 6s; animation-delay: 4s, 0s; }
        .snowflake:nth-of-type(39) { left: 92%; animation-duration: 12s, 5s; animation-delay: 0s, 2s; }
        .snowflake:nth-of-type(40) { left: 98%; animation-duration: 17s, 4s; animation-delay: 3s, 5s; }

        .snowflake:nth-child(odd) { animation-direction: normal; }
        .snowflake:nth-child(even) { animation-direction: alternate; }

        @media (max-width: 768px) {
            .snowflake { font-size: 1em; }
            .snowflake-img img { width: 20px; }
        }
      `}}),h.jsxs("div",{className:"snowflakes","aria-hidden":"true",children:[Array.from({length:100}).map((t,r)=>h.jsxs("div",{className:"snowflake",children:[["","",""][r%3]," "]},`snow-${r}`)),Array.from({length:8}).map((t,r)=>{const a=n[r%n.length];return h.jsx("div",{className:"snowflake snowflake-img",children:h.jsx("img",{src:`/assets/img/${a}`,alt:"",style:{width:"25px",height:"auto"}})},`img-${r}`)})]})]})},LN=()=>{};var m1={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dx=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let a=n.charCodeAt(r);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},VN=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const a=n[t++];if(a<128)e[r++]=String.fromCharCode(a);else if(a>191&&a<224){const l=n[t++];e[r++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=n[t++],c=n[t++],f=n[t++],g=((a&7)<<18|(l&63)<<12|(c&63)<<6|f&63)-65536;e[r++]=String.fromCharCode(55296+(g>>10)),e[r++]=String.fromCharCode(56320+(g&1023))}else{const l=n[t++],c=n[t++];e[r++]=String.fromCharCode((a&15)<<12|(l&63)<<6|c&63)}}return e.join("")},Mx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<n.length;a+=3){const l=n[a],c=a+1<n.length,f=c?n[a+1]:0,g=a+2<n.length,y=g?n[a+2]:0,v=l>>2,w=(l&3)<<4|f>>4;let E=(f&15)<<2|y>>6,S=y&63;g||(S=64,c||(E=64)),r.push(t[v],t[w],t[E],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Dx(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):VN(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<n.length;){const l=t[n.charAt(a++)],f=a<n.length?t[n.charAt(a)]:0;++a;const y=a<n.length?t[n.charAt(a)]:64;++a;const w=a<n.length?t[n.charAt(a)]:64;if(++a,l==null||f==null||y==null||w==null)throw new UN;const E=l<<2|f>>4;if(r.push(E),y!==64){const S=f<<4&240|y>>2;if(r.push(S),w!==64){const j=y<<6&192|w;r.push(j)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class UN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const BN=function(n){const e=Dx(n);return Mx.encodeByteArray(e,!0)},Yd=function(n){return BN(n).replace(/\./g,"")},Px=function(n){try{return Mx.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qN=()=>zN().__FIREBASE_DEFAULTS__,HN=()=>{if(typeof process>"u"||typeof m1>"u")return;const n=m1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},$N=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Px(n[1]);return e&&JSON.parse(e)},Af=()=>{try{return LN()||qN()||HN()||$N()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Lx=n=>{var e,t;return(t=(e=Af())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},Vx=n=>{const e=Lx(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Ux=()=>{var n;return(n=Af())==null?void 0:n.config},Bx=n=>{var e;return(e=Af())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FN=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ba(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function A0(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zx(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",a=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${r}`,aud:r,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Yd(JSON.stringify(t)),Yd(JSON.stringify(c)),""].join(".")}const hu={};function GN(){const n={prod:[],emulator:[]};for(const e of Object.keys(hu))hu[e]?n.emulator.push(e):n.prod.push(e);return n}function KN(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let g1=!1;function N0(n,e){if(typeof window>"u"||typeof document>"u"||!ba(window.location.host)||hu[n]===e||hu[n]||g1)return;hu[n]=e;function t(E){return`__firebase__banner__${E}`}const r="__firebase__banner",l=GN().prod.length>0;function c(){const E=document.getElementById(r);E&&E.remove()}function f(E){E.style.display="flex",E.style.background="#7faaf0",E.style.position="fixed",E.style.bottom="5px",E.style.left="5px",E.style.padding=".5em",E.style.borderRadius="5px",E.style.alignItems="center"}function g(E,S){E.setAttribute("width","24"),E.setAttribute("id",S),E.setAttribute("height","24"),E.setAttribute("viewBox","0 0 24 24"),E.setAttribute("fill","none"),E.style.marginLeft="-6px"}function y(){const E=document.createElement("span");return E.style.cursor="pointer",E.style.marginLeft="16px",E.style.fontSize="24px",E.innerHTML=" &times;",E.onclick=()=>{g1=!0,c()},E}function v(E,S){E.setAttribute("id",S),E.innerText="Learn more",E.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",E.setAttribute("target","__blank"),E.style.paddingLeft="5px",E.style.textDecoration="underline"}function w(){const E=KN(r),S=t("text"),j=document.getElementById(S)||document.createElement("span"),D=t("learnmore"),R=document.getElementById(D)||document.createElement("a"),L=t("preprendIcon"),F=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(E.created){const B=E.element;f(B),v(R,D);const ee=y();g(F,L),B.append(F,j,R,ee),document.body.appendChild(B)}l?(j.innerText="Preview backend disconnected.",F.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(F.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,j.innerText="Preview backend running in this workspace."),j.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",w):w()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Un(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function QN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Un())}function YN(){var e;const n=(e=Af())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function XN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function WN(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function JN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ZN(){const n=Un();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function e4(){return!YN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function t4(){try{return typeof indexedDB=="object"}catch{return!1}}function n4(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)==null?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s4="FirebaseError";class Mr extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=s4,Object.setPrototypeOf(this,Mr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qu.prototype.create)}}class qu{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],c=l?r4(l,r):"Error",f=`${this.serviceName}: ${c} (${a}).`;return new Mr(a,f,r)}}function r4(n,e){return n.replace(i4,(t,r)=>{const a=e[r];return a!=null?String(a):`<${r}?>`})}const i4=/\{\$([^}]+)}/g;function a4(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function li(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const a of t){if(!r.includes(a))return!1;const l=n[a],c=e[a];if(p1(l)&&p1(c)){if(!li(l,c))return!1}else if(l!==c)return!1}for(const a of r)if(!t.includes(a))return!1;return!0}function p1(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function iu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[a,l]=r.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function au(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function o4(n,e){const t=new l4(n,e);return t.subscribe.bind(t)}class l4{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let a;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");c4(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:r},a.next===void 0&&(a.next=op),a.error===void 0&&(a.error=op),a.complete===void 0&&(a.complete=op);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function c4(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function op(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function It(n){return n&&n._delegate?n._delegate:n}class da{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const io="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u4{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new FN;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&r.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(a){if(r)return null;throw a}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(d4(e))try{this.getOrInitializeService({instanceIdentifier:io})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});r.resolve(l)}catch{}}}}clearInstance(e=io){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=io){return this.instances.has(e)}getOptions(e=io){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[l,c]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);r===f&&c.resolve(a)}return a}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),a=this.onInitCallbacks.get(r)??new Set;a.add(e),this.onInitCallbacks.set(r,a);const l=this.instances.get(r);return l&&e(l,r),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const a of r)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:h4(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=io){return this.component?this.component.multipleInstances?e:io:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function h4(n){return n===io?void 0:n}function d4(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f4{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new u4(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ye;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ye||(Ye={}));const m4={debug:Ye.DEBUG,verbose:Ye.VERBOSE,info:Ye.INFO,warn:Ye.WARN,error:Ye.ERROR,silent:Ye.SILENT},g4=Ye.INFO,p4={[Ye.DEBUG]:"log",[Ye.VERBOSE]:"log",[Ye.INFO]:"info",[Ye.WARN]:"warn",[Ye.ERROR]:"error"},y4=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),a=p4[e];if(a)console[a](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class R0{constructor(e){this.name=e,this._logLevel=g4,this._logHandler=y4,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?m4[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ye.DEBUG,...e),this._logHandler(this,Ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ye.VERBOSE,...e),this._logHandler(this,Ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ye.INFO,...e),this._logHandler(this,Ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ye.WARN,...e),this._logHandler(this,Ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ye.ERROR,...e),this._logHandler(this,Ye.ERROR,...e)}}const _4=(n,e)=>e.some(t=>n instanceof t);let y1,_1;function v4(){return y1||(y1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function b4(){return _1||(_1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const qx=new WeakMap,Op=new WeakMap,Hx=new WeakMap,lp=new WeakMap,C0=new WeakMap;function w4(n){const e=new Promise((t,r)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",c)},l=()=>{t(oa(n.result)),a()},c=()=>{r(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&qx.set(t,n)}).catch(()=>{}),C0.set(e,n),e}function x4(n){if(Op.has(n))return;const e=new Promise((t,r)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",c),n.removeEventListener("abort",c)},l=()=>{t(),a()},c=()=>{r(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",c),n.addEventListener("abort",c)});Op.set(n,e)}let Dp={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Op.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Hx.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return oa(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function E4(n){Dp=n(Dp)}function T4(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(cp(this),e,...t);return Hx.set(r,e.sort?e.sort():[e]),oa(r)}:b4().includes(n)?function(...e){return n.apply(cp(this),e),oa(qx.get(this))}:function(...e){return oa(n.apply(cp(this),e))}}function S4(n){return typeof n=="function"?T4(n):(n instanceof IDBTransaction&&x4(n),_4(n,v4())?new Proxy(n,Dp):n)}function oa(n){if(n instanceof IDBRequest)return w4(n);if(lp.has(n))return lp.get(n);const e=S4(n);return e!==n&&(lp.set(n,e),C0.set(e,n)),e}const cp=n=>C0.get(n);function A4(n,e,{blocked:t,upgrade:r,blocking:a,terminated:l}={}){const c=indexedDB.open(n,e),f=oa(c);return r&&c.addEventListener("upgradeneeded",g=>{r(oa(c.result),g.oldVersion,g.newVersion,oa(c.transaction),g)}),t&&c.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),f.then(g=>{l&&g.addEventListener("close",()=>l()),a&&g.addEventListener("versionchange",y=>a(y.oldVersion,y.newVersion,y))}).catch(()=>{}),f}const N4=["get","getKey","getAll","getAllKeys","count"],R4=["put","add","delete","clear"],up=new Map;function v1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(up.get(e))return up.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,a=R4.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(a||N4.includes(t)))return;const l=async function(c,...f){const g=this.transaction(c,a?"readwrite":"readonly");let y=g.store;return r&&(y=y.index(f.shift())),(await Promise.all([y[t](...f),a&&g.done]))[0]};return up.set(e,l),l}E4(n=>({...n,get:(e,t,r)=>v1(e,t)||n.get(e,t,r),has:(e,t)=>!!v1(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C4{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(I4(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function I4(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Mp="@firebase/app",b1="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ci=new R0("@firebase/app"),j4="@firebase/app-compat",k4="@firebase/analytics-compat",O4="@firebase/analytics",D4="@firebase/app-check-compat",M4="@firebase/app-check",P4="@firebase/auth",L4="@firebase/auth-compat",V4="@firebase/database",U4="@firebase/data-connect",B4="@firebase/database-compat",z4="@firebase/functions",q4="@firebase/functions-compat",H4="@firebase/installations",$4="@firebase/installations-compat",F4="@firebase/messaging",G4="@firebase/messaging-compat",K4="@firebase/performance",Q4="@firebase/performance-compat",Y4="@firebase/remote-config",X4="@firebase/remote-config-compat",W4="@firebase/storage",J4="@firebase/storage-compat",Z4="@firebase/firestore",e5="@firebase/ai",t5="@firebase/firestore-compat",n5="firebase",s5="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pp="[DEFAULT]",r5={[Mp]:"fire-core",[j4]:"fire-core-compat",[O4]:"fire-analytics",[k4]:"fire-analytics-compat",[M4]:"fire-app-check",[D4]:"fire-app-check-compat",[P4]:"fire-auth",[L4]:"fire-auth-compat",[V4]:"fire-rtdb",[U4]:"fire-data-connect",[B4]:"fire-rtdb-compat",[z4]:"fire-fn",[q4]:"fire-fn-compat",[H4]:"fire-iid",[$4]:"fire-iid-compat",[F4]:"fire-fcm",[G4]:"fire-fcm-compat",[K4]:"fire-perf",[Q4]:"fire-perf-compat",[Y4]:"fire-rc",[X4]:"fire-rc-compat",[W4]:"fire-gcs",[J4]:"fire-gcs-compat",[Z4]:"fire-fst",[t5]:"fire-fst-compat",[e5]:"fire-vertex","fire-js":"fire-js",[n5]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tu=new Map,i5=new Map,Lp=new Map;function w1(n,e){try{n.container.addComponent(e)}catch(t){ci.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function po(n){const e=n.name;if(Lp.has(e))return ci.debug(`There were multiple attempts to register component ${e}.`),!1;Lp.set(e,n);for(const t of Tu.values())w1(t,n);for(const t of i5.values())w1(t,n);return!0}function Nf(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function bs(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a5={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},la=new qu("app","Firebase",a5);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o5{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new da("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw la.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const To=s5;function $x(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r={name:Pp,automaticDataCollectionEnabled:!0,...e},a=r.name;if(typeof a!="string"||!a)throw la.create("bad-app-name",{appName:String(a)});if(t||(t=Ux()),!t)throw la.create("no-options");const l=Tu.get(a);if(l){if(li(t,l.options)&&li(r,l.config))return l;throw la.create("duplicate-app",{appName:a})}const c=new f4(a);for(const g of Lp.values())c.addComponent(g);const f=new o5(t,r,c);return Tu.set(a,f),f}function Rf(n=Pp){const e=Tu.get(n);if(!e&&n===Pp&&Ux())return $x();if(!e)throw la.create("no-app",{appName:n});return e}function l5(){return Array.from(Tu.values())}function Cr(n,e,t){let r=r5[n]??n;t&&(r+=`-${t}`);const a=r.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const c=[`Unable to register library "${r}" with version "${e}":`];a&&c.push(`library name "${r}" contains illegal characters (whitespace or "/")`),a&&l&&c.push("and"),l&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ci.warn(c.join(" "));return}po(new da(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c5="firebase-heartbeat-database",u5=1,Su="firebase-heartbeat-store";let hp=null;function Fx(){return hp||(hp=A4(c5,u5,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Su)}catch(t){console.warn(t)}}}}).catch(n=>{throw la.create("idb-open",{originalErrorMessage:n.message})})),hp}async function h5(n){try{const t=(await Fx()).transaction(Su),r=await t.objectStore(Su).get(Gx(n));return await t.done,r}catch(e){if(e instanceof Mr)ci.warn(e.message);else{const t=la.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ci.warn(t.message)}}}async function x1(n,e){try{const r=(await Fx()).transaction(Su,"readwrite");await r.objectStore(Su).put(e,Gx(n)),await r.done}catch(t){if(t instanceof Mr)ci.warn(t.message);else{const r=la.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ci.warn(r.message)}}}function Gx(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d5=1024,f5=30;class m5{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new p5(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=E1();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(c=>c.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>f5){const c=y5(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ci.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=E1(),{heartbeatsToSend:r,unsentEntries:a}=g5(this._heartbeatsCache.heartbeats),l=Yd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return ci.warn(t),""}}}function E1(){return new Date().toISOString().substring(0,10)}function g5(n,e=d5){const t=[];let r=n.slice();for(const a of n){const l=t.find(c=>c.agent===a.agent);if(l){if(l.dates.push(a.date),T1(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),T1(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class p5{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return t4()?n4().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await h5(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return x1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return x1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function T1(n){return Yd(JSON.stringify({version:2,heartbeats:n})).length}function y5(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _5(n){po(new da("platform-logger",e=>new C4(e),"PRIVATE")),po(new da("heartbeat",e=>new m5(e),"PRIVATE")),Cr(Mp,b1,n),Cr(Mp,b1,"esm2020"),Cr("fire-js","")}_5("");var S1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ca,Kx;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,I){function k(){}k.prototype=I.prototype,C.F=I.prototype,C.prototype=new k,C.prototype.constructor=C,C.D=function(U,P,H){for(var A=Array(arguments.length-2),me=2;me<arguments.length;me++)A[me-2]=arguments[me];return I.prototype[P].apply(U,A)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(C,I,k){k||(k=0);const U=Array(16);if(typeof I=="string")for(var P=0;P<16;++P)U[P]=I.charCodeAt(k++)|I.charCodeAt(k++)<<8|I.charCodeAt(k++)<<16|I.charCodeAt(k++)<<24;else for(P=0;P<16;++P)U[P]=I[k++]|I[k++]<<8|I[k++]<<16|I[k++]<<24;I=C.g[0],k=C.g[1],P=C.g[2];let H=C.g[3],A;A=I+(H^k&(P^H))+U[0]+3614090360&4294967295,I=k+(A<<7&4294967295|A>>>25),A=H+(P^I&(k^P))+U[1]+3905402710&4294967295,H=I+(A<<12&4294967295|A>>>20),A=P+(k^H&(I^k))+U[2]+606105819&4294967295,P=H+(A<<17&4294967295|A>>>15),A=k+(I^P&(H^I))+U[3]+3250441966&4294967295,k=P+(A<<22&4294967295|A>>>10),A=I+(H^k&(P^H))+U[4]+4118548399&4294967295,I=k+(A<<7&4294967295|A>>>25),A=H+(P^I&(k^P))+U[5]+1200080426&4294967295,H=I+(A<<12&4294967295|A>>>20),A=P+(k^H&(I^k))+U[6]+2821735955&4294967295,P=H+(A<<17&4294967295|A>>>15),A=k+(I^P&(H^I))+U[7]+4249261313&4294967295,k=P+(A<<22&4294967295|A>>>10),A=I+(H^k&(P^H))+U[8]+1770035416&4294967295,I=k+(A<<7&4294967295|A>>>25),A=H+(P^I&(k^P))+U[9]+2336552879&4294967295,H=I+(A<<12&4294967295|A>>>20),A=P+(k^H&(I^k))+U[10]+4294925233&4294967295,P=H+(A<<17&4294967295|A>>>15),A=k+(I^P&(H^I))+U[11]+2304563134&4294967295,k=P+(A<<22&4294967295|A>>>10),A=I+(H^k&(P^H))+U[12]+1804603682&4294967295,I=k+(A<<7&4294967295|A>>>25),A=H+(P^I&(k^P))+U[13]+4254626195&4294967295,H=I+(A<<12&4294967295|A>>>20),A=P+(k^H&(I^k))+U[14]+2792965006&4294967295,P=H+(A<<17&4294967295|A>>>15),A=k+(I^P&(H^I))+U[15]+1236535329&4294967295,k=P+(A<<22&4294967295|A>>>10),A=I+(P^H&(k^P))+U[1]+4129170786&4294967295,I=k+(A<<5&4294967295|A>>>27),A=H+(k^P&(I^k))+U[6]+3225465664&4294967295,H=I+(A<<9&4294967295|A>>>23),A=P+(I^k&(H^I))+U[11]+643717713&4294967295,P=H+(A<<14&4294967295|A>>>18),A=k+(H^I&(P^H))+U[0]+3921069994&4294967295,k=P+(A<<20&4294967295|A>>>12),A=I+(P^H&(k^P))+U[5]+3593408605&4294967295,I=k+(A<<5&4294967295|A>>>27),A=H+(k^P&(I^k))+U[10]+38016083&4294967295,H=I+(A<<9&4294967295|A>>>23),A=P+(I^k&(H^I))+U[15]+3634488961&4294967295,P=H+(A<<14&4294967295|A>>>18),A=k+(H^I&(P^H))+U[4]+3889429448&4294967295,k=P+(A<<20&4294967295|A>>>12),A=I+(P^H&(k^P))+U[9]+568446438&4294967295,I=k+(A<<5&4294967295|A>>>27),A=H+(k^P&(I^k))+U[14]+3275163606&4294967295,H=I+(A<<9&4294967295|A>>>23),A=P+(I^k&(H^I))+U[3]+4107603335&4294967295,P=H+(A<<14&4294967295|A>>>18),A=k+(H^I&(P^H))+U[8]+1163531501&4294967295,k=P+(A<<20&4294967295|A>>>12),A=I+(P^H&(k^P))+U[13]+2850285829&4294967295,I=k+(A<<5&4294967295|A>>>27),A=H+(k^P&(I^k))+U[2]+4243563512&4294967295,H=I+(A<<9&4294967295|A>>>23),A=P+(I^k&(H^I))+U[7]+1735328473&4294967295,P=H+(A<<14&4294967295|A>>>18),A=k+(H^I&(P^H))+U[12]+2368359562&4294967295,k=P+(A<<20&4294967295|A>>>12),A=I+(k^P^H)+U[5]+4294588738&4294967295,I=k+(A<<4&4294967295|A>>>28),A=H+(I^k^P)+U[8]+2272392833&4294967295,H=I+(A<<11&4294967295|A>>>21),A=P+(H^I^k)+U[11]+1839030562&4294967295,P=H+(A<<16&4294967295|A>>>16),A=k+(P^H^I)+U[14]+4259657740&4294967295,k=P+(A<<23&4294967295|A>>>9),A=I+(k^P^H)+U[1]+2763975236&4294967295,I=k+(A<<4&4294967295|A>>>28),A=H+(I^k^P)+U[4]+1272893353&4294967295,H=I+(A<<11&4294967295|A>>>21),A=P+(H^I^k)+U[7]+4139469664&4294967295,P=H+(A<<16&4294967295|A>>>16),A=k+(P^H^I)+U[10]+3200236656&4294967295,k=P+(A<<23&4294967295|A>>>9),A=I+(k^P^H)+U[13]+681279174&4294967295,I=k+(A<<4&4294967295|A>>>28),A=H+(I^k^P)+U[0]+3936430074&4294967295,H=I+(A<<11&4294967295|A>>>21),A=P+(H^I^k)+U[3]+3572445317&4294967295,P=H+(A<<16&4294967295|A>>>16),A=k+(P^H^I)+U[6]+76029189&4294967295,k=P+(A<<23&4294967295|A>>>9),A=I+(k^P^H)+U[9]+3654602809&4294967295,I=k+(A<<4&4294967295|A>>>28),A=H+(I^k^P)+U[12]+3873151461&4294967295,H=I+(A<<11&4294967295|A>>>21),A=P+(H^I^k)+U[15]+530742520&4294967295,P=H+(A<<16&4294967295|A>>>16),A=k+(P^H^I)+U[2]+3299628645&4294967295,k=P+(A<<23&4294967295|A>>>9),A=I+(P^(k|~H))+U[0]+4096336452&4294967295,I=k+(A<<6&4294967295|A>>>26),A=H+(k^(I|~P))+U[7]+1126891415&4294967295,H=I+(A<<10&4294967295|A>>>22),A=P+(I^(H|~k))+U[14]+2878612391&4294967295,P=H+(A<<15&4294967295|A>>>17),A=k+(H^(P|~I))+U[5]+4237533241&4294967295,k=P+(A<<21&4294967295|A>>>11),A=I+(P^(k|~H))+U[12]+1700485571&4294967295,I=k+(A<<6&4294967295|A>>>26),A=H+(k^(I|~P))+U[3]+2399980690&4294967295,H=I+(A<<10&4294967295|A>>>22),A=P+(I^(H|~k))+U[10]+4293915773&4294967295,P=H+(A<<15&4294967295|A>>>17),A=k+(H^(P|~I))+U[1]+2240044497&4294967295,k=P+(A<<21&4294967295|A>>>11),A=I+(P^(k|~H))+U[8]+1873313359&4294967295,I=k+(A<<6&4294967295|A>>>26),A=H+(k^(I|~P))+U[15]+4264355552&4294967295,H=I+(A<<10&4294967295|A>>>22),A=P+(I^(H|~k))+U[6]+2734768916&4294967295,P=H+(A<<15&4294967295|A>>>17),A=k+(H^(P|~I))+U[13]+1309151649&4294967295,k=P+(A<<21&4294967295|A>>>11),A=I+(P^(k|~H))+U[4]+4149444226&4294967295,I=k+(A<<6&4294967295|A>>>26),A=H+(k^(I|~P))+U[11]+3174756917&4294967295,H=I+(A<<10&4294967295|A>>>22),A=P+(I^(H|~k))+U[2]+718787259&4294967295,P=H+(A<<15&4294967295|A>>>17),A=k+(H^(P|~I))+U[9]+3951481745&4294967295,C.g[0]=C.g[0]+I&4294967295,C.g[1]=C.g[1]+(P+(A<<21&4294967295|A>>>11))&4294967295,C.g[2]=C.g[2]+P&4294967295,C.g[3]=C.g[3]+H&4294967295}r.prototype.v=function(C,I){I===void 0&&(I=C.length);const k=I-this.blockSize,U=this.C;let P=this.h,H=0;for(;H<I;){if(P==0)for(;H<=k;)a(this,C,H),H+=this.blockSize;if(typeof C=="string"){for(;H<I;)if(U[P++]=C.charCodeAt(H++),P==this.blockSize){a(this,U),P=0;break}}else for(;H<I;)if(U[P++]=C[H++],P==this.blockSize){a(this,U),P=0;break}}this.h=P,this.o+=I},r.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var I=1;I<C.length-8;++I)C[I]=0;I=this.o*8;for(var k=C.length-8;k<C.length;++k)C[k]=I&255,I/=256;for(this.v(C),C=Array(16),I=0,k=0;k<4;++k)for(let U=0;U<32;U+=8)C[I++]=this.g[k]>>>U&255;return C};function l(C,I){var k=f;return Object.prototype.hasOwnProperty.call(k,C)?k[C]:k[C]=I(C)}function c(C,I){this.h=I;const k=[];let U=!0;for(let P=C.length-1;P>=0;P--){const H=C[P]|0;U&&H==I||(k[P]=H,U=!1)}this.g=k}var f={};function g(C){return-128<=C&&C<128?l(C,function(I){return new c([I|0],I<0?-1:0)}):new c([C|0],C<0?-1:0)}function y(C){if(isNaN(C)||!isFinite(C))return w;if(C<0)return R(y(-C));const I=[];let k=1;for(let U=0;C>=k;U++)I[U]=C/k|0,k*=4294967296;return new c(I,0)}function v(C,I){if(C.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(C.charAt(0)=="-")return R(v(C.substring(1),I));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=y(Math.pow(I,8));let U=w;for(let H=0;H<C.length;H+=8){var P=Math.min(8,C.length-H);const A=parseInt(C.substring(H,H+P),I);P<8?(P=y(Math.pow(I,P)),U=U.j(P).add(y(A))):(U=U.j(k),U=U.add(y(A)))}return U}var w=g(0),E=g(1),S=g(16777216);n=c.prototype,n.m=function(){if(D(this))return-R(this).m();let C=0,I=1;for(let k=0;k<this.g.length;k++){const U=this.i(k);C+=(U>=0?U:4294967296+U)*I,I*=4294967296}return C},n.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(j(this))return"0";if(D(this))return"-"+R(this).toString(C);const I=y(Math.pow(C,6));var k=this;let U="";for(;;){const P=ee(k,I).g;k=L(k,P.j(I));let H=((k.g.length>0?k.g[0]:k.h)>>>0).toString(C);if(k=P,j(k))return H+U;for(;H.length<6;)H="0"+H;U=H+U}},n.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function j(C){if(C.h!=0)return!1;for(let I=0;I<C.g.length;I++)if(C.g[I]!=0)return!1;return!0}function D(C){return C.h==-1}n.l=function(C){return C=L(this,C),D(C)?-1:j(C)?0:1};function R(C){const I=C.g.length,k=[];for(let U=0;U<I;U++)k[U]=~C.g[U];return new c(k,~C.h).add(E)}n.abs=function(){return D(this)?R(this):this},n.add=function(C){const I=Math.max(this.g.length,C.g.length),k=[];let U=0;for(let P=0;P<=I;P++){let H=U+(this.i(P)&65535)+(C.i(P)&65535),A=(H>>>16)+(this.i(P)>>>16)+(C.i(P)>>>16);U=A>>>16,H&=65535,A&=65535,k[P]=A<<16|H}return new c(k,k[k.length-1]&-2147483648?-1:0)};function L(C,I){return C.add(R(I))}n.j=function(C){if(j(this)||j(C))return w;if(D(this))return D(C)?R(this).j(R(C)):R(R(this).j(C));if(D(C))return R(this.j(R(C)));if(this.l(S)<0&&C.l(S)<0)return y(this.m()*C.m());const I=this.g.length+C.g.length,k=[];for(var U=0;U<2*I;U++)k[U]=0;for(U=0;U<this.g.length;U++)for(let P=0;P<C.g.length;P++){const H=this.i(U)>>>16,A=this.i(U)&65535,me=C.i(P)>>>16,xe=C.i(P)&65535;k[2*U+2*P]+=A*xe,F(k,2*U+2*P),k[2*U+2*P+1]+=H*xe,F(k,2*U+2*P+1),k[2*U+2*P+1]+=A*me,F(k,2*U+2*P+1),k[2*U+2*P+2]+=H*me,F(k,2*U+2*P+2)}for(C=0;C<I;C++)k[C]=k[2*C+1]<<16|k[2*C];for(C=I;C<2*I;C++)k[C]=0;return new c(k,0)};function F(C,I){for(;(C[I]&65535)!=C[I];)C[I+1]+=C[I]>>>16,C[I]&=65535,I++}function B(C,I){this.g=C,this.h=I}function ee(C,I){if(j(I))throw Error("division by zero");if(j(C))return new B(w,w);if(D(C))return I=ee(R(C),I),new B(R(I.g),R(I.h));if(D(I))return I=ee(C,R(I)),new B(R(I.g),I.h);if(C.g.length>30){if(D(C)||D(I))throw Error("slowDivide_ only works with positive integers.");for(var k=E,U=I;U.l(C)<=0;)k=he(k),U=he(U);var P=ue(k,1),H=ue(U,1);for(U=ue(U,2),k=ue(k,2);!j(U);){var A=H.add(U);A.l(C)<=0&&(P=P.add(k),H=A),U=ue(U,1),k=ue(k,1)}return I=L(C,P.j(I)),new B(P,I)}for(P=w;C.l(I)>=0;){for(k=Math.max(1,Math.floor(C.m()/I.m())),U=Math.ceil(Math.log(k)/Math.LN2),U=U<=48?1:Math.pow(2,U-48),H=y(k),A=H.j(I);D(A)||A.l(C)>0;)k-=U,H=y(k),A=H.j(I);j(H)&&(H=E),P=P.add(H),C=L(C,A)}return new B(P,C)}n.B=function(C){return ee(this,C).h},n.and=function(C){const I=Math.max(this.g.length,C.g.length),k=[];for(let U=0;U<I;U++)k[U]=this.i(U)&C.i(U);return new c(k,this.h&C.h)},n.or=function(C){const I=Math.max(this.g.length,C.g.length),k=[];for(let U=0;U<I;U++)k[U]=this.i(U)|C.i(U);return new c(k,this.h|C.h)},n.xor=function(C){const I=Math.max(this.g.length,C.g.length),k=[];for(let U=0;U<I;U++)k[U]=this.i(U)^C.i(U);return new c(k,this.h^C.h)};function he(C){const I=C.g.length+1,k=[];for(let U=0;U<I;U++)k[U]=C.i(U)<<1|C.i(U-1)>>>31;return new c(k,C.h)}function ue(C,I){const k=I>>5;I%=32;const U=C.g.length-k,P=[];for(let H=0;H<U;H++)P[H]=I>0?C.i(H+k)>>>I|C.i(H+k+1)<<32-I:C.i(H+k);return new c(P,C.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,Kx=r,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=y,c.fromString=v,ca=c}).apply(typeof S1<"u"?S1:typeof self<"u"?self:typeof window<"u"?window:{});var wd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Qx,ou,Yx,Bd,Vp,Xx,Wx,Jx;(function(){var n,e=Object.defineProperty;function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof wd=="object"&&wd];for(var _=0;_<d.length;++_){var x=d[_];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var r=t(this);function a(d,_){if(_)e:{var x=r;d=d.split(".");for(var N=0;N<d.length-1;N++){var G=d[N];if(!(G in x))break e;x=x[G]}d=d[d.length-1],N=x[d],_=_(N),_!=N&&_!=null&&e(x,d,{configurable:!0,writable:!0,value:_})}}a("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(d){return d||function(_){var x=[],N;for(N in _)Object.prototype.hasOwnProperty.call(_,N)&&x.push([N,_[N]]);return x}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},c=this||self;function f(d){var _=typeof d;return _=="object"&&d!=null||_=="function"}function g(d,_,x){return d.call.apply(d.bind,arguments)}function y(d,_,x){return y=g,y.apply(null,arguments)}function v(d,_){var x=Array.prototype.slice.call(arguments,1);return function(){var N=x.slice();return N.push.apply(N,arguments),d.apply(this,N)}}function w(d,_){function x(){}x.prototype=_.prototype,d.Z=_.prototype,d.prototype=new x,d.prototype.constructor=d,d.Ob=function(N,G,J){for(var fe=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)fe[Ue-2]=arguments[Ue];return _.prototype[G].apply(N,fe)}}var E=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function S(d){const _=d.length;if(_>0){const x=Array(_);for(let N=0;N<_;N++)x[N]=d[N];return x}return[]}function j(d,_){for(let N=1;N<arguments.length;N++){const G=arguments[N];var x=typeof G;if(x=x!="object"?x:G?Array.isArray(G)?"array":x:"null",x=="array"||x=="object"&&typeof G.length=="number"){x=d.length||0;const J=G.length||0;d.length=x+J;for(let fe=0;fe<J;fe++)d[x+fe]=G[fe]}else d.push(G)}}class D{constructor(_,x){this.i=_,this.j=x,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function R(d){c.setTimeout(()=>{throw d},0)}function L(){var d=C;let _=null;return d.g&&(_=d.g,d.g=d.g.next,d.g||(d.h=null),_.next=null),_}class F{constructor(){this.h=this.g=null}add(_,x){const N=B.get();N.set(_,x),this.h?this.h.next=N:this.g=N,this.h=N}}var B=new D(()=>new ee,d=>d.reset());class ee{constructor(){this.next=this.g=this.h=null}set(_,x){this.h=_,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let he,ue=!1,C=new F,I=()=>{const d=Promise.resolve(void 0);he=()=>{d.then(k)}};function k(){for(var d;d=L();){try{d.h.call(d.g)}catch(x){R(x)}var _=B;_.j(d),_.h<100&&(_.h++,d.next=_.g,_.g=d)}ue=!1}function U(){this.u=this.u,this.C=this.C}U.prototype.u=!1,U.prototype.dispose=function(){this.u||(this.u=!0,this.N())},U.prototype[Symbol.dispose]=function(){this.dispose()},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(d,_){this.type=d,this.g=this.target=_,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var H=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var d=!1,_=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const x=()=>{};c.addEventListener("test",x,_),c.removeEventListener("test",x,_)}catch{}return d})();function A(d){return/^[\s\xa0]*$/.test(d)}function me(d,_){P.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,_)}w(me,P),me.prototype.init=function(d,_){const x=this.type=d.type,N=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=_,_=d.relatedTarget,_||(x=="mouseover"?_=d.fromElement:x=="mouseout"&&(_=d.toElement)),this.relatedTarget=_,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&me.Z.h.call(this)},me.prototype.h=function(){me.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var xe="closure_listenable_"+(Math.random()*1e6|0),V=0;function le(d,_,x,N,G){this.listener=d,this.proxy=null,this.src=_,this.type=x,this.capture=!!N,this.ha=G,this.key=++V,this.da=this.fa=!1}function _e(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function De(d,_,x){for(const N in d)_.call(x,d[N],N,d)}function $e(d,_){for(const x in d)_.call(void 0,d[x],x,d)}function z(d){const _={};for(const x in d)_[x]=d[x];return _}const ne="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function W(d,_){let x,N;for(let G=1;G<arguments.length;G++){N=arguments[G];for(x in N)d[x]=N[x];for(let J=0;J<ne.length;J++)x=ne[J],Object.prototype.hasOwnProperty.call(N,x)&&(d[x]=N[x])}}function ie(d){this.src=d,this.g={},this.h=0}ie.prototype.add=function(d,_,x,N,G){const J=d.toString();d=this.g[J],d||(d=this.g[J]=[],this.h++);const fe=Te(d,_,N,G);return fe>-1?(_=d[fe],x||(_.fa=!1)):(_=new le(_,this.src,J,!!N,G),_.fa=x,d.push(_)),_};function de(d,_){const x=_.type;if(x in d.g){var N=d.g[x],G=Array.prototype.indexOf.call(N,_,void 0),J;(J=G>=0)&&Array.prototype.splice.call(N,G,1),J&&(_e(_),d.g[x].length==0&&(delete d.g[x],d.h--))}}function Te(d,_,x,N){for(let G=0;G<d.length;++G){const J=d[G];if(!J.da&&J.listener==_&&J.capture==!!x&&J.ha==N)return G}return-1}var Ie="closure_lm_"+(Math.random()*1e6|0),Je={};function nt(d,_,x,N,G){if(Array.isArray(_)){for(let J=0;J<_.length;J++)nt(d,_[J],x,N,G);return null}return x=fi(x),d&&d[xe]?d.J(_,x,f(N)?!!N.capture:!1,G):Me(d,_,x,!1,N,G)}function Me(d,_,x,N,G,J){if(!_)throw Error("Invalid event type");const fe=f(G)?!!G.capture:!!G;let Ue=zs(d);if(Ue||(d[Ie]=Ue=new ie(d)),x=Ue.add(_,x,N,fe,J),x.proxy)return x;if(N=mt(),x.proxy=N,N.src=d,N.listener=x,d.addEventListener)H||(G=fe),G===void 0&&(G=!1),d.addEventListener(_.toString(),N,G);else if(d.attachEvent)d.attachEvent(Ze(_.toString()),N);else if(d.addListener&&d.removeListener)d.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return x}function mt(){function d(x){return _.call(d.src,d.listener,x)}const _=Cn;return d}function Rn(d,_,x,N,G){if(Array.isArray(_))for(var J=0;J<_.length;J++)Rn(d,_[J],x,N,G);else N=f(N)?!!N.capture:!!N,x=fi(x),d&&d[xe]?(d=d.i,J=String(_).toString(),J in d.g&&(_=d.g[J],x=Te(_,x,N,G),x>-1&&(_e(_[x]),Array.prototype.splice.call(_,x,1),_.length==0&&(delete d.g[J],d.h--)))):d&&(d=zs(d))&&(_=d.g[_.toString()],d=-1,_&&(d=Te(_,x,N,G)),(x=d>-1?_[d]:null)&&rs(x))}function rs(d){if(typeof d!="number"&&d&&!d.da){var _=d.src;if(_&&_[xe])de(_.i,d);else{var x=d.type,N=d.proxy;_.removeEventListener?_.removeEventListener(x,N,d.capture):_.detachEvent?_.detachEvent(Ze(x),N):_.addListener&&_.removeListener&&_.removeListener(N),(x=zs(_))?(de(x,d),x.h==0&&(x.src=null,_[Ie]=null)):_e(d)}}}function Ze(d){return d in Je?Je[d]:Je[d]="on"+d}function Cn(d,_){if(d.da)d=!0;else{_=new me(_,this);const x=d.listener,N=d.ha||d.src;d.fa&&rs(d),d=x.call(N,_)}return d}function zs(d){return d=d[Ie],d instanceof ie?d:null}var cr="__closure_events_fn_"+(Math.random()*1e9>>>0);function fi(d){return typeof d=="function"?d:(d[cr]||(d[cr]=function(_){return d.handleEvent(_)}),d[cr])}function jt(){U.call(this),this.i=new ie(this),this.M=this,this.G=null}w(jt,U),jt.prototype[xe]=!0,jt.prototype.removeEventListener=function(d,_,x,N){Rn(this,d,_,x,N)};function Lt(d,_){var x,N=d.G;if(N)for(x=[];N;N=N.G)x.push(N);if(d=d.M,N=_.type||_,typeof _=="string")_=new P(_,d);else if(_ instanceof P)_.target=_.target||d;else{var G=_;_=new P(N,d),W(_,G)}G=!0;let J,fe;if(x)for(fe=x.length-1;fe>=0;fe--)J=_.g=x[fe],G=qs(J,N,!0,_)&&G;if(J=_.g=d,G=qs(J,N,!0,_)&&G,G=qs(J,N,!1,_)&&G,x)for(fe=0;fe<x.length;fe++)J=_.g=x[fe],G=qs(J,N,!1,_)&&G}jt.prototype.N=function(){if(jt.Z.N.call(this),this.i){var d=this.i;for(const _ in d.g){const x=d.g[_];for(let N=0;N<x.length;N++)_e(x[N]);delete d.g[_],d.h--}}this.G=null},jt.prototype.J=function(d,_,x,N){return this.i.add(String(d),_,!1,x,N)},jt.prototype.K=function(d,_,x,N){return this.i.add(String(d),_,!0,x,N)};function qs(d,_,x,N){if(_=d.i.g[String(_)],!_)return!0;_=_.concat();let G=!0;for(let J=0;J<_.length;++J){const fe=_[J];if(fe&&!fe.da&&fe.capture==x){const Ue=fe.listener,Gt=fe.ha||fe.src;fe.fa&&de(d.i,fe),G=Ue.call(Gt,N)!==!1&&G}}return G&&!N.defaultPrevented}function Aa(d,_){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=y(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:c.setTimeout(d,_||0)}function jo(d){d.g=Aa(()=>{d.g=null,d.i&&(d.i=!1,jo(d))},d.l);const _=d.h;d.h=null,d.m.apply(null,_)}class bn extends U{constructor(_,x){super(),this.m=_,this.l=x,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:jo(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function As(d){U.call(this),this.h=d,this.g={}}w(As,U);var Hs=[];function Na(d){De(d.g,function(_,x){this.g.hasOwnProperty(x)&&rs(_)},d),d.g={}}As.prototype.N=function(){As.Z.N.call(this),Na(this)},As.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var $s=c.JSON.stringify,ko=c.JSON.parse,Ra=class{stringify(d){return c.JSON.stringify(d,void 0)}parse(d){return c.JSON.parse(d,void 0)}};function Ca(){}function Fs(){}var is={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function $t(){P.call(this,"d")}w($t,P);function Kn(){P.call(this,"c")}w(Kn,P);var At={},Ia=null;function ur(){return Ia=Ia||new jt}At.Ia="serverreachability";function ja(d){P.call(this,At.Ia,d)}w(ja,P);function In(d){const _=ur();Lt(_,new ja(_))}At.STAT_EVENT="statevent";function Lr(d,_){P.call(this,At.STAT_EVENT,d),this.stat=_}w(Lr,P);function Vt(d){const _=ur();Lt(_,new Lr(_,d))}At.Ja="timingevent";function Qn(d,_){P.call(this,At.Ja,d),this.size=_}w(Qn,P);function fn(d,_){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){d()},_)}function as(){this.g=!0}as.prototype.ua=function(){this.g=!1};function mi(d,_,x,N,G,J){d.info(function(){if(d.g)if(J){var fe="",Ue=J.split("&");for(let it=0;it<Ue.length;it++){var Gt=Ue[it].split("=");if(Gt.length>1){const Rt=Gt[0];Gt=Gt[1];const ks=Rt.split("_");fe=ks.length>=2&&ks[1]=="type"?fe+(Rt+"="+Gt+"&"):fe+(Rt+"=redacted&")}}}else fe=null;else fe=J;return"XMLHTTP REQ ("+N+") [attempt "+G+"]: "+_+`
`+x+`
`+fe})}function ka(d,_,x,N,G,J,fe){d.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+G+"]: "+_+`
`+x+`
`+J+" "+fe})}function zn(d,_,x,N){d.info(function(){return"XMLHTTP TEXT ("+_+"): "+dr(d,x)+(N?" "+N:"")})}function hr(d,_){d.info(function(){return"TIMEOUT: "+_})}as.prototype.info=function(){};function dr(d,_){if(!d.g)return _;if(!_)return null;try{const J=JSON.parse(_);if(J){for(d=0;d<J.length;d++)if(Array.isArray(J[d])){var x=J[d];if(!(x.length<2)){var N=x[1];if(Array.isArray(N)&&!(N.length<1)){var G=N[0];if(G!="noop"&&G!="stop"&&G!="close")for(let fe=1;fe<N.length;fe++)N[fe]=""}}}}return $s(J)}catch{return _}}var fr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},gi={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},pi;function mr(){}w(mr,Ca),mr.prototype.g=function(){return new XMLHttpRequest},pi=new mr;function os(d){return encodeURIComponent(String(d))}function Oo(d){var _=1;d=d.split(":");const x=[];for(;_>0&&d.length;)x.push(d.shift()),_--;return d.length&&x.push(d.join(":")),x}function ls(d,_,x,N){this.j=d,this.i=_,this.l=x,this.S=N||1,this.V=new As(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new cs}function cs(){this.i=null,this.g="",this.h=!1}var Ut={},Xt={};function Ns(d,_,x){d.M=1,d.A=Oa(Wt(_)),d.u=x,d.R=!0,yi(d,null)}function yi(d,_){d.F=Date.now(),Rs(d),d.B=Wt(d.A);var x=d.B,N=d.S;Array.isArray(N)||(N=[String(N)]),Lo(x.i,"t",N),d.C=0,x=d.j.L,d.h=new cs,d.g=mh(d.j,x?_:null,!d.u),d.P>0&&(d.O=new bn(y(d.Y,d,d.g),d.P)),_=d.V,x=d.g,N=d.ba;var G="readystatechange";Array.isArray(G)||(G&&(Hs[0]=G.toString()),G=Hs);for(let J=0;J<G.length;J++){const fe=nt(x,G[J],N||_.handleEvent,!1,_.h||_);if(!fe)break;_.g[fe.key]=fe}_=d.J?z(d.J):{},d.u?(d.v||(d.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,_)):(d.v="GET",d.g.ea(d.B,d.v,null,_)),In(),mi(d.i,d.v,d.B,d.l,d.S,d.u)}ls.prototype.ba=function(d){d=d.target;const _=this.O;_&&Qs(d)==3?_.j():this.Y(d)},ls.prototype.Y=function(d){try{if(d==this.g)e:{const Ue=Qs(this.g),Gt=this.g.ya(),it=this.g.ca();if(!(Ue<3)&&(Ue!=3||this.g&&(this.h.h||this.g.la()||wn(this.g)))){this.K||Ue!=4||Gt==7||(Gt==8||it<=0?In(3):In(2)),us(this);var _=this.g.ca();this.X=_;var x=cc(this);if(this.o=_==200,ka(this.i,this.v,this.B,this.l,this.S,Ue,_),this.o){if(this.U&&!this.L){t:{if(this.g){var N,G=this.g;if((N=G.g?G.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(N)){var J=N;break t}}J=null}if(d=J)zn(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Cs(this,d);else{this.o=!1,this.m=3,Vt(12),qn(this),jn(this);break e}}if(this.R){d=!0;let Rt;for(;!this.K&&this.C<x.length;)if(Rt=Mo(this,x),Rt==Xt){Ue==4&&(this.m=4,Vt(14),d=!1),zn(this.i,this.l,null,"[Incomplete Response]");break}else if(Rt==Ut){this.m=4,Vt(15),zn(this.i,this.l,x,"[Invalid Chunk]"),d=!1;break}else zn(this.i,this.l,Rt,null),Cs(this,Rt);if(Do(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ue!=4||x.length!=0||this.h.h||(this.m=1,Vt(16),d=!1),this.o=this.o&&d,!d)zn(this.i,this.l,x,"[Invalid Chunked Response]"),qn(this),jn(this);else if(x.length>0&&!this.W){this.W=!0;var fe=this.j;fe.g==this&&fe.aa&&!fe.P&&(fe.j.info("Great, no buffering proxy detected. Bytes received: "+x.length),vc(fe),fe.P=!0,Vt(11))}}else zn(this.i,this.l,x,null),Cs(this,x);Ue==4&&qn(this),this.o&&!this.K&&(Ue==4?uh(this.j,this):(this.o=!1,Rs(this)))}else Ur(this.g),_==400&&x.indexOf("Unknown SID")>0?(this.m=3,Vt(12)):(this.m=0,Vt(13)),qn(this),jn(this)}}}catch{}finally{}};function cc(d){if(!Do(d))return d.g.la();const _=wn(d.g);if(_==="")return"";let x="";const N=_.length,G=Qs(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return qn(d),jn(d),"";d.h.i=new c.TextDecoder}for(let J=0;J<N;J++)d.h.h=!0,x+=d.h.i.decode(_[J],{stream:!(G&&J==N-1)});return _.length=0,d.h.g+=x,d.C=0,d.h.g}function Do(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function Mo(d,_){var x=d.C,N=_.indexOf(`
`,x);return N==-1?Xt:(x=Number(_.substring(x,N)),isNaN(x)?Ut:(N+=1,N+x>_.length?Xt:(_=_.slice(N,N+x),d.C=N+x,_)))}ls.prototype.cancel=function(){this.K=!0,qn(this)};function Rs(d){d.T=Date.now()+d.H,_i(d,d.H)}function _i(d,_){if(d.D!=null)throw Error("WatchDog timer not null");d.D=fn(y(d.aa,d),_)}function us(d){d.D&&(c.clearTimeout(d.D),d.D=null)}ls.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(hr(this.i,this.B),this.M!=2&&(In(),Vt(17)),qn(this),this.m=2,jn(this)):_i(this,this.T-d)};function jn(d){d.j.I==0||d.K||uh(d.j,d)}function qn(d){us(d);var _=d.O;_&&typeof _.dispose=="function"&&_.dispose(),d.O=null,Na(d.V),d.g&&(_=d.g,d.g=null,_.abort(),_.dispose())}function Cs(d,_){try{var x=d.j;if(x.I!=0&&(x.g==d||Se(x.h,d))){if(!d.L&&Se(x.h,d)&&x.I==3){try{var N=x.Ba.g.parse(_)}catch{N=null}if(Array.isArray(N)&&N.length==3){var G=N;if(G[0]==0){e:if(!x.v){if(x.g)if(x.g.F+3e3<d.F)qo(x),Ni(x);else break e;Ba(x),Vt(18)}}else x.xa=G[1],0<x.xa-x.K&&G[2]<37500&&x.F&&x.A==0&&!x.C&&(x.C=fn(y(x.Va,x),6e3));ce(x.h)<=1&&x.ta&&(x.ta=void 0)}else br(x,11)}else if((d.L||x.g==d)&&qo(x),!A(_))for(G=x.Ba.g.parse(_),_=0;_<G.length;_++){let it=G[_];const Rt=it[0];if(!(Rt<=x.K))if(x.K=Rt,it=it[1],x.I==2)if(it[0]=="c"){x.M=it[1],x.ba=it[2];const ks=it[3];ks!=null&&(x.ka=ks,x.j.info("VER="+x.ka));const wr=it[4];wr!=null&&(x.za=wr,x.j.info("SVER="+x.za));const Ys=it[5];Ys!=null&&typeof Ys=="number"&&Ys>0&&(N=1.5*Ys,x.O=N,x.j.info("backChannelRequestTimeoutMs_="+N)),N=x;const Xs=d.g;if(Xs){const za=Xs.g?Xs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(za){var J=N.h;J.g||za.indexOf("spdy")==-1&&za.indexOf("quic")==-1&&za.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(ze(J,J.h),J.h=null))}if(N.G){const Ho=Xs.g?Xs.g.getResponseHeader("X-HTTP-Session-Id"):null;Ho&&(N.wa=Ho,ct(N.J,N.G,Ho))}}x.I=3,x.l&&x.l.ra(),x.aa&&(x.T=Date.now()-d.F,x.j.info("Handshake RTT: "+x.T+"ms")),N=x;var fe=d;if(N.na=fh(N,N.L?N.ba:null,N.W),fe.L){qe(N.h,fe);var Ue=fe,Gt=N.O;Gt&&(Ue.H=Gt),Ue.D&&(us(Ue),Rs(Ue)),N.g=fe}else lh(N);x.i.length>0&&vr(x)}else it[0]!="stop"&&it[0]!="close"||br(x,7);else x.I==3&&(it[0]=="stop"||it[0]=="close"?it[0]=="stop"?br(x,7):yc(x):it[0]!="noop"&&x.l&&x.l.qa(it),x.A=0)}}In(4)}catch{}}var kt=class{constructor(d,_){this.g=d,this.map=_}};function vi(d){this.l=d||10,c.PerformanceNavigationTiming?(d=c.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function O(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function ce(d){return d.h?1:d.g?d.g.size:0}function Se(d,_){return d.h?d.h==_:d.g?d.g.has(_):!1}function ze(d,_){d.g?d.g.add(_):d.h=_}function qe(d,_){d.h&&d.h==_?d.h=null:d.g&&d.g.has(_)&&d.g.delete(_)}vi.prototype.cancel=function(){if(this.i=ln(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function ln(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let _=d.i;for(const x of d.g.values())_=_.concat(x.G);return _}return S(d.i)}var Nt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ot(d,_){if(d){d=d.split("&");for(let x=0;x<d.length;x++){const N=d[x].indexOf("=");let G,J=null;N>=0?(G=d[x].substring(0,N),J=d[x].substring(N+1)):G=d[x],_(G,J?decodeURIComponent(J.replace(/\+/g," ")):"")}}}function Ft(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;d instanceof Ft?(this.l=d.l,mn(this,d.j),this.o=d.o,this.g=d.g,bi(this,d.u),this.h=d.h,uc(this,ah(d.i)),this.m=d.m):d&&(_=String(d).match(Nt))?(this.l=!1,mn(this,_[1]||"",!0),this.o=gr(_[2]||""),this.g=gr(_[3]||"",!0),bi(this,_[4]),this.h=gr(_[5]||"",!0),uc(this,_[6]||"",!0),this.m=gr(_[7]||"")):(this.l=!1,this.i=new xi(null,this.l))}Ft.prototype.toString=function(){const d=[];var _=this.j;_&&d.push(Da(_,Po,!0),":");var x=this.g;return(x||_=="file")&&(d.push("//"),(_=this.o)&&d.push(Da(_,Po,!0),"@"),d.push(os(x).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.u,x!=null&&d.push(":",String(x))),(x=this.h)&&(this.g&&x.charAt(0)!="/"&&d.push("/"),d.push(Da(x,x.charAt(0)=="/"?hc:sh,!0))),(x=this.i.toString())&&d.push("?",x),(x=this.m)&&d.push("#",Da(x,rh)),d.join("")},Ft.prototype.resolve=function(d){const _=Wt(this);let x=!!d.j;x?mn(_,d.j):x=!!d.o,x?_.o=d.o:x=!!d.g,x?_.g=d.g:x=d.u!=null;var N=d.h;if(x)bi(_,d.u);else if(x=!!d.h){if(N.charAt(0)!="/")if(this.g&&!this.h)N="/"+N;else{var G=_.h.lastIndexOf("/");G!=-1&&(N=_.h.slice(0,G+1)+N)}if(G=N,G==".."||G==".")N="";else if(G.indexOf("./")!=-1||G.indexOf("/.")!=-1){N=G.lastIndexOf("/",0)==0,G=G.split("/");const J=[];for(let fe=0;fe<G.length;){const Ue=G[fe++];Ue=="."?N&&fe==G.length&&J.push(""):Ue==".."?((J.length>1||J.length==1&&J[0]!="")&&J.pop(),N&&fe==G.length&&J.push("")):(J.push(Ue),N=!0)}N=J.join("/")}else N=G}return x?_.h=N:x=d.i.toString()!=="",x?uc(_,ah(d.i)):x=!!d.m,x&&(_.m=d.m),_};function Wt(d){return new Ft(d)}function mn(d,_,x){d.j=x?gr(_,!0):_,d.j&&(d.j=d.j.replace(/:$/,""))}function bi(d,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);d.u=_}else d.u=null}function uc(d,_,x){_ instanceof xi?(d.i=_,Vo(d.i,d.l)):(x||(_=Da(_,wi)),d.i=new xi(_,d.l))}function ct(d,_,x){d.i.set(_,x)}function Oa(d){return ct(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function gr(d,_){return d?_?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Da(d,_,x){return typeof d=="string"?(d=encodeURI(d).replace(_,Yn),x&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function Yn(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var Po=/[#\/\?@]/g,sh=/[#\?:]/g,hc=/[#\?]/g,wi=/[#\?@]/g,rh=/#/g;function xi(d,_){this.h=this.g=null,this.i=d||null,this.j=!!_}function Xn(d){d.g||(d.g=new Map,d.h=0,d.i&&Ot(d.i,function(_,x){d.add(decodeURIComponent(_.replace(/\+/g," ")),x)}))}n=xi.prototype,n.add=function(d,_){Xn(this),this.i=null,d=Ei(this,d);let x=this.g.get(d);return x||this.g.set(d,x=[]),x.push(_),this.h+=1,this};function ih(d,_){Xn(d),_=Ei(d,_),d.g.has(_)&&(d.i=null,d.h-=d.g.get(_).length,d.g.delete(_))}function dc(d,_){return Xn(d),_=Ei(d,_),d.g.has(_)}n.forEach=function(d,_){Xn(this),this.g.forEach(function(x,N){x.forEach(function(G){d.call(_,G,N,this)},this)},this)};function fc(d,_){Xn(d);let x=[];if(typeof _=="string")dc(d,_)&&(x=x.concat(d.g.get(Ei(d,_))));else for(d=Array.from(d.g.values()),_=0;_<d.length;_++)x=x.concat(d[_]);return x}n.set=function(d,_){return Xn(this),this.i=null,d=Ei(this,d),dc(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[_]),this.h+=1,this},n.get=function(d,_){return d?(d=fc(this,d),d.length>0?String(d[0]):_):_};function Lo(d,_,x){ih(d,_),x.length>0&&(d.i=null,d.g.set(Ei(d,_),S(x)),d.h+=x.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],_=Array.from(this.g.keys());for(let N=0;N<_.length;N++){var x=_[N];const G=os(x);x=fc(this,x);for(let J=0;J<x.length;J++){let fe=G;x[J]!==""&&(fe+="="+os(x[J])),d.push(fe)}}return this.i=d.join("&")};function ah(d){const _=new xi;return _.i=d.i,d.g&&(_.g=new Map(d.g),_.h=d.h),_}function Ei(d,_){return _=String(_),d.j&&(_=_.toLowerCase()),_}function Vo(d,_){_&&!d.j&&(Xn(d),d.i=null,d.g.forEach(function(x,N){const G=N.toLowerCase();N!=G&&(ih(this,N),Lo(this,G,x))},d)),d.j=_}function Gs(d,_){const x=new as;if(c.Image){const N=new Image;N.onload=v(Is,x,"TestLoadImage: loaded",!0,_,N),N.onerror=v(Is,x,"TestLoadImage: error",!1,_,N),N.onabort=v(Is,x,"TestLoadImage: abort",!1,_,N),N.ontimeout=v(Is,x,"TestLoadImage: timeout",!1,_,N),c.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=d}else _(!1)}function mc(d,_){const x=new as,N=new AbortController,G=setTimeout(()=>{N.abort(),Is(x,"TestPingServer: timeout",!1,_)},1e4);fetch(d,{signal:N.signal}).then(J=>{clearTimeout(G),J.ok?Is(x,"TestPingServer: ok",!0,_):Is(x,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(G),Is(x,"TestPingServer: error",!1,_)})}function Is(d,_,x,N,G){try{G&&(G.onload=null,G.onerror=null,G.onabort=null,G.ontimeout=null),N(x)}catch{}}function Ti(){this.g=new Ra}function pr(d){this.i=d.Sb||null,this.h=d.ab||!1}w(pr,Ca),pr.prototype.g=function(){return new Ma(this.i,this.h)};function Ma(d,_){jt.call(this),this.H=d,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}w(Ma,jt),n=Ma.prototype,n.open=function(d,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=_,this.readyState=1,Ks(this)},n.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(_.body=d),(this.H||c).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Si(this)),this.readyState=0},n.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Ks(this)),this.g&&(this.readyState=3,Ks(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Uo(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function Uo(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}n.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var _=d.value?d.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!d.done}))&&(this.response=this.responseText+=_)}d.done?Si(this):Ks(this),this.readyState==3&&Uo(this)}},n.Oa=function(d){this.g&&(this.response=this.responseText=d,Si(this))},n.Na=function(d){this.g&&(this.response=d,Si(this))},n.ga=function(){this.g&&Si(this)};function Si(d){d.readyState=4,d.l=null,d.j=null,d.B=null,Ks(d)}n.setRequestHeader=function(d,_){this.A.append(d,_)},n.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],_=this.h.entries();for(var x=_.next();!x.done;)x=x.value,d.push(x[0]+": "+x[1]),x=_.next();return d.join(`\r
`)};function Ks(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(Ma.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function js(d){let _="";return De(d,function(x,N){_+=N,_+=":",_+=x,_+=`\r
`}),_}function Pa(d,_,x){e:{for(N in x){var N=!1;break e}N=!0}N||(x=js(x),typeof d=="string"?x!=null&&os(x):ct(d,_,x))}function gt(d){jt.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}w(gt,jt);var yr=/^https?$/i,gc=["POST","PUT"];n=gt.prototype,n.Fa=function(d){this.H=d},n.ea=function(d,_,x,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);_=_?_.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():pi.g(),this.g.onreadystatechange=E(y(this.Ca,this));try{this.B=!0,this.g.open(_,String(d),!0),this.B=!1}catch(J){La(this,J);return}if(d=x||"",x=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var G in N)x.set(G,N[G]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const J of N.keys())x.set(J,N.get(J));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(x.keys()).find(J=>J.toLowerCase()=="content-type"),G=c.FormData&&d instanceof c.FormData,!(Array.prototype.indexOf.call(gc,_,void 0)>=0)||N||G||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,fe]of x)this.g.setRequestHeader(J,fe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(J){La(this,J)}};function La(d,_){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=_,d.o=5,pc(d),Vr(d)}function pc(d){d.A||(d.A=!0,Lt(d,"complete"),Lt(d,"error"))}n.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,Lt(this,"complete"),Lt(this,"abort"),Vr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Vr(this,!0)),gt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Va(this):this.Xa())},n.Xa=function(){Va(this)};function Va(d){if(d.h&&typeof l<"u"){if(d.v&&Qs(d)==4)setTimeout(d.Ca.bind(d),0);else if(Lt(d,"readystatechange"),Qs(d)==4){d.h=!1;try{const J=d.ca();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var x;if(!(x=_)){var N;if(N=J===0){let fe=String(d.D).match(Nt)[1]||null;!fe&&c.self&&c.self.location&&(fe=c.self.location.protocol.slice(0,-1)),N=!yr.test(fe?fe.toLowerCase():"")}x=N}if(x)Lt(d,"complete"),Lt(d,"success");else{d.o=6;try{var G=Qs(d)>2?d.g.statusText:""}catch{G=""}d.l=G+" ["+d.ca()+"]",pc(d)}}finally{Vr(d)}}}}function Vr(d,_){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const x=d.g;d.g=null,_||Lt(d,"ready");try{x.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Qs(d){return d.g?d.g.readyState:0}n.ca=function(){try{return Qs(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(d){if(this.g){var _=this.g.responseText;return d&&_.indexOf(d)==0&&(_=_.substring(d.length)),ko(_)}};function wn(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Ur(d){const _={};d=(d.g&&Qs(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<d.length;N++){if(A(d[N]))continue;var x=Oo(d[N]);const G=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const J=_[G]||[];_[G]=J,J.push(x)}$e(_,function(N){return N.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function _r(d,_,x){return x&&x.internalChannelParams&&x.internalChannelParams[d]||_}function Ai(d){this.za=0,this.i=[],this.j=new as,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=_r("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=_r("baseRetryDelayMs",5e3,d),this.Za=_r("retryDelaySeedMs",1e4,d),this.Ta=_r("forwardChannelMaxRetries",2,d),this.va=_r("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new vi(d&&d.concurrentRequestLimit),this.Ba=new Ti,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ai.prototype,n.ka=8,n.I=1,n.connect=function(d,_,x,N){Vt(0),this.W=d,this.H=_||{},x&&N!==void 0&&(this.H.OSID=x,this.H.OAID=N),this.F=this.X,this.J=fh(this,null,this.W),vr(this)};function yc(d){if(Bo(d),d.I==3){var _=d.V++,x=Wt(d.J);if(ct(x,"SID",d.M),ct(x,"RID",_),ct(x,"TYPE","terminate"),Ua(d,x),_=new ls(d,d.j,_),_.M=2,_.A=Oa(Wt(x)),x=!1,c.navigator&&c.navigator.sendBeacon)try{x=c.navigator.sendBeacon(_.A.toString(),"")}catch{}!x&&c.Image&&(new Image().src=_.A,x=!0),x||(_.g=mh(_.j,null),_.g.ea(_.A)),_.F=Date.now(),Rs(_)}dh(d)}function Ni(d){d.g&&(vc(d),d.g.cancel(),d.g=null)}function Bo(d){Ni(d),d.v&&(c.clearTimeout(d.v),d.v=null),qo(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&c.clearTimeout(d.m),d.m=null)}function vr(d){if(!O(d.h)&&!d.m){d.m=!0;var _=d.Ea;he||I(),ue||(he(),ue=!0),C.add(_,d),d.D=0}}function zo(d,_){return ce(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=_.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=fn(y(d.Ea,d,_),hh(d,d.D)),d.D++,!0)}n.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const G=new ls(this,this.j,d);let J=this.o;if(this.U&&(J?(J=z(J),W(J,this.U)):J=this.U),this.u!==null||this.R||(G.J=J,J=null),this.S)e:{for(var _=0,x=0;x<this.i.length;x++){t:{var N=this.i[x];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(_+=N,_>4096){_=x;break e}if(_===4096||x===this.i.length-1){_=x+1;break e}}_=1e3}else _=1e3;_=oh(this,G,_),x=Wt(this.J),ct(x,"RID",d),ct(x,"CVER",22),this.G&&ct(x,"X-HTTP-Session-Id",this.G),Ua(this,x),J&&(this.R?_="headers="+os(js(J))+"&"+_:this.u&&Pa(x,this.u,J)),ze(this.h,G),this.Ra&&ct(x,"TYPE","init"),this.S?(ct(x,"$req",_),ct(x,"SID","null"),G.U=!0,Ns(G,x,null)):Ns(G,x,_),this.I=2}}else this.I==3&&(d?_c(this,d):this.i.length==0||O(this.h)||_c(this))};function _c(d,_){var x;_?x=_.l:x=d.V++;const N=Wt(d.J);ct(N,"SID",d.M),ct(N,"RID",x),ct(N,"AID",d.K),Ua(d,N),d.u&&d.o&&Pa(N,d.u,d.o),x=new ls(d,d.j,x,d.D+1),d.u===null&&(x.J=d.o),_&&(d.i=_.G.concat(d.i)),_=oh(d,x,1e3),x.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),ze(d.h,x),Ns(x,N,_)}function Ua(d,_){d.H&&De(d.H,function(x,N){ct(_,N,x)}),d.l&&De({},function(x,N){ct(_,N,x)})}function oh(d,_,x){x=Math.min(d.i.length,x);const N=d.l?y(d.l.Ka,d.l,d):null;e:{var G=d.i;let Ue=-1;for(;;){const Gt=["count="+x];Ue==-1?x>0?(Ue=G[0].g,Gt.push("ofs="+Ue)):Ue=0:Gt.push("ofs="+Ue);let it=!0;for(let Rt=0;Rt<x;Rt++){var J=G[Rt].g;const ks=G[Rt].map;if(J-=Ue,J<0)Ue=Math.max(0,G[Rt].g-100),it=!1;else try{J="req"+J+"_"||"";try{var fe=ks instanceof Map?ks:Object.entries(ks);for(const[wr,Ys]of fe){let Xs=Ys;f(Ys)&&(Xs=$s(Ys)),Gt.push(J+wr+"="+encodeURIComponent(Xs))}}catch(wr){throw Gt.push(J+"type="+encodeURIComponent("_badmap")),wr}}catch{N&&N(ks)}}if(it){fe=Gt.join("&");break e}}fe=void 0}return d=d.i.splice(0,x),_.G=d,fe}function lh(d){if(!d.g&&!d.v){d.Y=1;var _=d.Da;he||I(),ue||(he(),ue=!0),C.add(_,d),d.A=0}}function Ba(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=fn(y(d.Da,d),hh(d,d.A)),d.A++,!0)}n.Da=function(){if(this.v=null,ch(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=fn(y(this.Wa,this),d)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Vt(10),Ni(this),ch(this))};function vc(d){d.B!=null&&(c.clearTimeout(d.B),d.B=null)}function ch(d){d.g=new ls(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var _=Wt(d.na);ct(_,"RID","rpc"),ct(_,"SID",d.M),ct(_,"AID",d.K),ct(_,"CI",d.F?"0":"1"),!d.F&&d.ia&&ct(_,"TO",d.ia),ct(_,"TYPE","xmlhttp"),Ua(d,_),d.u&&d.o&&Pa(_,d.u,d.o),d.O&&(d.g.H=d.O);var x=d.g;d=d.ba,x.M=1,x.A=Oa(Wt(_)),x.u=null,x.R=!0,yi(x,d)}n.Va=function(){this.C!=null&&(this.C=null,Ni(this),Ba(this),Vt(19))};function qo(d){d.C!=null&&(c.clearTimeout(d.C),d.C=null)}function uh(d,_){var x=null;if(d.g==_){qo(d),vc(d),d.g=null;var N=2}else if(Se(d.h,_))x=_.G,qe(d.h,_),N=1;else return;if(d.I!=0){if(_.o)if(N==1){x=_.u?_.u.length:0,_=Date.now()-_.F;var G=d.D;N=ur(),Lt(N,new Qn(N,x)),vr(d)}else lh(d);else if(G=_.m,G==3||G==0&&_.X>0||!(N==1&&zo(d,_)||N==2&&Ba(d)))switch(x&&x.length>0&&(_=d.h,_.i=_.i.concat(x)),G){case 1:br(d,5);break;case 4:br(d,10);break;case 3:br(d,6);break;default:br(d,2)}}}function hh(d,_){let x=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(x*=2),x*_}function br(d,_){if(d.j.info("Error code "+_),_==2){var x=y(d.bb,d),N=d.Ua;const G=!N;N=new Ft(N||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||mn(N,"https"),Oa(N),G?Gs(N.toString(),x):mc(N.toString(),x)}else Vt(2);d.I=0,d.l&&d.l.pa(_),dh(d),Bo(d)}n.bb=function(d){d?(this.j.info("Successfully pinged google.com"),Vt(2)):(this.j.info("Failed to ping google.com"),Vt(1))};function dh(d){if(d.I=0,d.ja=[],d.l){const _=ln(d.h);(_.length!=0||d.i.length!=0)&&(j(d.ja,_),j(d.ja,d.i),d.h.i.length=0,S(d.i),d.i.length=0),d.l.oa()}}function fh(d,_,x){var N=x instanceof Ft?Wt(x):new Ft(x);if(N.g!="")_&&(N.g=_+"."+N.g),bi(N,N.u);else{var G=c.location;N=G.protocol,_=_?_+"."+G.hostname:G.hostname,G=+G.port;const J=new Ft(null);N&&mn(J,N),_&&(J.g=_),G&&bi(J,G),x&&(J.h=x),N=J}return x=d.G,_=d.wa,x&&_&&ct(N,x,_),ct(N,"VER",d.ka),Ua(d,N),N}function mh(d,_,x){if(_&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=d.Aa&&!d.ma?new gt(new pr({ab:x})):new gt(d.ma),_.Fa(d.L),_}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function gh(){}n=gh.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Ri(){}Ri.prototype.g=function(d,_){return new Hn(d,_)};function Hn(d,_){jt.call(this),this.g=new Ai(_),this.l=d,this.h=_&&_.messageUrlParams||null,d=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(d?d["X-WebChannel-Content-Type"]=_.messageContentType:d={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(d?d["X-WebChannel-Client-Profile"]=_.sa:d={"X-WebChannel-Client-Profile":_.sa}),this.g.U=d,(d=_&&_.Qb)&&!A(d)&&(this.g.u=d),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!A(_)&&(this.g.G=_,d=this.h,d!==null&&_ in d&&(d=this.h,_ in d&&delete d[_])),this.j=new Br(this)}w(Hn,jt),Hn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Hn.prototype.close=function(){yc(this.g)},Hn.prototype.o=function(d){var _=this.g;if(typeof d=="string"){var x={};x.__data__=d,d=x}else this.v&&(x={},x.__data__=$s(d),d=x);_.i.push(new kt(_.Ya++,d)),_.I==3&&vr(_)},Hn.prototype.N=function(){this.g.l=null,delete this.j,yc(this.g),delete this.g,Hn.Z.N.call(this)};function ph(d){$t.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var _=d.__sm__;if(_){e:{for(const x in _){d=x;break e}d=void 0}(this.i=d)&&(d=this.i,_=_!==null&&d in _?_[d]:void 0),this.data=_}else this.data=d}w(ph,$t);function yh(){Kn.call(this),this.status=1}w(yh,Kn);function Br(d){this.g=d}w(Br,gh),Br.prototype.ra=function(){Lt(this.g,"a")},Br.prototype.qa=function(d){Lt(this.g,new ph(d))},Br.prototype.pa=function(d){Lt(this.g,new yh)},Br.prototype.oa=function(){Lt(this.g,"b")},Ri.prototype.createWebChannel=Ri.prototype.g,Hn.prototype.send=Hn.prototype.o,Hn.prototype.open=Hn.prototype.m,Hn.prototype.close=Hn.prototype.close,Jx=function(){return new Ri},Wx=function(){return ur()},Xx=At,Vp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},fr.NO_ERROR=0,fr.TIMEOUT=8,fr.HTTP_ERROR=6,Bd=fr,gi.COMPLETE="complete",Yx=gi,Fs.EventType=is,is.OPEN="a",is.CLOSE="b",is.ERROR="c",is.MESSAGE="d",jt.prototype.listen=jt.prototype.J,ou=Fs,gt.prototype.listenOnce=gt.prototype.K,gt.prototype.getLastError=gt.prototype.Ha,gt.prototype.getLastErrorCode=gt.prototype.ya,gt.prototype.getStatus=gt.prototype.ca,gt.prototype.getResponseJson=gt.prototype.La,gt.prototype.getResponseText=gt.prototype.la,gt.prototype.send=gt.prototype.ea,gt.prototype.setWithCredentials=gt.prototype.Fa,Qx=gt}).apply(typeof wd<"u"?wd:typeof self<"u"?self:typeof window<"u"?window:{});const A1="@firebase/firestore",N1="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Pn.UNAUTHENTICATED=new Pn(null),Pn.GOOGLE_CREDENTIALS=new Pn("google-credentials-uid"),Pn.FIRST_PARTY=new Pn("first-party-uid"),Pn.MOCK_USER=new Pn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zl="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yo=new R0("@firebase/firestore");function Sl(){return yo.logLevel}function ye(n,...e){if(yo.logLevel<=Ye.DEBUG){const t=e.map(I0);yo.debug(`Firestore (${Zl}): ${n}`,...t)}}function ui(n,...e){if(yo.logLevel<=Ye.ERROR){const t=e.map(I0);yo.error(`Firestore (${Zl}): ${n}`,...t)}}function _o(n,...e){if(yo.logLevel<=Ye.WARN){const t=e.map(I0);yo.warn(`Firestore (${Zl}): ${n}`,...t)}}function I0(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oe(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Zx(n,r,t)}function Zx(n,e,t){let r=`FIRESTORE (${Zl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw ui(r),new Error(r)}function lt(n,e,t,r){let a="Unexpected state";typeof t=="string"?a=t:r=t,n||Zx(e,a,r)}function Ve(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ge extends Mr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class t2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Pn.UNAUTHENTICATED)))}shutdown(){}}class v5{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class b5{constructor(e){this.t=e,this.currentUser=Pn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){lt(this.o===void 0,42304);let r=this.i;const a=g=>this.i!==r?(r=this.i,t(g)):Promise.resolve();let l=new ii;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new ii,e.enqueueRetryable((()=>a(this.currentUser)))};const c=()=>{const g=l;e.enqueueRetryable((async()=>{await g.promise,await a(this.currentUser)}))},f=g=>{ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((g=>f(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?f(g):(ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new ii)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(lt(typeof r.accessToken=="string",31837,{l:r}),new e2(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return lt(e===null||typeof e=="string",2055,{h:e}),new Pn(e)}}class w5{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Pn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class x5{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new w5(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Pn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class R1{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class E5{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,bs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){lt(this.o===void 0,3512);const r=l=>{l.error!=null&&ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,ye("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>r(l)))};const a=l=>{ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new R1(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(lt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new R1(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T5(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const a=T5(40);for(let l=0;l<a.length;++l)r.length<20&&a[l]<t&&(r+=e.charAt(a[l]%62))}return r}}function Xe(n,e){return n<e?-1:n>e?1:0}function Up(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++){const a=n.charAt(r),l=e.charAt(r);if(a!==l)return dp(a)===dp(l)?Xe(a,l):dp(a)?1:-1}return Xe(n.length,e.length)}const S5=55296,A5=57343;function dp(n){const e=n.charCodeAt(0);return e>=S5&&e<=A5}function Hl(n,e,t){return n.length===e.length&&n.every(((r,a)=>t(r,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bp="__name__";class Nr{constructor(e,t,r){t===void 0?t=0:t>e.length&&Oe(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Oe(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Nr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Nr?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let a=0;a<r;a++){const l=Nr.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return Xe(e.length,t.length)}static compareSegments(e,t){const r=Nr.isNumericId(e),a=Nr.isNumericId(t);return r&&!a?-1:!r&&a?1:r&&a?Nr.extractNumericId(e).compare(Nr.extractNumericId(t)):Up(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ca.fromString(e.substring(4,e.length-2))}}class Et extends Nr{construct(e,t,r){return new Et(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ge(re.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((a=>a.length>0)))}return new Et(t)}static emptyPath(){return new Et([])}}const N5=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class yn extends Nr{construct(e,t,r){return new yn(e,t,r)}static isValidIdentifier(e){return N5.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),yn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Bp}static keyField(){return new yn([Bp])}static fromServerFormat(e){const t=[];let r="",a=0;const l=()=>{if(r.length===0)throw new ge(re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let c=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new ge(re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[a+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new ge(re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=g,a+=2}else f==="`"?(c=!c,a++):f!=="."||c?(r+=f,a++):(l(),a++)}if(l(),c)throw new ge(re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new yn(t)}static emptyPath(){return new yn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e){this.path=e}static fromPath(e){return new Ae(Et.fromString(e))}static fromName(e){return new Ae(Et.fromString(e).popFirst(5))}static empty(){return new Ae(Et.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Et.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Et.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ae(new Et(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n2(n,e,t){if(!t)throw new ge(re.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function s2(n,e,t,r){if(e===!0&&r===!0)throw new ge(re.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function C1(n){if(!Ae.isDocumentKey(n))throw new ge(re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function I1(n){if(Ae.isDocumentKey(n))throw new ge(re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function r2(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function If(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Oe(12329,{type:typeof n})}function Vn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ge(re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=If(n);throw new ge(re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function an(n,e){const t={typeString:n};return e&&(t.value=e),t}function $u(n,e){if(!r2(n))throw new ge(re.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const a=e[r].typeString,l="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const c=n[r];if(a&&typeof c!==a){t=`JSON field '${r}' must be a ${a}.`;break}if(l!==void 0&&c!==l.value){t=`Expected '${r}' field to equal '${l.value}'`;break}}if(t)throw new ge(re.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j1=-62135596800,k1=1e6;class vt{static now(){return vt.fromMillis(Date.now())}static fromDate(e){return vt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*k1);return new vt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ge(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ge(re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<j1)throw new ge(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ge(re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/k1}_compareTo(e){return this.seconds===e.seconds?Xe(this.nanoseconds,e.nanoseconds):Xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:vt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if($u(e,vt._jsonSchema))return new vt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-j1;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}vt._jsonSchemaVersion="firestore/timestamp/1.0",vt._jsonSchema={type:an("string",vt._jsonSchemaVersion),seconds:an("number"),nanoseconds:an("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{static fromTimestamp(e){return new Pe(e)}static min(){return new Pe(new vt(0,0))}static max(){return new Pe(new vt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Au=-1;function R5(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,a=Pe.fromTimestamp(r===1e9?new vt(t+1,0):new vt(t,r));return new fa(a,Ae.empty(),e)}function C5(n){return new fa(n.readTime,n.key,Au)}class fa{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new fa(Pe.min(),Ae.empty(),Au)}static max(){return new fa(Pe.max(),Ae.empty(),Au)}}function I5(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ae.comparator(n.documentKey,e.documentKey),t!==0?t:Xe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j5="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class k5{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ec(n){if(n.code!==re.FAILED_PRECONDITION||n.message!==j5)throw n;ye("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Oe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new oe(((r,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(r,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(r,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof oe?t:oe.resolve(t)}catch(t){return oe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):oe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):oe.reject(t)}static resolve(e){return new oe(((t,r)=>{t(e)}))}static reject(e){return new oe(((t,r)=>{r(e)}))}static waitFor(e){return new oe(((t,r)=>{let a=0,l=0,c=!1;e.forEach((f=>{++a,f.next((()=>{++l,c&&l===a&&t()}),(g=>r(g)))})),c=!0,l===a&&t()}))}static or(e){let t=oe.resolve(!1);for(const r of e)t=t.next((a=>a?oe.resolve(a):r()));return t}static forEach(e,t){const r=[];return e.forEach(((a,l)=>{r.push(t.call(this,a,l))})),this.waitFor(r)}static mapArray(e,t){return new oe(((r,a)=>{const l=e.length,c=new Array(l);let f=0;for(let g=0;g<l;g++){const y=g;t(e[y]).next((v=>{c[y]=v,++f,f===l&&r(c)}),(v=>a(v)))}}))}static doWhile(e,t){return new oe(((r,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):r()};l()}))}}function O5(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function tc(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}jf.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j0=-1;function kf(n){return n==null}function Xd(n){return n===0&&1/n==-1/0}function D5(n){return typeof n=="number"&&Number.isInteger(n)&&!Xd(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i2="";function M5(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=O1(e)),e=P5(n.get(t),e);return O1(e)}function P5(n,e){let t=e;const r=n.length;for(let a=0;a<r;a++){const l=n.charAt(a);switch(l){case"\0":t+="";break;case i2:t+="";break;default:t+=l}}return t}function O1(n){return n+i2+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D1(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function wa(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function a2(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e,t){this.comparator=e,this.root=t||Nn.EMPTY}insert(e,t){return new Pt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Nn.BLACK,null,null))}remove(e){return new Pt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Nn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const a=this.comparator(e,r.key);if(a===0)return t+r.left.size;a<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new xd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new xd(this.root,e,this.comparator,!1)}getReverseIterator(){return new xd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new xd(this.root,e,this.comparator,!0)}}class xd{constructor(e,t,r,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?r(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Nn{constructor(e,t,r,a,l){this.key=e,this.value=t,this.color=r??Nn.RED,this.left=a??Nn.EMPTY,this.right=l??Nn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,a,l){return new Nn(e??this.key,t??this.value,r??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let a=this;const l=r(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,r),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,r)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Nn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return Nn.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Nn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Nn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Oe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Oe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Oe(27949);return e+(this.isRed()?0:1)}}Nn.EMPTY=null,Nn.RED=!0,Nn.BLACK=!1;Nn.EMPTY=new class{constructor(){this.size=0}get key(){throw Oe(57766)}get value(){throw Oe(16141)}get color(){throw Oe(16727)}get left(){throw Oe(29726)}get right(){throw Oe(36894)}copy(e,t,r,a,l){return this}insert(e,t,r){return new Nn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e){this.comparator=e,this.data=new Pt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const a=r.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new M1(this.data.getIterator())}getIteratorFrom(e){return new M1(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof dn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=r.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new dn(this.comparator);return t.data=e,t}}class M1{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e){this.fields=e,e.sort(yn.comparator)}static empty(){return new Ts([])}unionWith(e){let t=new dn(yn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Ts(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Hl(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new o2("Invalid base64 string: "+l):l}})(e);return new vn(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let c=0;c<a.length;++c)l+=String.fromCharCode(a[c]);return l})(e);return new vn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}vn.EMPTY_BYTE_STRING=new vn("");const L5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ma(n){if(lt(!!n,39018),typeof n=="string"){let e=0;const t=L5.exec(n);if(lt(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Yt(n.seconds),nanos:Yt(n.nanos)}}function Yt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ga(n){return typeof n=="string"?vn.fromBase64String(n):vn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2="server_timestamp",c2="__type__",u2="__previous_value__",h2="__local_write_time__";function k0(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[c2])==null?void 0:r.stringValue)===l2}function Of(n){const e=n.mapValue.fields[u2];return k0(e)?Of(e):e}function Nu(n){const e=ma(n.mapValue.fields[h2].timestampValue);return new vt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V5{constructor(e,t,r,a,l,c,f,g,y,v){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=a,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=f,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=v}}const Wd="(default)";class $l{constructor(e,t){this.projectId=e,this.database=t||Wd}static empty(){return new $l("","")}get isDefaultDatabase(){return this.database===Wd}isEqual(e){return e instanceof $l&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d2="__type__",U5="__max__",Ed={mapValue:{}},f2="__vector__",Jd="value";function pa(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?k0(n)?4:z5(n)?9007199254740991:B5(n)?10:11:Oe(28295,{value:n})}function Dr(n,e){if(n===e)return!0;const t=pa(n);if(t!==pa(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Nu(n).isEqual(Nu(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const c=ma(a.timestampValue),f=ma(l.timestampValue);return c.seconds===f.seconds&&c.nanos===f.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,l){return ga(a.bytesValue).isEqual(ga(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,l){return Yt(a.geoPointValue.latitude)===Yt(l.geoPointValue.latitude)&&Yt(a.geoPointValue.longitude)===Yt(l.geoPointValue.longitude)})(n,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Yt(a.integerValue)===Yt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const c=Yt(a.doubleValue),f=Yt(l.doubleValue);return c===f?Xd(c)===Xd(f):isNaN(c)&&isNaN(f)}return!1})(n,e);case 9:return Hl(n.arrayValue.values||[],e.arrayValue.values||[],Dr);case 10:case 11:return(function(a,l){const c=a.mapValue.fields||{},f=l.mapValue.fields||{};if(D1(c)!==D1(f))return!1;for(const g in c)if(c.hasOwnProperty(g)&&(f[g]===void 0||!Dr(c[g],f[g])))return!1;return!0})(n,e);default:return Oe(52216,{left:n})}}function Ru(n,e){return(n.values||[]).find((t=>Dr(t,e)))!==void 0}function Fl(n,e){if(n===e)return 0;const t=pa(n),r=pa(e);if(t!==r)return Xe(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Xe(n.booleanValue,e.booleanValue);case 2:return(function(l,c){const f=Yt(l.integerValue||l.doubleValue),g=Yt(c.integerValue||c.doubleValue);return f<g?-1:f>g?1:f===g?0:isNaN(f)?isNaN(g)?0:-1:1})(n,e);case 3:return P1(n.timestampValue,e.timestampValue);case 4:return P1(Nu(n),Nu(e));case 5:return Up(n.stringValue,e.stringValue);case 6:return(function(l,c){const f=ga(l),g=ga(c);return f.compareTo(g)})(n.bytesValue,e.bytesValue);case 7:return(function(l,c){const f=l.split("/"),g=c.split("/");for(let y=0;y<f.length&&y<g.length;y++){const v=Xe(f[y],g[y]);if(v!==0)return v}return Xe(f.length,g.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,c){const f=Xe(Yt(l.latitude),Yt(c.latitude));return f!==0?f:Xe(Yt(l.longitude),Yt(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return L1(n.arrayValue,e.arrayValue);case 10:return(function(l,c){var E,S,j,D;const f=l.fields||{},g=c.fields||{},y=(E=f[Jd])==null?void 0:E.arrayValue,v=(S=g[Jd])==null?void 0:S.arrayValue,w=Xe(((j=y==null?void 0:y.values)==null?void 0:j.length)||0,((D=v==null?void 0:v.values)==null?void 0:D.length)||0);return w!==0?w:L1(y,v)})(n.mapValue,e.mapValue);case 11:return(function(l,c){if(l===Ed.mapValue&&c===Ed.mapValue)return 0;if(l===Ed.mapValue)return 1;if(c===Ed.mapValue)return-1;const f=l.fields||{},g=Object.keys(f),y=c.fields||{},v=Object.keys(y);g.sort(),v.sort();for(let w=0;w<g.length&&w<v.length;++w){const E=Up(g[w],v[w]);if(E!==0)return E;const S=Fl(f[g[w]],y[v[w]]);if(S!==0)return S}return Xe(g.length,v.length)})(n.mapValue,e.mapValue);default:throw Oe(23264,{he:t})}}function P1(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Xe(n,e);const t=ma(n),r=ma(e),a=Xe(t.seconds,r.seconds);return a!==0?a:Xe(t.nanos,r.nanos)}function L1(n,e){const t=n.values||[],r=e.values||[];for(let a=0;a<t.length&&a<r.length;++a){const l=Fl(t[a],r[a]);if(l)return l}return Xe(t.length,r.length)}function Gl(n){return zp(n)}function zp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=ma(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ga(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ae.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",a=!0;for(const l of t.values||[])a?a=!1:r+=",",r+=zp(l);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const c of r)l?l=!1:a+=",",a+=`${c}:${zp(t.fields[c])}`;return a+"}"})(n.mapValue):Oe(61005,{value:n})}function zd(n){switch(pa(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Of(n);return e?16+zd(e):16;case 5:return 2*n.stringValue.length;case 6:return ga(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((a,l)=>a+zd(l)),0)})(n.arrayValue);case 10:case 11:return(function(r){let a=0;return wa(r.fields,((l,c)=>{a+=l.length+zd(c)})),a})(n.mapValue);default:throw Oe(13486,{value:n})}}function V1(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function qp(n){return!!n&&"integerValue"in n}function O0(n){return!!n&&"arrayValue"in n}function U1(n){return!!n&&"nullValue"in n}function B1(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function qd(n){return!!n&&"mapValue"in n}function B5(n){var t,r;return((r=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[d2])==null?void 0:r.stringValue)===f2}function du(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return wa(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=du(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=du(n.arrayValue.values[t]);return e}return{...n}}function z5(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===U5}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e){this.value=e}static empty(){return new ss({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!qd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=du(t)}setAll(e){let t=yn.emptyPath(),r={},a=[];e.forEach(((c,f)=>{if(!t.isImmediateParentOf(f)){const g=this.getFieldsMap(t);this.applyChanges(g,r,a),r={},a=[],t=f.popLast()}c?r[f.lastSegment()]=du(c):a.push(f.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,r,a)}delete(e){const t=this.field(e.popLast());qd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Dr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let a=t.mapValue.fields[e.get(r)];qd(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,r){wa(t,((a,l)=>e[a]=l));for(const a of r)delete e[a]}clone(){return new ss(du(this.value))}}function m2(n){const e=[];return wa(n.fields,((t,r)=>{const a=new yn([t]);if(qd(r)){const l=m2(r.mapValue).fields;if(l.length===0)e.push(a);else for(const c of l)e.push(a.child(c))}else e.push(a)})),new Ts(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e,t,r,a,l,c,f){this.key=e,this.documentType=t,this.version=r,this.readTime=a,this.createTime=l,this.data=c,this.documentState=f}static newInvalidDocument(e){return new Ln(e,0,Pe.min(),Pe.min(),Pe.min(),ss.empty(),0)}static newFoundDocument(e,t,r,a){return new Ln(e,1,t,Pe.min(),r,a,0)}static newNoDocument(e,t){return new Ln(e,2,t,Pe.min(),Pe.min(),ss.empty(),0)}static newUnknownDocument(e,t){return new Ln(e,3,t,Pe.min(),Pe.min(),ss.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ss.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ss.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ln&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ln(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd{constructor(e,t){this.position=e,this.inclusive=t}}function z1(n,e,t){let r=0;for(let a=0;a<n.position.length;a++){const l=e[a],c=n.position[a];if(l.field.isKeyField()?r=Ae.comparator(Ae.fromName(c.referenceValue),t.key):r=Fl(c,t.data.field(l.field)),l.dir==="desc"&&(r*=-1),r!==0)break}return r}function q1(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Dr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(e,t="asc"){this.field=e,this.dir=t}}function q5(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g2{}class rn extends g2{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new $5(e,t,r):t==="array-contains"?new K5(e,r):t==="in"?new Q5(e,r):t==="not-in"?new Y5(e,r):t==="array-contains-any"?new X5(e,r):new rn(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new F5(e,r):new G5(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Fl(t,this.value)):t!==null&&pa(this.value)===pa(t)&&this.matchesComparison(Fl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Oe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ar extends g2{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ar(e,t)}matches(e){return p2(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function p2(n){return n.op==="and"}function y2(n){return H5(n)&&p2(n)}function H5(n){for(const e of n.filters)if(e instanceof ar)return!1;return!0}function Hp(n){if(n instanceof rn)return n.field.canonicalString()+n.op.toString()+Gl(n.value);if(y2(n))return n.filters.map((e=>Hp(e))).join(",");{const e=n.filters.map((t=>Hp(t))).join(",");return`${n.op}(${e})`}}function _2(n,e){return n instanceof rn?(function(r,a){return a instanceof rn&&r.op===a.op&&r.field.isEqual(a.field)&&Dr(r.value,a.value)})(n,e):n instanceof ar?(function(r,a){return a instanceof ar&&r.op===a.op&&r.filters.length===a.filters.length?r.filters.reduce(((l,c,f)=>l&&_2(c,a.filters[f])),!0):!1})(n,e):void Oe(19439)}function v2(n){return n instanceof rn?(function(t){return`${t.field.canonicalString()} ${t.op} ${Gl(t.value)}`})(n):n instanceof ar?(function(t){return t.op.toString()+" {"+t.getFilters().map(v2).join(" ,")+"}"})(n):"Filter"}class $5 extends rn{constructor(e,t,r){super(e,t,r),this.key=Ae.fromName(r.referenceValue)}matches(e){const t=Ae.comparator(e.key,this.key);return this.matchesComparison(t)}}class F5 extends rn{constructor(e,t){super(e,"in",t),this.keys=b2("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class G5 extends rn{constructor(e,t){super(e,"not-in",t),this.keys=b2("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function b2(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((r=>Ae.fromName(r.referenceValue)))}class K5 extends rn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return O0(t)&&Ru(t.arrayValue,this.value)}}class Q5 extends rn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ru(this.value.arrayValue,t)}}class Y5 extends rn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ru(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ru(this.value.arrayValue,t)}}class X5 extends rn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!O0(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Ru(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W5{constructor(e,t=null,r=[],a=[],l=null,c=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=a,this.limit=l,this.startAt=c,this.endAt=f,this.Te=null}}function H1(n,e=null,t=[],r=[],a=null,l=null,c=null){return new W5(n,e,t,r,a,l,c)}function D0(n){const e=Ve(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Hp(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(l){return l.field.canonicalString()+l.dir})(r))).join(","),kf(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Gl(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Gl(r))).join(",")),e.Te=t}return e.Te}function M0(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!q5(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!_2(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!q1(n.startAt,e.startAt)&&q1(n.endAt,e.endAt)}function $p(n){return Ae.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e,t=null,r=[],a=[],l=null,c="F",f=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=a,this.limit=l,this.limitType=c,this.startAt=f,this.endAt=g,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function J5(n,e,t,r,a,l,c,f){return new nc(n,e,t,r,a,l,c,f)}function Df(n){return new nc(n)}function $1(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function w2(n){return n.collectionGroup!==null}function fu(n){const e=Ve(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let f=new dn(yn.comparator);return c.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(f=f.add(y.field))}))})),f})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Cu(l,r))})),t.has(yn.keyField().canonicalString())||e.Ie.push(new Cu(yn.keyField(),r))}return e.Ie}function Ir(n){const e=Ve(n);return e.Ee||(e.Ee=Z5(e,fu(n))),e.Ee}function Z5(n,e){if(n.limitType==="F")return H1(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Cu(a.field,l)}));const t=n.endAt?new Zd(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Zd(n.startAt.position,n.startAt.inclusive):null;return H1(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Fp(n,e){const t=n.filters.concat([e]);return new nc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ef(n,e,t){return new nc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Mf(n,e){return M0(Ir(n),Ir(e))&&n.limitType===e.limitType}function x2(n){return`${D0(Ir(n))}|lt:${n.limitType}`}function Al(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((a=>v2(a))).join(", ")}]`),kf(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((a=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(a))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((a=>Gl(a))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((a=>Gl(a))).join(",")),`Target(${r})`})(Ir(n))}; limitType=${n.limitType})`}function Pf(n,e){return e.isFoundDocument()&&(function(r,a){const l=a.key.path;return r.collectionGroup!==null?a.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(l):Ae.isDocumentKey(r.path)?r.path.isEqual(l):r.path.isImmediateParentOf(l)})(n,e)&&(function(r,a){for(const l of fu(r))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(r,a){for(const l of r.filters)if(!l.matches(a))return!1;return!0})(n,e)&&(function(r,a){return!(r.startAt&&!(function(c,f,g){const y=z1(c,f,g);return c.inclusive?y<=0:y<0})(r.startAt,fu(r),a)||r.endAt&&!(function(c,f,g){const y=z1(c,f,g);return c.inclusive?y>=0:y>0})(r.endAt,fu(r),a))})(n,e)}function eR(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function E2(n){return(e,t)=>{let r=!1;for(const a of fu(n)){const l=tR(a,e,t);if(l!==0)return l;r=r||a.field.isKeyField()}return 0}}function tR(n,e,t){const r=n.field.isKeyField()?Ae.comparator(e.key,t.key):(function(l,c,f){const g=c.data.field(l),y=f.data.field(l);return g!==null&&y!==null?Fl(g,y):Oe(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Oe(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[a,l]of r)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),a=this.inner[r];if(a===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return r.length===1?delete this.inner[t]:r.splice(a,1),this.innerSize--,!0;return!1}forEach(e){wa(this.inner,((t,r)=>{for(const[a,l]of r)e(a,l)}))}isEmpty(){return a2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nR=new Pt(Ae.comparator);function hi(){return nR}const T2=new Pt(Ae.comparator);function lu(...n){let e=T2;for(const t of n)e=e.insert(t.key,t);return e}function S2(n){let e=T2;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function uo(){return mu()}function A2(){return mu()}function mu(){return new So((n=>n.toString()),((n,e)=>n.isEqual(e)))}const sR=new Pt(Ae.comparator),rR=new dn(Ae.comparator);function We(...n){let e=rR;for(const t of n)e=e.add(t);return e}const iR=new dn(Xe);function aR(){return iR}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P0(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Xd(e)?"-0":e}}function N2(n){return{integerValue:""+n}}function oR(n,e){return D5(e)?N2(e):P0(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(){this._=void 0}}function lR(n,e,t){return n instanceof Iu?(function(a,l){const c={fields:{[c2]:{stringValue:l2},[h2]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&k0(l)&&(l=Of(l)),l&&(c.fields[u2]=l),{mapValue:c}})(t,e):n instanceof Kl?C2(n,e):n instanceof Ql?I2(n,e):(function(a,l){const c=R2(a,l),f=F1(c)+F1(a.Ae);return qp(c)&&qp(a.Ae)?N2(f):P0(a.serializer,f)})(n,e)}function cR(n,e,t){return n instanceof Kl?C2(n,e):n instanceof Ql?I2(n,e):t}function R2(n,e){return n instanceof tf?(function(r){return qp(r)||(function(l){return!!l&&"doubleValue"in l})(r)})(e)?e:{integerValue:0}:null}class Iu extends Lf{}class Kl extends Lf{constructor(e){super(),this.elements=e}}function C2(n,e){const t=j2(e);for(const r of n.elements)t.some((a=>Dr(a,r)))||t.push(r);return{arrayValue:{values:t}}}class Ql extends Lf{constructor(e){super(),this.elements=e}}function I2(n,e){let t=j2(e);for(const r of n.elements)t=t.filter((a=>!Dr(a,r)));return{arrayValue:{values:t}}}class tf extends Lf{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function F1(n){return Yt(n.integerValue||n.doubleValue)}function j2(n){return O0(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{constructor(e,t){this.field=e,this.transform=t}}function uR(n,e){return n.field.isEqual(e.field)&&(function(r,a){return r instanceof Kl&&a instanceof Kl||r instanceof Ql&&a instanceof Ql?Hl(r.elements,a.elements,Dr):r instanceof tf&&a instanceof tf?Dr(r.Ae,a.Ae):r instanceof Iu&&a instanceof Iu})(n.transform,e.transform)}class hR{constructor(e,t){this.version=e,this.transformResults=t}}class Gn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Gn}static exists(e){return new Gn(void 0,e)}static updateTime(e){return new Gn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Hd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Vf{}function k2(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Uf(n.key,Gn.none()):new Fu(n.key,n.data,Gn.none());{const t=n.data,r=ss.empty();let a=new dn(yn.comparator);for(let l of e.fields)if(!a.has(l)){let c=t.field(l);c===null&&l.length>1&&(l=l.popLast(),c=t.field(l)),c===null?r.delete(l):r.set(l,c),a=a.add(l)}return new xa(n.key,r,new Ts(a.toArray()),Gn.none())}}function dR(n,e,t){n instanceof Fu?(function(a,l,c){const f=a.value.clone(),g=K1(a.fieldTransforms,l,c.transformResults);f.setAll(g),l.convertToFoundDocument(c.version,f).setHasCommittedMutations()})(n,e,t):n instanceof xa?(function(a,l,c){if(!Hd(a.precondition,l))return void l.convertToUnknownDocument(c.version);const f=K1(a.fieldTransforms,l,c.transformResults),g=l.data;g.setAll(O2(a)),g.setAll(f),l.convertToFoundDocument(c.version,g).setHasCommittedMutations()})(n,e,t):(function(a,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function gu(n,e,t,r){return n instanceof Fu?(function(l,c,f,g){if(!Hd(l.precondition,c))return f;const y=l.value.clone(),v=Q1(l.fieldTransforms,g,c);return y.setAll(v),c.convertToFoundDocument(c.version,y).setHasLocalMutations(),null})(n,e,t,r):n instanceof xa?(function(l,c,f,g){if(!Hd(l.precondition,c))return f;const y=Q1(l.fieldTransforms,g,c),v=c.data;return v.setAll(O2(l)),v.setAll(y),c.convertToFoundDocument(c.version,v).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((w=>w.field)))})(n,e,t,r):(function(l,c,f){return Hd(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):f})(n,e,t)}function fR(n,e){let t=null;for(const r of n.fieldTransforms){const a=e.data.field(r.field),l=R2(r.transform,a||null);l!=null&&(t===null&&(t=ss.empty()),t.set(r.field,l))}return t||null}function G1(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,a){return r===void 0&&a===void 0||!(!r||!a)&&Hl(r,a,((l,c)=>uR(l,c)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Fu extends Vf{constructor(e,t,r,a=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class xa extends Vf{constructor(e,t,r,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function O2(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function K1(n,e,t){const r=new Map;lt(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let a=0;a<t.length;a++){const l=n[a],c=l.transform,f=e.data.field(l.field);r.set(l.field,cR(c,f,t[a]))}return r}function Q1(n,e,t){const r=new Map;for(const a of n){const l=a.transform,c=t.data.field(a.field);r.set(a.field,lR(l,c,e))}return r}class Uf extends Vf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class mR extends Vf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gR{constructor(e,t,r,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=a}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&dR(l,e,r[a])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=gu(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=gu(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=A2();return this.mutations.forEach((a=>{const l=e.get(a.key),c=l.overlayedDocument;let f=this.applyToLocalView(c,l.mutatedFields);f=t.has(a.key)?null:f;const g=k2(c,f);g!==null&&r.set(a.key,g),c.isValidDocument()||c.convertToNoDocument(Pe.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),We())}isEqual(e){return this.batchId===e.batchId&&Hl(this.mutations,e.mutations,((t,r)=>G1(t,r)))&&Hl(this.baseMutations,e.baseMutations,((t,r)=>G1(t,r)))}}class V0{constructor(e,t,r,a){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=a}static from(e,t,r){lt(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let a=(function(){return sR})();const l=e.mutations;for(let c=0;c<l.length;c++)a=a.insert(l[c].key,r[c].version);return new V0(e,t,r,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pR{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nn,tt;function _R(n){switch(n){case re.OK:return Oe(64938);case re.CANCELLED:case re.UNKNOWN:case re.DEADLINE_EXCEEDED:case re.RESOURCE_EXHAUSTED:case re.INTERNAL:case re.UNAVAILABLE:case re.UNAUTHENTICATED:return!1;case re.INVALID_ARGUMENT:case re.NOT_FOUND:case re.ALREADY_EXISTS:case re.PERMISSION_DENIED:case re.FAILED_PRECONDITION:case re.ABORTED:case re.OUT_OF_RANGE:case re.UNIMPLEMENTED:case re.DATA_LOSS:return!0;default:return Oe(15467,{code:n})}}function D2(n){if(n===void 0)return ui("GRPC error has no .code"),re.UNKNOWN;switch(n){case nn.OK:return re.OK;case nn.CANCELLED:return re.CANCELLED;case nn.UNKNOWN:return re.UNKNOWN;case nn.DEADLINE_EXCEEDED:return re.DEADLINE_EXCEEDED;case nn.RESOURCE_EXHAUSTED:return re.RESOURCE_EXHAUSTED;case nn.INTERNAL:return re.INTERNAL;case nn.UNAVAILABLE:return re.UNAVAILABLE;case nn.UNAUTHENTICATED:return re.UNAUTHENTICATED;case nn.INVALID_ARGUMENT:return re.INVALID_ARGUMENT;case nn.NOT_FOUND:return re.NOT_FOUND;case nn.ALREADY_EXISTS:return re.ALREADY_EXISTS;case nn.PERMISSION_DENIED:return re.PERMISSION_DENIED;case nn.FAILED_PRECONDITION:return re.FAILED_PRECONDITION;case nn.ABORTED:return re.ABORTED;case nn.OUT_OF_RANGE:return re.OUT_OF_RANGE;case nn.UNIMPLEMENTED:return re.UNIMPLEMENTED;case nn.DATA_LOSS:return re.DATA_LOSS;default:return Oe(39323,{code:n})}}(tt=nn||(nn={}))[tt.OK=0]="OK",tt[tt.CANCELLED=1]="CANCELLED",tt[tt.UNKNOWN=2]="UNKNOWN",tt[tt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",tt[tt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",tt[tt.NOT_FOUND=5]="NOT_FOUND",tt[tt.ALREADY_EXISTS=6]="ALREADY_EXISTS",tt[tt.PERMISSION_DENIED=7]="PERMISSION_DENIED",tt[tt.UNAUTHENTICATED=16]="UNAUTHENTICATED",tt[tt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",tt[tt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",tt[tt.ABORTED=10]="ABORTED",tt[tt.OUT_OF_RANGE=11]="OUT_OF_RANGE",tt[tt.UNIMPLEMENTED=12]="UNIMPLEMENTED",tt[tt.INTERNAL=13]="INTERNAL",tt[tt.UNAVAILABLE=14]="UNAVAILABLE",tt[tt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vR(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bR=new ca([4294967295,4294967295],0);function Y1(n){const e=vR().encode(n),t=new Kx;return t.update(e),new Uint8Array(t.digest())}function X1(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new ca([t,r],0),new ca([a,l],0)]}class U0{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new cu(`Invalid padding: ${t}`);if(r<0)throw new cu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new cu(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new cu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ca.fromNumber(this.ge)}ye(e,t,r){let a=e.add(t.multiply(ca.fromNumber(r)));return a.compare(bR)===1&&(a=new ca([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Y1(e),[r,a]=X1(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(r,a,l);if(!this.we(c))return!1}return!0}static create(e,t,r){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new U0(l,a,t);return r.forEach((f=>c.insert(f))),c}insert(e){if(this.ge===0)return;const t=Y1(e),[r,a]=X1(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(r,a,l);this.Se(c)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class cu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(e,t,r,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const a=new Map;return a.set(e,Gu.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Bf(Pe.min(),a,new Pt(Xe),hi(),We())}}class Gu{constructor(e,t,r,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Gu(r,t,We(),We(),We())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d{constructor(e,t,r,a){this.be=e,this.removedTargetIds=t,this.key=r,this.De=a}}class M2{constructor(e,t){this.targetId=e,this.Ce=t}}class P2{constructor(e,t,r=vn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=a}}class W1{constructor(){this.ve=0,this.Fe=J1(),this.Me=vn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=We(),t=We(),r=We();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:r=r.add(a);break;default:Oe(38017,{changeType:l})}})),new Gu(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=J1()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,lt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class wR{constructor(e){this.Ge=e,this.ze=new Map,this.je=hi(),this.Je=Td(),this.He=Td(),this.Ye=new Pt(Xe)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Oe(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,a)=>{this.rt(a)&&t(a)}))}st(e){const t=e.targetId,r=e.Ce.count,a=this.ot(t);if(a){const l=a.target;if($p(l))if(r===0){const c=new Ae(l.path);this.et(t,c,Ln.newNoDocument(c,Pe.min()))}else lt(r===1,20013,{expectedCount:r});else{const c=this._t(t);if(c!==r){const f=this.ut(e),g=f?this.ct(f,e,c):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:a=0},hashCount:l=0}=t;let c,f;try{c=ga(r).toUint8Array()}catch(g){if(g instanceof o2)return _o("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{f=new U0(c,a,l)}catch(g){return _o(g instanceof cu?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return f.ge===0?null:f}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let a=0;return r.forEach((l=>{const c=this.Ge.ht(),f=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(f)||(this.et(t,l,null),a++)})),a}Tt(e){const t=new Map;this.ze.forEach(((l,c)=>{const f=this.ot(c);if(f){if(l.current&&$p(f.target)){const g=new Ae(f.target.path);this.It(g).has(c)||this.Et(c,g)||this.et(c,g,Ln.newNoDocument(g,e))}l.Be&&(t.set(c,l.ke()),l.qe())}}));let r=We();this.He.forEach(((l,c)=>{let f=!0;c.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(r=r.add(l))})),this.je.forEach(((l,c)=>c.setReadTime(e)));const a=new Bf(e,t,this.Ye,this.je,r);return this.je=hi(),this.Je=Td(),this.He=Td(),this.Ye=new Pt(Xe),a}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.Qe(t,1):a.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new W1,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new dn(Xe),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new dn(Xe),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ye("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new W1),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Td(){return new Pt(Ae.comparator)}function J1(){return new Pt(Ae.comparator)}const xR={asc:"ASCENDING",desc:"DESCENDING"},ER={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},TR={and:"AND",or:"OR"};class SR{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Gp(n,e){return n.useProto3Json||kf(e)?e:{value:e}}function nf(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function L2(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function AR(n,e){return nf(n,e.toTimestamp())}function jr(n){return lt(!!n,49232),Pe.fromTimestamp((function(t){const r=ma(t);return new vt(r.seconds,r.nanos)})(n))}function B0(n,e){return Kp(n,e).canonicalString()}function Kp(n,e){const t=(function(a){return new Et(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function V2(n){const e=Et.fromString(n);return lt(H2(e),10190,{key:e.toString()}),e}function Qp(n,e){return B0(n.databaseId,e.path)}function fp(n,e){const t=V2(e);if(t.get(1)!==n.databaseId.projectId)throw new ge(re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ge(re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ae(B2(t))}function U2(n,e){return B0(n.databaseId,e)}function NR(n){const e=V2(n);return e.length===4?Et.emptyPath():B2(e)}function Yp(n){return new Et(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function B2(n){return lt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Z1(n,e,t){return{name:Qp(n,e),fields:t.value.mapValue.fields}}function RR(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:Oe(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(y,v){return y.useProto3Json?(lt(v===void 0||typeof v=="string",58123),vn.fromBase64String(v||"")):(lt(v===void 0||v instanceof Buffer||v instanceof Uint8Array,16193),vn.fromUint8Array(v||new Uint8Array))})(n,e.targetChange.resumeToken),c=e.targetChange.cause,f=c&&(function(y){const v=y.code===void 0?re.UNKNOWN:D2(y.code);return new ge(v,y.message||"")})(c);t=new P2(r,a,l,f||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const a=fp(n,r.document.name),l=jr(r.document.updateTime),c=r.document.createTime?jr(r.document.createTime):Pe.min(),f=new ss({mapValue:{fields:r.document.fields}}),g=Ln.newFoundDocument(a,l,c,f),y=r.targetIds||[],v=r.removedTargetIds||[];t=new $d(y,v,g.key,g)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const a=fp(n,r.document),l=r.readTime?jr(r.readTime):Pe.min(),c=Ln.newNoDocument(a,l),f=r.removedTargetIds||[];t=new $d([],f,c.key,c)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const a=fp(n,r.document),l=r.removedTargetIds||[];t=new $d([],l,a,null)}else{if(!("filter"in e))return Oe(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:a=0,unchangedNames:l}=r,c=new yR(a,l),f=r.targetId;t=new M2(f,c)}}return t}function CR(n,e){let t;if(e instanceof Fu)t={update:Z1(n,e.key,e.value)};else if(e instanceof Uf)t={delete:Qp(n,e.key)};else if(e instanceof xa)t={update:Z1(n,e.key,e.data),updateMask:VR(e.fieldMask)};else{if(!(e instanceof mR))return Oe(16599,{Vt:e.type});t={verify:Qp(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(l,c){const f=c.transform;if(f instanceof Iu)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Kl)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof Ql)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof tf)return{fieldPath:c.field.canonicalString(),increment:f.Ae};throw Oe(20930,{transform:c.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:AR(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Oe(27497)})(n,e.precondition)),t}function IR(n,e){return n&&n.length>0?(lt(e!==void 0,14353),n.map((t=>(function(a,l){let c=a.updateTime?jr(a.updateTime):jr(l);return c.isEqual(Pe.min())&&(c=jr(l)),new hR(c,a.transformResults||[])})(t,e)))):[]}function jR(n,e){return{documents:[U2(n,e.path)]}}function kR(n,e){const t={structuredQuery:{}},r=e.path;let a;e.collectionGroup!==null?(a=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=U2(n,a);const l=(function(y){if(y.length!==0)return q2(ar.create(y,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const c=(function(y){if(y.length!==0)return y.map((v=>(function(E){return{field:Nl(E.field),direction:MR(E.dir)}})(v)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const f=Gp(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:a}}function OR(n){let e=NR(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let a=null;if(r>0){lt(r===1,65062);const v=t.from[0];v.allDescendants?a=v.collectionId:e=e.child(v.collectionId)}let l=[];t.where&&(l=(function(w){const E=z2(w);return E instanceof ar&&y2(E)?E.getFilters():[E]})(t.where));let c=[];t.orderBy&&(c=(function(w){return w.map((E=>(function(j){return new Cu(Rl(j.field),(function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(j.direction))})(E)))})(t.orderBy));let f=null;t.limit&&(f=(function(w){let E;return E=typeof w=="object"?w.value:w,kf(E)?null:E})(t.limit));let g=null;t.startAt&&(g=(function(w){const E=!!w.before,S=w.values||[];return new Zd(S,E)})(t.startAt));let y=null;return t.endAt&&(y=(function(w){const E=!w.before,S=w.values||[];return new Zd(S,E)})(t.endAt)),J5(e,a,c,l,f,"F",g,y)}function DR(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Oe(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function z2(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Rl(t.unaryFilter.field);return rn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const a=Rl(t.unaryFilter.field);return rn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Rl(t.unaryFilter.field);return rn.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Rl(t.unaryFilter.field);return rn.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Oe(61313);default:return Oe(60726)}})(n):n.fieldFilter!==void 0?(function(t){return rn.create(Rl(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Oe(58110);default:return Oe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return ar.create(t.compositeFilter.filters.map((r=>z2(r))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Oe(1026)}})(t.compositeFilter.op))})(n):Oe(30097,{filter:n})}function MR(n){return xR[n]}function PR(n){return ER[n]}function LR(n){return TR[n]}function Nl(n){return{fieldPath:n.canonicalString()}}function Rl(n){return yn.fromServerFormat(n.fieldPath)}function q2(n){return n instanceof rn?(function(t){if(t.op==="=="){if(B1(t.value))return{unaryFilter:{field:Nl(t.field),op:"IS_NAN"}};if(U1(t.value))return{unaryFilter:{field:Nl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(B1(t.value))return{unaryFilter:{field:Nl(t.field),op:"IS_NOT_NAN"}};if(U1(t.value))return{unaryFilter:{field:Nl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Nl(t.field),op:PR(t.op),value:t.value}}})(n):n instanceof ar?(function(t){const r=t.getFilters().map((a=>q2(a)));return r.length===1?r[0]:{compositeFilter:{op:LR(t.op),filters:r}}})(n):Oe(54877,{filter:n})}function VR(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function H2(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e,t,r,a,l=Pe.min(),c=Pe.min(),f=vn.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=f,this.expectedCount=g}withSequenceNumber(e){return new ia(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ia(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ia(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ia(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UR{constructor(e){this.yt=e}}function BR(n){const e=OR({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ef(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR{constructor(){this.Cn=new qR}addToCollectionParentIndex(e,t){return this.Cn.add(t),oe.resolve()}getCollectionParents(e,t){return oe.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return oe.resolve()}deleteFieldIndex(e,t){return oe.resolve()}deleteAllFieldIndexes(e){return oe.resolve()}createTargetIndexes(e,t){return oe.resolve()}getDocumentsMatchingTarget(e,t){return oe.resolve(null)}getIndexType(e,t){return oe.resolve(0)}getFieldIndexes(e,t){return oe.resolve([])}getNextCollectionGroupToUpdate(e){return oe.resolve(null)}getMinOffset(e,t){return oe.resolve(fa.min())}getMinOffsetFromCollectionGroup(e,t){return oe.resolve(fa.min())}updateCollectionGroup(e,t,r){return oe.resolve()}updateIndexEntries(e,t){return oe.resolve()}}class qR{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t]||new dn(Et.comparator),l=!a.has(r);return this.index[t]=a.add(r),l}has(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t];return a&&a.has(r)}getEntries(e){return(this.index[e]||new dn(Et.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ew={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},$2=41943040;class ns{static withCacheSize(e){return new ns(e,ns.DEFAULT_COLLECTION_PERCENTILE,ns.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ns.DEFAULT_COLLECTION_PERCENTILE=10,ns.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ns.DEFAULT=new ns($2,ns.DEFAULT_COLLECTION_PERCENTILE,ns.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ns.DISABLED=new ns(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Yl(0)}static cr(){return new Yl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw="LruGarbageCollector",HR=1048576;function nw([n,e],[t,r]){const a=Xe(n,t);return a===0?Xe(e,r):a}class $R{constructor(e){this.Ir=e,this.buffer=new dn(nw),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();nw(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class FR{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ye(tw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){tc(t)?ye(tw,"Ignoring IndexedDB error during garbage collection: ",t):await ec(t)}await this.Vr(3e5)}))}}class GR{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return oe.resolve(jf.ce);const r=new $R(t);return this.mr.forEachTarget(e,(a=>r.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>r.Ar(a))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ye("LruGarbageCollector","Garbage collection skipped; disabled"),oe.resolve(ew)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ew):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,a,l,c,f,g,y;const v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((w=>(w>this.params.maximumSequenceNumbersToCollect?(ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),a=this.params.maximumSequenceNumbersToCollect):a=w,c=Date.now(),this.nthSequenceNumber(e,a)))).next((w=>(r=w,f=Date.now(),this.removeTargets(e,r,t)))).next((w=>(l=w,g=Date.now(),this.removeOrphanedDocuments(e,r)))).next((w=>(y=Date.now(),Sl()<=Ye.DEBUG&&ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-v}ms
	Determined least recently used ${a} in `+(f-c)+`ms
	Removed ${l} targets in `+(g-f)+`ms
	Removed ${w} documents in `+(y-g)+`ms
Total Duration: ${y-v}ms`),oe.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:w}))))}}function KR(n,e){return new GR(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{constructor(){this.changes=new So((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ln.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?oe.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YR{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(e,t,r,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=a}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(r=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(r!==null&&gu(r.mutation,a,Ts.empty(),vt.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,We()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=We()){const a=uo();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,r).next((l=>{let c=lu();return l.forEach(((f,g)=>{c=c.insert(f,g.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const r=uo();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,We())))}populateOverlays(e,t,r){const a=[];return r.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((c,f)=>{t.set(c,f)}))}))}computeViews(e,t,r,a){let l=hi();const c=mu(),f=(function(){return mu()})();return t.forEach(((g,y)=>{const v=r.get(y.key);a.has(y.key)&&(v===void 0||v.mutation instanceof xa)?l=l.insert(y.key,y):v!==void 0?(c.set(y.key,v.mutation.getFieldMask()),gu(v.mutation,y,v.mutation.getFieldMask(),vt.now())):c.set(y.key,Ts.empty())})),this.recalculateAndSaveOverlays(e,l).next((g=>(g.forEach(((y,v)=>c.set(y,v))),t.forEach(((y,v)=>f.set(y,new YR(v,c.get(y)??null)))),f)))}recalculateAndSaveOverlays(e,t){const r=mu();let a=new Pt(((c,f)=>c-f)),l=We();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const f of c)f.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let v=r.get(g)||Ts.empty();v=f.applyToLocalView(y,v),r.set(g,v);const w=(a.get(f.batchId)||We()).add(g);a=a.insert(f.batchId,w)}))})).next((()=>{const c=[],f=a.getReverseIterator();for(;f.hasNext();){const g=f.getNext(),y=g.key,v=g.value,w=A2();v.forEach((E=>{if(!l.has(E)){const S=k2(t.get(E),r.get(E));S!==null&&w.set(E,S),l=l.add(E)}})),c.push(this.documentOverlayCache.saveOverlays(e,y,w))}return oe.waitFor(c)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,a){return(function(c){return Ae.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):w2(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,a):this.getDocumentsMatchingCollectionQuery(e,t,r,a)}getNextDocuments(e,t,r,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,a).next((l=>{const c=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,a-l.size):oe.resolve(uo());let f=Au,g=l;return c.next((y=>oe.forEach(y,((v,w)=>(f<w.largestBatchId&&(f=w.largestBatchId),l.get(v)?oe.resolve():this.remoteDocumentCache.getEntry(e,v).next((E=>{g=g.insert(v,E)}))))).next((()=>this.populateOverlays(e,y,l))).next((()=>this.computeViews(e,g,y,We()))).next((v=>({batchId:f,changes:S2(v)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ae(t)).next((r=>{let a=lu();return r.isFoundDocument()&&(a=a.insert(r.key,r)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,a){const l=t.collectionGroup;let c=lu();return this.indexManager.getCollectionParents(e,l).next((f=>oe.forEach(f,(g=>{const y=(function(w,E){return new nc(E,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)})(t,g.child(l));return this.getDocumentsMatchingCollectionQuery(e,y,r,a).next((v=>{v.forEach(((w,E)=>{c=c.insert(w,E)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,r,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,l,a)))).next((c=>{l.forEach(((g,y)=>{const v=y.getKey();c.get(v)===null&&(c=c.insert(v,Ln.newInvalidDocument(v)))}));let f=lu();return c.forEach(((g,y)=>{const v=l.get(g);v!==void 0&&gu(v.mutation,y,Ts.empty(),vt.now()),Pf(t,y)&&(f=f.insert(g,y))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return oe.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:jr(a.createTime)}})(t)),oe.resolve()}getNamedQuery(e,t){return oe.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(a){return{name:a.name,query:BR(a.bundledQuery),readTime:jr(a.readTime)}})(t)),oe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{constructor(){this.overlays=new Pt(Ae.comparator),this.qr=new Map}getOverlay(e,t){return oe.resolve(this.overlays.get(t))}getOverlays(e,t){const r=uo();return oe.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&r.set(a,l)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((a,l)=>{this.St(e,t,l)})),oe.resolve()}removeOverlaysForBatchId(e,t,r){const a=this.qr.get(r);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(r)),oe.resolve()}getOverlaysForCollection(e,t,r){const a=uo(),l=t.length+1,c=new Ae(t.child("")),f=this.overlays.getIteratorFrom(c);for(;f.hasNext();){const g=f.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===l&&g.largestBatchId>r&&a.set(g.getKey(),g)}return oe.resolve(a)}getOverlaysForCollectionGroup(e,t,r,a){let l=new Pt(((y,v)=>y-v));const c=this.overlays.getIterator();for(;c.hasNext();){const y=c.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>r){let v=l.get(y.largestBatchId);v===null&&(v=uo(),l=l.insert(y.largestBatchId,v)),v.set(y.getKey(),y)}}const f=uo(),g=l.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,v)=>f.set(y,v))),!(f.size()>=a)););return oe.resolve(f)}St(e,t,r){const a=this.overlays.get(r.key);if(a!==null){const c=this.qr.get(a.largestBatchId).delete(r.key);this.qr.set(a.largestBatchId,c)}this.overlays=this.overlays.insert(r.key,new pR(t,r));let l=this.qr.get(t);l===void 0&&(l=We(),this.qr.set(t,l)),this.qr.set(t,l.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZR{constructor(){this.sessionToken=vn.EMPTY_BYTE_STRING}getSessionToken(e){return oe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,oe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0{constructor(){this.Qr=new dn(pn.$r),this.Ur=new dn(pn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new pn(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new pn(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new Ae(new Et([])),r=new pn(t,e),a=new pn(t,e+1),l=[];return this.Ur.forEachInRange([r,a],(c=>{this.Gr(c),l.push(c.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ae(new Et([])),r=new pn(t,e),a=new pn(t,e+1);let l=We();return this.Ur.forEachInRange([r,a],(c=>{l=l.add(c.key)})),l}containsKey(e){const t=new pn(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class pn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ae.comparator(e.key,t.key)||Xe(e.Yr,t.Yr)}static Kr(e,t){return Xe(e.Yr,t.Yr)||Ae.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new dn(pn.$r)}checkEmpty(e){return oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,a){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new gR(l,t,r,a);this.mutationQueue.push(c);for(const f of a)this.Zr=this.Zr.add(new pn(f.key,l)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return oe.resolve(c)}lookupMutationBatch(e,t){return oe.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=this.ei(r),l=a<0?0:a;return oe.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return oe.resolve(this.mutationQueue.length===0?j0:this.tr-1)}getAllMutationBatches(e){return oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new pn(t,0),a=new pn(t,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([r,a],(c=>{const f=this.Xr(c.Yr);l.push(f)})),oe.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new dn(Xe);return t.forEach((a=>{const l=new pn(a,0),c=new pn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,c],(f=>{r=r.add(f.Yr)}))})),oe.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1;let l=r;Ae.isDocumentKey(l)||(l=l.child(""));const c=new pn(new Ae(l),0);let f=new dn(Xe);return this.Zr.forEachWhile((g=>{const y=g.key.path;return!!r.isPrefixOf(y)&&(y.length===a&&(f=f.add(g.Yr)),!0)}),c),oe.resolve(this.ti(f))}ti(e){const t=[];return e.forEach((r=>{const a=this.Xr(r);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){lt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return oe.forEach(t.mutations,(a=>{const l=new pn(a.key,t.batchId);return r=r.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new pn(t,0),a=this.Zr.firstAfterOrEqual(r);return oe.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,oe.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC{constructor(e){this.ri=e,this.docs=(function(){return new Pt(Ae.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,a=this.docs.get(r),l=a?a.size:0,c=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return oe.resolve(r?r.document.mutableCopy():Ln.newInvalidDocument(t))}getEntries(e,t){let r=hi();return t.forEach((a=>{const l=this.docs.get(a);r=r.insert(a,l?l.document.mutableCopy():Ln.newInvalidDocument(a))})),oe.resolve(r)}getDocumentsMatchingQuery(e,t,r,a){let l=hi();const c=t.path,f=new Ae(c.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(f);for(;g.hasNext();){const{key:y,value:{document:v}}=g.getNext();if(!c.isPrefixOf(y.path))break;y.path.length>c.length+1||I5(C5(v),r)<=0||(a.has(v.key)||Pf(t,v))&&(l=l.insert(v.key,v.mutableCopy()))}return oe.resolve(l)}getAllFromCollectionGroup(e,t,r,a){Oe(9500)}ii(e,t){return oe.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new nC(this)}getSize(e){return oe.resolve(this.size)}}class nC extends QR{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,a)=>{a.isValidDocument()?t.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(r)})),oe.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{constructor(e){this.persistence=e,this.si=new So((t=>D0(t)),M0),this.lastRemoteSnapshotVersion=Pe.min(),this.highestTargetId=0,this.oi=0,this._i=new z0,this.targetCount=0,this.ai=Yl.ur()}forEachTarget(e,t){return this.si.forEach(((r,a)=>t(a))),oe.resolve()}getLastRemoteSnapshotVersion(e){return oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return oe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),oe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),oe.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Yl(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,oe.resolve()}updateTargetData(e,t){return this.Pr(t),oe.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,oe.resolve()}removeTargets(e,t,r){let a=0;const l=[];return this.si.forEach(((c,f)=>{f.sequenceNumber<=t&&r.get(f.targetId)===null&&(this.si.delete(c),l.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)})),oe.waitFor(l).next((()=>a))}getTargetCount(e){return oe.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return oe.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),oe.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((c=>{l.push(a.markPotentiallyOrphaned(e,c))})),oe.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),oe.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return oe.resolve(r)}containsKey(e,t){return oe.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F2{constructor(e,t){this.ui={},this.overlays={},this.ci=new jf(0),this.li=!1,this.li=!0,this.hi=new ZR,this.referenceDelegate=e(this),this.Pi=new sC(this),this.indexManager=new zR,this.remoteDocumentCache=(function(a){return new tC(a)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new UR(t),this.Ii=new WR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new JR,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new eC(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){ye("MemoryPersistence","Starting transaction:",e);const a=new rC(this.ci.next());return this.referenceDelegate.Ei(),r(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ai(e,t){return oe.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class rC extends k5{constructor(e){super(),this.currentSequenceNumber=e}}class q0{constructor(e){this.persistence=e,this.Ri=new z0,this.Vi=null}static mi(e){return new q0(e)}get fi(){if(this.Vi)return this.Vi;throw Oe(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),oe.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),oe.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),oe.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((a=>this.fi.add(a.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.fi.add(l.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return oe.forEach(this.fi,(r=>{const a=Ae.fromPath(r);return this.gi(e,a).next((l=>{l||t.removeEntry(a,Pe.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return oe.or([()=>oe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class sf{constructor(e,t){this.persistence=e,this.pi=new So((r=>M5(r.path)),((r,a)=>r.isEqual(a))),this.garbageCollector=KR(this,t)}static mi(e,t){return new sf(e,t)}Ei(){}di(e){return oe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((a=>r+a))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return oe.forEach(this.pi,((r,a)=>this.br(e,r,a).next((l=>l?oe.resolve():t(a)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ii(e,(c=>this.br(e,c,t).next((f=>{f||(r++,l.removeEntry(c,Pe.min()))})))).next((()=>l.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),oe.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),oe.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),oe.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),oe.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=zd(e.data.value)),t}br(e,t,r){return oe.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.pi.get(t);return oe.resolve(a!==void 0&&a>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H0{constructor(e,t,r,a){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=a}static As(e,t){let r=We(),a=We();for(const l of t.docChanges)switch(l.type){case 0:r=r.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new H0(e,t.fromCache,r,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return e4()?8:O5(Un())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,a){const l={result:null};return this.ys(e,t).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ws(e,t,a,r).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new iC;return this.Ss(e,t,c).next((f=>{if(l.result=f,this.Vs)return this.bs(e,t,c,f.size)}))})).next((()=>l.result))}bs(e,t,r,a){return r.documentReadCount<this.fs?(Sl()<=Ye.DEBUG&&ye("QueryEngine","SDK will not create cache indexes for query:",Al(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),oe.resolve()):(Sl()<=Ye.DEBUG&&ye("QueryEngine","Query:",Al(t),"scans",r.documentReadCount,"local documents and returns",a,"documents as results."),r.documentReadCount>this.gs*a?(Sl()<=Ye.DEBUG&&ye("QueryEngine","The SDK decides to create cache indexes for query:",Al(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ir(t))):oe.resolve())}ys(e,t){if($1(t))return oe.resolve(null);let r=Ir(t);return this.indexManager.getIndexType(e,r).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=ef(t,null,"F"),r=Ir(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((l=>{const c=We(...l);return this.ps.getDocuments(e,c).next((f=>this.indexManager.getMinOffset(e,r).next((g=>{const y=this.Ds(t,f);return this.Cs(t,y,c,g.readTime)?this.ys(e,ef(t,null,"F")):this.vs(e,y,t,g)}))))})))))}ws(e,t,r,a){return $1(t)||a.isEqual(Pe.min())?oe.resolve(null):this.ps.getDocuments(e,r).next((l=>{const c=this.Ds(t,l);return this.Cs(t,c,r,a)?oe.resolve(null):(Sl()<=Ye.DEBUG&&ye("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Al(t)),this.vs(e,c,t,R5(a,Au)).next((f=>f)))}))}Ds(e,t){let r=new dn(E2(e));return t.forEach(((a,l)=>{Pf(e,l)&&(r=r.add(l))})),r}Cs(e,t,r,a){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}Ss(e,t,r){return Sl()<=Ye.DEBUG&&ye("QueryEngine","Using full collection scan to execute query:",Al(t)),this.ps.getDocumentsMatchingQuery(e,t,fa.min(),r)}vs(e,t,r,a){return this.ps.getDocumentsMatchingQuery(e,r,a).next((l=>(t.forEach((c=>{l=l.insert(c.key,c)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $0="LocalStore",oC=3e8;class lC{constructor(e,t,r,a){this.persistence=e,this.Fs=t,this.serializer=a,this.Ms=new Pt(Xe),this.xs=new So((l=>D0(l)),M0),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new XR(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function cC(n,e,t,r){return new lC(n,e,t,r)}async function G2(n,e){const t=Ve(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let a;return t.mutationQueue.getAllMutationBatches(r).next((l=>(a=l,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((l=>{const c=[],f=[];let g=We();for(const y of a){c.push(y.batchId);for(const v of y.mutations)g=g.add(v.key)}for(const y of l){f.push(y.batchId);for(const v of y.mutations)g=g.add(v.key)}return t.localDocuments.getDocuments(r,g).next((y=>({Ls:y,removedBatchIds:c,addedBatchIds:f})))}))}))}function uC(n,e){const t=Ve(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const a=e.batch.keys(),l=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(f,g,y,v){const w=y.batch,E=w.keys();let S=oe.resolve();return E.forEach((j=>{S=S.next((()=>v.getEntry(g,j))).next((D=>{const R=y.docVersions.get(j);lt(R!==null,48541),D.version.compareTo(R)<0&&(w.applyToRemoteDocument(D,y),D.isValidDocument()&&(D.setReadTime(y.commitVersion),v.addEntry(D)))}))})),S.next((()=>f.mutationQueue.removeMutationBatch(g,w)))})(t,r,e,l).next((()=>l.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(f){let g=We();for(let y=0;y<f.mutationResults.length;++y)f.mutationResults[y].transformResults.length>0&&(g=g.add(f.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(r,a)))}))}function K2(n){const e=Ve(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function hC(n,e){const t=Ve(n),r=e.snapshotVersion;let a=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=t.Ns.newChangeBuffer({trackRemovals:!0});a=t.Ms;const f=[];e.targetChanges.forEach(((v,w)=>{const E=a.get(w);if(!E)return;f.push(t.Pi.removeMatchingKeys(l,v.removedDocuments,w).next((()=>t.Pi.addMatchingKeys(l,v.addedDocuments,w))));let S=E.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(w)!==null?S=S.withResumeToken(vn.EMPTY_BYTE_STRING,Pe.min()).withLastLimboFreeSnapshotVersion(Pe.min()):v.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(v.resumeToken,r)),a=a.insert(w,S),(function(D,R,L){return D.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=oC?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0})(E,S,v)&&f.push(t.Pi.updateTargetData(l,S))}));let g=hi(),y=We();if(e.documentUpdates.forEach((v=>{e.resolvedLimboDocuments.has(v)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(l,v))})),f.push(dC(l,c,e.documentUpdates).next((v=>{g=v.ks,y=v.qs}))),!r.isEqual(Pe.min())){const v=t.Pi.getLastRemoteSnapshotVersion(l).next((w=>t.Pi.setTargetsMetadata(l,l.currentSequenceNumber,r)));f.push(v)}return oe.waitFor(f).next((()=>c.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,g,y))).next((()=>g))})).then((l=>(t.Ms=a,l)))}function dC(n,e,t){let r=We(),a=We();return t.forEach((l=>r=r.add(l))),e.getEntries(n,r).next((l=>{let c=hi();return t.forEach(((f,g)=>{const y=l.get(f);g.isFoundDocument()!==y.isFoundDocument()&&(a=a.add(f)),g.isNoDocument()&&g.version.isEqual(Pe.min())?(e.removeEntry(f,g.readTime),c=c.insert(f,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),c=c.insert(f,g)):ye($0,"Ignoring outdated watch update for ",f,". Current version:",y.version," Watch version:",g.version)})),{ks:c,qs:a}}))}function fC(n,e){const t=Ve(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=j0),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function mC(n,e){const t=Ve(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let a;return t.Pi.getTargetData(r,e).next((l=>l?(a=l,oe.resolve(a)):t.Pi.allocateTargetId(r).next((c=>(a=new ia(e,c,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,a).next((()=>a)))))))})).then((r=>{const a=t.Ms.get(r.targetId);return(a===null||r.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function Xp(n,e,t){const r=Ve(n),a=r.Ms.get(e),l=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",l,(c=>r.persistence.referenceDelegate.removeTarget(c,a)))}catch(c){if(!tc(c))throw c;ye($0,`Failed to update sequence numbers for target ${e}: ${c}`)}r.Ms=r.Ms.remove(e),r.xs.delete(a.target)}function sw(n,e,t){const r=Ve(n);let a=Pe.min(),l=We();return r.persistence.runTransaction("Execute query","readwrite",(c=>(function(g,y,v){const w=Ve(g),E=w.xs.get(v);return E!==void 0?oe.resolve(w.Ms.get(E)):w.Pi.getTargetData(y,v)})(r,c,Ir(e)).next((f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(c,f.targetId).next((g=>{l=g}))})).next((()=>r.Fs.getDocumentsMatchingQuery(c,e,t?a:Pe.min(),t?l:We()))).next((f=>(gC(r,eR(e),f),{documents:f,Qs:l})))))}function gC(n,e,t){let r=n.Os.get(e)||Pe.min();t.forEach(((a,l)=>{l.readTime.compareTo(r)>0&&(r=l.readTime)})),n.Os.set(e,r)}class rw{constructor(){this.activeTargetIds=aR()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pC{constructor(){this.Mo=new rw,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new rw,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iw="ConnectivityMonitor";class aw{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ye(iw,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ye(iw,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sd=null;function Wp(){return Sd===null?Sd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Sd++,"0x"+Sd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mp="RestConnection",_C={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class vC{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${a}`,this.Wo=this.databaseId.database===Wd?`project_id=${r}`:`project_id=${r}&database_id=${a}`}Go(e,t,r,a,l){const c=Wp(),f=this.zo(e,t.toUriEncodedString());ye(mp,`Sending RPC '${e}' ${c}:`,f,r);const g={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(g,a,l);const{host:y}=new URL(f),v=ba(y);return this.Jo(e,f,g,r,v).then((w=>(ye(mp,`Received RPC '${e}' ${c}: `,w),w)),(w=>{throw _o(mp,`RPC '${e}' ${c} failed with error: `,w,"url: ",f,"request:",r),w}))}Ho(e,t,r,a,l,c){return this.Go(e,t,r,a,l)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Zl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),r&&r.headers.forEach(((a,l)=>e[l]=a))}zo(e,t){const r=_C[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bC{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const On="WebChannelConnection";class wC extends vC{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,a,l){const c=Wp();return new Promise(((f,g)=>{const y=new Qx;y.setWithCredentials(!0),y.listenOnce(Yx.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case Bd.NO_ERROR:const w=y.getResponseJson();ye(On,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(w)),f(w);break;case Bd.TIMEOUT:ye(On,`RPC '${e}' ${c} timed out`),g(new ge(re.DEADLINE_EXCEEDED,"Request time out"));break;case Bd.HTTP_ERROR:const E=y.getStatus();if(ye(On,`RPC '${e}' ${c} failed with status:`,E,"response text:",y.getResponseText()),E>0){let S=y.getResponseJson();Array.isArray(S)&&(S=S[0]);const j=S==null?void 0:S.error;if(j&&j.status&&j.message){const D=(function(L){const F=L.toLowerCase().replace(/_/g,"-");return Object.values(re).indexOf(F)>=0?F:re.UNKNOWN})(j.status);g(new ge(D,j.message))}else g(new ge(re.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new ge(re.UNAVAILABLE,"Connection failed."));break;default:Oe(9055,{l_:e,streamId:c,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{ye(On,`RPC '${e}' ${c} completed.`)}}));const v=JSON.stringify(a);ye(On,`RPC '${e}' ${c} sending request:`,a),y.send(t,"POST",v,r,15)}))}T_(e,t,r){const a=Wp(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=Jx(),f=Wx(),g={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},y=this.longPollingOptions.timeoutSeconds;y!==void 0&&(g.longPollingTimeout=Math.round(1e3*y)),this.useFetchStreams&&(g.useFetchStreams=!0),this.jo(g.initMessageHeaders,t,r),g.encodeInitMessageHeaders=!0;const v=l.join("");ye(On,`Creating RPC '${e}' stream ${a}: ${v}`,g);const w=c.createWebChannel(v,g);this.I_(w);let E=!1,S=!1;const j=new bC({Yo:R=>{S?ye(On,`Not sending because RPC '${e}' stream ${a} is closed:`,R):(E||(ye(On,`Opening RPC '${e}' stream ${a} transport.`),w.open(),E=!0),ye(On,`RPC '${e}' stream ${a} sending:`,R),w.send(R))},Zo:()=>w.close()}),D=(R,L,F)=>{R.listen(L,(B=>{try{F(B)}catch(ee){setTimeout((()=>{throw ee}),0)}}))};return D(w,ou.EventType.OPEN,(()=>{S||(ye(On,`RPC '${e}' stream ${a} transport opened.`),j.o_())})),D(w,ou.EventType.CLOSE,(()=>{S||(S=!0,ye(On,`RPC '${e}' stream ${a} transport closed`),j.a_(),this.E_(w))})),D(w,ou.EventType.ERROR,(R=>{S||(S=!0,_o(On,`RPC '${e}' stream ${a} transport errored. Name:`,R.name,"Message:",R.message),j.a_(new ge(re.UNAVAILABLE,"The operation could not be completed")))})),D(w,ou.EventType.MESSAGE,(R=>{var L;if(!S){const F=R.data[0];lt(!!F,16349);const B=F,ee=(B==null?void 0:B.error)||((L=B[0])==null?void 0:L.error);if(ee){ye(On,`RPC '${e}' stream ${a} received error:`,ee);const he=ee.status;let ue=(function(k){const U=nn[k];if(U!==void 0)return D2(U)})(he),C=ee.message;ue===void 0&&(ue=re.INTERNAL,C="Unknown error status: "+he+" with message "+ee.message),S=!0,j.a_(new ge(ue,C)),w.close()}else ye(On,`RPC '${e}' stream ${a} received:`,F),j.u_(F)}})),D(f,Xx.STAT_EVENT,(R=>{R.stat===Vp.PROXY?ye(On,`RPC '${e}' stream ${a} detected buffering proxy`):R.stat===Vp.NOPROXY&&ye(On,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{j.__()}),0),j}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function gp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zf(n){return new SR(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q2{constructor(e,t,r=1e3,a=1.5,l=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=a,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-r);a>0&&ye("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ow="PersistentStream";class Y2{constructor(e,t,r,a,l,c,f,g){this.Mi=e,this.S_=r,this.b_=a,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=f,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Q2(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===re.RESOURCE_EXHAUSTED?(ui(t.toString()),ui("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,a])=>{this.D_===t&&this.G_(r,a)}),(r=>{e((()=>{const a=new ge(re.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(a)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{r((()=>this.z_(a)))})),this.stream.onMessage((a=>{r((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ye(ow,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(ye(ow,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class xC extends Y2{constructor(e,t,r,a,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,a,c),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=RR(this.serializer,e),r=(function(l){if(!("targetChange"in l))return Pe.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?Pe.min():c.readTime?jr(c.readTime):Pe.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Yp(this.serializer),t.addTarget=(function(l,c){let f;const g=c.target;if(f=$p(g)?{documents:jR(l,g)}:{query:kR(l,g).ft},f.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){f.resumeToken=L2(l,c.resumeToken);const y=Gp(l,c.expectedCount);y!==null&&(f.expectedCount=y)}else if(c.snapshotVersion.compareTo(Pe.min())>0){f.readTime=nf(l,c.snapshotVersion.toTimestamp());const y=Gp(l,c.expectedCount);y!==null&&(f.expectedCount=y)}return f})(this.serializer,e);const r=DR(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Yp(this.serializer),t.removeTarget=e,this.q_(t)}}class EC extends Y2{constructor(e,t,r,a,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,a,c),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return lt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,lt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){lt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=IR(e.writeResults,e.commitTime),r=jr(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Yp(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>CR(this.serializer,r)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{}class SC extends TC{constructor(e,t,r,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new ge(re.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Go(e,Kp(t,r),a,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new ge(re.UNKNOWN,l.toString())}))}Ho(e,t,r,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,f])=>this.connection.Ho(e,Kp(t,r),a,c,f,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new ge(re.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class AC{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ui(t),this.aa=!1):ye("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo="RemoteStore";class NC{constructor(e,t,r,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((c=>{r.enqueueAndForget((async()=>{Ao(this)&&(ye(vo,"Restarting streams for network reachability change."),await(async function(g){const y=Ve(g);y.Ea.add(4),await Ku(y),y.Ra.set("Unknown"),y.Ea.delete(4),await qf(y)})(this))}))})),this.Ra=new AC(r,a)}}async function qf(n){if(Ao(n))for(const e of n.da)await e(!0)}async function Ku(n){for(const e of n.da)await e(!1)}function X2(n,e){const t=Ve(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Q0(t)?K0(t):sc(t).O_()&&G0(t,e))}function F0(n,e){const t=Ve(n),r=sc(t);t.Ia.delete(e),r.O_()&&W2(t,e),t.Ia.size===0&&(r.O_()?r.L_():Ao(t)&&t.Ra.set("Unknown"))}function G0(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Pe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}sc(n).Y_(e)}function W2(n,e){n.Va.Ue(e),sc(n).Z_(e)}function K0(n){n.Va=new wR({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),sc(n).start(),n.Ra.ua()}function Q0(n){return Ao(n)&&!sc(n).x_()&&n.Ia.size>0}function Ao(n){return Ve(n).Ea.size===0}function J2(n){n.Va=void 0}async function RC(n){n.Ra.set("Online")}async function CC(n){n.Ia.forEach(((e,t)=>{G0(n,e)}))}async function IC(n,e){J2(n),Q0(n)?(n.Ra.ha(e),K0(n)):n.Ra.set("Unknown")}async function jC(n,e,t){if(n.Ra.set("Online"),e instanceof P2&&e.state===2&&e.cause)try{await(async function(a,l){const c=l.cause;for(const f of l.targetIds)a.Ia.has(f)&&(await a.remoteSyncer.rejectListen(f,c),a.Ia.delete(f),a.Va.removeTarget(f))})(n,e)}catch(r){ye(vo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await rf(n,r)}else if(e instanceof $d?n.Va.Ze(e):e instanceof M2?n.Va.st(e):n.Va.tt(e),!t.isEqual(Pe.min()))try{const r=await K2(n.localStore);t.compareTo(r)>=0&&await(function(l,c){const f=l.Va.Tt(c);return f.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const v=l.Ia.get(y);v&&l.Ia.set(y,v.withResumeToken(g.resumeToken,c))}})),f.targetMismatches.forEach(((g,y)=>{const v=l.Ia.get(g);if(!v)return;l.Ia.set(g,v.withResumeToken(vn.EMPTY_BYTE_STRING,v.snapshotVersion)),W2(l,g);const w=new ia(v.target,g,y,v.sequenceNumber);G0(l,w)})),l.remoteSyncer.applyRemoteEvent(f)})(n,t)}catch(r){ye(vo,"Failed to raise snapshot:",r),await rf(n,r)}}async function rf(n,e,t){if(!tc(e))throw e;n.Ea.add(1),await Ku(n),n.Ra.set("Offline"),t||(t=()=>K2(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ye(vo,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await qf(n)}))}function Z2(n,e){return e().catch((t=>rf(n,t,e)))}async function Hf(n){const e=Ve(n),t=ya(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:j0;for(;kC(e);)try{const a=await fC(e.localStore,r);if(a===null){e.Ta.length===0&&t.L_();break}r=a.batchId,OC(e,a)}catch(a){await rf(e,a)}eE(e)&&tE(e)}function kC(n){return Ao(n)&&n.Ta.length<10}function OC(n,e){n.Ta.push(e);const t=ya(n);t.O_()&&t.X_&&t.ea(e.mutations)}function eE(n){return Ao(n)&&!ya(n).x_()&&n.Ta.length>0}function tE(n){ya(n).start()}async function DC(n){ya(n).ra()}async function MC(n){const e=ya(n);for(const t of n.Ta)e.ea(t.mutations)}async function PC(n,e,t){const r=n.Ta.shift(),a=V0.from(r,e,t);await Z2(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await Hf(n)}async function LC(n,e){e&&ya(n).X_&&await(async function(r,a){if((function(c){return _R(c)&&c!==re.ABORTED})(a.code)){const l=r.Ta.shift();ya(r).B_(),await Z2(r,(()=>r.remoteSyncer.rejectFailedWrite(l.batchId,a))),await Hf(r)}})(n,e),eE(n)&&tE(n)}async function lw(n,e){const t=Ve(n);t.asyncQueue.verifyOperationInProgress(),ye(vo,"RemoteStore received new credentials");const r=Ao(t);t.Ea.add(3),await Ku(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await qf(t)}async function VC(n,e){const t=Ve(n);e?(t.Ea.delete(2),await qf(t)):e||(t.Ea.add(2),await Ku(t),t.Ra.set("Unknown"))}function sc(n){return n.ma||(n.ma=(function(t,r,a){const l=Ve(t);return l.sa(),new xC(r,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Xo:RC.bind(null,n),t_:CC.bind(null,n),r_:IC.bind(null,n),H_:jC.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Q0(n)?K0(n):n.Ra.set("Unknown")):(await n.ma.stop(),J2(n))}))),n.ma}function ya(n){return n.fa||(n.fa=(function(t,r,a){const l=Ve(t);return l.sa(),new EC(r,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:DC.bind(null,n),r_:LC.bind(null,n),ta:MC.bind(null,n),na:PC.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Hf(n)):(await n.fa.stop(),n.Ta.length>0&&(ye(vo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0{constructor(e,t,r,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=a,this.removalCallback=l,this.deferred=new ii,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,a,l){const c=Date.now()+r,f=new Y0(e,t,c,a,l);return f.start(r),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ge(re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function X0(n,e){if(ui("AsyncQueue",`${e}: ${n}`),tc(n))return new ge(re.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{static emptySet(e){return new Pl(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Ae.comparator(t.key,r.key):(t,r)=>Ae.comparator(t.key,r.key),this.keyedMap=lu(),this.sortedSet=new Pt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Pl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=r.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Pl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(){this.ga=new Pt(Ae.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Oe(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Xl{constructor(e,t,r,a,l,c,f,g,y){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=f,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,r,a,l){const c=[];return t.forEach((f=>{c.push({type:0,doc:f})})),new Xl(e,t,Pl.emptySet(t),c,r,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Mf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==r[a].type||!t[a].doc.isEqual(r[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UC{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class BC{constructor(){this.queries=uw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const a=Ve(t),l=a.queries;a.queries=uw(),l.forEach(((c,f)=>{for(const g of f.Sa)g.onError(r)}))})(this,new ge(re.ABORTED,"Firestore shutting down"))}}function uw(){return new So((n=>x2(n)),Mf)}async function W0(n,e){const t=Ve(n);let r=3;const a=e.query;let l=t.queries.get(a);l?!l.ba()&&e.Da()&&(r=2):(l=new UC,r=e.Da()?0:1);try{switch(r){case 0:l.wa=await t.onListen(a,!0);break;case 1:l.wa=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(c){const f=X0(c,`Initialization of query '${Al(e.query)}' failed`);return void e.onError(f)}t.queries.set(a,l),l.Sa.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&Z0(t)}async function J0(n,e){const t=Ve(n),r=e.query;let a=3;const l=t.queries.get(r);if(l){const c=l.Sa.indexOf(e);c>=0&&(l.Sa.splice(c,1),l.Sa.length===0?a=e.Da()?0:1:!l.ba()&&e.Da()&&(a=2))}switch(a){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function zC(n,e){const t=Ve(n);let r=!1;for(const a of e){const l=a.query,c=t.queries.get(l);if(c){for(const f of c.Sa)f.Fa(a)&&(r=!0);c.wa=a}}r&&Z0(t)}function qC(n,e,t){const r=Ve(n),a=r.queries.get(e);if(a)for(const l of a.Sa)l.onError(t);r.queries.delete(e)}function Z0(n){n.Ca.forEach((e=>{e.next()}))}var Jp,hw;(hw=Jp||(Jp={})).Ma="default",hw.Cache="cache";class ey{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const a of e.docChanges)a.type!==3&&r.push(a);e=new Xl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Xl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Jp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nE{constructor(e){this.key=e}}class sE{constructor(e){this.key=e}}class HC{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=We(),this.mutatedKeys=We(),this.eu=E2(e),this.tu=new Pl(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new cw,a=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,c=a,f=!1;const g=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,y=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((v,w)=>{const E=a.get(v),S=Pf(this.query,w)?w:null,j=!!E&&this.mutatedKeys.has(E.key),D=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let R=!1;E&&S?E.data.isEqual(S.data)?j!==D&&(r.track({type:3,doc:S}),R=!0):this.su(E,S)||(r.track({type:2,doc:S}),R=!0,(g&&this.eu(S,g)>0||y&&this.eu(S,y)<0)&&(f=!0)):!E&&S?(r.track({type:0,doc:S}),R=!0):E&&!S&&(r.track({type:1,doc:E}),R=!0,(g||y)&&(f=!0)),R&&(S?(c=c.add(S),l=D?l.add(v):l.delete(v)):(c=c.delete(v),l=l.delete(v)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const v=this.query.limitType==="F"?c.last():c.first();c=c.delete(v.key),l=l.delete(v.key),r.track({type:1,doc:v})}return{tu:c,iu:r,Cs:f,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((v,w)=>(function(S,j){const D=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Oe(20277,{Rt:R})}};return D(S)-D(j)})(v.type,w.type)||this.eu(v.doc,w.doc))),this.ou(r),a=a??!1;const f=t&&!a?this._u():[],g=this.Xa.size===0&&this.current&&!a?1:0,y=g!==this.Za;return this.Za=g,c.length!==0||y?{snapshot:new Xl(this.query,e.tu,l,c,e.mutatedKeys,g===0,y,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:f}:{au:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new cw,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=We(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new sE(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new nE(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=We();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Xl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const ty="SyncEngine";class $C{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class FC{constructor(e){this.key=e,this.hu=!1}}class GC{constructor(e,t,r,a,l,c){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new So((f=>x2(f)),Mf),this.Iu=new Map,this.Eu=new Set,this.du=new Pt(Ae.comparator),this.Au=new Map,this.Ru=new z0,this.Vu={},this.mu=new Map,this.fu=Yl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function KC(n,e,t=!0){const r=cE(n);let a;const l=r.Tu.get(e);return l?(r.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await rE(r,e,t,!0),a}async function QC(n,e){const t=cE(n);await rE(t,e,!0,!1)}async function rE(n,e,t,r){const a=await mC(n.localStore,Ir(e)),l=a.targetId,c=n.sharedClientState.addLocalQueryTarget(l,t);let f;return r&&(f=await YC(n,e,l,c==="current",a.resumeToken)),n.isPrimaryClient&&t&&X2(n.remoteStore,a),f}async function YC(n,e,t,r,a){n.pu=(w,E,S)=>(async function(D,R,L,F){let B=R.view.ru(L);B.Cs&&(B=await sw(D.localStore,R.query,!1).then((({documents:C})=>R.view.ru(C,B))));const ee=F&&F.targetChanges.get(R.targetId),he=F&&F.targetMismatches.get(R.targetId)!=null,ue=R.view.applyChanges(B,D.isPrimaryClient,ee,he);return fw(D,R.targetId,ue.au),ue.snapshot})(n,w,E,S);const l=await sw(n.localStore,e,!0),c=new HC(e,l.Qs),f=c.ru(l.documents),g=Gu.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",a),y=c.applyChanges(f,n.isPrimaryClient,g);fw(n,t,y.au);const v=new $C(e,t,c);return n.Tu.set(e,v),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),y.snapshot}async function XC(n,e,t){const r=Ve(n),a=r.Tu.get(e),l=r.Iu.get(a.targetId);if(l.length>1)return r.Iu.set(a.targetId,l.filter((c=>!Mf(c,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await Xp(r.localStore,a.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(a.targetId),t&&F0(r.remoteStore,a.targetId),Zp(r,a.targetId)})).catch(ec)):(Zp(r,a.targetId),await Xp(r.localStore,a.targetId,!0))}async function WC(n,e){const t=Ve(n),r=t.Tu.get(e),a=t.Iu.get(r.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),F0(t.remoteStore,r.targetId))}async function JC(n,e,t){const r=i3(n);try{const a=await(function(c,f){const g=Ve(c),y=vt.now(),v=f.reduce(((S,j)=>S.add(j.key)),We());let w,E;return g.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let j=hi(),D=We();return g.Ns.getEntries(S,v).next((R=>{j=R,j.forEach(((L,F)=>{F.isValidDocument()||(D=D.add(L))}))})).next((()=>g.localDocuments.getOverlayedDocuments(S,j))).next((R=>{w=R;const L=[];for(const F of f){const B=fR(F,w.get(F.key).overlayedDocument);B!=null&&L.push(new xa(F.key,B,m2(B.value.mapValue),Gn.exists(!0)))}return g.mutationQueue.addMutationBatch(S,y,L,f)})).next((R=>{E=R;const L=R.applyToLocalDocumentSet(w,D);return g.documentOverlayCache.saveOverlays(S,R.batchId,L)}))})).then((()=>({batchId:E.batchId,changes:S2(w)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(a.batchId),(function(c,f,g){let y=c.Vu[c.currentUser.toKey()];y||(y=new Pt(Xe)),y=y.insert(f,g),c.Vu[c.currentUser.toKey()]=y})(r,a.batchId,t),await Qu(r,a.changes),await Hf(r.remoteStore)}catch(a){const l=X0(a,"Failed to persist write");t.reject(l)}}async function iE(n,e){const t=Ve(n);try{const r=await hC(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const c=t.Au.get(l);c&&(lt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?c.hu=!0:a.modifiedDocuments.size>0?lt(c.hu,14607):a.removedDocuments.size>0&&(lt(c.hu,42227),c.hu=!1))})),await Qu(t,r,e)}catch(r){await ec(r)}}function dw(n,e,t){const r=Ve(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const a=[];r.Tu.forEach(((l,c)=>{const f=c.view.va(e);f.snapshot&&a.push(f.snapshot)})),(function(c,f){const g=Ve(c);g.onlineState=f;let y=!1;g.queries.forEach(((v,w)=>{for(const E of w.Sa)E.va(f)&&(y=!0)})),y&&Z0(g)})(r.eventManager,e),a.length&&r.Pu.H_(a),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function ZC(n,e,t){const r=Ve(n);r.sharedClientState.updateQueryState(e,"rejected",t);const a=r.Au.get(e),l=a&&a.key;if(l){let c=new Pt(Ae.comparator);c=c.insert(l,Ln.newNoDocument(l,Pe.min()));const f=We().add(l),g=new Bf(Pe.min(),new Map,new Pt(Xe),c,f);await iE(r,g),r.du=r.du.remove(l),r.Au.delete(e),ny(r)}else await Xp(r.localStore,e,!1).then((()=>Zp(r,e,t))).catch(ec)}async function e3(n,e){const t=Ve(n),r=e.batch.batchId;try{const a=await uC(t.localStore,e);oE(t,r,null),aE(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Qu(t,a)}catch(a){await ec(a)}}async function t3(n,e,t){const r=Ve(n);try{const a=await(function(c,f){const g=Ve(c);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let v;return g.mutationQueue.lookupMutationBatch(y,f).next((w=>(lt(w!==null,37113),v=w.keys(),g.mutationQueue.removeMutationBatch(y,w)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,v,f))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,v))).next((()=>g.localDocuments.getDocuments(y,v)))}))})(r.localStore,e);oE(r,e,t),aE(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Qu(r,a)}catch(a){await ec(a)}}function aE(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function oE(n,e,t){const r=Ve(n);let a=r.Vu[r.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),r.Vu[r.currentUser.toKey()]=a}}function Zp(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||lE(n,r)}))}function lE(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(F0(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),ny(n))}function fw(n,e,t){for(const r of t)r instanceof nE?(n.Ru.addReference(r.key,e),n3(n,r)):r instanceof sE?(ye(ty,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||lE(n,r.key)):Oe(19791,{wu:r})}function n3(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(ye(ty,"New document in limbo: "+t),n.Eu.add(r),ny(n))}function ny(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Ae(Et.fromString(e)),r=n.fu.next();n.Au.set(r,new FC(t)),n.du=n.du.insert(t,r),X2(n.remoteStore,new ia(Ir(Df(t.path)),r,"TargetPurposeLimboResolution",jf.ce))}}async function Qu(n,e,t){const r=Ve(n),a=[],l=[],c=[];r.Tu.isEmpty()||(r.Tu.forEach(((f,g)=>{c.push(r.pu(g,e,t).then((y=>{var v;if((y||t)&&r.isPrimaryClient){const w=y?!y.fromCache:(v=t==null?void 0:t.targetChanges.get(g.targetId))==null?void 0:v.current;r.sharedClientState.updateQueryState(g.targetId,w?"current":"not-current")}if(y){a.push(y);const w=H0.As(g.targetId,y);l.push(w)}})))})),await Promise.all(c),r.Pu.H_(a),await(async function(g,y){const v=Ve(g);try{await v.persistence.runTransaction("notifyLocalViewChanges","readwrite",(w=>oe.forEach(y,(E=>oe.forEach(E.Es,(S=>v.persistence.referenceDelegate.addReference(w,E.targetId,S))).next((()=>oe.forEach(E.ds,(S=>v.persistence.referenceDelegate.removeReference(w,E.targetId,S)))))))))}catch(w){if(!tc(w))throw w;ye($0,"Failed to update sequence numbers: "+w)}for(const w of y){const E=w.targetId;if(!w.fromCache){const S=v.Ms.get(E),j=S.snapshotVersion,D=S.withLastLimboFreeSnapshotVersion(j);v.Ms=v.Ms.insert(E,D)}}})(r.localStore,l))}async function s3(n,e){const t=Ve(n);if(!t.currentUser.isEqual(e)){ye(ty,"User change. New user:",e.toKey());const r=await G2(t.localStore,e);t.currentUser=e,(function(l,c){l.mu.forEach((f=>{f.forEach((g=>{g.reject(new ge(re.CANCELLED,c))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Qu(t,r.Ls)}}function r3(n,e){const t=Ve(n),r=t.Au.get(e);if(r&&r.hu)return We().add(r.key);{let a=We();const l=t.Iu.get(e);if(!l)return a;for(const c of l){const f=t.Tu.get(c);a=a.unionWith(f.view.nu)}return a}}function cE(n){const e=Ve(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=iE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=r3.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ZC.bind(null,e),e.Pu.H_=zC.bind(null,e.eventManager),e.Pu.yu=qC.bind(null,e.eventManager),e}function i3(n){const e=Ve(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=e3.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=t3.bind(null,e),e}class af{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=zf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return cC(this.persistence,new aC,e.initialUser,this.serializer)}Cu(e){return new F2(q0.mi,this.serializer)}Du(e){return new pC}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}af.provider={build:()=>new af};class a3 extends af{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){lt(this.persistence.referenceDelegate instanceof sf,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new FR(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?ns.withCacheSize(this.cacheSizeBytes):ns.DEFAULT;return new F2((r=>sf.mi(r,t)),this.serializer)}}class e0{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>dw(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=s3.bind(null,this.syncEngine),await VC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new BC})()}createDatastore(e){const t=zf(e.databaseInfo.databaseId),r=(function(l){return new wC(l)})(e.databaseInfo);return(function(l,c,f,g){return new SC(l,c,f,g)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,a,l,c,f){return new NC(r,a,l,c,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>dw(this.syncEngine,t,0)),(function(){return aw.v()?new aw:new yC})())}createSyncEngine(e,t){return(function(a,l,c,f,g,y,v){const w=new GC(a,l,c,f,g,y);return v&&(w.gu=!0),w})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=Ve(a);ye(vo,"RemoteStore shutting down."),l.Ea.add(5),await Ku(l),l.Aa.shutdown(),l.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}e0.provider={build:()=>new e0};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ui("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a="FirestoreClient";class o3{constructor(e,t,r,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=a,this.user=Pn.UNAUTHENTICATED,this.clientId=Cf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(r,(async c=>{ye(_a,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(r,(c=>(ye(_a,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ii;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=X0(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function pp(n,e){n.asyncQueue.verifyOperationInProgress(),ye(_a,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async a=>{r.isEqual(a)||(await G2(e.localStore,a),r=a)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function mw(n,e){n.asyncQueue.verifyOperationInProgress();const t=await l3(n);ye(_a,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>lw(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,a)=>lw(e.remoteStore,a))),n._onlineComponents=e}async function l3(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ye(_a,"Using user provided OfflineComponentProvider");try{await pp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===re.FAILED_PRECONDITION||a.code===re.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;_o("Error using user provided cache. Falling back to memory cache: "+t),await pp(n,new af)}}else ye(_a,"Using default OfflineComponentProvider"),await pp(n,new a3(void 0));return n._offlineComponents}async function uE(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ye(_a,"Using user provided OnlineComponentProvider"),await mw(n,n._uninitializedComponentsProvider._online)):(ye(_a,"Using default OnlineComponentProvider"),await mw(n,new e0))),n._onlineComponents}function c3(n){return uE(n).then((e=>e.syncEngine))}async function of(n){const e=await uE(n),t=e.eventManager;return t.onListen=KC.bind(null,e.syncEngine),t.onUnlisten=XC.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=QC.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=WC.bind(null,e.syncEngine),t}function u3(n,e,t={}){const r=new ii;return n.asyncQueue.enqueueAndForget((async()=>(function(l,c,f,g,y){const v=new sy({next:E=>{v.Nu(),c.enqueueAndForget((()=>J0(l,w)));const S=E.docs.has(f);!S&&E.fromCache?y.reject(new ge(re.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&E.fromCache&&g&&g.source==="server"?y.reject(new ge(re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(E)},error:E=>y.reject(E)}),w=new ey(Df(f.path),v,{includeMetadataChanges:!0,qa:!0});return W0(l,w)})(await of(n),n.asyncQueue,e,t,r))),r.promise}function h3(n,e,t={}){const r=new ii;return n.asyncQueue.enqueueAndForget((async()=>(function(l,c,f,g,y){const v=new sy({next:E=>{v.Nu(),c.enqueueAndForget((()=>J0(l,w))),E.fromCache&&g.source==="server"?y.reject(new ge(re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(E)},error:E=>y.reject(E)}),w=new ey(f,v,{includeMetadataChanges:!0,qa:!0});return W0(l,w)})(await of(n),n.asyncQueue,e,t,r))),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hE(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gw=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dE="firestore.googleapis.com",pw=!0;class yw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ge(re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=dE,this.ssl=pw}else this.host=e.host,this.ssl=e.ssl??pw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=$2;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<HR)throw new ge(re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}s2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=hE(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ge(re.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ge(re.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ge(re.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,a){return r.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class $f{constructor(e,t,r,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ge(re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ge(re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new t2;switch(r.type){case"firstParty":return new x5(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ge(re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=gw.get(t);r&&(ye("ComponentProvider","Removing Datastore"),gw.delete(t),r.terminate())})(this),Promise.resolve()}}function fE(n,e,t,r={}){var y;n=Vn(n,$f);const a=ba(e),l=n._getSettings(),c={...l,emulatorOptions:n._getEmulatorOptions()},f=`${e}:${t}`;a&&(A0(`https://${f}`),N0("Firestore",!0)),l.host!==dE&&l.host!==f&&_o("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...l,host:f,ssl:a,emulatorOptions:r};if(!li(g,c)&&(n._setSettings(g),r.mockUserToken)){let v,w;if(typeof r.mockUserToken=="string")v=r.mockUserToken,w=Pn.MOCK_USER;else{v=zx(r.mockUserToken,(y=n._app)==null?void 0:y.options.projectId);const E=r.mockUserToken.sub||r.mockUserToken.user_id;if(!E)throw new ge(re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");w=new Pn(E)}n._authCredentials=new v5(new e2(v,w))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Pr(this.firestore,e,this._query)}}class Mt{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ai(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Mt(this.firestore,e,this._key)}toJSON(){return{type:Mt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if($u(t,Mt._jsonSchema))return new Mt(e,r||null,new Ae(Et.fromString(t.referencePath)))}}Mt._jsonSchemaVersion="firestore/documentReference/1.0",Mt._jsonSchema={type:an("string",Mt._jsonSchemaVersion),referencePath:an("string")};class ai extends Pr{constructor(e,t,r){super(e,t,Df(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Mt(this.firestore,null,new Ae(e))}withConverter(e){return new ai(this.firestore,e,this._path)}}function wt(n,e,...t){if(n=It(n),n2("collection","path",e),n instanceof $f){const r=Et.fromString(e,...t);return I1(r),new ai(n,null,r)}{if(!(n instanceof Mt||n instanceof ai))throw new ge(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Et.fromString(e,...t));return I1(r),new ai(n.firestore,null,r)}}function ft(n,e,...t){if(n=It(n),arguments.length===1&&(e=Cf.newId()),n2("doc","path",e),n instanceof $f){const r=Et.fromString(e,...t);return C1(r),new Mt(n,null,new Ae(r))}{if(!(n instanceof Mt||n instanceof ai))throw new ge(re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Et.fromString(e,...t));return C1(r),new Mt(n.firestore,n instanceof ai?n.converter:null,new Ae(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _w="AsyncQueue";class vw{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Q2(this,"async_queue_retry"),this._c=()=>{const r=gp();r&&ye(_w,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=gp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=gp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ii;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!tc(e))throw e;ye(_w,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,ui("INTERNAL UNHANDLED ERROR: ",bw(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=Y0.createAndSchedule(this,e,t,r,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&Oe(47125,{Pc:bw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function bw(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ww(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const a=t;for(const l of r)if(l in a&&typeof a[l]=="function")return!0;return!1})(n,["next","error","complete"])}class or extends $f{constructor(e,t,r,a){super(e,t,r,a),this.type="firestore",this._queue=new vw,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new vw(e),this._firestoreClient=void 0,await e}}}function mE(n,e){const t=typeof n=="object"?n:Rf(),r=typeof n=="string"?n:Wd,a=Nf(t,"firestore").getImmediate({identifier:r});if(!a._initialized){const l=Vx("firestore");l&&fE(a,...l)}return a}function rc(n){if(n._terminated)throw new ge(re.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||d3(n),n._firestoreClient}function d3(n){var r,a,l;const e=n._freezeSettings(),t=(function(f,g,y,v){return new V5(f,g,y,v.host,v.ssl,v.experimentalForceLongPolling,v.experimentalAutoDetectLongPolling,hE(v.experimentalLongPollingOptions),v.useFetchStreams,v.isUsingEmulator)})(n._databaseId,((r=n._app)==null?void 0:r.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(a=e.localCache)!=null&&a._offlineComponentProvider&&((l=e.localCache)!=null&&l._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new o3(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(f){const g=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(g),_online:g}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ws(vn.fromBase64String(e))}catch(t){throw new ge(re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ws(vn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ws._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if($u(e,ws._jsonSchema))return ws.fromBase64String(e.bytes)}}ws._jsonSchemaVersion="firestore/bytes/1.0",ws._jsonSchema={type:an("string",ws._jsonSchemaVersion),bytes:an("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ge(re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new yn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function Ff(){return new No(Bp)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ge(re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ge(re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Xe(this._lat,e._lat)||Xe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:rr._jsonSchemaVersion}}static fromJSON(e){if($u(e,rr._jsonSchema))return new rr(e.latitude,e.longitude)}}rr._jsonSchemaVersion="firestore/geoPoint/1.0",rr._jsonSchema={type:an("string",rr._jsonSchemaVersion),latitude:an("number"),longitude:an("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,a){if(r.length!==a.length)return!1;for(let l=0;l<r.length;++l)if(r[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ir._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if($u(e,ir._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ir(e.vectorValues);throw new ge(re.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ir._jsonSchemaVersion="firestore/vectorValue/1.0",ir._jsonSchema={type:an("string",ir._jsonSchemaVersion),vectorValues:an("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f3=/^__.*__$/;class m3{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new xa(e,this.data,this.fieldMask,t,this.fieldTransforms):new Fu(e,this.data,t,this.fieldTransforms)}}class gE{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new xa(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function pE(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Oe(40011,{Ac:n})}}class Gf{constructor(e,t,r,a,l,c){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=a,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Gf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var a;const t=(a=this.path)==null?void 0:a.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){var a;const t=(a=this.path)==null?void 0:a.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return lf(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(pE(this.Ac)&&f3.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class g3{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||zf(e)}Cc(e,t,r,a=!1){return new Gf({Ac:e,methodName:t,Dc:r,path:yn.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Yu(n){const e=n._freezeSettings(),t=zf(n._databaseId);return new g3(n._databaseId,!!e.ignoreUndefinedProperties,t)}function ry(n,e,t,r,a,l={}){const c=n.Cc(l.merge||l.mergeFields?2:0,e,t,a);ly("Data must be an object, but it was:",c,r);const f=bE(r,c);let g,y;if(l.merge)g=new Ts(c.fieldMask),y=c.fieldTransforms;else if(l.mergeFields){const v=[];for(const w of l.mergeFields){const E=t0(e,w,t);if(!c.contains(E))throw new ge(re.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);xE(v,E)||v.push(E)}g=new Ts(v),y=c.fieldTransforms.filter((w=>g.covers(w.field)))}else g=null,y=c.fieldTransforms;return new m3(new ss(f),g,y)}class Kf extends Ro{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Kf}}function yE(n,e,t){return new Gf({Ac:3,Dc:e.settings.Dc,methodName:n._methodName,fc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class iy extends Ro{_toFieldTransform(e){return new L0(e.path,new Iu)}isEqual(e){return e instanceof iy}}class ay extends Ro{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=yE(this,e,!0),r=this.vc.map((l=>Co(l,t))),a=new Kl(r);return new L0(e.path,a)}isEqual(e){return e instanceof ay&&li(this.vc,e.vc)}}class oy extends Ro{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=yE(this,e,!0),r=this.vc.map((l=>Co(l,t))),a=new Ql(r);return new L0(e.path,a)}isEqual(e){return e instanceof oy&&li(this.vc,e.vc)}}function _E(n,e,t,r){const a=n.Cc(1,e,t);ly("Data must be an object, but it was:",a,r);const l=[],c=ss.empty();wa(r,((g,y)=>{const v=cy(e,g,t);y=It(y);const w=a.yc(v);if(y instanceof Kf)l.push(v);else{const E=Co(y,w);E!=null&&(l.push(v),c.set(v,E))}}));const f=new Ts(l);return new gE(c,f,a.fieldTransforms)}function vE(n,e,t,r,a,l){const c=n.Cc(1,e,t),f=[t0(e,r,t)],g=[a];if(l.length%2!=0)throw new ge(re.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<l.length;E+=2)f.push(t0(e,l[E])),g.push(l[E+1]);const y=[],v=ss.empty();for(let E=f.length-1;E>=0;--E)if(!xE(y,f[E])){const S=f[E];let j=g[E];j=It(j);const D=c.yc(S);if(j instanceof Kf)y.push(S);else{const R=Co(j,D);R!=null&&(y.push(S),v.set(S,R))}}const w=new Ts(y);return new gE(v,w,c.fieldTransforms)}function p3(n,e,t,r=!1){return Co(t,n.Cc(r?4:3,e))}function Co(n,e){if(wE(n=It(n)))return ly("Unsupported field value:",e,n),bE(n,e);if(n instanceof Ro)return(function(r,a){if(!pE(a.Ac))throw a.Sc(`${r._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${r._methodName}() is not currently supported inside arrays`);const l=r._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,a){const l=[];let c=0;for(const f of r){let g=Co(f,a.wc(c));g==null&&(g={nullValue:"NULL_VALUE"}),l.push(g),c++}return{arrayValue:{values:l}}})(n,e)}return(function(r,a){if((r=It(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return oR(a.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const l=vt.fromDate(r);return{timestampValue:nf(a.serializer,l)}}if(r instanceof vt){const l=new vt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:nf(a.serializer,l)}}if(r instanceof rr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ws)return{bytesValue:L2(a.serializer,r._byteString)};if(r instanceof Mt){const l=a.databaseId,c=r.firestore._databaseId;if(!c.isEqual(l))throw a.Sc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:B0(r.firestore._databaseId||a.databaseId,r._key.path)}}if(r instanceof ir)return(function(c,f){return{mapValue:{fields:{[d2]:{stringValue:f2},[Jd]:{arrayValue:{values:c.toArray().map((y=>{if(typeof y!="number")throw f.Sc("VectorValues must only contain numeric values.");return P0(f.serializer,y)}))}}}}}})(r,a);throw a.Sc(`Unsupported field value: ${If(r)}`)})(n,e)}function bE(n,e){const t={};return a2(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wa(n,((r,a)=>{const l=Co(a,e.mc(r));l!=null&&(t[r]=l)})),{mapValue:{fields:t}}}function wE(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof vt||n instanceof rr||n instanceof ws||n instanceof Mt||n instanceof Ro||n instanceof ir)}function ly(n,e,t){if(!wE(t)||!r2(t)){const r=If(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function t0(n,e,t){if((e=It(e))instanceof No)return e._internalPath;if(typeof e=="string")return cy(n,e);throw lf("Field path arguments must be of type string or ",n,!1,void 0,t)}const y3=new RegExp("[~\\*/\\[\\]]");function cy(n,e,t){if(e.search(y3)>=0)throw lf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new No(...e.split("."))._internalPath}catch{throw lf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function lf(n,e,t,r,a){const l=r&&!r.isEmpty(),c=a!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let g="";return(l||c)&&(g+=" (found",l&&(g+=` in field ${r}`),c&&(g+=` in document ${a}`),g+=")"),new ge(re.INVALID_ARGUMENT,f+n+g)}function xE(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EE{constructor(e,t,r,a,l){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Mt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new _3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Qf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class _3 extends EE{data(){return super.data()}}function Qf(n,e){return typeof e=="string"?cy(n,e):e instanceof No?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TE(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ge(re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class uy{}class Yf extends uy{}function qt(n,e,...t){let r=[];e instanceof uy&&r.push(e),r=r.concat(t),(function(l){const c=l.filter((g=>g instanceof Xf)).length,f=l.filter((g=>g instanceof Xu)).length;if(c>1||c>0&&f>0)throw new ge(re.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const a of r)n=a._apply(n);return n}class Xu extends Yf{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Xu(e,t,r)}_apply(e){const t=this._parse(e);return SE(e._query,t),new Pr(e.firestore,e.converter,Fp(e._query,t))}_parse(e){const t=Yu(e.firestore);return(function(l,c,f,g,y,v,w){let E;if(y.isKeyField()){if(v==="array-contains"||v==="array-contains-any")throw new ge(re.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if(v==="in"||v==="not-in"){Ew(w,v);const j=[];for(const D of w)j.push(xw(g,l,D));E={arrayValue:{values:j}}}else E=xw(g,l,w)}else v!=="in"&&v!=="not-in"&&v!=="array-contains-any"||Ew(w,v),E=p3(f,c,w,v==="in"||v==="not-in");return rn.create(y,v,E)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function hn(n,e,t){const r=e,a=Qf("where",n);return Xu._create(a,r,t)}class Xf extends uy{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Xf(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:ar.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let c=a;const f=l.getFlattenedFilters();for(const g of f)SE(c,g),c=Fp(c,g)})(e._query,t),new Pr(e.firestore,e.converter,Fp(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Wf extends Yf{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Wf(e,t)}_apply(e){const t=(function(a,l,c){if(a.startAt!==null)throw new ge(re.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new ge(re.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Cu(l,c)})(e._query,this._field,this._direction);return new Pr(e.firestore,e.converter,(function(a,l){const c=a.explicitOrderBy.concat([l]);return new nc(a.path,a.collectionGroup,c,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)})(e._query,t))}}function Jf(n,e="asc"){const t=e,r=Qf("orderBy",n);return Wf._create(r,t)}class Zf extends Yf{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Zf(e,t,r)}_apply(e){return new Pr(e.firestore,e.converter,ef(e._query,this._limit,this._limitType))}}function cf(n){return Zf._create("limit",n,"F")}function xw(n,e,t){if(typeof(t=It(t))=="string"){if(t==="")throw new ge(re.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!w2(e)&&t.indexOf("/")!==-1)throw new ge(re.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Et.fromString(t));if(!Ae.isDocumentKey(r))throw new ge(re.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return V1(n,new Ae(r))}if(t instanceof Mt)return V1(n,t._key);throw new ge(re.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${If(t)}.`)}function Ew(n,e){if(!Array.isArray(n)||n.length===0)throw new ge(re.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function SE(n,e){const t=(function(a,l){for(const c of a)for(const f of c.getFlattenedFilters())if(l.indexOf(f.op)>=0)return f.op;return null})(n.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ge(re.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ge(re.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class AE{convertValue(e,t="none"){switch(pa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Yt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ga(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Oe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return wa(e,((a,l)=>{r[a]=this.convertValue(l,t)})),r}convertVectorValue(e){var r,a,l;const t=(l=(a=(r=e.fields)==null?void 0:r[Jd].arrayValue)==null?void 0:a.values)==null?void 0:l.map((c=>Yt(c.doubleValue)));return new ir(t)}convertGeoPoint(e){return new rr(Yt(e.latitude),Yt(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Of(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Nu(e));default:return null}}convertTimestamp(e){const t=ma(e);return new vt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Et.fromString(e);lt(H2(r),9688,{name:e});const a=new $l(r.get(1),r.get(3)),l=new Ae(r.popFirst(5));return a.isEqual(t)||ui(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hy(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class kl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ua extends EE{constructor(e,t,r,a,l,c){super(e,t,r,a,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new pu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Qf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ge(re.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ua._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}ua._jsonSchemaVersion="firestore/documentSnapshot/1.0",ua._jsonSchema={type:an("string",ua._jsonSchemaVersion),bundleSource:an("string","DocumentSnapshot"),bundleName:an("string"),bundle:an("string")};class pu extends ua{data(e={}){return super.data(e)}}class ha{constructor(e,t,r,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new kl(a.hasPendingWrites,a.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new pu(this._firestore,this._userDataWriter,r.key,r,new kl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ge(re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map((f=>{const g=new pu(a._firestore,a._userDataWriter,f.doc.key,f.doc,new kl(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:g,oldIndex:-1,newIndex:c++}}))}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((f=>l||f.type!==3)).map((f=>{const g=new pu(a._firestore,a._userDataWriter,f.doc.key,f.doc,new kl(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let y=-1,v=-1;return f.type!==0&&(y=c.indexOf(f.doc.key),c=c.delete(f.doc.key)),f.type!==1&&(c=c.add(f.doc),v=c.indexOf(f.doc.key)),{type:v3(f.type),doc:g,oldIndex:y,newIndex:v}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ge(re.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ha._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Cf.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),r.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function v3(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Oe(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bo(n){n=Vn(n,Mt);const e=Vn(n.firestore,or);return u3(rc(e),n._key).then((t=>RE(e,n,t)))}ha._jsonSchemaVersion="firestore/querySnapshot/1.0",ha._jsonSchema={type:an("string",ha._jsonSchemaVersion),bundleSource:an("string","QuerySnapshot"),bundleName:an("string"),bundle:an("string")};class dy extends AE{constructor(e){super(),this.firestore=e}convertBytes(e){return new ws(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Mt(this.firestore,null,t)}}function _n(n){n=Vn(n,Pr);const e=Vn(n.firestore,or),t=rc(e),r=new dy(e);return TE(n._query),h3(t,n._query).then((a=>new ha(e,r,n,a)))}function NE(n,e,t){n=Vn(n,Mt);const r=Vn(n.firestore,or),a=hy(n.converter,e,t);return ic(r,[ry(Yu(r),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,Gn.none())])}function vs(n,e,t,...r){n=Vn(n,Mt);const a=Vn(n.firestore,or),l=Yu(a);let c;return c=typeof(e=It(e))=="string"||e instanceof No?vE(l,"updateDoc",n._key,e,t,r):_E(l,"updateDoc",n._key,e),ic(a,[c.toMutation(n._key,Gn.exists(!0))])}function fy(n){return ic(Vn(n.firestore,or),[new Uf(n._key,Gn.none())])}function ju(n,e){const t=Vn(n.firestore,or),r=ft(n),a=hy(n.converter,e);return ic(t,[ry(Yu(n.firestore),"addDoc",r._key,a,n.converter!==null,{}).toMutation(r._key,Gn.exists(!1))]).then((()=>r))}function Ll(n,...e){var g,y,v;n=It(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||ww(e[r])||(t=e[r++]);const a={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(ww(e[r])){const w=e[r];e[r]=(g=w.next)==null?void 0:g.bind(w),e[r+1]=(y=w.error)==null?void 0:y.bind(w),e[r+2]=(v=w.complete)==null?void 0:v.bind(w)}let l,c,f;if(n instanceof Mt)c=Vn(n.firestore,or),f=Df(n._key.path),l={next:w=>{e[r]&&e[r](RE(c,n,w))},error:e[r+1],complete:e[r+2]};else{const w=Vn(n,Pr);c=Vn(w.firestore,or),f=w._query;const E=new dy(c);l={next:S=>{e[r]&&e[r](new ha(c,E,w,S))},error:e[r+1],complete:e[r+2]},TE(n._query)}return(function(E,S,j,D){const R=new sy(D),L=new ey(S,R,j);return E.asyncQueue.enqueueAndForget((async()=>W0(await of(E),L))),()=>{R.Nu(),E.asyncQueue.enqueueAndForget((async()=>J0(await of(E),L)))}})(rc(c),f,a,l)}function ic(n,e){return(function(r,a){const l=new ii;return r.asyncQueue.enqueueAndForget((async()=>JC(await c3(r),a,l))),l.promise})(rc(n),e)}function RE(n,e,t){const r=t.docs.get(e._key),a=new dy(n);return new ua(n,a,e._key,r,new kl(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CE{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Yu(e)}set(e,t,r){this._verifyNotCommitted();const a=yp(e,this._firestore),l=hy(a.converter,t,r),c=ry(this._dataReader,"WriteBatch.set",a._key,l,a.converter!==null,r);return this._mutations.push(c.toMutation(a._key,Gn.none())),this}update(e,t,r,...a){this._verifyNotCommitted();const l=yp(e,this._firestore);let c;return c=typeof(t=It(t))=="string"||t instanceof No?vE(this._dataReader,"WriteBatch.update",l._key,t,r,a):_E(this._dataReader,"WriteBatch.update",l._key,t),this._mutations.push(c.toMutation(l._key,Gn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=yp(e,this._firestore);return this._mutations=this._mutations.concat(new Uf(t._key,Gn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ge(re.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function yp(n,e){if((n=It(n)).firestore!==e)throw new ge(re.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function Wu(){return new iy("serverTimestamp")}function IE(...n){return new ay("arrayUnion",n)}function jE(...n){return new oy("arrayRemove",n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kE(n){return rc(n=Vn(n,or)),new CE(n,(e=>ic(n,e)))}(function(e,t=!0){(function(a){Zl=a})(To),po(new da("firestore",((r,{instanceIdentifier:a,options:l})=>{const c=r.getProvider("app").getImmediate(),f=new or(new b5(r.getProvider("auth-internal")),new E5(c,r.getProvider("app-check-internal")),(function(y,v){if(!Object.prototype.hasOwnProperty.apply(y.options,["projectId"]))throw new ge(re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new $l(y.options.projectId,v)})(c,a),c);return l={useFetchStreams:t,...l},f._setSettings(l),f}),"PUBLIC").setMultipleInstances(!0)),Cr(A1,N1,e),Cr(A1,N1,"esm2020")})();const ku=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:AE,Bytes:ws,CollectionReference:ai,DocumentReference:Mt,DocumentSnapshot:ua,FieldPath:No,FieldValue:Ro,Firestore:or,FirestoreError:ge,GeoPoint:rr,Query:Pr,QueryCompositeFilterConstraint:Xf,QueryConstraint:Yf,QueryDocumentSnapshot:pu,QueryFieldFilterConstraint:Xu,QueryLimitConstraint:Zf,QueryOrderByConstraint:Wf,QuerySnapshot:ha,SnapshotMetadata:kl,Timestamp:vt,VectorValue:ir,WriteBatch:CE,_AutoId:Cf,_ByteString:vn,_DatabaseId:$l,_DocumentKey:Ae,_EmptyAuthCredentialsProvider:t2,_FieldPath:yn,_cast:Vn,_logWarn:_o,_validateIsNotUsedTogether:s2,addDoc:ju,arrayRemove:jE,arrayUnion:IE,collection:wt,connectFirestoreEmulator:fE,deleteDoc:fy,doc:ft,documentId:Ff,ensureFirestoreConfigured:rc,executeWrite:ic,getDoc:bo,getDocs:_n,getFirestore:mE,limit:cf,onSnapshot:Ll,orderBy:Jf,query:qt,serverTimestamp:Wu,setDoc:NE,updateDoc:vs,where:hn,writeBatch:kE},Symbol.toStringTag,{value:"Module"}));var b3="firebase",w3="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Cr(b3,w3,"app");function OE(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const x3=OE,DE=new qu("auth","Firebase",OE());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uf=new R0("@firebase/auth");function E3(n,...e){uf.logLevel<=Ye.WARN&&uf.warn(`Auth (${To}): ${n}`,...e)}function Fd(n,...e){uf.logLevel<=Ye.ERROR&&uf.error(`Auth (${To}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lr(n,...e){throw my(n,...e)}function kr(n,...e){return my(n,...e)}function ME(n,e,t){const r={...x3(),[e]:t};return new qu("auth","Firebase",r).create(e,{appName:n.name})}function oi(n){return ME(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function my(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return DE.create(n,...e)}function ke(n,e,...t){if(!n)throw my(e,...t)}function si(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Fd(e),new Error(e)}function di(n,e){n||si(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n0(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function T3(){return Tw()==="http:"||Tw()==="https:"}function Tw(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S3(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(T3()||WN()||"connection"in navigator)?navigator.onLine:!0}function A3(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e,t){this.shortDelay=e,this.longDelay=t,di(t>e,"Short delay should be less than long delay!"),this.isMobile=QN()||JN()}get(){return S3()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gy(n,e){di(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PE{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;si("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;si("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;si("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N3={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R3=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],C3=new Ju(3e4,6e4);function Ea(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Ta(n,e,t,r,a={}){return LE(n,a,async()=>{let l={},c={};r&&(e==="GET"?c=r:l={body:JSON.stringify(r)});const f=Hu({key:n.config.apiKey,...c}).slice(1),g=await n._getAdditionalHeaders();g["Content-Type"]="application/json",n.languageCode&&(g["X-Firebase-Locale"]=n.languageCode);const y={method:e,headers:g,...l};return XN()||(y.referrerPolicy="no-referrer"),n.emulatorConfig&&ba(n.emulatorConfig.host)&&(y.credentials="include"),PE.fetch()(await VE(n,n.config.apiHost,t,f),y)})}async function LE(n,e,t){n._canInitEmulator=!1;const r={...N3,...e};try{const a=new j3(n),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw Ad(n,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const f=l.ok?c.errorMessage:c.error.message,[g,y]=f.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ad(n,"credential-already-in-use",c);if(g==="EMAIL_EXISTS")throw Ad(n,"email-already-in-use",c);if(g==="USER_DISABLED")throw Ad(n,"user-disabled",c);const v=r[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw ME(n,v,y);lr(n,v)}}catch(a){if(a instanceof Mr)throw a;lr(n,"network-request-failed",{message:String(a)})}}async function Zu(n,e,t,r,a={}){const l=await Ta(n,e,t,r,a);return"mfaPendingCredential"in l&&lr(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function VE(n,e,t,r){const a=`${e}${t}?${r}`,l=n,c=l.config.emulator?gy(n.config,a):`${n.config.apiScheme}://${a}`;return R3.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}function I3(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class j3{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(kr(this.auth,"network-request-failed")),C3.get())})}}function Ad(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const a=kr(n,e,r);return a.customData._tokenResponse=t,a}function Sw(n){return n!==void 0&&n.enterprise!==void 0}class k3{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return I3(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function O3(n,e){return Ta(n,"GET","/v2/recaptchaConfig",Ea(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D3(n,e){return Ta(n,"POST","/v1/accounts:delete",e)}async function hf(n,e){return Ta(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function M3(n,e=!1){const t=It(n),r=await t.getIdToken(e),a=py(r);ke(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,c=l==null?void 0:l.sign_in_provider;return{claims:a,token:r,authTime:yu(_p(a.auth_time)),issuedAtTime:yu(_p(a.iat)),expirationTime:yu(_p(a.exp)),signInProvider:c||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function _p(n){return Number(n)*1e3}function py(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Fd("JWT malformed, contained fewer than 3 sections"),null;try{const a=Px(t);return a?JSON.parse(a):(Fd("Failed to decode base64 JWT payload"),null)}catch(a){return Fd("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function Aw(n){const e=py(n);return ke(e,"internal-error"),ke(typeof e.exp<"u","internal-error"),ke(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ou(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Mr&&P3(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function P3({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L3{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=yu(this.lastLoginAt),this.creationTime=yu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function df(n){var w;const e=n.auth,t=await n.getIdToken(),r=await Ou(n,hf(e,{idToken:t}));ke(r==null?void 0:r.users.length,e,"internal-error");const a=r.users[0];n._notifyReloadListener(a);const l=(w=a.providerUserInfo)!=null&&w.length?UE(a.providerUserInfo):[],c=U3(n.providerData,l),f=n.isAnonymous,g=!(n.email&&a.passwordHash)&&!(c!=null&&c.length),y=f?g:!1,v={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new s0(a.createdAt,a.lastLoginAt),isAnonymous:y};Object.assign(n,v)}async function V3(n){const e=It(n);await df(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function U3(n,e){return[...n.filter(r=>!e.some(a=>a.providerId===r.providerId)),...e]}function UE(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B3(n,e){const t=await LE(n,{},async()=>{const r=Hu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=n.config,c=await VE(n,a,"/v1/token",`key=${l}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:f,body:r};return n.emulatorConfig&&ba(n.emulatorConfig.host)&&(g.credentials="include"),PE.fetch()(c,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function z3(n,e){return Ta(n,"POST","/v2/accounts:revokeToken",Ea(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ke(e.idToken,"internal-error"),ke(typeof e.idToken<"u","internal-error"),ke(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Aw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ke(e.length!==0,"internal-error");const t=Aw(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ke(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:a,expiresIn:l}=await B3(e,t);this.updateTokensAndExpiration(r,a,Number(l))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:a,expirationTime:l}=t,c=new Vl;return r&&(ke(typeof r=="string","internal-error",{appName:e}),c.refreshToken=r),a&&(ke(typeof a=="string","internal-error",{appName:e}),c.accessToken=a),l&&(ke(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Vl,this.toJSON())}_performRefresh(){return si("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wi(n,e){ke(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class sr{constructor({uid:e,auth:t,stsTokenManager:r,...a}){this.providerId="firebase",this.proactiveRefresh=new L3(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new s0(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await Ou(this,this.stsTokenManager.getToken(this.auth,e));return ke(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return M3(this,e)}reload(){return V3(this)}_assign(e){this!==e&&(ke(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new sr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){ke(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await df(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(bs(this.auth.app))return Promise.reject(oi(this.auth));const e=await this.getIdToken();return await Ou(this,D3(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,a=t.email??void 0,l=t.phoneNumber??void 0,c=t.photoURL??void 0,f=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,v=t.lastLoginAt??void 0,{uid:w,emailVerified:E,isAnonymous:S,providerData:j,stsTokenManager:D}=t;ke(w&&D,e,"internal-error");const R=Vl.fromJSON(this.name,D);ke(typeof w=="string",e,"internal-error"),Wi(r,e.name),Wi(a,e.name),ke(typeof E=="boolean",e,"internal-error"),ke(typeof S=="boolean",e,"internal-error"),Wi(l,e.name),Wi(c,e.name),Wi(f,e.name),Wi(g,e.name),Wi(y,e.name),Wi(v,e.name);const L=new sr({uid:w,auth:e,email:a,emailVerified:E,displayName:r,isAnonymous:S,photoURL:c,phoneNumber:l,tenantId:f,stsTokenManager:R,createdAt:y,lastLoginAt:v});return j&&Array.isArray(j)&&(L.providerData=j.map(F=>({...F}))),g&&(L._redirectEventId=g),L}static async _fromIdTokenResponse(e,t,r=!1){const a=new Vl;a.updateFromServerResponse(t);const l=new sr({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:r});return await df(l),l}static async _fromGetAccountInfoResponse(e,t,r){const a=t.users[0];ke(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?UE(a.providerUserInfo):[],c=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),f=new Vl;f.updateFromIdToken(r);const g=new sr({uid:a.localId,auth:e,stsTokenManager:f,isAnonymous:c}),y={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new s0(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(g,y),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nw=new Map;function ri(n){di(n instanceof Function,"Expected a class definition");let e=Nw.get(n);return e?(di(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Nw.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}BE.type="NONE";const Rw=BE;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gd(n,e,t){return`firebase:${n}:${e}:${t}`}class Ul{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:a,name:l}=this.auth;this.fullUserKey=Gd(this.userKey,a.apiKey,l),this.fullPersistenceKey=Gd("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await hf(this.auth,{idToken:e}).catch(()=>{});return t?sr._fromGetAccountInfoResponse(this.auth,t,e):null}return sr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Ul(ri(Rw),e,r);const a=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let l=a[0]||ri(Rw);const c=Gd(r,e.config.apiKey,e.name);let f=null;for(const y of t)try{const v=await y._get(c);if(v){let w;if(typeof v=="string"){const E=await hf(e,{idToken:v}).catch(()=>{});if(!E)break;w=await sr._fromGetAccountInfoResponse(e,E,v)}else w=sr._fromJSON(e,v);y!==l&&(f=w),l=y;break}}catch{}const g=a.filter(y=>y._shouldAllowMigration);return!l._shouldAllowMigration||!g.length?new Ul(l,e,r):(l=g[0],f&&await l._set(c,f.toJSON()),await Promise.all(t.map(async y=>{if(y!==l)try{await y._remove(c)}catch{}})),new Ul(l,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cw(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if($E(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(zE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(GE(e))return"Blackberry";if(KE(e))return"Webos";if(qE(e))return"Safari";if((e.includes("chrome/")||HE(e))&&!e.includes("edge/"))return"Chrome";if(FE(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function zE(n=Un()){return/firefox\//i.test(n)}function qE(n=Un()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function HE(n=Un()){return/crios\//i.test(n)}function $E(n=Un()){return/iemobile/i.test(n)}function FE(n=Un()){return/android/i.test(n)}function GE(n=Un()){return/blackberry/i.test(n)}function KE(n=Un()){return/webos/i.test(n)}function yy(n=Un()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function q3(n=Un()){var e;return yy(n)&&!!((e=window.navigator)!=null&&e.standalone)}function H3(){return ZN()&&document.documentMode===10}function QE(n=Un()){return yy(n)||FE(n)||KE(n)||GE(n)||/windows phone/i.test(n)||$E(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YE(n,e=[]){let t;switch(n){case"Browser":t=Cw(Un());break;case"Worker":t=`${Cw(Un())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${To}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $3{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=l=>new Promise((c,f)=>{try{const g=e(l);c(g)}catch(g){f(g)}});r.onAbort=t,this.queue.push(r);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F3(n,e={}){return Ta(n,"GET","/v2/passwordPolicy",Ea(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G3=6;class K3{constructor(e){var r;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??G3,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let a=0;a<e.length;a++)r=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q3{constructor(e,t,r,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Iw(this),this.idTokenSubscription=new Iw(this),this.beforeStateQueue=new $3(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=DE,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ri(t)),this._initializationPromise=this.queue(async()=>{var r,a,l;if(!this._deleted&&(this.persistenceManager=await Ul.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((a=this._popupRedirectResolver)!=null&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)==null?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await hf(this,{idToken:e}),r=await sr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var l;if(bs(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(f,f))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(l=this.redirectUser)==null?void 0:l._redirectEventId,f=r==null?void 0:r._redirectEventId,g=await this.tryRedirectSignIn(e);(!c||c===f)&&(g!=null&&g.user)&&(r=g.user,a=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(r)}catch(c){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return ke(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await df(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=A3()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(bs(this.app))return Promise.reject(oi(this));const t=e?It(e):null;return t&&ke(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ke(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return bs(this.app)?Promise.reject(oi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return bs(this.app)?Promise.reject(oi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ri(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await F3(this),t=new K3(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new qu("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await z3(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ri(e)||this._popupRedirectResolver;ke(t,this,"argument-error"),this.redirectPersistenceManager=await Ul.create(this,[ri(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let c=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(ke(f,this,"internal-error"),f.then(()=>{c||l(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,r,a);return()=>{c=!0,g()}}else{const g=e.addObserver(t);return()=>{c=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ke(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=YE(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var a;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((a=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:a.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var t;if(bs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&E3(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Io(n){return It(n)}class Iw{constructor(e){this.auth=e,this.observer=null,this.addObserver=o4(t=>this.observer=t)}get next(){return ke(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let em={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Y3(n){em=n}function XE(n){return em.loadJS(n)}function X3(){return em.recaptchaEnterpriseScript}function W3(){return em.gapiScript}function J3(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class Z3{constructor(){this.enterprise=new eI}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class eI{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const tI="recaptcha-enterprise",WE="NO_RECAPTCHA";class nI{constructor(e){this.type=tI,this.auth=Io(e)}async verify(e="verify",t=!1){async function r(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(c,f)=>{O3(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const y=new k3(g);return l.tenantId==null?l._agentRecaptchaConfig=y:l._tenantRecaptchaConfigs[l.tenantId]=y,c(y.siteKey)}}).catch(g=>{f(g)})})}function a(l,c,f){const g=window.grecaptcha;Sw(g)?g.enterprise.ready(()=>{g.enterprise.execute(l,{action:e}).then(y=>{c(y)}).catch(()=>{c(WE)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Z3().execute("siteKey",{action:"verify"}):new Promise((l,c)=>{r(this.auth).then(f=>{if(!t&&Sw(window.grecaptcha))a(f,l,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let g=X3();g.length!==0&&(g+=f),XE(g).then(()=>{a(f,l,c)}).catch(y=>{c(y)})}}).catch(f=>{c(f)})})}}async function jw(n,e,t,r=!1,a=!1){const l=new nI(n);let c;if(a)c=WE;else try{c=await l.verify(t)}catch{c=await l.verify(t,!0)}const f={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const g=f.phoneEnrollmentInfo.phoneNumber,y=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const g=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return r?Object.assign(f,{captchaResp:c}):Object.assign(f,{captchaResponse:c}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function r0(n,e,t,r,a){var l;if((l=n._getRecaptchaConfig())!=null&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await jw(n,e,t,t==="getOobCode");return r(n,c)}else return r(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await jw(n,e,t,t==="getOobCode");return r(n,f)}else return Promise.reject(c)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sI(n,e){const t=Nf(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(li(l,e??{}))return a;lr(a,"already-initialized")}return t.initialize({options:e})}function rI(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(ri);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function iI(n,e,t){const r=Io(n);ke(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const a=!1,l=JE(e),{host:c,port:f}=aI(e),g=f===null?"":`:${f}`,y={url:`${l}//${c}${g}/`},v=Object.freeze({host:c,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!r._canInitEmulator){ke(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ke(li(y,r.config.emulator)&&li(v,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=y,r.emulatorConfig=v,r.settings.appVerificationDisabledForTesting=!0,ba(c)?(A0(`${l}//${c}${g}`),N0("Auth",!0)):oI()}function JE(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function aI(n){const e=JE(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const l=a[1];return{host:l,port:kw(r.substr(l.length+1))}}else{const[l,c]=r.split(":");return{host:l,port:kw(c)}}}function kw(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function oI(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return si("not implemented")}_getIdTokenResponse(e){return si("not implemented")}_linkToIdToken(e,t){return si("not implemented")}_getReauthenticationResolver(e){return si("not implemented")}}async function lI(n,e){return Ta(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cI(n,e){return Zu(n,"POST","/v1/accounts:signInWithPassword",Ea(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uI(n,e){return Zu(n,"POST","/v1/accounts:signInWithEmailLink",Ea(n,e))}async function hI(n,e){return Zu(n,"POST","/v1/accounts:signInWithEmailLink",Ea(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du extends _y{constructor(e,t,r,a=null){super("password",r),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new Du(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Du(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return r0(e,t,"signInWithPassword",cI);case"emailLink":return uI(e,{email:this._email,oobCode:this._password});default:lr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return r0(e,r,"signUpPassword",lI);case"emailLink":return hI(e,{idToken:t,email:this._email,oobCode:this._password});default:lr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bl(n,e){return Zu(n,"POST","/v1/accounts:signInWithIdp",Ea(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dI="http://localhost";class wo extends _y{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new wo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):lr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a,...l}=t;if(!r||!a)return null;const c=new wo(r,a);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return Bl(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Bl(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Bl(e,t)}buildRequest(){const e={requestUri:dI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Hu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fI(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function mI(n){const e=iu(au(n)).link,t=e?iu(au(e)).deep_link_id:null,r=iu(au(n)).deep_link_id;return(r?iu(au(r)).link:null)||r||t||e||n}class vy{constructor(e){const t=iu(au(e)),r=t.apiKey??null,a=t.oobCode??null,l=fI(t.mode??null);ke(r&&a&&l,"argument-error"),this.apiKey=r,this.operation=l,this.code=a,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=mI(e);try{return new vy(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(){this.providerId=ac.PROVIDER_ID}static credential(e,t){return Du._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=vy.parseLink(t);return ke(r,"argument-error"),Du._fromEmailAndCode(e,r.code,r.tenantId)}}ac.PROVIDER_ID="password";ac.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ac.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh extends ZE{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi extends eh{constructor(){super("facebook.com")}static credential(e){return wo._fromParams({providerId:Zi.PROVIDER_ID,signInMethod:Zi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Zi.credentialFromTaggedObject(e)}static credentialFromError(e){return Zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Zi.credential(e.oauthAccessToken)}catch{return null}}}Zi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Zi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ea extends eh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return wo._fromParams({providerId:ea.PROVIDER_ID,signInMethod:ea.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ea.credentialFromTaggedObject(e)}static credentialFromError(e){return ea.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return ea.credential(t,r)}catch{return null}}}ea.GOOGLE_SIGN_IN_METHOD="google.com";ea.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta extends eh{constructor(){super("github.com")}static credential(e){return wo._fromParams({providerId:ta.PROVIDER_ID,signInMethod:ta.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ta.credentialFromTaggedObject(e)}static credentialFromError(e){return ta.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ta.credential(e.oauthAccessToken)}catch{return null}}}ta.GITHUB_SIGN_IN_METHOD="github.com";ta.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na extends eh{constructor(){super("twitter.com")}static credential(e,t){return wo._fromParams({providerId:na.PROVIDER_ID,signInMethod:na.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return na.credentialFromTaggedObject(e)}static credentialFromError(e){return na.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return na.credential(t,r)}catch{return null}}}na.TWITTER_SIGN_IN_METHOD="twitter.com";na.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gI(n,e){return Zu(n,"POST","/v1/accounts:signUp",Ea(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,a=!1){const l=await sr._fromIdTokenResponse(e,r,a),c=Ow(r);return new xo({user:l,providerId:c,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const a=Ow(r);return new xo({user:e,providerId:a,_tokenResponse:r,operationType:t})}}function Ow(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff extends Mr{constructor(e,t,r,a){super(t.code,t.message),this.operationType=r,this.user=a,Object.setPrototypeOf(this,ff.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,a){return new ff(e,t,r,a)}}function eT(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?ff._fromErrorAndOperation(n,l,e,r):l})}async function pI(n,e,t=!1){const r=await Ou(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return xo._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yI(n,e,t=!1){const{auth:r}=n;if(bs(r.app))return Promise.reject(oi(r));const a="reauthenticate";try{const l=await Ou(n,eT(r,a,e,n),t);ke(l.idToken,r,"internal-error");const c=py(l.idToken);ke(c,r,"internal-error");const{sub:f}=c;return ke(n.uid===f,r,"user-mismatch"),xo._forOperation(n,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&lr(r,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tT(n,e,t=!1){if(bs(n.app))return Promise.reject(oi(n));const r="signIn",a=await eT(n,r,e),l=await xo._fromIdTokenResponse(n,r,a);return t||await n._updateCurrentUser(l.user),l}async function _I(n,e){return tT(Io(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nT(n){const e=Io(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function vI(n,e,t){if(bs(n.app))return Promise.reject(oi(n));const r=Io(n),c=await r0(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",gI).catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&nT(n),g}),f=await xo._fromIdTokenResponse(r,"signIn",c);return await r._updateCurrentUser(f.user),f}function bI(n,e,t){return bs(n.app)?Promise.reject(oi(n)):_I(It(n),ac.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&nT(n),r})}function wI(n,e,t,r){return It(n).onIdTokenChanged(e,t,r)}function xI(n,e,t){return It(n).beforeAuthStateChanged(e,t)}function EI(n,e,t,r){return It(n).onAuthStateChanged(e,t,r)}const mf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(mf,"1"),this.storage.removeItem(mf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI=1e3,SI=10;class rT extends sT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=QE(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),a=this.localCache[t];r!==a&&e(t,a,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,f,g)=>{this.notifyListeners(c,g)});return}const r=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const c=this.storage.getItem(r);!t&&this.localCache[r]===c||this.notifyListeners(r,c)},l=this.storage.getItem(r);H3()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,SI):a()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},TI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}rT.type="LOCAL";const AI=rT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iT extends sT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}iT.type="SESSION";const aT=iT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NI(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const r=new tm(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:a,data:l}=t.data,c=this.handlersMap[a];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:a});const f=Array.from(c).map(async y=>y(t.origin,l)),g=await NI(f);t.ports[0].postMessage({status:"done",eventId:r,eventType:a,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}tm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function by(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,c;return new Promise((f,g)=>{const y=by("",20);a.port1.start();const v=setTimeout(()=>{g(new Error("unsupported_event"))},r);c={messageChannel:a,onMessage(w){const E=w;if(E.data.eventId===y)switch(E.data.status){case"ack":clearTimeout(v),l=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(E.data.response);break;default:clearTimeout(v),clearTimeout(l),g(new Error("invalid_response"));break}}},this.handlers.add(c),a.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[a.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Or(){return window}function CI(n){Or().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oT(){return typeof Or().WorkerGlobalScope<"u"&&typeof Or().importScripts=="function"}async function II(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function jI(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function kI(){return oT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lT="firebaseLocalStorageDb",OI=1,gf="firebaseLocalStorage",cT="fbase_key";class th{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function nm(n,e){return n.transaction([gf],e?"readwrite":"readonly").objectStore(gf)}function DI(){const n=indexedDB.deleteDatabase(lT);return new th(n).toPromise()}function i0(){const n=indexedDB.open(lT,OI);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(gf,{keyPath:cT})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(gf)?e(r):(r.close(),await DI(),e(await i0()))})})}async function Dw(n,e,t){const r=nm(n,!0).put({[cT]:e,value:t});return new th(r).toPromise()}async function MI(n,e){const t=nm(n,!1).get(e),r=await new th(t).toPromise();return r===void 0?null:r.value}function Mw(n,e){const t=nm(n,!0).delete(e);return new th(t).toPromise()}const PI=800,LI=3;class uT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await i0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>LI)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return oT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=tm._getInstance(kI()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await II(),!this.activeServiceWorker)return;this.sender=new RI(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||jI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await i0();return await Dw(e,mf,"1"),await Mw(e,mf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Dw(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>MI(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Mw(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=nm(a,!1).getAll();return new th(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)r.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!r.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),PI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}uT.type="LOCAL";const VI=uT;new Ju(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UI(n,e){return e?ri(e):(ke(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy extends _y{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Bl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Bl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Bl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function BI(n){return tT(n.auth,new wy(n),n.bypassAuthState)}function zI(n){const{auth:e,user:t}=n;return ke(t,e,"internal-error"),yI(t,new wy(n),n.bypassAuthState)}async function qI(n){const{auth:e,user:t}=n;return ke(t,e,"internal-error"),pI(t,new wy(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(e,t,r,a,l=!1){this.auth=e,this.resolver=r,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:a,tenantId:l,error:c,type:f}=e;if(c){this.reject(c);return}const g={auth:this.auth,requestUri:t,sessionId:r,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return BI;case"linkViaPopup":case"linkViaRedirect":return qI;case"reauthViaPopup":case"reauthViaRedirect":return zI;default:lr(this.auth,"internal-error")}}resolve(e){di(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){di(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HI=new Ju(2e3,1e4);class Ol extends hT{constructor(e,t,r,a,l){super(e,t,a,l),this.provider=r,this.authWindow=null,this.pollId=null,Ol.currentPopupAction&&Ol.currentPopupAction.cancel(),Ol.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ke(e,this.auth,"internal-error"),e}async onExecution(){di(this.filter.length===1,"Popup operations only handle one event");const e=by();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(kr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(kr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ol.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if((r=(t=this.authWindow)==null?void 0:t.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(kr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,HI.get())};e()}}Ol.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $I="pendingRedirect",Kd=new Map;class FI extends hT{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Kd.get(this.auth._key());if(!e){try{const r=await GI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Kd.set(this.auth._key(),e)}return this.bypassAuthState||Kd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function GI(n,e){const t=YI(e),r=QI(n);if(!await r._isAvailable())return!1;const a=await r._get(t)==="true";return await r._remove(t),a}function KI(n,e){Kd.set(n._key(),e)}function QI(n){return ri(n._redirectPersistence)}function YI(n){return Gd($I,n.config.apiKey,n.name)}async function XI(n,e,t=!1){if(bs(n.app))return Promise.reject(oi(n));const r=Io(n),a=UI(r,e),c=await new FI(r,a,t).execute();return c&&!t&&(delete c.user._redirectEventId,await r._persistUserIfCurrent(c.user),await r._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WI=600*1e3;class JI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!ZI(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!dT(e)){const a=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";t.onError(kr(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=WI&&this.cachedEventUids.clear(),this.cachedEventUids.has(Pw(e))}saveEventToCache(e){this.cachedEventUids.add(Pw(e)),this.lastProcessedEventTime=Date.now()}}function Pw(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function dT({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function ZI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return dT(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e6(n,e={}){return Ta(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t6=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,n6=/^https?/;async function s6(n){if(n.config.emulator)return;const{authorizedDomains:e}=await e6(n);for(const t of e)try{if(r6(t))return}catch{}lr(n,"unauthorized-domain")}function r6(n){const e=n0(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===r}if(!n6.test(t))return!1;if(t6.test(n))return r===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i6=new Ju(3e4,6e4);function Lw(){const n=Or().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function a6(n){return new Promise((e,t)=>{var a,l,c;function r(){Lw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Lw(),t(kr(n,"network-request-failed"))},timeout:i6.get()})}if((l=(a=Or().gapi)==null?void 0:a.iframes)!=null&&l.Iframe)e(gapi.iframes.getContext());else if((c=Or().gapi)!=null&&c.load)r();else{const f=J3("iframefcb");return Or()[f]=()=>{gapi.load?r():t(kr(n,"network-request-failed"))},XE(`${W3()}?onload=${f}`).catch(g=>t(g))}}).catch(e=>{throw Qd=null,e})}let Qd=null;function o6(n){return Qd=Qd||a6(n),Qd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l6=new Ju(5e3,15e3),c6="__/auth/iframe",u6="emulator/auth/iframe",h6={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},d6=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function f6(n){const e=n.config;ke(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?gy(e,u6):`https://${n.config.authDomain}/${c6}`,r={apiKey:e.apiKey,appName:n.name,v:To},a=d6.get(n.config.apiHost);a&&(r.eid=a);const l=n._getFrameworks();return l.length&&(r.fw=l.join(",")),`${t}?${Hu(r).slice(1)}`}async function m6(n){const e=await o6(n),t=Or().gapi;return ke(t,n,"internal-error"),e.open({where:document.body,url:f6(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:h6,dontclear:!0},r=>new Promise(async(a,l)=>{await r.restyle({setHideOnLeave:!1});const c=kr(n,"network-request-failed"),f=Or().setTimeout(()=>{l(c)},l6.get());function g(){Or().clearTimeout(f),a(r)}r.ping(g).then(g,()=>{l(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g6={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},p6=500,y6=600,_6="_blank",v6="http://localhost";class Vw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function b6(n,e,t,r=p6,a=y6){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),c=Math.max((window.screen.availWidth-r)/2,0).toString();let f="";const g={...g6,width:r.toString(),height:a.toString(),top:l,left:c},y=Un().toLowerCase();t&&(f=HE(y)?_6:t),zE(y)&&(e=e||v6,g.scrollbars="yes");const v=Object.entries(g).reduce((E,[S,j])=>`${E}${S}=${j},`,"");if(q3(y)&&f!=="_self")return w6(e||"",f),new Vw(null);const w=window.open(e||"",f,v);ke(w,n,"popup-blocked");try{w.focus()}catch{}return new Vw(w)}function w6(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x6="__/auth/handler",E6="emulator/auth/handler",T6=encodeURIComponent("fac");async function Uw(n,e,t,r,a,l){ke(n.config.authDomain,n,"auth-domain-config-required"),ke(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:To,eventId:a};if(e instanceof ZE){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",a4(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[v,w]of Object.entries({}))c[v]=w}if(e instanceof eh){const v=e.getScopes().filter(w=>w!=="");v.length>0&&(c.scopes=v.join(","))}n.tenantId&&(c.tid=n.tenantId);const f=c;for(const v of Object.keys(f))f[v]===void 0&&delete f[v];const g=await n._getAppCheckToken(),y=g?`#${T6}=${encodeURIComponent(g)}`:"";return`${S6(n)}?${Hu(f).slice(1)}${y}`}function S6({config:n}){return n.emulator?gy(n,E6):`https://${n.authDomain}/${x6}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vp="webStorageSupport";class A6{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=aT,this._completeRedirectFn=XI,this._overrideRedirectResult=KI}async _openPopup(e,t,r,a){var c;di((c=this.eventManagers[e._key()])==null?void 0:c.manager,"_initialize() not called before _openPopup()");const l=await Uw(e,t,r,n0(),a);return b6(e,l,by())}async _openRedirect(e,t,r,a){await this._originValidation(e);const l=await Uw(e,t,r,n0(),a);return CI(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(di(l,"If manager is not set, promise should be"),l)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await m6(e),r=new JI(e);return t.register("authEvent",a=>(ke(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:r.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(vp,{type:vp},a=>{var c;const l=(c=a==null?void 0:a[0])==null?void 0:c[vp];l!==void 0&&t(!!l),lr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=s6(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return QE()||qE()||yy()}}const N6=A6;var Bw="@firebase/auth",zw="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R6{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ke(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C6(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function I6(n){po(new da("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:f}=r.options;ke(c&&!c.includes(":"),"invalid-api-key",{appName:r.name});const g={apiKey:c,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:YE(n)},y=new Q3(r,a,l,g);return rI(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),po(new da("auth-internal",e=>{const t=Io(e.getProvider("auth").getImmediate());return(r=>new R6(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Cr(Bw,zw,C6(n)),Cr(Bw,zw,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j6=300,k6=Bx("authIdTokenMaxAge")||j6;let qw=null;const O6=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>k6)return;const a=t==null?void 0:t.token;qw!==a&&(qw=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function D6(n=Rf()){const e=Nf(n,"auth");if(e.isInitialized())return e.getImmediate();const t=sI(n,{popupRedirectResolver:N6,persistence:[VI,AI,aT]}),r=Bx("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(r,location.origin);if(location.origin===l.origin){const c=O6(l.toString());xI(t,c,()=>c(t.currentUser)),wI(t,f=>c(f))}}const a=Lx("auth");return a&&iI(t,`http://${a}`),t}function M6(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}Y3({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=a=>{const l=kr("internal-error");l.customData=a,t(l)},r.type="text/javascript",r.charset="UTF-8",M6().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});I6("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fT="firebasestorage.googleapis.com",mT="storageBucket",P6=120*1e3,L6=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let on=class gT extends Mr{constructor(e,t,r=0){super(bp(e),`Firebase Storage: ${t} (${bp(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,gT.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return bp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}};var Ht;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ht||(Ht={}));function bp(n){return"storage/"+n}function xy(){const n="An unknown error occurred, please check the error payload for server response.";return new on(Ht.UNKNOWN,n)}function V6(n){return new on(Ht.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function U6(n){return new on(Ht.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function B6(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new on(Ht.UNAUTHENTICATED,n)}function z6(){return new on(Ht.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function q6(n){return new on(Ht.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function H6(){return new on(Ht.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function $6(){return new on(Ht.CANCELED,"User canceled the upload/download.")}function F6(n){return new on(Ht.INVALID_URL,"Invalid URL '"+n+"'.")}function G6(n){return new on(Ht.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function K6(){return new on(Ht.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+mT+"' property when initializing the app?")}function Q6(){return new on(Ht.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Y6(){return new on(Ht.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function X6(n){return new on(Ht.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function a0(n){return new on(Ht.INVALID_ARGUMENT,n)}function pT(){return new on(Ht.APP_DELETED,"The Firebase app was deleted.")}function W6(n){return new on(Ht.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function _u(n,e){return new on(Ht.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function ru(n){throw new on(Ht.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=Ss.makeFromUrl(e,t)}catch{return new Ss(e,"")}if(r.path==="")return r;throw G6(e)}static makeFromUrl(e,t){let r=null;const a="([A-Za-z0-9.\\-_]+)";function l(ee){ee.path.charAt(ee.path.length-1)==="/"&&(ee.path_=ee.path_.slice(0,-1))}const c="(/(.*))?$",f=new RegExp("^gs://"+a+c,"i"),g={bucket:1,path:3};function y(ee){ee.path_=decodeURIComponent(ee.path)}const v="v[A-Za-z0-9_]+",w=t.replace(/[.]/g,"\\."),E="(/([^?#]*).*)?$",S=new RegExp(`^https?://${w}/${v}/b/${a}/o${E}`,"i"),j={bucket:1,path:3},D=t===fT?"(?:storage.googleapis.com|storage.cloud.google.com)":t,R="([^?#]*)",L=new RegExp(`^https?://${D}/${a}/${R}`,"i"),B=[{regex:f,indices:g,postModify:l},{regex:S,indices:j,postModify:y},{regex:L,indices:{bucket:1,path:2},postModify:y}];for(let ee=0;ee<B.length;ee++){const he=B[ee],ue=he.regex.exec(e);if(ue){const C=ue[he.indices.bucket];let I=ue[he.indices.path];I||(I=""),r=new Ss(C,I),he.postModify(r);break}}if(r==null)throw F6(e);return r}}class J6{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z6(n,e,t){let r=1,a=null,l=null,c=!1,f=0;function g(){return f===2}let y=!1;function v(...R){y||(y=!0,e.apply(null,R))}function w(R){a=setTimeout(()=>{a=null,n(S,g())},R)}function E(){l&&clearTimeout(l)}function S(R,...L){if(y){E();return}if(R){E(),v.call(null,R,...L);return}if(g()||c){E(),v.call(null,R,...L);return}r<64&&(r*=2);let B;f===1?(f=2,B=0):B=(r+Math.random())*1e3,w(B)}let j=!1;function D(R){j||(j=!0,E(),!y&&(a!==null?(R||(f=2),clearTimeout(a),w(0)):R||(f=1)))}return w(0),l=setTimeout(()=>{c=!0,D(!0)},t),D}function ej(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tj(n){return n!==void 0}function nj(n){return typeof n=="object"&&!Array.isArray(n)}function Ey(n){return typeof n=="string"||n instanceof String}function Hw(n){return Ty()&&n instanceof Blob}function Ty(){return typeof Blob<"u"}function $w(n,e,t,r){if(r<e)throw a0(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw a0(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sy(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function yT(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const a=e(r)+"="+e(n[r]);t=t+a+"&"}return t=t.slice(0,-1),t}var go;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(go||(go={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sj(n,e){const t=n>=500&&n<600,a=[408,429].indexOf(n)!==-1,l=e.indexOf(n)!==-1;return t||a||l}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rj{constructor(e,t,r,a,l,c,f,g,y,v,w,E=!0,S=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=a,this.successCodes_=l,this.additionalRetryCodes_=c,this.callback_=f,this.errorCallback_=g,this.timeout_=y,this.progressCallback_=v,this.connectionFactory_=w,this.retry=E,this.isUsingEmulator=S,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((j,D)=>{this.resolve_=j,this.reject_=D,this.start_()})}start_(){const e=(r,a)=>{if(a){r(!1,new Nd(!1,null,!0));return}const l=this.connectionFactory_();this.pendingConnection_=l;const c=f=>{const g=f.loaded,y=f.lengthComputable?f.total:-1;this.progressCallback_!==null&&this.progressCallback_(g,y)};this.progressCallback_!==null&&l.addUploadProgressListener(c),l.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&l.removeUploadProgressListener(c),this.pendingConnection_=null;const f=l.getErrorCode()===go.NO_ERROR,g=l.getStatus();if(!f||sj(g,this.additionalRetryCodes_)&&this.retry){const v=l.getErrorCode()===go.ABORT;r(!1,new Nd(!1,null,v));return}const y=this.successCodes_.indexOf(g)!==-1;r(!0,new Nd(y,l))})},t=(r,a)=>{const l=this.resolve_,c=this.reject_,f=a.connection;if(a.wasSuccessCode)try{const g=this.callback_(f,f.getResponse());tj(g)?l(g):l()}catch(g){c(g)}else if(f!==null){const g=xy();g.serverResponse=f.getErrorText(),this.errorCallback_?c(this.errorCallback_(f,g)):c(g)}else if(a.canceled){const g=this.appDelete_?pT():$6();c(g)}else{const g=H6();c(g)}};this.canceled_?t(!1,new Nd(!1,null,!0)):this.backoffId_=Z6(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&ej(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Nd{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function ij(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function aj(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function oj(n,e){e&&(n["X-Firebase-GMPID"]=e)}function lj(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function cj(n,e,t,r,a,l,c=!0,f=!1){const g=yT(n.urlParams),y=n.url+g,v=Object.assign({},n.headers);return oj(v,e),ij(v,t),aj(v,l),lj(v,r),new rj(y,n.method,v,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,a,c,f)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uj(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function hj(...n){const e=uj();if(e!==void 0){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(Ty())return new Blob(n);throw new on(Ht.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function dj(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fj(n){if(typeof atob>"u")throw X6("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class wp{constructor(e,t){this.data=e,this.contentType=t||null}}function mj(n,e){switch(n){case Rr.RAW:return new wp(_T(e));case Rr.BASE64:case Rr.BASE64URL:return new wp(vT(n,e));case Rr.DATA_URL:return new wp(pj(e),yj(e))}throw xy()}function _T(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const l=r,c=n.charCodeAt(++t);r=65536|(l&1023)<<10|c&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function gj(n){let e;try{e=decodeURIComponent(n)}catch{throw _u(Rr.DATA_URL,"Malformed data URL.")}return _T(e)}function vT(n,e){switch(n){case Rr.BASE64:{const a=e.indexOf("-")!==-1,l=e.indexOf("_")!==-1;if(a||l)throw _u(n,"Invalid character '"+(a?"-":"_")+"' found: is it base64url encoded?");break}case Rr.BASE64URL:{const a=e.indexOf("+")!==-1,l=e.indexOf("/")!==-1;if(a||l)throw _u(n,"Invalid character '"+(a?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=fj(e)}catch(a){throw a.message.includes("polyfill")?a:_u(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return r}class bT{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw _u(Rr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;r!=null&&(this.base64=_j(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function pj(n){const e=new bT(n);return e.base64?vT(Rr.BASE64,e.rest):gj(e.rest)}function yj(n){return new bT(n).contentType}function _j(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sa{constructor(e,t){let r=0,a="";Hw(e)?(this.data_=e,r=e.size,a=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=a}size(){return this.size_}type(){return this.type_}slice(e,t){if(Hw(this.data_)){const r=this.data_,a=dj(r,e,t);return a===null?null:new sa(a)}else{const r=new Uint8Array(this.data_.buffer,e,t-e);return new sa(r,!0)}}static getBlob(...e){if(Ty()){const t=e.map(r=>r instanceof sa?r.data_:r);return new sa(hj.apply(null,t))}else{const t=e.map(c=>Ey(c)?mj(Rr.RAW,c).data:c.data_);let r=0;t.forEach(c=>{r+=c.byteLength});const a=new Uint8Array(r);let l=0;return t.forEach(c=>{for(let f=0;f<c.length;f++)a[l++]=c[f]}),new sa(a,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wT(n){let e;try{e=JSON.parse(n)}catch{return null}return nj(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vj(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function bj(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function xT(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wj(n,e){return e}class Fn{constructor(e,t,r,a){this.server=e,this.local=t||e,this.writable=!!r,this.xform=a||wj}}let Rd=null;function xj(n){return!Ey(n)||n.length<2?n:xT(n)}function ET(){if(Rd)return Rd;const n=[];n.push(new Fn("bucket")),n.push(new Fn("generation")),n.push(new Fn("metageneration")),n.push(new Fn("name","fullPath",!0));function e(l,c){return xj(c)}const t=new Fn("name");t.xform=e,n.push(t);function r(l,c){return c!==void 0?Number(c):c}const a=new Fn("size");return a.xform=r,n.push(a),n.push(new Fn("timeCreated")),n.push(new Fn("updated")),n.push(new Fn("md5Hash",null,!0)),n.push(new Fn("cacheControl",null,!0)),n.push(new Fn("contentDisposition",null,!0)),n.push(new Fn("contentEncoding",null,!0)),n.push(new Fn("contentLanguage",null,!0)),n.push(new Fn("contentType",null,!0)),n.push(new Fn("metadata","customMetadata",!0)),Rd=n,Rd}function Ej(n,e){function t(){const r=n.bucket,a=n.fullPath,l=new Ss(r,a);return e._makeStorageReference(l)}Object.defineProperty(n,"ref",{get:t})}function Tj(n,e,t){const r={};r.type="file";const a=t.length;for(let l=0;l<a;l++){const c=t[l];r[c.local]=c.xform(r,e[c.server])}return Ej(r,n),r}function TT(n,e,t){const r=wT(e);return r===null?null:Tj(n,r,t)}function Sj(n,e,t,r){const a=wT(e);if(a===null||!Ey(a.downloadTokens))return null;const l=a.downloadTokens;if(l.length===0)return null;const c=encodeURIComponent;return l.split(",").map(y=>{const v=n.bucket,w=n.fullPath,E="/b/"+c(v)+"/o/"+c(w),S=Sy(E,t,r),j=yT({alt:"media",token:y});return S+j})[0]}function Aj(n,e){const t={},r=e.length;for(let a=0;a<r;a++){const l=e[a];l.writable&&(t[l.server]=n[l.local])}return JSON.stringify(t)}class ST{constructor(e,t,r,a){this.url=e,this.method=t,this.handler=r,this.timeout=a,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AT(n){if(!n)throw xy()}function Nj(n,e){function t(r,a){const l=TT(n,a,e);return AT(l!==null),l}return t}function Rj(n,e){function t(r,a){const l=TT(n,a,e);return AT(l!==null),Sj(l,a,n.host,n._protocol)}return t}function NT(n){function e(t,r){let a;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?a=z6():a=B6():t.getStatus()===402?a=U6(n.bucket):t.getStatus()===403?a=q6(n.path):a=r,a.status=t.getStatus(),a.serverResponse=r.serverResponse,a}return e}function Cj(n){const e=NT(n);function t(r,a){let l=e(r,a);return r.getStatus()===404&&(l=V6(n.path)),l.serverResponse=a.serverResponse,l}return t}function Ij(n,e,t){const r=e.fullServerUrl(),a=Sy(r,n.host,n._protocol),l="GET",c=n.maxOperationRetryTime,f=new ST(a,l,Rj(n,t),c);return f.errorHandler=Cj(e),f}function jj(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function kj(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=jj(null,e)),r}function Oj(n,e,t,r,a){const l=e.bucketOnlyServerUrl(),c={"X-Goog-Upload-Protocol":"multipart"};function f(){let B="";for(let ee=0;ee<2;ee++)B=B+Math.random().toString().slice(2);return B}const g=f();c["Content-Type"]="multipart/related; boundary="+g;const y=kj(e,r,a),v=Aj(y,t),w="--"+g+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+v+`\r
--`+g+`\r
Content-Type: `+y.contentType+`\r
\r
`,E=`\r
--`+g+"--",S=sa.getBlob(w,r,E);if(S===null)throw Q6();const j={name:y.fullPath},D=Sy(l,n.host,n._protocol),R="POST",L=n.maxUploadRetryTime,F=new ST(D,R,Nj(n,t),L);return F.urlParams=j,F.headers=c,F.body=S.uploadData(),F.errorHandler=NT(e),F}class Dj{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=go.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=go.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=go.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,a,l){if(this.sent_)throw ru("cannot .send() more than once");if(ba(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),l!==void 0)for(const c in l)l.hasOwnProperty(c)&&this.xhr_.setRequestHeader(c,l[c].toString());return a!==void 0?this.xhr_.send(a):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ru("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ru("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ru("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ru("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Mj extends Dj{initXhr(){this.xhr_.responseType="text"}}function RT(){return new Mj}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{constructor(e,t){this._service=e,t instanceof Ss?this._location=t:this._location=Ss.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Eo(e,t)}get root(){const e=new Ss(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return xT(this._location.path)}get storage(){return this._service}get parent(){const e=vj(this._location.path);if(e===null)return null;const t=new Ss(this._location.bucket,e);return new Eo(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw W6(e)}}function Pj(n,e,t){n._throwIfRoot("uploadBytes");const r=Oj(n.storage,n._location,ET(),new sa(e,!0),t);return n.storage.makeRequestWithTokens(r,RT).then(a=>({metadata:a,ref:n}))}function Lj(n){n._throwIfRoot("getDownloadURL");const e=Ij(n.storage,n._location,ET());return n.storage.makeRequestWithTokens(e,RT).then(t=>{if(t===null)throw Y6();return t})}function Vj(n,e){const t=bj(n._location.path,e),r=new Ss(n._location.bucket,t);return new Eo(n.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uj(n){return/^[A-Za-z]+:\/\//.test(n)}function Bj(n,e){return new Eo(n,e)}function CT(n,e){if(n instanceof Ay){const t=n;if(t._bucket==null)throw K6();const r=new Eo(t,t._bucket);return e!=null?CT(r,e):r}else return e!==void 0?Vj(n,e):n}function zj(n,e){if(e&&Uj(e)){if(n instanceof Ay)return Bj(n,e);throw a0("To use ref(service, url), the first argument must be a Storage instance.")}else return CT(n,e)}function Fw(n,e){const t=e==null?void 0:e[mT];return t==null?null:Ss.makeFromBucketSpec(t,n)}function qj(n,e,t,r={}){n.host=`${e}:${t}`;const a=ba(e);a&&(A0(`https://${n.host}/b`),N0("Storage",!0)),n._isUsingEmulator=!0,n._protocol=a?"https":"http";const{mockUserToken:l}=r;l&&(n._overrideAuthToken=typeof l=="string"?l:zx(l,n.app.options.projectId))}class Ay{constructor(e,t,r,a,l,c=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=a,this._firebaseVersion=l,this._isUsingEmulator=c,this._bucket=null,this._host=fT,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=P6,this._maxUploadRetryTime=L6,this._requests=new Set,a!=null?this._bucket=Ss.makeFromBucketSpec(a,this._host):this._bucket=Fw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ss.makeFromBucketSpec(this._url,e):this._bucket=Fw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){$w("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){$w("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(bs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Eo(this,e)}_makeRequest(e,t,r,a,l=!0){if(this._deleted)return new J6(pT());{const c=cj(e,this._appId,r,a,t,this._firebaseVersion,l,this._isUsingEmulator);return this._requests.add(c),c.getPromise().then(()=>this._requests.delete(c),()=>this._requests.delete(c)),c}}async makeRequestWithTokens(e,t){const[r,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,a).getPromise()}}const Gw="@firebase/storage",Kw="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IT="storage";function Hj(n,e,t){return n=It(n),Pj(n,e,t)}function $j(n){return n=It(n),Lj(n)}function Fj(n,e){return n=It(n),zj(n,e)}function jT(n=Rf(),e){n=It(n);const r=Nf(n,IT).getImmediate({identifier:e}),a=Vx("storage");return a&&Gj(r,...a),r}function Gj(n,e,t,r={}){qj(n,e,t,r)}function Kj(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),a=n.getProvider("app-check-internal");return new Ay(t,r,a,e,To)}function Qj(){po(new da(IT,Kj,"PUBLIC").setMultipleInstances(!0)),Cr(Gw,Kw,""),Cr(Gw,Kw,"esm2020")}Qj();const Yj={apiKey:"AIzaSyDll7h-FpzCVml2vy8KeMPA6xExGUda_NE",authDomain:"thi-tnd.firebaseapp.com",projectId:"thi-tnd",storageBucket:"thi-tnd.firebasestorage.app",messagingSenderId:"107125875663",appId:"1:107125875663:web:0e1a632779f51340c828ba",databaseURL:"https://thi-tnd-default-rtdb.asia-southeast1.firebasedatabase.app"},sm=l5().length?Rf():$x(Yj),Mu=D6(sm),Re=mE(sm);jT(sm);const Xj=Object.freeze(Object.defineProperty({__proto__:null,app:sm,auth:Mu,db:Re},Symbol.toStringTag,{value:"Module"})),kT=async(n,e,t,r,a,l,c,f)=>{try{const g={title:n,message:e,type:t,targetType:r,targetId:a,senderId:l,senderName:c||"H thng",createdAt:Wu(),expiryDate:f?vt.fromDate(f):null,read:!1,readBy:[],deletedBy:[]};if(r==="user"&&a)await ju(wt(Re,"users",a,"notifications"),g),console.log(`Notification sent to user ${a}`);else if(r==="class"&&a){let y=new Map;const v=qt(wt(Re,"courses"),hn("name","==",a)),w=await _n(v);let E=null,S=a;if(!w.empty)E=w.docs[0].id;else{const R=ft(Re,"courses",a),L=await _n(qt(wt(Re,"courses"),hn(Ff(),"==",a)));L.empty||(E=a,S=L.docs[0].data().name)}console.log(`Resolved Class Target: ID=${E}, Name=${S}`);const j=[];if(S&&(j.push(_n(qt(wt(Re,"users"),hn("courseName","==",S)))),j.push(_n(qt(wt(Re,"users"),hn("class","==",S))))),E&&j.push(_n(qt(wt(Re,"users"),hn("courseId","==",E)))),(await Promise.all(j)).forEach(R=>{R.docs.forEach(L=>{y.set(L.id,L.id)})}),y.size===0)console.log("No students found for this class.");else{const R=kE(Re);let L=0;y.forEach(F=>{const B=ft(wt(Re,"users",F,"notifications"));R.set(B,g),L++}),await R.commit(),console.log(`Notification sent to ${y.size} students in class ${S}`)}}await ju(wt(Re,"notifications"),g),console.log("Master notification record created.")}catch(g){throw console.error("Error sending notification:",g),g}},Wj=async(n,e)=>{try{const t=[],r=qt(wt(Re,"notifications"),hn("targetType","==","all"),cf(20)),a=qt(wt(Re,"users",n,"notifications"),Jf("createdAt","desc"),cf(20));try{(await _n(r)).docs.forEach(f=>{var v;const g=f.data(),y=((v=g.readBy)==null?void 0:v.includes(n))||!1;t.push({id:f.id,...g,read:y})})}catch(c){console.warn("Retrying global fetch without constraints due to error:",c)}try{(await _n(a)).docs.forEach(f=>{t.push({id:f.id,...f.data()})})}catch(c){console.error("Error fetching personal notifications:",c)}return t.sort((c,f)=>{var v,w;const g=((v=c.createdAt)==null?void 0:v.seconds)||0;return(((w=f.createdAt)==null?void 0:w.seconds)||0)-g}).filter(c=>{var f;return!((f=c.deletedBy)!=null&&f.includes(n))})}catch(t){return console.error("Error fetching notifications:",t),[]}},Jj=async(n,e)=>{try{const t=ft(Re,"notifications",n),{arrayUnion:r}=await Mn(async()=>{const{arrayUnion:l}=await Promise.resolve().then(()=>ku);return{arrayUnion:l}},void 0);try{await vs(t,{deletedBy:r(e)});return}catch{}const a=ft(Re,"users",e,"notifications",n);await vs(a,{deletedBy:r(e)})}catch{}},OT=async()=>{try{const n=vt.now(),e=qt(wt(Re,"notifications"),hn("targetType","==","all"),cf(20)),t=await _n(e),r=[];return t.forEach(a=>{const l=a.data();(l.type==="special"||l.type==="attention")&&(l.expiryDate&&l.expiryDate.seconds?l.expiryDate.seconds>n.seconds&&r.push({id:a.id,...l}):r.push({id:a.id,...l}))}),r}catch(n){return console.error("Error fetching marquee:",n),[]}},Zj=async()=>{try{const n=qt(wt(Re,"notifications"),Jf("createdAt","desc"));return(await _n(n)).docs.map(t=>({id:t.id,...t.data()}))}catch(n){return console.error("Error fetching all notifications:",n),[]}},ek=async n=>{try{return await fy(ft(Re,"notifications",n)),!0}catch(e){return console.error("Error deleting notification:",e),!1}};var DT={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Qw=aa.createContext&&aa.createContext(DT),tk=["attr","size","title"];function nk(n,e){if(n==null)return{};var t=sk(n,e),r,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(n);for(a=0;a<l.length;a++)r=l[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(n,r)&&(t[r]=n[r])}return t}function sk(n,e){if(n==null)return{};var t={};for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){if(e.indexOf(r)>=0)continue;t[r]=n[r]}return t}function pf(){return pf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},pf.apply(this,arguments)}function Yw(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,r)}return t}function yf(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Yw(Object(t),!0).forEach(function(r){rk(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Yw(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function rk(n,e,t){return e=ik(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function ik(n){var e=ak(n,"string");return typeof e=="symbol"?e:e+""}function ak(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function MT(n){return n&&n.map((e,t)=>aa.createElement(e.tag,yf({key:t},e.attr),MT(e.child)))}function ot(n){return e=>aa.createElement(ok,pf({attr:yf({},n.attr)},e),MT(n.child))}function ok(n){var e=t=>{var{attr:r,size:a,title:l}=n,c=nk(n,tk),f=a||t.size||"1em",g;return t.className&&(g=t.className),n.className&&(g=(g?g+" ":"")+n.className),aa.createElement("svg",pf({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,c,{className:g,style:yf(yf({color:n.color||t.color},t.style),n.style),height:f,width:f,xmlns:"http://www.w3.org/2000/svg"}),l&&aa.createElement("title",null,l),n.children)};return Qw!==void 0?aa.createElement(Qw.Consumer,null,t=>e(t)):e(DT)}function vu(n){return ot({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"},child:[]}]})(n)}function lk(n){return ot({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.034 8 8 119.033 8 256s111.034 248 248 248 248-111.034 248-248S392.967 8 256 8zm130.108 117.892c65.448 65.448 70 165.481 20.677 235.637L150.47 105.216c70.204-49.356 170.226-44.735 235.638 20.676zM125.892 386.108c-65.448-65.448-70-165.481-20.677-235.637L361.53 406.784c-70.203 49.356-170.226 44.736-235.638-20.676z"},child:[]}]})(n)}function Pu(n){return ot({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 512c35.32 0 63.97-28.65 63.97-64H160.03c0 35.35 28.65 64 63.97 64zm215.39-149.71c-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84C118.56 68.1 64.08 130.3 64.08 208c0 102.3-36.15 133.53-55.47 154.29-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h383.8c19.12 0 32-15.6 32.1-32 .05-7.55-2.61-15.27-8.61-21.71z"},child:[]}]})(n)}function ck(n){return ot({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"},child:[]}]})(n)}function uk(n){return ot({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 144v288c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V144c0-26.5 21.5-48 48-48h88l12.3-32.9c7-18.7 24.9-31.1 44.9-31.1h125.5c20 0 37.9 12.4 44.9 31.1L376 96h88c26.5 0 48 21.5 48 48zM376 288c0-66.2-53.8-120-120-120s-120 53.8-120 120 53.8 120 120 120 120-53.8 120-120zm-32 0c0 48.5-39.5 88-88 88s-88-39.5-88-88 39.5-88 88-88 88 39.5 88 88z"},child:[]}]})(n)}function Xw(n){return ot({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M208 352c-2.39 0-4.78.35-7.06 1.09C187.98 357.3 174.35 360 160 360c-14.35 0-27.98-2.7-40.95-6.91-2.28-.74-4.66-1.09-7.05-1.09C49.94 352-.33 402.48 0 464.62.14 490.88 21.73 512 48 512h224c26.27 0 47.86-21.12 48-47.38.33-62.14-49.94-112.62-112-112.62zm-48-32c53.02 0 96-42.98 96-96s-42.98-96-96-96-96 42.98-96 96 42.98 96 96 96zM592 0H208c-26.47 0-48 22.25-48 49.59V96c23.42 0 45.1 6.78 64 17.8V64h352v288h-64v-64H384v64h-76.24c19.1 16.69 33.12 38.73 39.69 64H592c26.47 0 48-22.25 48-49.59V49.59C640 22.25 618.47 0 592 0z"},child:[]}]})(n)}function PT(n){return ot({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},child:[]}]})(n)}function hk(n){return ot({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"},child:[]}]})(n)}function Cl(n){return ot({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(n)}function dk(n){return ot({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 464c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V200.724a48 48 0 0 1 18.387-37.776c24.913-19.529 45.501-35.365 164.2-121.511C199.412 29.17 232.797-.347 256 .003c23.198-.354 56.596 29.172 73.413 41.433 118.687 86.137 139.303 101.995 164.2 121.512A48 48 0 0 1 512 200.724V464zm-65.666-196.605c-2.563-3.728-7.7-4.595-11.339-1.907-22.845 16.873-55.462 40.705-105.582 77.079-16.825 12.266-50.21 41.781-73.413 41.43-23.211.344-56.559-29.143-73.413-41.43-50.114-36.37-82.734-60.204-105.582-77.079-3.639-2.688-8.776-1.821-11.339 1.907l-9.072 13.196a7.998 7.998 0 0 0 1.839 10.967c22.887 16.899 55.454 40.69 105.303 76.868 20.274 14.781 56.524 47.813 92.264 47.573 35.724.242 71.961-32.771 92.263-47.573 49.85-36.179 82.418-59.97 105.303-76.868a7.998 7.998 0 0 0 1.839-10.967l-9.071-13.196z"},child:[]}]})(n)}function rm(n){return ot({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(n)}function Ww(n){return ot({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"},child:[]}]})(n)}function _f(n){return ot({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M622.34 153.2L343.4 67.5c-15.2-4.67-31.6-4.67-46.79 0L17.66 153.2c-23.54 7.23-23.54 38.36 0 45.59l48.63 14.94c-10.67 13.19-17.23 29.28-17.88 46.9C38.78 266.15 32 276.11 32 288c0 10.78 5.68 19.85 13.86 25.65L20.33 428.53C18.11 438.52 25.71 448 35.94 448h56.11c10.24 0 17.84-9.48 15.62-19.47L82.14 313.65C90.32 307.85 96 298.78 96 288c0-11.57-6.47-21.25-15.66-26.87.76-15.02 8.44-28.3 20.69-36.72L296.6 284.5c9.06 2.78 26.44 6.25 46.79 0l278.95-85.7c23.55-7.24 23.55-38.36 0-45.6zM352.79 315.09c-28.53 8.76-52.84 3.92-65.59 0l-145.02-44.55L128 384c0 35.35 85.96 64 192 64s192-28.65 192-64l-14.18-113.47-145.03 44.56z"},child:[]}]})(n)}function bu(n){return ot({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z"},child:[]}]})(n)}function fk(n){return ot({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"},child:[]}]})(n)}function LT(n){return ot({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M80 368H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm0-320H16A16 16 0 0 0 0 64v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16V64a16 16 0 0 0-16-16zm0 160H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm416 176H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"},child:[]}]})(n)}function Cd(n){return ot({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"},child:[]}]})(n)}function Dl(n){return ot({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(n)}function VT(n){return ot({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(n)}function ho(n){return ot({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M0 224v272c0 8.84 7.16 16 16 16h80V192H32c-17.67 0-32 14.33-32 32zm360-48h-24v-40c0-4.42-3.58-8-8-8h-16c-4.42 0-8 3.58-8 8v64c0 4.42 3.58 8 8 8h48c4.42 0 8-3.58 8-8v-16c0-4.42-3.58-8-8-8zm137.75-63.96l-160-106.67a32.02 32.02 0 0 0-35.5 0l-160 106.67A32.002 32.002 0 0 0 128 138.66V512h128V368c0-8.84 7.16-16 16-16h96c8.84 0 16 7.16 16 16v144h128V138.67c0-10.7-5.35-20.7-14.25-26.63zM320 256c-44.18 0-80-35.82-80-80s35.82-80 80-80 80 35.82 80 80-35.82 80-80 80zm288-64h-64v320h80c8.84 0 16-7.16 16-16V224c0-17.67-14.33-32-32-32z"},child:[]}]})(n)}function o0(n){return ot({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(n)}function mk(n){return ot({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(n)}function UT(n){return ot({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M296 32h192c13.255 0 24 10.745 24 24v160c0 13.255-10.745 24-24 24H296c-13.255 0-24-10.745-24-24V56c0-13.255 10.745-24 24-24zm-80 0H24C10.745 32 0 42.745 0 56v160c0 13.255 10.745 24 24 24h192c13.255 0 24-10.745 24-24V56c0-13.255-10.745-24-24-24zM0 296v160c0 13.255 10.745 24 24 24h192c13.255 0 24-10.745 24-24V296c0-13.255-10.745-24-24-24H24c-13.255 0-24 10.745-24 24zm296 184h192c13.255 0 24-10.745 24-24V296c0-13.255-10.745-24-24-24H296c-13.255 0-24 10.745-24 24v160c0 13.255 10.745 24 24 24z"},child:[]}]})(n)}function Ml(n){return ot({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(n)}function fo(n){return ot({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(n)}function gk(n){return ot({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M496 128v16a8 8 0 0 1-8 8h-24v12c0 6.627-5.373 12-12 12H60c-6.627 0-12-5.373-12-12v-12H24a8 8 0 0 1-8-8v-16a8 8 0 0 1 4.941-7.392l232-88a7.996 7.996 0 0 1 6.118 0l232 88A8 8 0 0 1 496 128zm-24 304H40c-13.255 0-24 10.745-24 24v16a8 8 0 0 0 8 8h464a8 8 0 0 0 8-8v-16c0-13.255-10.745-24-24-24zM96 192v192H60c-6.627 0-12 5.373-12 12v20h416v-20c0-6.627-5.373-12-12-12h-36V192h-64v192h-64V192h-64v192h-64V192H96z"},child:[]}]})(n)}function pk(n){return ot({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M610.5 373.3c2.6-14.1 2.6-28.5 0-42.6l25.8-14.9c3-1.7 4.3-5.2 3.3-8.5-6.7-21.6-18.2-41.2-33.2-57.4-2.3-2.5-6-3.1-9-1.4l-25.8 14.9c-10.9-9.3-23.4-16.5-36.9-21.3v-29.8c0-3.4-2.4-6.4-5.7-7.1-22.3-5-45-4.8-66.2 0-3.3.7-5.7 3.7-5.7 7.1v29.8c-13.5 4.8-26 12-36.9 21.3l-25.8-14.9c-2.9-1.7-6.7-1.1-9 1.4-15 16.2-26.5 35.8-33.2 57.4-1 3.3.4 6.8 3.3 8.5l25.8 14.9c-2.6 14.1-2.6 28.5 0 42.6l-25.8 14.9c-3 1.7-4.3 5.2-3.3 8.5 6.7 21.6 18.2 41.1 33.2 57.4 2.3 2.5 6 3.1 9 1.4l25.8-14.9c10.9 9.3 23.4 16.5 36.9 21.3v29.8c0 3.4 2.4 6.4 5.7 7.1 22.3 5 45 4.8 66.2 0 3.3-.7 5.7-3.7 5.7-7.1v-29.8c13.5-4.8 26-12 36.9-21.3l25.8 14.9c2.9 1.7 6.7 1.1 9-1.4 15-16.2 26.5-35.8 33.2-57.4 1-3.3-.4-6.8-3.3-8.5l-25.8-14.9zM496 400.5c-26.8 0-48.5-21.8-48.5-48.5s21.8-48.5 48.5-48.5 48.5 21.8 48.5 48.5-21.7 48.5-48.5 48.5zM224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm201.2 226.5c-2.3-1.2-4.6-2.6-6.8-3.9l-7.9 4.6c-6 3.4-12.8 5.3-19.6 5.3-10.9 0-21.4-4.6-28.9-12.6-18.3-19.8-32.3-43.9-40.2-69.6-5.5-17.7 1.9-36.4 17.9-45.7l7.9-4.6c-.1-2.6-.1-5.2 0-7.8l-7.9-4.6c-16-9.2-23.4-28-17.9-45.7.9-2.9 2.2-5.8 3.2-8.7-3.8-.3-7.5-1.2-11.4-1.2h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c10.1 0 19.5-3.2 27.2-8.5-1.2-3.8-2-7.7-2-11.8v-9.2z"},child:[]}]})(n)}function Jw(n){return ot({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M319.4 320.6L224 416l-95.4-95.4C57.1 323.7 0 382.2 0 454.4v9.6c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-9.6c0-72.2-57.1-130.7-128.6-133.8zM13.6 79.8l6.4 1.5v58.4c-7 4.2-12 11.5-12 20.3 0 8.4 4.6 15.4 11.1 19.7L3.5 242c-1.7 6.9 2.1 14 7.6 14h41.8c5.5 0 9.3-7.1 7.6-14l-15.6-62.3C51.4 175.4 56 168.4 56 160c0-8.8-5-16.1-12-20.3V87.1l66 15.9c-8.6 17.2-14 36.4-14 57 0 70.7 57.3 128 128 128s128-57.3 128-128c0-20.6-5.3-39.8-14-57l96.3-23.2c18.2-4.4 18.2-27.1 0-31.5l-190.4-46c-13-3.1-26.7-3.1-39.7 0L13.6 48.2c-18.1 4.4-18.1 27.2 0 31.6z"},child:[]}]})(n)}function wu(n){return ot({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm95.8 32.6L272 480l-32-136 32-56h-96l32 56-32 136-47.8-191.4C56.9 292 0 350.3 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-72.1-56.9-130.4-128.2-133.8z"},child:[]}]})(n)}function vf(n){return ot({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(n)}function Lu(n){return ot({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(n)}const yk=()=>{const[n,e]=K.useState([]);return K.useEffect(()=>{const t=async()=>{const a=await OT();a.sort((l,c)=>{var y,v;const f=((y=l.createdAt)==null?void 0:y.seconds)||0;return(((v=c.createdAt)==null?void 0:v.seconds)||0)-f}),e(a)};t();const r=setInterval(t,3e4);return()=>clearInterval(r)},[]),n.length===0?null:h.jsx("div",{className:"fixed top-16 left-0 right-0 z-[30] pointer-events-none",children:n.map(t=>{const r=t.type==="special",a=r?"bg-gradient-to-r from-red-600 to-red-700 text-white border-b border-red-800 shadow-red-500/50":"bg-gradient-to-r from-amber-500 to-orange-600 text-white border-b border-orange-700 shadow-orange-500/50";return h.jsx("div",{className:`${a} shadow-lg py-3 relative`,children:h.jsx("marquee",{behavior:"scroll",direction:"left",scrollamount:"5",width:"100%",children:h.jsxs("div",{className:"inline-flex items-center gap-4 mx-8 font-bold text-sm md:text-base uppercase tracking-wider",children:[r?h.jsx(rm,{className:"animate-pulse"}):h.jsx(Pu,{className:"animate-bounce"}),h.jsxs("span",{children:[t.title,":"]}),h.jsx("span",{className:"font-medium normal-case",children:t.message})]})})},t.id)})})},_k=()=>{const[n,e]=K.useState(null);K.useEffect(()=>{(async()=>{const l=await OT();if(l.length>0){const c=l.find(y=>y.type==="special"),f=l.find(y=>y.type==="attention"),g=c||f;g&&(sessionStorage.getItem(`seen_alert_${g.id}`)||e(g))}})()},[]);const t=()=>{n&&(sessionStorage.setItem(`seen_alert_${n.id}`,"true"),e(null))};if(!n)return null;const r=n.type==="special";return h.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm animate-fade-in p-4",children:h.jsx("div",{className:`bg-white dark:bg-slate-800 rounded-3xl shadow-2xl max-w-md w-full overflow-hidden transform transition-all scale-100 animate-bounce-in border-t-8 ${r?"border-red-500":"border-orange-500"}`,children:h.jsxs("div",{className:"p-8 flex flex-col items-center text-center",children:[h.jsx("div",{className:`w-20 h-20 rounded-full flex items-center justify-center mb-6 ${r?"bg-red-100 text-red-500":"bg-orange-100 text-orange-500"}`,children:h.jsx(rm,{className:"text-4xl animate-pulse"})}),h.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white mb-2",children:r?"THNG BO C BIT":"CH "}),h.jsx("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-200 mb-4",children:n.title}),h.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8 leading-relaxed",children:n.message}),h.jsx("button",{onClick:t,className:`px-8 py-3 rounded-xl font-bold text-white shadow-lg hover:shadow-xl hover:scale-105 transition-all ${r?"bg-gradient-to-r from-red-500 to-pink-600":"bg-gradient-to-r from-orange-400 to-yellow-500"}`,children:" Hiu"})]})})})},va=n=>{const e=(n||"").toLowerCase();return e==="hoc_vien"||e==="student"||e==="hoc-vien"?"/assets/img/avatar.webp1.webp":"/assets/img/avatar.webp.webp"},vk=async n=>{try{const e=ft(Re,"users",n),t=await bo(e);if(t.exists()){const r=t.data();return{id:n,email:r.email,full_name:r.fullName||r.full_name||"Ngi dng",role:(()=>{const a=r.role;return a==="teacher"||a==="giao-vien"||a==="giao_vien"?"giao_vien":a==="student"||a==="hoc-vien"||a==="hoc_vien"?"hoc_vien":a==="manager"||a==="quan-ly"||a==="quan_ly"?"quan_ly":a==="leader"||a==="lanh-dao"||a==="lanh_dao"?"lanh_dao":a==="admin"?"admin":"hoc_vien"})(),photoURL:r.photoURL||va(r.role),birthDate:r.birthDate||"",address:r.address||"",class:r.class||"",phoneNumber:r.phoneNumber||"",courseName:r.courseName||"",courseId:r.courseId||""}}return null}catch(e){return console.error("Error fetching user profile from Firestore:",e),null}},Zw=async(n,e,t,r,a,l,c,f)=>{try{let g=t;a==="n tp"&&r?g=`${t} / ${r}`:a==="Thi th"&&(g=`${t} (Thi th)`),await ju(wt(Re,"exam_results"),{studentId:n,licenseId:e,score:l,totalQuestions:c,timeTaken:f,completedAt:Wu(),type:a,quizTitle:g})}catch(g){console.error("Error saving exam result to Firestore:",g)}},bk=async()=>{try{const n=qt(wt(Re,"courses")),e=await _n(n),t=[];return e.forEach(r=>{const a=r.data();a.name&&t.push({id:r.id,name:a.name})}),t.sort((r,a)=>r.name.localeCompare(a.name))}catch(n){return console.error("Error fetching courses:",n),[]}},wk=async n=>{try{if(!n||n.length<3)return[];const e=qt(wt(Re,"users"),hn("email",">=",n),hn("email","<=",n+""));return(await _n(e)).docs.map(r=>{const a=r.data();return{id:r.id,email:a.email,full_name:a.fullName||a.full_name||"Ngi dng",role:(()=>{const l=a.role;return l==="teacher"||l==="giao-vien"?"giao_vien":l==="student"||l==="hoc-vien"?"hoc_vien":l==="manager"||l==="quan-ly"?"quan_ly":l==="leader"||l==="lanh-dao"?"lanh_dao":l||"hoc_vien"})(),photoURL:a.photoURL||va(a.role),birthDate:a.birthDate||"",address:a.address||"",class:a.class||"",phoneNumber:a.phoneNumber||"",courseName:a.courseName||"",courseId:a.courseId||""}})}catch(e){return console.error("Error searching users:",e),[]}},xk=({userProfile:n})=>{const[e,t]=K.useState([]),[r,a]=K.useState(!0);K.useEffect(()=>{l()},[]);const l=async()=>{a(!0);const V=await Zj();t(V),a(!1)},c=V=>!(n.role==="giao_vien"&&(V.type==="special"||V.type==="attention")),f=async V=>{confirm("Bn c chc chn mun XA VNH VIN thng bo ny? Hnh ng ny s g thng bo khi mn hnh ca tt c ngi dng.")&&(await ek(V)?(alert(" xa thng bo!"),l()):alert("C li xy ra khi xa."))},g=V=>V?new Date(V*1e3).toLocaleString("vi-VN"):"--",[y,v]=K.useState(!1),[w,E]=K.useState(""),[S,j]=K.useState(""),[D,R]=K.useState("system"),[L,F]=K.useState("all"),[B,ee]=K.useState([]),[he,ue]=K.useState(""),[C,I]=K.useState(""),[k,U]=K.useState([]),[P,H]=K.useState(null),[A,me]=K.useState("");K.useEffect(()=>{y&&L==="class"&&bk().then(ee)},[y,L]),K.useEffect(()=>{if(C.length>2&&L==="user"){const V=setTimeout(async()=>{const le=await wk(C);U(le)},500);return()=>clearTimeout(V)}},[C,L]);const xe=async V=>{if(V.preventDefault(),!w||!S)return alert("Vui lng nhp tiu  v ni dung");if(L==="class"&&!he)return alert("Vui lng chn lp");if(L==="user"&&!P)return alert("Vui lng chn ngi nhn");try{let le=null;L==="class"&&(le=he),L==="user"&&(le=P.id),await kT(w,S,D,L,le,n.id,n.full_name,A?new Date(A):null),alert(" gi thng bo thnh cng!"),v(!1),E(""),j(""),R("system"),l()}catch(le){console.error(le),alert("Li khi gi thng bo")}};return h.jsxs("div",{className:"p-4 md:p-8 animate-fade-in pb-20 max-w-7xl mx-auto",children:[h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-xl overflow-hidden min-h-[500px] flex flex-col",children:[h.jsxs("div",{className:"p-6 border-b border-gray-100 dark:border-slate-700 bg-gradient-to-r from-teal-500 to-emerald-600 text-white flex justify-between items-center",children:[h.jsxs("div",{children:[h.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-3",children:[h.jsx(rm,{})," Qun L Thng Bo H Thng"]}),h.jsx("p",{className:"text-teal-100 mt-1 opacity-90",children:n.role==="giao_vien"?"Bn c th xem tt c v qun l thng bo thng.":"Bn c ton quyn qun l thng bo."})]}),h.jsxs("button",{onClick:()=>v(!0),className:"bg-white text-teal-600 px-4 py-2 rounded-lg font-bold shadow hover:bg-teal-50 transition flex items-center gap-2",children:[h.jsx(Dl,{})," To mi"]})]}),h.jsx("div",{className:"flex-1 p-6 bg-gray-50 dark:bg-slate-900/50 overflow-x-auto",children:r?h.jsx("div",{className:"text-center py-20 text-gray-500",children:"ang ti d liu..."}):h.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow border border-gray-200 dark:border-slate-700 overflow-hidden min-w-[800px]",children:h.jsxs("table",{className:"w-full text-left text-sm",children:[h.jsx("thead",{className:"bg-gray-100 dark:bg-slate-700 text-gray-700 dark:text-gray-200 font-bold uppercase",children:h.jsxs("tr",{children:[h.jsx("th",{className:"p-4 w-32",children:"i tng"}),h.jsx("th",{className:"p-4 w-32",children:"Loi"}),h.jsx("th",{className:"p-4",children:"Tiu  & Ni dung"}),h.jsx("th",{className:"p-4 w-40",children:"Ngi to"}),h.jsx("th",{className:"p-4 w-48",children:"Ht hn (Marquee)"}),h.jsx("th",{className:"p-4 w-40",children:"Ngy to"}),h.jsx("th",{className:"p-4 w-32 text-center",children:"Hnh ng"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-slate-700",children:e.length===0?h.jsx("tr",{children:h.jsx("td",{colSpan:7,className:"p-10 text-center text-gray-500 text-base",children:"H thng cha c thng bo no."})}):e.map(V=>{var _e,De;const le=c(V);return h.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors",children:[h.jsxs("td",{className:"p-4 align-top",children:[h.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded text-xs font-bold whitespace-nowrap border
                                                            ${V.targetType==="all"?"bg-purple-100 text-purple-700 border-purple-200":V.targetType==="class"?"bg-indigo-100 text-indigo-700 border-indigo-200":"bg-pink-100 text-pink-700 border-pink-200"}
                                                        `,children:[V.targetType==="all"&&h.jsxs(h.Fragment,{children:[h.jsx(Ww,{})," Tt c"]}),V.targetType==="class"&&h.jsxs(h.Fragment,{children:[h.jsx(Lu,{})," Lp"]}),V.targetType==="user"&&h.jsxs(h.Fragment,{children:[h.jsx(vf,{})," C nhn"]})]}),V.targetId&&V.targetType!=="all"&&h.jsx("div",{className:"text-xs text-gray-500 mt-1 font-mono",children:V.targetId})]}),h.jsx("td",{className:"p-4 align-top",children:h.jsx("span",{className:`inline-block px-2 py-1 rounded text-xs font-bold whitespace-nowrap
                                                            ${V.type==="special"?"bg-red-100 text-red-600":V.type==="attention"?"bg-orange-100 text-orange-600":"bg-blue-100 text-blue-600"}
                                                        `,children:V.type==="special"?"C BIT":V.type==="attention"?"CH ":"Thng"})}),h.jsxs("td",{className:"p-4 align-top",children:[h.jsx("div",{className:"font-bold text-gray-900 dark:text-white mb-1 text-base",children:V.title}),h.jsx("div",{className:"text-gray-600 dark:text-gray-400 line-clamp-2",children:V.message})]}),h.jsxs("td",{className:"p-4 align-top text-gray-700 dark:text-gray-300 font-medium",children:[V.senderName,h.jsx("div",{className:"text-xs text-gray-400 font-normal",children:V.senderId===n.id?"(Bn)":""})]}),h.jsx("td",{className:"p-4 align-top",children:V.type==="special"||V.type==="attention"?h.jsxs("div",{className:"flex items-center gap-1 text-xs font-mono bg-gray-100 dark:bg-slate-900 px-2 py-1 rounded border whitespace-nowrap",children:[h.jsx(hk,{className:"text-gray-400"}),g((_e=V.expiryDate)==null?void 0:_e.seconds)]}):h.jsx("span",{className:"text-gray-400 text-xs",children:"--"})}),h.jsx("td",{className:"p-4 align-top text-gray-500 text-xs whitespace-nowrap",children:g((De=V.createdAt)==null?void 0:De.seconds)}),h.jsx("td",{className:"p-4 align-top text-center",children:le?h.jsxs("button",{onClick:()=>f(V.id),className:"text-red-500 hover:text-red-700 p-2 bg-red-50 hover:bg-red-100 rounded-lg transition-colors flex items-center gap-1 mx-auto",title:"Xa vnh vin",children:[h.jsx(fo,{size:14})," ",h.jsx("span",{className:"text-xs font-bold",children:"Xa"})]}):h.jsx("div",{className:"text-gray-300 flex justify-center p-2 cursor-not-allowed",title:"Bn khng c quyn xa thng bo cp cao ny",children:h.jsx(lk,{})})})]},V.id)})})]})})})]}),y&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-4 backdrop-blur-sm",onClick:()=>v(!1),children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden animate-scale-in",onClick:V=>V.stopPropagation(),children:[h.jsxs("div",{className:"p-6 border-b dark:border-slate-700 bg-gray-50 dark:bg-slate-900 flex justify-between items-center",children:[h.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-gray-800 dark:text-white",children:[h.jsx(Dl,{className:"text-teal-600"})," To thng bo mi"]}),h.jsx("button",{onClick:()=>v(!1),className:"text-gray-400 hover:text-gray-600 text-2xl",children:""})]}),h.jsxs("form",{onSubmit:xe,className:"p-6 space-y-4",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300",children:"Gi ti:"}),h.jsxs("div",{className:"flex gap-4",children:[h.jsxs("label",{className:`flex items-center gap-2 p-3 rounded-lg border cursor-pointer flex-1 justify-center transition-all ${L==="all"?"bg-purple-50 border-purple-500 text-purple-700 ring-1 ring-purple-500":"border-gray-200 hover:bg-gray-50"}`,children:[h.jsx("input",{type:"radio",name:"target",value:"all",checked:L==="all",onChange:()=>F("all"),className:"hidden"}),h.jsx(Ww,{})," Tt c"]}),h.jsxs("label",{className:`flex items-center gap-2 p-3 rounded-lg border cursor-pointer flex-1 justify-center transition-all ${L==="class"?"bg-indigo-50 border-indigo-500 text-indigo-700 ring-1 ring-indigo-500":"border-gray-200 hover:bg-gray-50"}`,children:[h.jsx("input",{type:"radio",name:"target",value:"class",checked:L==="class",onChange:()=>F("class"),className:"hidden"}),h.jsx(Lu,{})," Lp hc"]}),h.jsxs("label",{className:`flex items-center gap-2 p-3 rounded-lg border cursor-pointer flex-1 justify-center transition-all ${L==="user"?"bg-pink-50 border-pink-500 text-pink-700 ring-1 ring-pink-500":"border-gray-200 hover:bg-gray-50"}`,children:[h.jsx("input",{type:"radio",name:"target",value:"user",checked:L==="user",onChange:()=>F("user"),className:"hidden"}),h.jsx(vf,{})," C nhn"]})]})]}),L==="class"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"Chn lp:"}),h.jsxs("select",{className:"w-full p-2 border rounded-lg dark:bg-slate-700",value:he,onChange:V=>ue(V.target.value),required:!0,children:[h.jsx("option",{value:"",children:"-- Chn lp --"}),B.map(V=>h.jsxs("option",{value:V.name,children:[V.name," -- (",V.id,")"]},V.id))]})]}),L==="user"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"Tm ngi nhn (Email):"}),h.jsx("input",{className:"w-full p-2 border rounded-lg dark:bg-slate-700",placeholder:"Nhp email...",value:C,onChange:V=>I(V.target.value)}),k.length>0&&h.jsx("div",{className:"mt-2 border rounded max-h-40 overflow-y-auto bg-gray-50 dark:bg-slate-900",children:k.map(V=>h.jsxs("div",{onClick:()=>{H(V),U([]),I(V.email)},className:"p-2 hover:bg-teal-50 cursor-pointer flex justify-between items-center border-b last:border-0",children:[h.jsx("span",{className:"font-medium",children:V.full_name}),h.jsx("span",{className:"text-xs text-gray-500",children:V.email})]},V.id))}),P&&h.jsxs("div",{className:"mt-2 p-2 bg-green-50 text-green-700 text-sm rounded flex items-center gap-2",children:[h.jsx(PT,{}),"  chn: ",h.jsx("b",{children:P.full_name})," (",P.email,")"]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"Tiu :"}),h.jsx("input",{className:"w-full p-2 border rounded-lg dark:bg-slate-700",value:w,onChange:V=>E(V.target.value),required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"Ni dung:"}),h.jsx("textarea",{className:"w-full p-2 border rounded-lg dark:bg-slate-700 h-24",value:S,onChange:V=>j(V.target.value),required:!0})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"Loi thng bo:"}),h.jsxs("select",{className:"w-full p-2 border rounded-lg dark:bg-slate-700",value:D,onChange:V=>R(V.target.value),children:[h.jsx("option",{value:"system",children:"Thng (Xanh)"}),h.jsx("option",{value:"attention",children:"Ch  (Cam)"}),h.jsx("option",{value:"special",children:"c bit ( - Marquee)"})]})]}),(D==="attention"||D==="special")&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"Ht hn chy ch (Marquee):"}),h.jsx("input",{type:"datetime-local",className:"w-full p-2 border rounded-lg dark:bg-slate-700",value:A,onChange:V=>me(V.target.value),required:!0})]})]}),h.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t dark:border-slate-700 mt-6",children:[h.jsx("button",{type:"button",onClick:()=>v(!1),className:"px-5 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg font-medium transition",children:"Hy"}),h.jsx("button",{type:"submit",className:"px-5 py-2 bg-teal-600 hover:bg-teal-700 text-white rounded-lg font-bold shadow-lg shadow-teal-500/30 transition transform hover:-translate-y-0.5",children:"Gi thng bo"})]})]})]})})]})},ex=({onStart:n,onLoginClick:e,onRegisterClick:t})=>{const{theme:r}=Bn();return h.jsx("div",{className:"text-center p-4 animate-slide-in-right",children:h.jsxs("div",{className:"bg-card text-card-foreground rounded-2xl shadow-xl p-8 md:p-12 max-w-2xl mx-auto relative",children:[r==="tri-an"?h.jsx("img",{src:"https://i.postimg.cc/MH9hVp8S/happy-techers-day.jpg",alt:"Icon Chc mng Ngy Nh gio",className:"h-24 w-24 mx-auto mb-4 rounded-full object-cover"}):r==="noel"?h.jsx(ql,{className:"h-24 w-24 mx-auto text-primary mb-4"}):h.jsx(ql,{className:"h-24 w-24 mx-auto text-primary mb-4"}),h.jsx("h1",{className:"text-4xl md:text-5xl font-extrabold text-foreground mb-2",children:"ng Dng n tp"}),r==="tri-an"&&h.jsx("p",{className:"text-xl font-semibold text-primary mb-4",children:"Phin bn c bit Tri n Thy C"}),r==="noel"&&h.jsx("p",{className:"text-xl font-semibold text-primary mb-4",children:"Cho n Ging Sinh An Lnh"}),h.jsx("p",{className:"text-lg text-muted-foreground mb-4",children:"Cho mng anh/ch  n vi ng dng n tp, n thi chng ch chuyn mn phng tin thy ni a."}),r==="tri-an"&&h.jsx("p",{className:"text-lg text-muted-foreground mb-8 italic",children:'"Nhn ngy Nh gio Vit Nam 20-11, knh chc qu thy c lun mnh khe, hnh phc v thnh cng trong s nghip trng ngi."'}),h.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[h.jsx("button",{onClick:n,className:"w-full sm:w-auto bg-primary text-primary-foreground font-bold text-lg py-4 px-10 rounded-lg hover:bg-primary/90 focus:outline-none focus:ring-4 focus:ring-ring transition-all duration-300 transform hover:scale-105",children:"Bt u"}),h.jsx("button",{onClick:e,className:"w-full sm:w-auto bg-secondary text-secondary-foreground font-bold text-lg py-4 px-10 rounded-lg hover:bg-secondary/80 focus:outline-none focus:ring-4 focus:ring-ring transition-all duration-300",children:"ng nhp"})]}),h.jsx("div",{className:"mt-4",children:h.jsx("button",{onClick:t,className:"text-primary hover:underline font-medium",children:"Cha c ti khon? ng k ngay"})})]})})},Ek=async n=>{const e=n.trim();return e.includes("@")?e:`${e}@gmail.com`},Tk=({onBack:n})=>{const[e,t]=K.useState(""),[r,a]=K.useState(""),[l,c]=K.useState(!1),[f,g]=K.useState(null),y=async v=>{v.preventDefault(),c(!0),g(null);try{const w=await Ek(e);await bI(Mu,w,r)}catch(w){console.error("Login failed:",w),w.code==="auth/invalid-email"?g("Tn ng nhp hoc email khng hp l."):w.code==="auth/user-not-found"||w.code==="auth/wrong-password"||w.code==="auth/invalid-credential"?g("Ti khon hoc mt khu khng chnh xc."):g("ng nhp tht bi. Vui lng th li.")}finally{c(!1)}};return h.jsxs("div",{className:"w-full max-w-md mx-auto p-4 animate-slide-in-right",children:[h.jsxs("div",{className:"relative text-center mb-10",children:[h.jsx("button",{onClick:n,className:"absolute left-0 top-1/2 -translate-y-1/2 bg-card/50 p-3 rounded-full shadow-md hover:bg-muted focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:ring-offset-background transition-all duration-300 transform hover:scale-110","aria-label":"Quay li",children:h.jsx(Jl,{className:"h-10 w-10 text-primary"})}),h.jsx(ql,{className:"h-20 w-20 mx-auto text-primary mb-4"}),h.jsx("h1",{className:"text-4xl font-bold text-foreground",children:"ng nhp"}),h.jsx("p",{className:"text-lg text-muted-foreground mt-2",children:"Truy cp vo h thng qun l hc tp."})]}),h.jsx("div",{className:"bg-card p-8 rounded-2xl shadow-lg",children:h.jsxs("form",{onSubmit:y,children:[f&&h.jsx("p",{className:"bg-destructive/10 text-destructive p-3 rounded-md mb-4 text-center",children:f}),h.jsxs("div",{className:"mb-4",children:[h.jsx("label",{htmlFor:"account",className:"block text-sm font-medium text-card-foreground mb-2",children:"Ti khon"}),h.jsx("input",{id:"account",type:"text",value:e,onChange:v=>t(v.target.value),placeholder:"Nhp ti khon hoc email",className:"w-full px-4 py-3 bg-background border border-border rounded-lg text-foreground focus:outline-none focus:ring-2 focus:ring-ring transition-colors duration-300",required:!0,autoFocus:!0})]}),h.jsxs("div",{className:"mb-6",children:[h.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-card-foreground mb-2",children:"Mt khu"}),h.jsx("input",{id:"password",type:"password",value:r,onChange:v=>a(v.target.value),placeholder:"",className:"w-full px-4 py-3 bg-background border border-border rounded-lg text-foreground focus:outline-none focus:ring-2 focus:ring-ring transition-colors duration-300",required:!0})]}),h.jsx("button",{type:"submit",disabled:l,className:"w-full bg-primary text-primary-foreground font-bold py-3 px-6 rounded-lg hover:bg-primary/90 focus:outline-none focus:ring-4 focus:ring-ring transition-all duration-300 disabled:opacity-50 disabled:cursor-wait",children:l?"ang x l...":"ng nhp"})]})})]})},Sk=({onBack:n,onSuccess:e})=>{const[t,r]=K.useState(""),[a,l]=K.useState(""),[c,f]=K.useState(""),[g,y]=K.useState(""),[v,w]=K.useState(""),[E,S]=K.useState(""),[j,D]=K.useState(!1),[R,L]=K.useState(null),F=async B=>{if(B.preventDefault(),D(!0),L(null),a.length<6){L("Mt khu phi c t nht 6 k t."),D(!1);return}try{const he=(await vI(Mu,t.trim(),a)).user,ue=t.split("@")[0].toLowerCase();await NE(ft(Re,"users",he.uid),{email:he.email,fullName:c.trim(),phoneNumber:v.trim(),birthDate:E,role:"hoc_vien",class:g.trim(),username:ue,createdAt:Wu()}),console.log("Registration successful"),e()}catch(ee){console.error("Registration failed:",ee),ee.code==="auth/email-already-in-use"?L("Email ny  c s dng."):ee.code==="auth/invalid-email"?L("Email khng hp l."):ee.code==="auth/weak-password"?L("Mt khu qu yu."):L("ng k tht bi. Vui lng th li.")}finally{D(!1)}};return h.jsxs("div",{className:"w-full max-w-md mx-auto p-4 animate-slide-in-right",children:[h.jsxs("div",{className:"relative text-center mb-6",children:[h.jsx("button",{onClick:n,className:"absolute left-0 top-1/2 -translate-y-1/2 bg-card/50 p-2 rounded-full shadow-md hover:bg-muted transition-all duration-300",children:h.jsx(Jl,{className:"h-8 w-8 text-primary"})}),h.jsx(ql,{className:"h-16 w-16 mx-auto text-primary mb-2"}),h.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"ng K"}),h.jsx("p",{className:"text-sm text-muted-foreground",children:"To ti khon hc vin mi"})]}),h.jsx("div",{className:"bg-card p-6 rounded-2xl shadow-lg",children:h.jsxs("form",{onSubmit:F,className:"space-y-4",children:[R&&h.jsx("p",{className:"bg-destructive/10 text-destructive p-3 rounded-md text-sm text-center",children:R}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-card-foreground mb-1",children:"H v Tn *"}),h.jsx("input",{type:"text",value:c,onChange:B=>f(B.target.value),required:!0,className:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:ring-2 focus:ring-primary outline-none",placeholder:"Nguyn Vn A"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-card-foreground mb-1",children:"Lp Hc *"}),h.jsx("input",{type:"text",value:g,onChange:B=>y(B.target.value),required:!0,className:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:ring-2 focus:ring-primary outline-none",placeholder:"Nhp tn lp (GV s duyt)"})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-card-foreground mb-1",children:"Ngy sinh"}),h.jsx("input",{type:"date",value:E,onChange:B=>S(B.target.value),className:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:ring-2 focus:ring-primary outline-none"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-card-foreground mb-1",children:"ST"}),h.jsx("input",{type:"tel",value:v,onChange:B=>w(B.target.value),className:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:ring-2 focus:ring-primary outline-none",placeholder:"09..."})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-card-foreground mb-1",children:"Email *"}),h.jsx("input",{type:"email",value:t,onChange:B=>r(B.target.value),required:!0,className:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:ring-2 focus:ring-primary outline-none",placeholder:"email@example.com"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-card-foreground mb-1",children:"Mt khu *"}),h.jsx("input",{type:"password",value:a,onChange:B=>l(B.target.value),required:!0,className:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:ring-2 focus:ring-primary outline-none",placeholder:"t nht 6 k t"})]}),h.jsx("button",{type:"submit",disabled:j,className:"w-full bg-primary text-primary-foreground font-bold py-3 px-6 rounded-lg hover:bg-primary/90 transition-all duration-300 mt-4 disabled:opacity-50",children:j?"ang to ti khon...":"ng K"})]})})]})},Ak=(n,e)=>{const t="h-14 w-14 mx-auto text-primary mb-3 object-contain",r="h-14 w-14 mx-auto mb-3 object-cover rounded-full border-2 border-border/20 shadow-sm",a="h-14 w-14 mx-auto mb-3 object-contain drop-shadow-lg",l=n.name.toLowerCase();if(e==="noel")return l.includes("thuyn trng")?h.jsx("img",{src:"/assets/img/hat.png",alt:"Captain Hat",className:a}):l.includes("my trng")?h.jsx("img",{src:"/assets/img/gift4.png",alt:"Chief Engineer",className:a}):l.includes("thy th")?h.jsx("img",{src:"/assets/img/bell.png",alt:"Sailor",className:a}):l.includes("li phng tin")?h.jsx("img",{src:"/assets/img/tree.png",alt:"Helm",className:a}):l.includes("chng ch")?h.jsx("img",{src:"/assets/img/star-gold.png",alt:"Certificate",className:a}):h.jsx("img",{src:"/assets/img/gift5.png",alt:"Default",className:a});if(e==="tri-an")switch(n.id){case"thuyentruong-h1":return h.jsx("img",{src:"https://i.postimg.cc/Vs76y54F/8.jpg",alt:n.name,className:r});case"thuyentruong-h2":return h.jsx("img",{src:"https://i.postimg.cc/Pf6xGNK4/9.jpg",alt:n.name,className:r});case"thuyentruong-h3":return h.jsx("img",{src:"https://i.postimg.cc/Vs76y54W/7.jpg",alt:n.name,className:r});case"thuythu":return h.jsx(kp,{className:t});case"lai-phuong-tien":return h.jsx(ql,{className:t});case"maytruong-h1":return h.jsx("img",{src:"https://i.postimg.cc/zDpm90H6/undefined.jpg",alt:n.name,className:r});case"maytruong-h2":return h.jsx("img",{src:"https://i.postimg.cc/wMwSLjdc/Teachers-day-background-design-art-illustration.jpg",alt:n.name,className:r});case"maytruong-h3":return h.jsx("img",{src:"https://i.postimg.cc/NFdWmjwH/Hinh-thiep.jpg",alt:n.name,className:r});case"thomay":return h.jsx("img",{src:"https://i.postimg.cc/cJYy2WQN/hinh-nen-3.jpg",alt:n.name,className:r});case"caotoc":return h.jsx("img",{src:"https://i.postimg.cc/dQWMQybn/5.jpg",alt:n.name,className:r});case"ven-bien":return h.jsx("img",{src:"https://i.postimg.cc/zDdmDgs0/6.jpg",alt:n.name,className:r});case"antoan-ven-bien":return h.jsx("img",{src:"https://i.postimg.cc/ZYFWdtv0/BOARD.webp",alt:n.name,className:r});case"antoan-xang-dau":return h.jsx("img",{src:"https://i.postimg.cc/T2k82Dzc/4.jpg",alt:n.name,className:r});case"antoan-hoa-chat":return h.jsx("img",{src:"https://i.postimg.cc/mZVx08Ff/World-Teacher-s-Day-Flowers-Border-Pink.jpg",alt:n.name,className:r});default:return l.includes("chng ch")?h.jsx(f1,{className:t}):h.jsx(d1,{className:t})}return l.includes("thuyn trng")?h.jsx(kN,{className:t}):l.includes("my trng")?h.jsx(jN,{className:t}):l.includes("thy th")?h.jsx(kp,{className:t}):l.includes("li phng tin")?h.jsx(ql,{className:t}):l.includes("chng ch")?h.jsx(f1,{className:t}):h.jsx(d1,{className:t})},Nk=({licenses:n,onSelect:e,onBack:t})=>{const{theme:r}=Bn();return h.jsxs("div",{className:"w-full max-w-4xl mx-auto p-4 animate-slide-in-right",children:[h.jsxs("div",{className:"relative text-center mb-10",children:[h.jsx("button",{onClick:t,className:"absolute left-0 top-1/2 -translate-y-1/2 bg-card/50 p-3 rounded-full shadow-md hover:bg-muted focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:ring-offset-background transition-all duration-300 transform hover:scale-110","aria-label":"Quay li",children:h.jsx(Jl,{className:"h-10 w-10 text-primary"})}),r==="noel"?h.jsx("img",{src:"/assets/img/tree.png",alt:"Tree",className:"h-20 w-20 mx-auto mb-4 object-contain drop-shadow-lg"}):h.jsx(kp,{className:"h-20 w-20 mx-auto text-primary mb-4"}),h.jsx("h1",{className:"text-4xl font-bold text-foreground",children:"Chn Hng Bng"}),h.jsx("p",{className:"text-lg text-muted-foreground mt-2",children:"Anh/ch vui lng chn hng bng mun n tp v thi th."})]}),h.jsx("div",{className:"bg-card p-6 rounded-2xl shadow-lg",children:h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:n.map(a=>{const l=a.subjects.reduce((c,f)=>c+f.questions.length,0);return h.jsxs("button",{onClick:()=>e(a),className:"group w-full p-4 bg-background rounded-lg text-center hover:bg-primary/10 transition-all duration-300 transform hover:scale-105 focus:ring-4 focus:ring-ring focus:outline-none",children:[Ak(a,r),h.jsx("h3",{className:"text-md font-bold text-primary",children:a.name}),h.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[a.subjects.length," mn - ",l," cu"]})]},a.id)})})})]})},Rk=({onNameSubmit:n,onBack:e})=>{const[t,r]=K.useState(""),a=l=>{l.preventDefault();const c=t.trim();n(c||"Hc vin")};return h.jsxs("div",{className:"w-full max-w-md mx-auto p-4 animate-slide-in-right",children:[h.jsxs("div",{className:"text-center mb-10",children:[h.jsx(CN,{className:"h-20 w-20 mx-auto text-primary mb-4"}),h.jsxs("div",{className:"relative flex justify-center items-center",children:[h.jsx("div",{className:"absolute left-0",children:h.jsx("button",{onClick:e,className:"bg-card/50 p-3 rounded-full shadow-md hover:bg-muted focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:ring-offset-background transition-all duration-300 transform hover:scale-110","aria-label":"Quay li",children:h.jsx(Jl,{className:"h-10 w-10 text-primary"})})}),h.jsx("h1",{className:"text-4xl font-bold text-foreground",children:"Thng tin ca anh/ch"})]}),h.jsx("p",{className:"text-lg text-muted-foreground mt-2",children:"Nhp tn  ti c th lu li tin  hc tp cho anh/ch."})]}),h.jsx("div",{className:"bg-card p-8 rounded-2xl shadow-lg",children:h.jsxs("form",{onSubmit:a,children:[h.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-card-foreground mb-2",children:"Tn ca anh/ch"}),h.jsx("input",{id:"name",type:"text",value:t,onChange:l=>r(l.target.value),placeholder:"V d: Nguyn Vn A (c th b trng)",className:"w-full px-4 py-3 bg-background border border-border rounded-lg text-foreground focus:outline-none focus:ring-2 focus:ring-ring transition-colors duration-300",autoFocus:!0}),h.jsx("button",{type:"submit",className:"mt-6 w-full bg-primary text-primary-foreground font-bold py-3 px-6 rounded-lg hover:bg-primary/90 focus:outline-none focus:ring-4 focus:ring-ring transition-all duration-300",children:"Xc nhn"})]})})]})},Ck=({onModeSelect:n,licenseName:e,userName:t,onSwitchLicense:r})=>h.jsxs("div",{className:"w-full max-w-4xl mx-auto p-4 animate-slide-in-right",children:[h.jsxs("div",{className:"relative text-center mb-10",children:[h.jsx("div",{className:"absolute right-0 top-0",children:h.jsxs("button",{onClick:r,className:"flex items-center gap-1.5 text-xs font-medium text-muted-foreground hover:text-primary transition-all duration-300 py-1 px-2 rounded-md hover:bg-secondary",title:"Chn li hng bng",children:[h.jsx(IN,{className:"h-4 w-4"}),h.jsx("span",{children:"Chn li hng bng"})]})}),h.jsxs("h1",{className:"text-4xl font-bold text-foreground",children:["Cho anh/ch ",t,"!"]}),h.jsxs("p",{className:"text-lg text-muted-foreground mt-2",children:["Anh/ch ang hc hng bng ",h.jsx("span",{className:"font-semibold text-primary",children:e}),"."]}),h.jsx("p",{className:"text-lg text-muted-foreground mt-1",children:"Hy chn mt ch   bt u."})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("button",{onClick:()=>n("practice"),className:"group bg-card text-card-foreground p-8 rounded-2xl shadow-lg text-center hover:bg-primary/10 transition-all duration-300 transform hover:-translate-y-2 focus:outline-none focus:ring-4 focus:ring-ring",children:[h.jsx(S0,{className:"h-16 w-16 mx-auto text-primary mb-4 transition-transform group-hover:scale-110"}),h.jsx("h2",{className:"text-2xl font-bold text-card-foreground",children:"n tp"}),h.jsx("p",{className:"text-muted-foreground mt-2",children:"Luyn tp tng mn  nm vng kin thc."})]}),h.jsxs("button",{onClick:()=>n("online_exam"),className:"group bg-card text-card-foreground p-8 rounded-2xl shadow-lg text-center hover:bg-destructive/10 transition-all duration-300 transform hover:-translate-y-2 focus:outline-none focus:ring-4 focus:ring-ring",children:[h.jsx(ON,{className:"h-16 w-16 mx-auto text-destructive mb-4 transition-transform group-hover:scale-110"}),h.jsx("h2",{className:"text-2xl font-bold text-card-foreground",children:"Thi th"}),h.jsx("p",{className:"text-muted-foreground mt-2",children:"Lm bi thi 30 cu ngu nhin trong 45 pht."})]})]})]}),tx=n=>{if(!n)return"";const e=new Date(n),t=e.getDate().toString().padStart(2,"0"),r=(e.getMonth()+1).toString().padStart(2,"0"),a=e.getHours().toString().padStart(2,"0"),l=e.getMinutes().toString().padStart(2,"0");return`(${t}/${r} ${a}:${l})`},Ik=({subjects:n,progress:e,onSelect:t,onBack:r})=>h.jsxs("div",{className:"w-full max-w-2xl mx-auto p-4 animate-slide-in-right",children:[h.jsxs("div",{className:"relative text-center mb-10",children:[h.jsx("button",{onClick:r,className:"absolute left-0 top-1/2 -translate-y-1/2 bg-card/50 p-3 rounded-full shadow-md hover:bg-muted focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:ring-offset-background transition-all duration-300 transform hover:scale-110","aria-label":"Quay li",children:h.jsx(Jl,{className:"h-10 w-10 text-primary"})}),h.jsx(S0,{className:"h-20 w-20 mx-auto text-primary mb-4"}),h.jsx("h1",{className:"text-4xl font-bold text-foreground",children:"Chn Mn hc"}),h.jsx("p",{className:"text-lg text-muted-foreground mt-2",children:"Chn mt mn  bt u n tp."})]}),h.jsx("div",{className:"bg-card p-6 rounded-2xl shadow-lg",children:h.jsx("div",{className:"space-y-3",children:n.map(a=>{const l=e[a.id],c=l&&l.lastScore!==null;return h.jsxs("button",{onClick:()=>t(a),className:"w-full flex items-center justify-between p-5 bg-background rounded-lg text-left hover:bg-primary/10 transition-all duration-300 transform hover:scale-[1.02] focus:ring-4 focus:ring-ring focus:outline-none",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-bold text-primary",children:a.name}),h.jsxs("p",{className:"text-sm text-muted-foreground",children:[a.questions.length," cu hi"]})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[c&&h.jsxs("div",{className:"text-right text-sm",children:[h.jsxs("p",{className:"text-muted-foreground flex items-center justify-end",children:[h.jsx("span",{children:"Ln cui:"}),h.jsxs("span",{className:"font-semibold text-primary ml-1",children:[l.lastScore,"/",a.questions.length]}),l.lastScoreTimestamp&&h.jsx("span",{className:"ml-1.5 text-xs text-muted-foreground/80",children:tx(l.lastScoreTimestamp)})]}),h.jsxs("p",{className:"text-muted-foreground flex items-center justify-end mt-0.5",children:[h.jsx("span",{children:"Cao nht:"}),h.jsxs("span",{className:"font-semibold text-success ml-1",children:[l.highScore,"/",a.questions.length]}),l.highScoreTimestamp&&h.jsx("span",{className:"ml-1.5 text-xs text-muted-foreground/80",children:tx(l.highScoreTimestamp)})]})]}),h.jsx(RN,{className:"h-6 w-6 text-muted-foreground"})]})]},a.id)})})})]}),jk=({quiz:n,onFinish:e,onBack:t,initialIndex:r=0,initialAnswers:a={},onProgressUpdate:l})=>{const[c,f]=K.useState(r),[g,y]=K.useState(a);if(!n.questions||n.questions.length===0)return h.jsxs("div",{className:"w-full max-w-3xl mx-auto p-4 text-center",children:[h.jsx("h2",{className:"text-xl font-bold mb-4",children:"Cha c cu hi no trong ch  ny."}),h.jsx("button",{onClick:t,className:"bg-primary text-primary-foreground hover:bg-primary/90 py-2 px-4 rounded-lg",children:"Quay li"})]});const v=K.useMemo(()=>n.questions[c],[n.questions,c]);if(!v)return h.jsxs("div",{className:"w-full max-w-3xl mx-auto p-4 text-center",children:[h.jsx("h2",{className:"text-xl font-bold mb-4",children:"C li xy ra khi ti cu hi."}),h.jsx("button",{onClick:t,className:"bg-primary text-primary-foreground py-2 px-4 rounded-lg",children:"Quay li"})]});const w=K.useMemo(()=>g[v.id]!==void 0,[g,v.id]),E=K.useMemo(()=>g[v.id]||null,[g,v.id]);K.useEffect(()=>{l==null||l(c,0,g)},[c,g]);const S=()=>{e(g)},j=L=>{w||y(F=>({...F,[v.id]:L}))},D=()=>{c===n.questions.length-1?S():f(F=>F+1)},R=c/n.questions.length*100;return h.jsx("div",{className:"w-full max-w-3xl mx-auto p-4 md:p-6 animate-slide-in-right font-quiz-default",children:h.jsxs("div",{className:"bg-card text-card-foreground rounded-2xl shadow-xl p-6 md:p-8",children:[h.jsxs("div",{className:"mb-6",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4 relative",children:[h.jsx("button",{onClick:t,className:"absolute left-0 top-1/2 -translate-y-1/2 bg-background/50 p-3 rounded-full shadow-md hover:bg-muted focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 focus:ring-offset-card transition-all duration-300 transform hover:scale-110","aria-label":"Quay li",children:h.jsx(Jl,{className:"h-10 w-10"})}),h.jsx("h1",{className:"text-xl font-bold text-foreground text-center flex-grow",children:n.title}),h.jsx("button",{onClick:S,className:"bg-secondary text-secondary-foreground hover:bg-secondary/80 text-sm font-bold py-2 px-4 rounded-lg transition-colors duration-300",children:"Kt thc"})]}),h.jsx("div",{className:"w-full bg-secondary rounded-full h-2.5 mb-2",children:h.jsx("div",{className:"bg-primary h-2.5 rounded-full transition-all duration-500",style:{width:`${R}%`}})}),h.jsx("div",{className:"flex justify-between items-center text-sm text-muted-foreground",children:h.jsxs("span",{children:["Cu ",c+1," / ",n.questions.length]})})]}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-5 text-foreground",children:v.text}),v.image&&h.jsx("div",{className:"mb-6 rounded-lg overflow-hidden",children:h.jsx("img",{src:v.image,alt:"Cu hi",className:"w-full h-auto object-cover max-h-80"})}),h.jsx("div",{className:"space-y-3",children:v.answers.map(L=>{const F=E===L.id;let B="w-full text-left p-4 rounded-lg border-2 transition-all duration-300 flex items-center justify-between text-lg";const ee=L.id===v.correctAnswerId;return w?ee?B+=" bg-success/10 border-success text-success":F&&!ee?B+=" bg-destructive/10 border-destructive text-destructive":B+=" border-border text-muted-foreground":F?B+=" bg-primary/10 border-primary ring-2 ring-primary text-primary-foreground":B+=" bg-background hover:bg-muted border-border text-foreground",h.jsxs("button",{onClick:()=>j(L.id),disabled:w,className:B,children:[h.jsx("span",{className:"flex-grow",children:L.text}),w&&h.jsxs(h.Fragment,{children:[ee&&h.jsx(E0,{className:"h-6 w-6 text-success ml-3"}),F&&!ee&&h.jsx(T0,{className:"h-6 w-6 text-destructive ml-3"})]})]},L.id)})}),h.jsx("div",{className:"mt-8",children:h.jsx("div",{className:"text-right",children:w?h.jsx("button",{onClick:D,className:"bg-success text-success-foreground font-bold py-3 px-8 rounded-lg hover:bg-success/90 transition-all duration-300 animate-slide-in-right",children:c===n.questions.length-1?"Hon thnh":"Cu tip theo"}):h.jsx("div",{className:"h-[48px]"})})})]})]})})},kk=n=>{const e=Math.floor(n/60),t=n%60;return`${e.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},Ok=({checked:n,onChange:e})=>h.jsx("div",{onClick:e,className:`w-[14px] h-[14px] border border-[#999] inline-block cursor-pointer bg-white relative ${n?"bg-[#333]":""}`,children:n&&h.jsx("div",{className:"absolute top-[2px] left-[2px] w-[8px] h-[8px] bg-[#333]"})}),Dk=({quiz:n,onFinish:e,onBack:t,userName:r,selectedLicense:a,initialIndex:l=0,initialAnswers:c={},initialTime:f,onProgressUpdate:g})=>{const[y,v]=K.useState(l),[w,E]=K.useState(c),[S,j]=K.useState(f!==void 0?f:n.timeLimit??3600),D=K.useMemo(()=>n.questions[y],[n.questions,y]),R=K.useRef(w);K.useEffect(()=>{R.current=w,g==null||g(y,S,w)},[w]),K.useEffect(()=>{g==null||g(y,S,w)},[y]),K.useEffect(()=>{S%5===0&&(g==null||g(y,S,w))},[S]);const L=()=>{window.confirm("Anh/ch c chc chn mun thot khi bi thi khng? Mi tin trnh s b mt.")&&t()},F=K.useCallback(()=>{const he=R.current,ue=n.questions.length-Object.keys(he).length,C=ue>0?`Anh/ch vn cn ${ue} cu cha tr li. Anh/ch c chc chn mun np bi khng?`:"Anh/ch  hon thnh tt c cc cu hi. Anh/ch c mun np bi khng?";window.confirm(C)&&e(he)},[n.questions.length,e]),B=K.useRef(e);K.useEffect(()=>{B.current=e},[e]),K.useEffect(()=>{const he=setInterval(()=>{j(ue=>ue>0?ue-1:0)},1e3);return()=>clearInterval(he)},[]),K.useEffect(()=>{S===0&&(alert(" ht gi lm bi! H thng s t ng np bi ca anh/ch."),B.current(R.current))},[S]);const ee=(he,ue)=>{E(C=>({...C,[he]:ue}))};return h.jsxs("div",{className:"w-full max-w-7xl mx-auto font-sans text-black shadow-lg animate-slide-in-right rounded-md",children:[h.jsx("div",{className:"h-3 bg-yellow-700 rounded-t-md border-b-2 border-yellow-900"}),h.jsxs("div",{className:"bg-white p-4",children:[h.jsxs("div",{className:"flex justify-between items-start pb-4 border-b border-gray-300",children:[h.jsxs("div",{className:"flex gap-4 items-center",children:[h.jsx("img",{src:"https://i.postimg.cc/8PDn1wfM/favicon.png",alt:"Avatar",className:"w-20 h-[100px] border border-gray-300 object-contain p-1"}),h.jsxs("div",{className:"text-sm",children:[h.jsx("p",{children:"S bo danh:"}),h.jsx("p",{children:"Ngy sinh:"}),h.jsxs("p",{className:"mt-2",children:["H tn: ",h.jsx("span",{className:"font-bold text-blue-700",children:r||"Hc vin"})]}),h.jsxs("p",{children:["Hng bng: ",h.jsx("span",{className:"font-bold text-blue-700",children:(a==null?void 0:a.name)||"Thuyn trng hng ba - T3"})]})]})]}),h.jsxs("div",{className:"flex items-start gap-4",children:[h.jsxs("div",{className:"bg-[#f0ad4e] text-black p-2 rounded-md text-sm w-48",children:[h.jsx("p",{className:"font-bold",children:"ang thi"}),h.jsx("p",{children:"Thi gian: 45 pht"}),h.jsx("p",{children:"B gi: 0 pht"}),h.jsxs("p",{children:["Cn li: ",h.jsx("span",{className:"font-bold",children:kk(S)})]})]}),h.jsx("button",{onClick:L,className:"text-sm text-gray-600 hover:text-red-500 font-semibold",children:"Thot"})]})]}),h.jsxs("div",{className:"flex mt-4 gap-4",children:[h.jsxs("div",{className:"flex-1 border border-gray-400 rounded-md p-4 flex flex-col justify-between min-h-[500px]",children:[h.jsxs("div",{children:[h.jsx("p",{className:"font-bold mb-4 border-b border-dashed border-gray-400 pb-2",children:"Ni dung cu hi"}),h.jsxs("p",{className:"font-bold text-red-600 mb-2",children:["Cu :",y+1]}),h.jsx("p",{className:"mb-4 font-semibold",children:D.text}),D.image&&h.jsx("div",{className:"mb-4 flex justify-start",children:h.jsx("img",{src:D.image,alt:"Hnh nh cu hi",className:"max-w-full h-auto max-h-60 object-contain border border-gray-300 rounded-md"})}),h.jsx("div",{className:"space-y-4",children:D.answers.map((he,ue)=>h.jsxs("div",{className:"flex items-start",children:[h.jsxs("span",{className:"font-bold mr-2 text-gray-700 min-w-[20px]",children:[String.fromCharCode(65+ue),"."]}),h.jsx("p",{children:he.text})]},he.id))})]}),h.jsxs("div",{className:"flex justify-center gap-4 mt-8",children:[h.jsxs("button",{onClick:()=>v(he=>Math.max(0,he-1)),disabled:y===0,className:"bg-[#f0ad4e] text-black px-4 py-2 rounded-md border border-gray-400 flex items-center font-semibold hover:bg-yellow-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"w-5 h-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})}),"Tr li"]}),y<n.questions.length-1&&h.jsxs("button",{onClick:()=>v(he=>Math.min(n.questions.length-1,he+1)),className:"bg-[#f0ad4e] text-black px-4 py-2 rounded-md border border-gray-400 flex items-center font-semibold hover:bg-yellow-500 transition-colors",children:["Tip tc",h.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"w-5 h-5",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})})]})]})]}),h.jsxs("div",{className:"w-[200px] flex-none flex flex-col",children:[h.jsx("div",{className:"border border-gray-300 rounded-md",children:h.jsxs("table",{className:"w-full border-collapse text-xs",children:[h.jsx("thead",{className:"sticky top-0 bg-[#f0ad4e] z-10",children:h.jsxs("tr",{children:[h.jsx("th",{className:"border border-gray-400 p-2",children:"Cu"}),h.jsx("th",{className:"border border-gray-400 p-2",children:"a"}),h.jsx("th",{className:"border border-gray-400 p-2",children:"b"}),h.jsx("th",{className:"border border-gray-400 p-2",children:"c"}),h.jsx("th",{className:"border border-gray-400 p-2",children:"d"})]})}),h.jsx("tbody",{children:n.questions.map((he,ue)=>h.jsxs("tr",{className:y===ue?"bg-cyan-200":"hover:bg-gray-50",children:[h.jsxs("td",{className:`border border-gray-400 p-2 font-bold text-center cursor-pointer whitespace-nowrap ${y===ue?"text-black":"text-gray-500"}`,onClick:()=>v(ue),children:["Cu ",ue+1]}),he.answers.slice(0,4).map(C=>h.jsx("td",{className:"border border-gray-400 p-2 text-center",children:h.jsx(Ok,{checked:w[he.id]===C.id,onChange:()=>ee(he.id,C.id)})},C.id))]},he.id))})]})}),h.jsx("div",{className:"text-center mt-4 pt-2 border-t border-gray-200",children:h.jsx("button",{onClick:F,className:"bg-[#337ab7] text-white px-8 py-2 rounded-md font-semibold hover:bg-blue-700 transition-colors w-full",children:"Np bi"})})]})]}),h.jsxs("div",{className:"mt-4 bg-[#005a9c] text-white p-4 rounded-b-md flex items-center gap-4 text-xs",children:[h.jsx("img",{src:"https://i.postimg.cc/8PDn1wfM/favicon.png",alt:"Logo",className:"h-16 w-16 object-contain"}),h.jsxs("div",{children:[h.jsx("p",{className:"font-bold",children:"CNG TY C PHN T VN V GIO DC NINH BNH"}),h.jsx("p",{children:"a ch: ng Triu Vit Vng, phng Hoa L, tnh Ninh Bnh "})]})]})]})]})},Mk=({quiz:n,userAnswers:e,score:t,onRetry:r,onBack:a,userName:l})=>{const[c,f]=K.useState("all"),[g]=K.useState(()=>new Date),y=n.questions.length,v=t>=25,w=K.useMemo(()=>new Intl.DateTimeFormat("vi-VN",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"}).format(g),[g]),E=K.useMemo(()=>c==="incorrect"?n.questions.filter(S=>e[S.id]!==S.correctAnswerId):n.questions,[c,n.questions,e]);return h.jsxs("div",{className:"w-full max-w-4xl mx-auto p-4 animate-slide-in-right font-quiz-default",children:[h.jsxs("div",{className:"bg-card text-card-foreground rounded-2xl shadow-xl p-8 text-center mb-8",children:[h.jsx(Ox,{className:"h-24 w-24 mx-auto text-yellow-400 mb-4"}),h.jsx("h1",{className:"text-4xl font-bold text-foreground mb-2",children:"Kt qu Thi th"}),h.jsxs("div",{className:"my-4 text-muted-foreground",children:[h.jsxs("p",{className:"text-lg",children:["Th sinh: ",h.jsx("span",{className:"font-bold text-primary",children:l})]}),h.jsxs("p",{className:"text-sm",children:["Hon thnh lc: ",w]})]}),h.jsx("p",{className:`text-2xl font-bold mb-6 ${v?"text-success":"text-destructive"}`,children:v?"Chc mng, anh/ch  T!":"Rt tic, anh/ch KHNG T."}),h.jsxs("div",{className:`inline-block p-6 rounded-xl border ${v?"bg-success/10 border-success/20":"bg-destructive/10 border-destructive/20"}`,children:[h.jsxs("p",{className:`text-5xl font-extrabold ${v?"text-success":"text-destructive"}`,children:[t," / ",y]}),h.jsx("p",{className:"text-lg text-muted-foreground mt-1",children:"S cu ng"})]})]}),h.jsxs("div",{className:"bg-card text-card-foreground rounded-2xl shadow-xl p-8",children:[h.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6",children:[h.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Xem li bi lm"}),h.jsxs("div",{className:"flex items-center gap-2 mt-4 sm:mt-0",children:[h.jsx("button",{onClick:()=>f("all"),className:`px-4 py-2 text-sm font-semibold rounded-md transition-colors ${c==="all"?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground"}`,children:"Tt c"}),h.jsxs("button",{onClick:()=>f("incorrect"),className:`px-4 py-2 text-sm font-semibold rounded-md transition-colors ${c==="incorrect"?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground"}`,children:["Ch cu sai (",n.questions.length-t,")"]})]})]}),h.jsx("div",{className:"space-y-6 max-h-[50vh] overflow-y-auto pr-2",children:E.length>0?E.map((S,j)=>{const D=e[S.id],R=S.correctAnswerId;return h.jsxs("div",{className:"p-4 border-b border-border last:border-b-0",children:[h.jsxs("p",{className:"font-semibold text-lg mb-3 text-foreground",children:[h.jsxs("span",{className:"mr-2",children:["Cu ",n.questions.findIndex(L=>L.id===S.id)+1,":"]}),S.text]}),h.jsx("div",{className:"space-y-2",children:S.answers.map(L=>{const F=L.id===D,B=L.id===R;let ee="flex items-center p-3 rounded-md text-sm ";return B?ee+="bg-success/10 text-success":F?ee+="bg-destructive/10 text-destructive":ee+="bg-muted/50 text-muted-foreground",h.jsxs("div",{className:ee,children:[B?h.jsx(E0,{className:"h-5 w-5 mr-3 text-success"}):F?h.jsx(T0,{className:"h-5 w-5 mr-3 text-destructive"}):h.jsx("div",{className:"w-5 h-5 mr-3"}),h.jsx("span",{children:L.text})]},L.id)})})]},S.id)}):h.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Tuyt vi! Anh/ch  tr li ng tt c cc cu hi."})})]}),h.jsxs("div",{className:"text-center mt-8 flex flex-col sm:flex-row justify-center items-center gap-4",children:[h.jsx("button",{onClick:a,className:"w-full sm:w-auto bg-primary text-primary-foreground font-bold py-3 px-8 rounded-lg hover:bg-primary/90 focus:outline-none focus:ring-4 focus:ring-ring transition-all duration-300 transform hover:scale-105",children:"Quay li"}),h.jsx("button",{onClick:r,className:"w-full sm:w-auto bg-secondary text-secondary-foreground font-bold py-3 px-8 rounded-lg hover:bg-muted focus:outline-none focus:ring-4 focus:ring-ring transition-colors duration-300",children:"Lm li bi thi"})]})]})},Pk=({quiz:n,userAnswers:e,score:t,onRetry:r,onBack:a,userName:l})=>{const[c,f]=K.useState("all"),[g]=K.useState(()=>new Date),y=n.questions.length,v=y>0?Math.round(t/y*100):0,w=K.useMemo(()=>new Intl.DateTimeFormat("vi-VN",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit",year:"numeric"}).format(g),[g]),E=K.useMemo(()=>c==="incorrect"?n.questions.filter(S=>e[S.id]!==S.correctAnswerId):n.questions,[c,n.questions,e]);return h.jsxs("div",{className:"w-full max-w-4xl mx-auto p-4 animate-slide-in-right font-quiz-default",children:[h.jsxs("div",{className:"bg-card text-card-foreground rounded-2xl shadow-xl p-8 text-center mb-8",children:[h.jsx(Ox,{className:"h-24 w-24 mx-auto text-yellow-400 mb-4"}),h.jsx("h1",{className:"text-4xl font-bold text-foreground mb-2",children:"Kt qu n tp"}),h.jsxs("div",{className:"my-4 text-muted-foreground",children:[h.jsxs("p",{className:"text-lg",children:["Hc vin: ",h.jsx("span",{className:"font-bold text-primary",children:l})]}),h.jsxs("p",{className:"text-sm",children:["Hon thnh lc: ",w]})]}),h.jsxs("div",{className:"bg-primary/10 inline-block p-6 rounded-xl border border-primary/20 mt-4",children:[h.jsxs("p",{className:"text-5xl font-extrabold text-primary",children:[t," / ",y]}),h.jsxs("p",{className:"text-2xl font-semibold text-primary/80 mt-1",children:["(",v,"%)"]})]})]}),h.jsxs("div",{className:"bg-card text-card-foreground rounded-2xl shadow-xl p-8",children:[h.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6",children:[h.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Xem li bi lm"}),h.jsxs("div",{className:"flex items-center gap-2 mt-4 sm:mt-0",children:[h.jsx("button",{onClick:()=>f("all"),className:`px-4 py-2 text-sm font-semibold rounded-md transition-colors ${c==="all"?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground"}`,children:"Tt c"}),h.jsxs("button",{onClick:()=>f("incorrect"),className:`px-4 py-2 text-sm font-semibold rounded-md transition-colors ${c==="incorrect"?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground"}`,children:["Ch cu sai (",n.questions.length-t,")"]})]})]}),h.jsx("div",{className:"space-y-6 max-h-[50vh] overflow-y-auto pr-2",children:E.length>0?E.map((S,j)=>{const D=e[S.id],R=S.correctAnswerId;return h.jsxs("div",{className:"p-4 border-b border-border last:border-b-0",children:[h.jsxs("p",{className:"font-semibold text-lg mb-3 text-foreground",children:[h.jsxs("span",{className:"mr-2",children:["Cu ",n.questions.findIndex(L=>L.id===S.id)+1,":"]}),S.text]}),h.jsx("div",{className:"space-y-2",children:S.answers.map(L=>{const F=L.id===D,B=L.id===R;let ee="flex items-center p-3 rounded-md text-sm ";return B?ee+="bg-success/10 text-success":F?ee+="bg-destructive/10 text-destructive":ee+="bg-muted/50 text-muted-foreground",h.jsxs("div",{className:ee,children:[B?h.jsx(E0,{className:"h-5 w-5 mr-3 text-success"}):F?h.jsx(T0,{className:"h-5 w-5 mr-3 text-destructive"}):h.jsx("div",{className:"w-5 h-5 mr-3"}),h.jsx("span",{children:L.text})]},L.id)})})]},S.id)}):h.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Tuyt vi! Anh/ch  tr li ng tt c cc cu hi."})})]}),h.jsxs("div",{className:"text-center mt-8 flex flex-col sm:flex-row justify-center items-center gap-4",children:[h.jsx("button",{onClick:a,className:"w-full sm:w-auto bg-primary text-primary-foreground font-bold py-3 px-8 rounded-lg hover:bg-primary/90 focus:outline-none focus:ring-4 focus:ring-ring transition-all duration-300 transform hover:scale-105",children:"Cc mn khc"}),h.jsx("button",{onClick:r,className:"w-full sm:w-auto bg-secondary text-secondary-foreground font-bold py-3 px-8 rounded-lg hover:bg-muted focus:outline-none focus:ring-4 focus:ring-ring transition-colors duration-300",children:"Lm li"})]})]})},Lk="_card_ns310_3",Vk="_header_ns310_45",Uk="_logoPlaceholder_ns310_69",Bk="_schoolName_ns310_97",zk="_body_ns310_113",qk="_cardTitle_ns310_135",Hk="_contentRow_ns310_157",$k="_photoSection_ns310_169",Fk="_photoWrapper_ns310_179",Gk="_avatar_ns310_195",Kk="_infoSection_ns310_209",Qk="_infoRow_ns310_229",Yk="_label_ns310_239",Xk="_value_ns310_255",Wk="_valueHighlight_ns310_265",Jk="_footer_ns310_281",Zk="_barcode_ns310_299",dt={card:Lk,header:Vk,logoPlaceholder:Uk,schoolName:Bk,body:zk,cardTitle:qk,contentRow:Hk,photoSection:$k,photoWrapper:Fk,avatar:Gk,infoSection:Kk,infoRow:Qk,label:Yk,value:Xk,valueHighlight:Wk,footer:Jk,barcode:Zk},eO=({user:n})=>{const e=n.role!=="hoc_vien",t=e?"TH GIO VIN":"TH HC VIN",r=e?{background:"linear-gradient(135deg, #b91c1c 0%, #c2410c 100%)",borderBottom:"4px solid #fcd34d"}:{},a=e?{color:"#b91c1c",textShadow:"0px 1px 2px rgba(0,0,0,0.1)"}:{};return h.jsxs("div",{className:dt.card,style:e?{borderColor:"#fcd34d",boxShadow:"0 10px 25px -5px rgba(234, 88, 12, 0.3)"}:{},children:[h.jsxs("div",{className:dt.header,style:r,children:[h.jsx("div",{className:dt.logoPlaceholder,style:e?{color:"#fbbf24",background:"rgba(255,255,255,0.2)"}:{},children:h.jsx(gk,{size:20})}),h.jsxs("div",{className:dt.schoolName,style:e?{color:"#fff",fontWeight:"800"}:{},children:["Cng ty C phn",h.jsx("br",{}),"T VN V GIO DC NINH BNH"]})]}),h.jsxs("div",{className:dt.body,children:[h.jsx("h2",{className:dt.cardTitle,style:a,children:t}),h.jsxs("div",{className:dt.contentRow,children:[h.jsx("div",{className:dt.photoSection,children:h.jsx("div",{className:dt.photoWrapper,style:e?{borderColor:"#fcd34d"}:{},children:h.jsx("img",{src:n.photoURL||"https://via.placeholder.com/150",alt:"Avatar",className:dt.avatar})})}),h.jsxs("div",{className:dt.infoSection,children:[h.jsxs("div",{className:dt.infoRow,children:[h.jsx("span",{className:dt.label,children:"H tn:"}),h.jsx("span",{className:`${dt.value} ${dt.valueHighlight}`,style:e?{color:"#b91c1c"}:{},children:n.full_name||"---"})]}),h.jsxs("div",{className:dt.infoRow,children:[h.jsx("span",{className:dt.label,children:"Ngy sinh: "}),h.jsxs("span",{className:dt.value,children:[" ",n.birthDate||" --/--/----"]})]}),e?h.jsxs("div",{className:dt.infoRow,children:[h.jsx("span",{className:dt.label,children:"Phng: "}),h.jsx("span",{className:dt.value,style:{fontWeight:"bold"},children:" Phng o to - T vn hnh my tu thy"})]}):h.jsxs("div",{className:dt.infoRow,children:[h.jsx("span",{className:dt.label,children:"Lp hc: "}),h.jsx("span",{className:dt.value,children:n.courseName||"Cha vo kha"})]}),h.jsxs("div",{className:dt.infoRow,children:[h.jsx("span",{className:dt.label,children:"a ch:"}),h.jsx("span",{className:dt.value,style:{fontSize:"0.9rem"},children:n.address||"---"})]})]})]})]}),h.jsxs("div",{className:dt.footer,style:e?{background:"#fef2f2",borderTop:"1px dashed #fca5a5"}:{},children:[h.jsx("div",{className:dt.barcode,style:e?{opacity:.8}:{}}),h.jsxs("div",{style:{position:"absolute",bottom:"5px",fontSize:"0.6rem",color:e?"#991b1b":"#718096"},children:["ID: ",n.id?n.id.substring(0,10).toUpperCase():"---"]})]})]})},tO=({isOpen:n,onClose:e,notifications:t,userId:r,onMarkRead:a})=>{if(!n)return null;const l=async(c,f)=>{c.stopPropagation(),confirm("Bn c mun xa thng bo ny?")&&await Jj(f.id,r)};return h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4 animate-fade-in",onClick:e,children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[80vh]",onClick:c=>c.stopPropagation(),children:[h.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-slate-700 flex justify-between items-center bg-gradient-to-r from-blue-500 to-indigo-600 text-white",children:[h.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2",children:[h.jsx(Pu,{})," Hp th thng bo"]}),h.jsx("button",{onClick:e,className:"hover:bg-white/20 p-2 rounded-full transition-colors",children:h.jsx(Ml,{})})]}),h.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50 dark:bg-slate-900/50",children:t.length===0?h.jsxs("div",{className:"text-center py-10 text-gray-400",children:[h.jsx(dk,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),h.jsx("p",{children:"Cha c thng bo no."})]}):t.map(c=>{var g,y;const f=((g=c.readBy)==null?void 0:g.includes(r))||c.read;return h.jsxs("div",{onClick:()=>a(c.id),className:`p-4 rounded-xl border transition-all cursor-pointer relative overflow-hidden group
                                        ${f?"bg-white dark:bg-slate-800 border-gray-200 dark:border-slate-700 opacity-60":"bg-white dark:bg-slate-800 border-blue-200 dark:border-blue-500/50 shadow-md transform hover:-translate-y-1"}
                                    `,children:[!f&&h.jsx("div",{className:"absolute top-0 right-0 w-3 h-3 bg-red-500 rounded-full m-2 animate-pulse"}),h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("div",{className:`p-2 rounded-full flex-shrink-0 
                                            ${c.type==="special"?"bg-red-100 text-red-600 animate-pulse":c.type==="attention"?"bg-orange-100 text-orange-600":c.type==="system"?"bg-blue-100 text-blue-600":c.type==="class"?"bg-indigo-100 text-indigo-600":c.type==="reminder"?"bg-yellow-100 text-yellow-600":"bg-green-100 text-green-600"}
                                        `,children:h.jsx(Pu,{size:14})}),h.jsxs("div",{className:"flex-1",children:[h.jsxs("h3",{className:`font-bold text-sm mb-1 ${f?"text-gray-600 dark:text-gray-400":"text-gray-900 dark:text-white"}`,children:[c.title,(c.type==="special"||c.type==="attention")&&h.jsx("span",{className:"ml-2 text-[10px] uppercase border px-1 rounded bg-red-50 text-red-500 border-red-200",children:"Quan trng"})]}),h.jsx("p",{className:"text-xs text-gray-500 mb-2 line-clamp-3",children:c.message}),h.jsxs("div",{className:"flex justify-between items-center text-[10px] text-gray-400",children:[h.jsx("span",{children:c.senderName}),h.jsx("span",{children:(y=c.createdAt)!=null&&y.seconds?new Date(c.createdAt.seconds*1e3).toLocaleDateString("vi-VN"):"Va xong"})]})]}),h.jsx("button",{onClick:v=>l(v,c),className:"p-2 text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",title:"Xa thng bo",children:h.jsx(fo,{size:12})})]})]},c.id)})})]})})},nO=({notification:n,userId:e,onDismiss:t,onOpenInbox:r})=>{const[a,l]=K.useState(!1);return K.useEffect(()=>{if(n&&!n.readBy.includes(e)&&(l(!0),n.type!=="system")){const c=setTimeout(()=>l(!1),8e3);return()=>clearTimeout(c)}},[n,e]),!n||!a?null:h.jsx("div",{className:"fixed top-20 right-4 z-40 max-w-sm w-full animate-slide-in-right cursor-pointer",onClick:r,children:h.jsxs("div",{className:`rounded-xl shadow-2xl border-l-4 p-4 flex items-start gap-3 relative overflow-hidden backdrop-blur-md bg-white/90 dark:bg-slate-800/90
                ${n.type==="system"?"border-red-500":"border-blue-500"}
            `,children:[h.jsx("button",{onClick:c=>{c.stopPropagation(),l(!1),t()},className:"absolute top-2 right-2 text-gray-400 hover:text-gray-600 p-1",children:h.jsx(Ml,{size:12})}),h.jsx("div",{className:`p-2 rounded-full ${n.type==="system"?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600"}`,children:h.jsx(Pu,{})}),h.jsxs("div",{className:"flex-1 pr-6",children:[h.jsx("h4",{className:"font-bold text-sm text-gray-900 dark:text-white mb-1",children:n.title}),h.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300 line-clamp-2",children:n.message}),h.jsx("p",{className:"text-[10px] text-gray-400 mt-2",children:"Nhn  xem chi tit"})]})]})})},sO=({userProfile:n,onStart:e,onHistoryClick:t,onClassClick:r})=>{const{theme:a}=Bn(),[l,c]=K.useState([]),[f,g]=K.useState(!1),[y,v]=K.useState(0),[w,E]=K.useState(null);K.useEffect(()=>{(async()=>{if(n!=null&&n.id){const D=await Wj(n.id,n.class);c(D);const R=D.filter(L=>!L.read);v(R.length),R.length>0&&E(R[0])}})()},[n]);const S=j=>{c(D=>D.map(R=>R.id===j?{...R,read:!0,readBy:[...R.readBy||[],n.id]}:R)),v(D=>Math.max(0,D-1)),(w==null?void 0:w.id)===j&&E(null)};return h.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 animate-slide-in-right",children:h.jsxs("div",{className:"w-full max-w-4xl grid grid-cols-1 md:grid-cols-2 gap-8 items-center",children:[h.jsxs("div",{className:"flex flex-col items-center",children:[h.jsx("div",{className:"w-full flex justify-end mb-4 md:mb-0 relative md:absolute md:top-4 md:right-4 gap-2",children:h.jsxs("button",{onClick:()=>g(!0),className:"bg-white/80 dark:bg-slate-800/80 p-3 rounded-full shadow-lg hover:scale-110 transition-transform relative",children:[h.jsx(Pu,{className:"text-xl text-yellow-500"}),y>0&&h.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold w-5 h-5 rounded-full flex items-center justify-center animate-bounce",children:y})]})}),h.jsx(eO,{user:n})]}),h.jsx(tO,{isOpen:f,onClose:()=>g(!1),notifications:l,userId:n.id,onMarkRead:S}),h.jsx(nO,{notification:w,userId:n.id,onDismiss:()=>E(null),onOpenInbox:()=>g(!0)}),h.jsxs("div",{className:"bg-card/90 backdrop-blur-sm p-8 rounded-2xl shadow-xl border border-border",children:[h.jsxs("h1",{className:"text-3xl font-bold text-primary mb-6 text-center",children:["Xin cho, ",n.full_name||"Hc vin","!"]}),h.jsx("p",{className:"text-muted-foreground text-center mb-8",children:"Chc bn c mt bui n tp hiu qu v t kt qu cao."}),h.jsx("div",{className:"space-y-4",children:h.jsxs("button",{onClick:e,className:"w-full bg-primary text-primary-foreground font-bold text-lg py-4 px-6 rounded-xl hover:bg-primary/90 focus:outline-none focus:ring-4 focus:ring-ring transition-all duration-300 transform hover:scale-105 flex items-center justify-center gap-3 shadow-lg",children:[h.jsx(S0,{className:"w-8 h-8"}),h.jsx("span",{children:"Vo n Tp / Thi Th"})]})})]})]})})},bf=async n=>{try{const e=qt(wt(Re,"exam_results"),hn("studentId","==",n));return(await _n(e)).docs.map(a=>{const l=a.data(),c=l.submitted_at||l.completedAt,f=c?c.toDate():new Date;return{id:a.id,...l,userId:l.studentId,completedAt:f}}).sort((a,l)=>l.completedAt.getTime()-a.completedAt.getTime())}catch(e){return console.error("Error fetching exam history:",e),[]}},rO=({userProfile:n,onBack:e})=>{const[t,r]=K.useState([]),[a,l]=K.useState(!0),[c,f]=K.useState({});K.useEffect(()=>{(async()=>{const E=await bf(n.id);E.sort((j,D)=>D.completedAt.getTime()-j.completedAt.getTime()),r(E),l(!1);const S=Array.from(new Set(E.filter(j=>j.roomId).map(j=>j.roomId)));if(S.length>0){const j={};await Promise.all(S.map(async D=>{try{const{doc:R,getDoc:L}=await Mn(async()=>{const{doc:ee,getDoc:he}=await Promise.resolve().then(()=>ku);return{doc:ee,getDoc:he}},void 0),{db:F}=await Mn(async()=>{const{db:ee}=await Promise.resolve().then(()=>Xj);return{db:ee}},void 0),B=await L(R(F,"exam_rooms",D));B.exists()&&(j[D]=B.data())}catch(R){console.error(`Error fetching room ${D}`,R)}})),f(j)}})()},[n.id]);const g=w=>w.roomId?"Thi Trc Tuyn":w.quizId==="exam-quiz"||w.quizId==="thithu2"||w.type==="Thi th"?"Thi th":"n tp",y=w=>{switch(w){case"Thi Trc Tuyn":return"bg-red-100 text-red-800 border-red-200";case"Thi th":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-blue-100 text-blue-800 border-blue-200"}},v=w=>{if(w.roomId&&c[w.roomId]){const E=c[w.roomId];return`Phng thi ${E.name} / ${E.course_name||"T do"} / ${E.license_name||""}`}return w.quizTitle||(w.roomId?`Phng thi ${w.roomId}`:w.type)};return h.jsxs("div",{className:"w-full max-w-5xl mx-auto p-4 animate-slide-in-right",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsxs("h1",{className:"text-2xl font-bold text-foreground flex items-center gap-2",children:[h.jsx(bu,{className:"text-primary"}),"Lch s n tp & Thi"]}),h.jsx("button",{onClick:e,className:"bg-secondary text-secondary-foreground px-4 py-2 rounded-lg hover:bg-secondary/80 transition-colors shadow-sm",children:"Quay li"})]}),a?h.jsx("div",{className:"text-center p-8",children:h.jsx("p",{className:"text-muted-foreground",children:"ang ti d liu..."})}):t.length===0?h.jsx("div",{className:"text-center p-8 bg-card rounded-xl shadow-sm border border-border",children:h.jsx("p",{className:"text-muted-foreground",children:"Cha c lch s lm bi no."})}):h.jsx("div",{className:"bg-white dark:bg-card rounded-xl shadow-sm border border-border overflow-hidden",children:h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full text-left border-collapse",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"bg-muted/50 border-b border-border text-xs uppercase text-muted-foreground",children:[h.jsx("th",{className:"p-4 font-semibold",children:"Loi"}),h.jsx("th",{className:"p-4 font-semibold",children:"Bi thi"}),h.jsx("th",{className:"p-4 font-semibold text-center",children:"im s"}),h.jsx("th",{className:"p-4 font-semibold",children:"Gi np"})," ",h.jsx("th",{className:"p-4 font-semibold",children:"Ngy np"})]})}),h.jsx("tbody",{className:"divide-y divide-border",children:t.map(w=>{const E=g(w);return h.jsxs("tr",{className:"hover:bg-muted/30 transition-colors",children:[h.jsx("td",{className:"p-4 align-middle",children:h.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-medium border ${y(E)}`,children:E})}),h.jsx("td",{className:"p-4 align-middle font-medium text-foreground",children:v(w)}),h.jsxs("td",{className:"p-4 align-middle text-center",children:[h.jsx("span",{className:"font-bold text-primary",children:w.score}),h.jsxs("span",{className:"text-muted-foreground text-sm",children:[" / ",w.totalQuestions]})]}),h.jsx("td",{className:"p-4 align-middle text-sm",children:new Date(w.completedAt).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})}),h.jsx("td",{className:"p-4 align-middle text-sm text-muted-foreground",children:new Date(w.completedAt).toLocaleDateString("vi-VN")})]},w.id)})})]})})})]})},iO=n=>{if(!n)return"Thnh vin";const e=n.toLowerCase().trim();return{admin:"Qun tr vin",quan_ly:"Qun l",lanh_dao:"Lnh o",giao_vien:"Gio vin",hoc_vien:"Hc vin",phu_huynh:"Ph huynh"}[e]||n},aO=({userProfile:n,onBack:e})=>{const[t,r]=K.useState(null),[a,l]=K.useState([]),[c,f]=K.useState([]),[g,y]=K.useState(!0),[v,w]=K.useState("grid"),[E,S]=K.useState({}),[j,D]=K.useState("");return K.useEffect(()=>{let R,L,F;return(async()=>{if(!n.id)return;const ee=ft(Re,"users",n.id),he=await bo(ee);if(!he.exists()){y(!1);return}const C=he.data().courseId;if(!C){y(!1);return}const I=ft(Re,"courses",C);R=Ll(I,k=>{if(k.exists()){const U={id:k.id,...k.data()};if(r(U),U.licenseId&&Mn(async()=>{const{fetchLicenses:P}=await Promise.resolve().then(()=>DS);return{fetchLicenses:P}},void 0).then(({fetchLicenses:P})=>{P().then(H=>{const A=H.find(me=>me.id===U.licenseId);A&&D(A.name)})}),L&&L(),U.teacherIds&&U.teacherIds.length>0)try{const P=[...new Set(U.teacherIds.filter(H=>H&&H.trim()!==""))].slice(0,10);if(P.length>0){const H=qt(wt(Re,"users"),hn(Ff(),"in",P));L=Ll(H,A=>{l(A.docs.map(me=>{const xe=me.data();return{uid:me.id,...xe,photoURL:xe.photoURL||va(xe.role)}}))})}else l([])}catch(P){console.error("Error creating teacher query:",P),l([])}else l([]);if(F)y(!1);else{const P=qt(wt(Re,"users"),hn("courseId","==",C),hn("role","==","hoc_vien"));F=Ll(P,async H=>{const A=H.docs.map(xe=>{const V=xe.data();return{uid:xe.id,...V,photoURL:V.photoURL||va(V.role)}});f(A);const me={};await Promise.all(A.map(async xe=>{try{const V=await bf(xe.uid);if(V&&V.length>0){const le=V[0];me[xe.uid]={type:le.quizTitle||le.type||"Bi thi",time:le.completedAt?le.completedAt.toLocaleString("vi-VN"):"--",score:`${le.score}/${le.totalQuestions} cu`}}else me[xe.uid]={type:"--",time:"--",score:"--"}}catch(V){console.error(`Error fetching history for ${xe.uid}`,V),me[xe.uid]={type:"Li",time:"--",score:"--"}}})),S(me),y(!1)})}}else r(null),y(!1)})})(),()=>{R&&R(),L&&L(),F&&F()}},[n.id]),g?h.jsx("div",{className:"flex justify-center items-center h-screen",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600"})}):t?h.jsxs("div",{className:"w-full max-w-7xl mx-auto p-4 animate-slide-in-right",children:[h.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[h.jsxs("div",{children:[h.jsxs("button",{onClick:e,className:"flex items-center gap-2 text-sm text-gray-500 hover:text-blue-600 mb-2 transition-colors font-medium",children:[h.jsx(vu,{})," Quay li Dashboard"]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-2 rounded-lg",children:h.jsx(ho,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-cyan-500",children:t.name}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-0.5",children:t.description||"Cha c m t"}),j&&h.jsxs("div",{className:"mt-2 inline-flex items-center gap-1.5 bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-xs font-bold border border-yellow-200",children:[h.jsx(_f,{}),h.jsxs("span",{children:["Chng ch: ",j]})]})]})]})]}),h.jsxs("div",{className:"flex gap-4",children:[h.jsxs("div",{className:"bg-white dark:bg-slate-800 px-4 py-2 rounded-xl shadow-sm border border-gray-100 dark:border-slate-700 flex items-center gap-3",children:[h.jsx("div",{className:"bg-green-100 p-2 rounded-full text-green-600",children:h.jsx(wu,{})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-xs text-gray-500",children:"Gio vin"}),h.jsx("p",{className:"font-bold text-lg",children:a.length})]})]}),h.jsxs("div",{className:"bg-white dark:bg-slate-800 px-4 py-2 rounded-xl shadow-sm border border-gray-100 dark:border-slate-700 flex items-center gap-3",children:[h.jsx("div",{className:"bg-blue-100 p-2 rounded-full text-blue-600",children:h.jsx(Lu,{})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-xs text-gray-500",children:"Hc vin"}),h.jsx("p",{className:"font-bold text-lg",children:c.length})]})]})]})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[h.jsx("div",{className:"lg:col-span-1 space-y-6",children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200 dark:border-slate-700 p-5 sticky top-20",children:[h.jsxs("h3",{className:"font-bold text-lg mb-4 flex items-center gap-2 text-gray-800 dark:text-white border-b pb-3 border-gray-100 dark:border-slate-700",children:[h.jsx(wu,{className:"text-green-500"})," i ng Gio vin"]}),h.jsxs("div",{className:"space-y-3",children:[a.map(R=>h.jsxs("div",{className:"flex items-center gap-3 p-2 hover:bg-gray-50 dark:hover:bg-slate-700/50 rounded-lg transition-colors group cursor-pointer",children:[h.jsxs("div",{className:"relative",children:[h.jsx("img",{src:R.photoURL||`https://ui-avatars.com/api/?name=${encodeURIComponent(R.fullName)}&background=random`,alt:R.fullName,className:"w-10 h-10 rounded-full object-cover border border-gray-200 dark:border-slate-600 group-hover:scale-105 transition-transform"}),t.headTeacherId===R.uid&&h.jsx("div",{className:"absolute -top-1 -right-1 bg-yellow-400 text-white rounded-full p-0.5 border-2 border-white",children:h.jsx(_f,{size:10})})]}),h.jsxs("div",{className:"min-w-0 flex-1",children:[h.jsx("p",{className:"font-medium text-sm text-gray-900 dark:text-gray-100 truncate",children:R.fullName}),h.jsx("p",{className:"text-[11px] text-gray-400",children:iO(R.role)}),t.headTeacherId===R.uid&&h.jsx("span",{className:"inline-flex items-center text-[10px] font-bold text-yellow-600",children:" GV Ch Nhim"})]})]},R.uid)),a.length===0&&h.jsx("p",{className:"text-sm text-gray-500 italic text-center py-4",children:"Cha c thng tin gio vin."})]})]})}),h.jsx("div",{className:"lg:col-span-3",children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200 dark:border-slate-700 p-6 min-h-[500px]",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[h.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-700 rounded-lg p-1",children:[h.jsx("button",{onClick:()=>w("grid"),className:`p-1.5 rounded ${v==="grid"?"bg-white dark:bg-slate-600 shadow text-blue-600":"text-gray-500 hover:text-blue-500"}`,title:"Dng li",children:h.jsx(UT,{})}),h.jsx("button",{onClick:()=>w("list"),className:`p-1.5 rounded ${v==="list"?"bg-white dark:bg-slate-600 shadow text-blue-600":"text-gray-500 hover:text-blue-500"}`,title:"Dng danh sch",children:h.jsx(LT,{})})]}),h.jsxs("span",{className:"text-sm px-2 py-0.5 bg-blue-100 text-blue-700 rounded-full font-medium",children:[c.length," thnh vin"]})]}),c.length===0?h.jsxs("div",{className:"text-center py-20 flex flex-col items-center",children:[h.jsx("div",{className:"bg-gray-100 dark:bg-slate-700 p-6 rounded-full mb-4",children:h.jsx(Lu,{className:"text-gray-300 w-12 h-12"})}),h.jsx("p",{className:"text-gray-500 font-medium",children:"Lp cha c hc vin no khc."})]}):v==="grid"?h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-5",children:c.map(R=>h.jsxs("div",{className:"bg-gray-50 dark:bg-slate-700/30 rounded-xl p-4 border border-gray-100 dark:border-slate-700 hover:shadow-md hover:border-blue-200 dark:hover:border-blue-500/30 transition-all duration-300 group relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-gradient-to-bl from-blue-100 to-transparent -mr-8 -mt-8 rounded-full opacity-50 group-hover:scale-150 transition-transform"}),h.jsxs("div",{className:"flex items-start gap-4 relative z-10",children:[h.jsxs("div",{className:"relative",children:[h.jsx("img",{src:R.photoURL||`https://ui-avatars.com/api/?name=${encodeURIComponent(R.fullName)}&background=random`,alt:R.fullName,className:"w-14 h-14 rounded-full object-cover border-2 border-white dark:border-slate-600 shadow-sm group-hover:border-blue-500 transition-colors"}),h.jsx("div",{className:"absolute bottom-0 right-0 w-3.5 h-3.5 bg-green-500 border-2 border-white rounded-full"})]}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("h4",{className:"font-bold text-gray-900 dark:text-gray-100 truncate group-hover:text-blue-600 transition-colors text-base",children:R.fullName}),h.jsxs("div",{className:"space-y-1.5 mt-2",children:[h.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1.5 bg-white dark:bg-slate-800 px-2 py-1 rounded border border-gray-100 dark:border-slate-600 w-fit",children:[h.jsx("span",{children:""})," ",R.birthDate||"--/--"]}),h.jsxs("p",{className:"text-xs text-gray-500 truncate flex items-center gap-1.5",title:R.address,children:[h.jsx("span",{children:""})," ",R.address||"Cha cp nht"]})]}),R.uid===n.id&&h.jsx("div",{className:"mt-2",children:h.jsx("span",{className:"text-[10px] font-bold text-teal-600 bg-teal-50 border border-teal-100 px-2 py-0.5 rounded-full",children:"L ti"})})]})]})]},R.uid))}):h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full text-sm text-left",children:[h.jsx("thead",{className:"text-xs text-gray-500 uppercase bg-gray-50 dark:bg-slate-700 dark:text-gray-300",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-4 py-3 rounded-l-lg",children:"Hc vin"}),h.jsx("th",{className:"px-4 py-3",children:"Ngy sinh"}),h.jsx("th",{className:"px-4 py-3",children:"Bi lm gn nht"}),h.jsx("th",{className:"px-4 py-3",children:"Thi gian"}),h.jsx("th",{className:"px-4 py-3 rounded-r-lg",children:"im"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-slate-700",children:c.map(R=>{const L=E[R.uid]||{type:"--",time:"--",score:"--"};return h.jsxs("tr",{className:"bg-white dark:bg-slate-800 hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors",children:[h.jsxs("td",{className:"px-4 py-3 font-medium text-gray-900 dark:text-white flex items-center gap-3",children:[h.jsx("img",{src:R.photoURL||`https://ui-avatars.com/api/?name=${encodeURIComponent(R.fullName)}`,className:"w-8 h-8 rounded-full border border-gray-200"}),h.jsxs("div",{children:[h.jsx("p",{children:R.fullName}),R.uid===n.id&&h.jsx("span",{className:"text-[10px] font-bold text-teal-600 border border-teal-100 bg-teal-50 px-1 rounded",children:"Ti"})]})]}),h.jsx("td",{className:"px-4 py-3 text-gray-500",children:R.birthDate||"--"}),h.jsx("td",{className:"px-4 py-3",children:h.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold
                                                        ${L.type.includes("n")?"bg-blue-100 text-blue-700":L.type.includes("Th")?"bg-purple-100 text-purple-700":L.type==="--"?"bg-gray-100 text-gray-500":"bg-red-100 text-red-700"}`,children:L.type})}),h.jsx("td",{className:"px-4 py-3 text-gray-500",children:L.time}),h.jsx("td",{className:"px-4 py-3 font-bold text-teal-600",children:L.score})]},R.uid)})})]})})]})})]})]}):h.jsxs("div",{className:"w-full max-w-5xl mx-auto p-4 animate-slide-in-right",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-3 bg-clip-text text-transparent bg-gradient-to-r from-teal-600 to-emerald-600",children:[h.jsx(ho,{className:"text-teal-600"})," Lp Ca Ti"]}),h.jsx("button",{onClick:e,className:"bg-gray-200 dark:bg-slate-700 text-gray-800 dark:text-gray-200 px-4 py-2 rounded-lg hover:bg-gray-300 dark:hover:bg-slate-600 transition-colors",children:"Quay li"})]}),h.jsx("div",{className:"text-center p-12 bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700 shadow-sm",children:h.jsx("p",{className:"text-gray-500",children:"Bn cha c phn lp."})})]})},oO=n=>{switch(n){case"admin":return"Qun tr vin";case"lanh_dao":return"Lnh o";case"quan_ly":return"Qun l";case"giao_vien":return"Gio vin";case"hoc_vien":return"Hc vin";default:return n}},xp=n=>n==="admin"?10:n==="lanh_dao"?5:n==="quan_ly"?2:n==="giao_vien"?1:0,Ar=n=>(n||"").toLowerCase(),lO=({userProfile:n,onBack:e})=>{var kt,vi;const[t,r]=K.useState([]),[a,l]=K.useState(null),[c,f]=K.useState(!0),[g,y]=K.useState({}),[v,w]=K.useState(!0),[E,S]=K.useState([]),[j,D]=K.useState([]),[R,L]=K.useState([]),[F,B]=K.useState([]),[ee,he]=K.useState({}),[ue,C]=K.useState(!1),[I,k]=K.useState(!1),[U,P]=K.useState(""),[H,A]=K.useState(""),[me,xe]=K.useState(!1),[V,le]=K.useState(!1),[_e,De]=K.useState(!1),[$e,z]=K.useState(null),[ne,W]=K.useState([]),[ie,de]=K.useState(!1),[Te,Ie]=K.useState({}),[Je,nt]=K.useState(!1),[Me,mt]=K.useState(null),[Rn,rs]=K.useState(!1),[Ze,Cn]=K.useState(!1),[zs,cr]=K.useState(!1),[fi,jt]=K.useState(""),[Lt,qs]=K.useState(""),[Aa,jo]=K.useState(!1),[bn,As]=K.useState(!1),[Hs,Na]=K.useState(null),[$s,ko]=K.useState(""),[Ra,Ca]=K.useState(""),[Fs,is]=K.useState("system"),[$t,Kn]=K.useState(""),[At,Ia]=K.useState(!1),[ur,ja]=K.useState("list"),[In,Lr]=K.useState([]),[Vt,Qn]=K.useState(!1),[fn,as]=K.useState(null),[mi,ka]=K.useState(""),[zn,hr]=K.useState(""),[dr,fr]=K.useState(""),[gi,pi]=K.useState(""),mr=xp(n.role)>=2,os=["admin","quan_ly","lanh_dao","giao_vien"].includes(n.role),Oo=xp(n.role)>=2,ls=xp(n.role)>=2,cs=O=>O.roomId?"Thi Trc Tuyn":O.quizId==="exam-quiz"||O.quizId==="thithu2"||O.type==="Thi th"||O.quizTitle&&O.quizTitle.includes("Thi th")?"Thi th":"n tp",Ut=O=>{switch(O){case"Thi Trc Tuyn":return"bg-red-100 text-red-800 border-red-200";case"Thi th":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-blue-100 text-blue-800 border-blue-200"}},Xt=O=>{if(O.roomId&&Te[O.roomId]){const ce=Te[O.roomId];return`Phng thi ${ce.name} / ${ce.course_name||"T do"} / ${ce.license_name||""}`}return O.quizTitle||(O.roomId?`Phng thi ${O.roomId}`:O.type)};K.useEffect(()=>{(async()=>{try{const ce=qt(wt(Re,"courses")),ze=(await _n(ce)).docs.map(Nt=>({id:Nt.id,...Nt.data()}));r(ze);const qe=new Set(ze.map(Nt=>Nt.headTeacherId).filter(Boolean)),ln={};for(const Nt of Array.from(qe))if(Nt)try{const Ot=await bo(ft(Re,"users",Nt));Ot.exists()&&(ln[Nt]=Ot.data().fullName)}catch{}y(ln)}catch(ce){console.error(ce)}finally{f(!1)}})(),Mn(async()=>{const{fetchLicenses:ce}=await Promise.resolve().then(()=>DS);return{fetchLicenses:ce}},void 0).then(({fetchLicenses:ce})=>{ce().then(Lr).catch(console.error)})},[n]),K.useEffect(()=>{if(!a)return;let O,ce;if(a.teacherIds&&a.teacherIds.length>0)try{const ze=[...new Set(a.teacherIds.filter(qe=>qe&&qe.trim()!==""))].slice(0,10);if(ze.length>0){const qe=qt(wt(Re,"users"),hn(Ff(),"in",ze));O=Ll(qe,ln=>{D(ln.docs.map(Nt=>{const Ot=Nt.data();return{uid:Nt.id,...Ot,photoURL:Ot.photoURL||va(Ot.role)}}))})}else D([])}catch(ze){console.error("Teacher fetch error:",ze),D([])}else D([]);const Se=qt(wt(Re,"users"),hn("courseId","==",a.id));return ce=Ll(Se,async ze=>{const qe=ze.docs.map(Nt=>{const Ot=Nt.data();return{uid:Nt.id,...Ot,photoURL:Ot.photoURL||va(Ot.role)}});S(qe);const ln={};await Promise.all(qe.map(async Nt=>{try{const Ot=await bf(Nt.uid);if(Ot&&Ot.length>0){const Ft=Ot[0];ln[Nt.uid]={type:Ft.quizTitle||Ft.type||"Bi thi",time:Ft.completedAt?Ft.completedAt.toLocaleString("vi-VN"):"--",score:`${Ft.score}/${Ft.totalQuestions} cu`,rawDate:Ft.completedAt}}else ln[Nt.uid]={type:"--",time:"--",score:"--"}}catch{ln[Nt.uid]={type:"Li",time:"--",score:"--"}}})),he(ln)}),()=>{O&&O(),ce&&ce()}},[a]),K.useEffect(()=>{ue&&(async()=>{const ce=qt(wt(Re,"users"),hn("role","in",["hoc_vien"])),ze=(await _n(ce)).docs.map(qe=>({uid:qe.id,...qe.data()}));L(ze.filter(qe=>qe.courseId!==(a==null?void 0:a.id)||!qe.courseId))})()},[ue,a]),K.useEffect(()=>{I&&(async()=>{const ce=qt(wt(Re,"users"),hn("role","in",["giao_vien","admin","quan_ly","lanh_dao"])),ze=(await _n(ce)).docs.map(qe=>({uid:qe.id,...qe.data()}));B(ze.filter(qe=>!((a==null?void 0:a.teacherIds)||[]).includes(qe.uid)))})()},[I,a]),K.useEffect(()=>{_e&&$e&&(de(!0),(async()=>{const ce=await bf($e.uid);ce.sort((ze,qe)=>qe.completedAt.getTime()-ze.completedAt.getTime()),W(ce);const Se=Array.from(new Set(ce.filter(ze=>ze.roomId).map(ze=>ze.roomId)));if(Se.length>0){const ze={};await Promise.all(Se.map(async qe=>{try{const ln=await bo(ft(Re,"exam_rooms",qe));ln.exists()&&(ze[qe]=ln.data())}catch{}})),Ie(ze)}de(!1)})())},[_e,$e]);const Ns=async O=>{O.preventDefault();try{await ju(wt(Re,"courses"),{name:fi,description:Lt,teacherIds:[],createdAt:Wu(),createdBy:n.id,licenseId:gi}),cr(!1),jt(""),qs(""),pi(""),window.location.reload()}catch(ce){console.error(ce)}},yi=async O=>{if(O.preventDefault(),!!fn)try{if(await vs(ft(Re,"courses",fn.id),{name:mi,description:zn,licenseId:dr}),fn.licenseId!==dr){const ce=qt(wt(Re,"users"),hn("courseId","==",fn.id)),ze=(await _n(ce)).docs.map(qe=>vs(ft(Re,"users",qe.id),{defaultLicenseId:dr||null}));await Promise.all(ze)}alert("Cp nht lp hc thnh cng!"),r(ce=>ce.map(Se=>Se.id===fn.id?{...Se,name:mi,description:zn,licenseId:dr}:Se)),(a==null?void 0:a.id)===fn.id&&l(ce=>ce?{...ce,name:mi,description:zn,licenseId:dr}:null),Qn(!1)}catch(ce){console.error(ce),alert("Li khi cp nht lp.")}},cc=async O=>{if(confirm("Bn c chc chn mun xa lp ny? Hnh ng ny khng th hon tc!"))try{await Mn(async()=>{const{deleteDoc:ce}=await Promise.resolve().then(()=>ku);return{deleteDoc:ce}},void 0).then(({deleteDoc:ce})=>ce(ft(Re,"courses",O))),r(ce=>ce.filter(Se=>Se.id!==O)),alert(" xa lp hc!"),(a==null?void 0:a.id)===O&&l(null)}catch(ce){console.error(ce),alert("Li khi xa lp.")}},Do=(O,ce)=>{ce.stopPropagation(),as(O),ka(O.name),hr(O.description||""),fr(O.licenseId||""),Qn(!0)},Mo=async O=>{if(!a)return;const ce=R.find(Se=>Se.uid===O);if(ce&&ce.courseId){alert(`Hc vin ny ang hc lp ${ce.courseName||ce.courseId}. Vui lng xa khi lp c trc khi thm vo lp mi.`);return}xe(!0);try{await vs(ft(Re,"users",O),{courseId:a.id,courseName:a.name,defaultLicenseId:a.licenseId||null}),L(Se=>Se.filter(ze=>ze.uid!==O)),alert(` thm hc vin vo lp ${a.name}`)}catch(Se){console.error(Se),alert("Li khi thm hc vin.")}finally{xe(!1)}},Rs=async O=>{if(a){le(!0);try{const ce=ft(Re,"courses",a.id);await vs(ce,{teacherIds:IE(O),...Aa?{headTeacherId:O}:{}}),B(Se=>Se.filter(ze=>ze.uid!==O)),Aa&&l(Se=>Se?{...Se,headTeacherId:O}:null),l(Se=>Se?{...Se,teacherIds:[...Se.teacherIds||[],O]}:null)}catch(ce){console.error(ce)}finally{le(!1)}}},_i=async O=>{if(a&&confirm("Bn c chc chn xo gio vin ny khi lp?"))try{const ce=ft(Re,"courses",a.id);await vs(ce,{teacherIds:jE(O),...a.headTeacherId===O?{headTeacherId:null}:{}}),l(Se=>Se?{...Se,teacherIds:(Se.teacherIds||[]).filter(ze=>ze!==O),headTeacherId:Se.headTeacherId===O?void 0:Se.headTeacherId}:null)}catch(ce){console.error("Error removing teacher:",ce)}},us=async O=>{if(confirm("Bn c chc chn mun xa hc vin ny khi lp?"))try{await vs(ft(Re,"users",O),{courseId:null,courseName:null})}catch(ce){console.error(ce)}},jn=(O,ce,Se)=>{Na({type:O,id:ce,name:Se}),ko(""),Ca(""),As(!0)},qn=async O=>{if(O.preventDefault(),!(!Hs||!n.id)){Ia(!0);try{const ce=$t?new Date($t):null,Se=Fs==="special"||Fs==="attention",ze=Se?"all":Hs.type,qe=Se?null:Hs.id;await kT($s,Ra,Fs,ze,qe,n.id,n.full_name,ce),alert("Gi thng bo thnh cng!"),As(!1)}catch(ce){console.error(ce),alert("Li khi gi thng bo. C th thiu Index Firestore.")}finally{Ia(!1)}}},Cs=async()=>{if(Me){rs(!0);try{const O=ce=>ce===void 0?null:ce;await vs(ft(Re,"users",Me.uid),{fullName:O(Me.fullName),birthDate:O(Me.birthDate),email:O(Me.email),phoneNumber:O(Me.phoneNumber),address:O(Me.address),cccd:O(Me.cccd),cccdDate:O(Me.cccdDate),cccdPlace:O(Me.cccdPlace),class:O(Me.class),courseCode:O(Me.courseCode),role:O(Me.role)}),alert(" cp nht thng tin hc vin!"),nt(!1),Cn(!1)}catch(O){console.error("Error updating user:",O),alert("Li khi cp nht thng tin.")}finally{rs(!1)}}};return a?h.jsxs("div",{className:"w-full max-w-7xl mx-auto p-4 animate-slide-in-right relative",children:[h.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-cyan-600 rounded-2xl p-6 mb-8 text-white shadow-lg relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-20",children:h.jsx(ho,{className:"w-32 h-32 transform rotate-12"})}),h.jsxs("div",{className:"relative z-10",children:[h.jsxs("button",{onClick:e,className:"absolute top-0 left-0 bg-white/20 hover:bg-white/30 text-white px-3 py-1 rounded text-sm transition flex items-center gap-1 backdrop-blur-sm",children:[h.jsx(vu,{})," Quay li Dashboard"]}),h.jsxs("div",{className:"mt-8",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[h.jsx("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-md",children:h.jsx(Xw,{className:"w-8 h-8"})}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-3xl font-bold",children:a.name}),h.jsx("p",{className:"opacity-90",children:a.description||"Cha c m t"})]})]}),a.licenseId&&h.jsxs("div",{className:"inline-flex items-center gap-2 bg-yellow-400 text-black px-3 py-1 rounded-full text-sm font-bold shadow-sm mt-2",children:[h.jsx(_f,{}),((kt=In.find(O=>O.id===a.licenseId))==null?void 0:kt.name)||a.licenseId]})]})]})]}),ue&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:()=>C(!1),children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-4xl p-6 h-[80vh] flex flex-col relative",onClick:O=>O.stopPropagation(),children:[h.jsx("button",{onClick:()=>C(!1),className:"absolute top-4 right-4 bg-gray-100 dark:bg-slate-700 p-2 rounded-full border border-gray-200 dark:border-slate-600",children:h.jsx(Ml,{})}),h.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[h.jsxs("span",{className:"text-gray-800 dark:text-white",children:["Thm Hc Vin vo ",a.name]}),a.licenseId&&h.jsxs("span",{className:"text-xs px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full border border-yellow-200",children:["Hng: ",((vi=In.find(O=>O.id===a.licenseId))==null?void 0:vi.name)||a.licenseId]})]}),h.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[h.jsxs("div",{className:"relative flex-1",children:[h.jsx(o0,{className:"absolute left-3 top-3 text-gray-400"}),h.jsx("input",{className:"w-full pl-10 pr-4 py-2 border rounded-lg dark:bg-slate-700 focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Tm kim tn, email, st...",value:U,onChange:O=>P(O.target.value)})]}),h.jsxs("div",{className:"flex items-center gap-2 p-2 bg-blue-50 dark:bg-blue-900/30 rounded-lg border border-blue-100 dark:border-blue-800 px-4 cursor-pointer",onClick:()=>w(!v),children:[h.jsx("input",{type:"checkbox",checked:v,onChange:O=>w(O.target.checked),className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500"}),h.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-200 cursor-pointer select-none",children:"Ch hin hc vin cha c lp"})]})]}),h.jsxs("div",{className:"grid grid-cols-12 gap-2 text-xs font-bold text-gray-500 uppercase px-3 pb-2 border-b border-gray-100 dark:border-slate-700",children:[h.jsx("div",{className:"col-span-4",children:"Hc vin"}),h.jsx("div",{className:"col-span-2",children:"Ngy sinh/ST"}),h.jsx("div",{className:"col-span-3",children:"a ch/Qu qun"}),h.jsx("div",{className:"col-span-2",children:"Lp hin ti"}),h.jsx("div",{className:"col-span-1 text-center",children:"Thao tc"})]}),h.jsx("div",{className:"flex-1 overflow-y-auto pr-2 space-y-2 mt-2",children:R.filter(O=>{const ce=Ar(O.fullName).includes(Ar(U))||Ar(O.email).includes(Ar(U))||Ar(O.phoneNumber).includes(Ar(U)),Se=v?!O.courseId:!0;return ce&&Se}).map(O=>h.jsxs("div",{className:"grid grid-cols-12 gap-2 items-center p-3 bg-gray-50 dark:bg-slate-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-700 transition border border-transparent hover:border-gray-200 dark:hover:border-slate-600",children:[h.jsxs("div",{className:"col-span-4 flex items-center gap-3 overflow-hidden",children:[h.jsx("img",{src:O.photoURL||`https://ui-avatars.com/api/?name=${encodeURIComponent(O.fullName)}`,className:"w-10 h-10 rounded-full border border-gray-200 flex-shrink-0"}),h.jsxs("div",{className:"min-w-0",children:[h.jsx("p",{className:"font-bold text-sm truncate text-gray-900 dark:text-white",title:O.fullName,children:O.fullName}),h.jsx("p",{className:"text-xs text-gray-500 truncate",title:O.email,children:O.email})]})]}),h.jsxs("div",{className:"col-span-2 text-sm text-gray-700 dark:text-gray-300",children:[h.jsx("div",{className:"text-xs text-gray-500",children:O.birthDate||"--/--/----"}),h.jsx("div",{className:"font-medium",children:O.phoneNumber||"---"})]}),h.jsx("div",{className:"col-span-3 text-sm text-gray-700 dark:text-gray-300",children:h.jsx("p",{className:"line-clamp-2 text-xs",title:O.address||O.cccdPlace,children:O.address||O.cccdPlace||"---"})}),h.jsx("div",{className:"col-span-2 text-sm",children:O.courseName?h.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded-md text-xs font-semibold border border-yellow-200 truncate block text-center",title:O.courseName,children:O.courseName}):h.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-md text-xs font-semibold border border-green-200 block text-center",children:"Cha c"})}),h.jsx("div",{className:"col-span-1 flex justify-center",children:h.jsx("button",{onClick:()=>Mo(O.uid),disabled:me,className:"bg-blue-600 text-white p-2 rounded hover:bg-blue-700 disabled:opacity-50 shadow-sm transition-transform active:scale-95",title:"Thm vo lp",children:h.jsx(Dl,{})})})]},O.uid))})]})}),I&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:()=>k(!1),children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-2xl p-6 h-[80vh] flex flex-col relative",onClick:O=>O.stopPropagation(),children:[h.jsx("button",{onClick:()=>k(!1),className:"absolute top-4 right-4 bg-gray-100 p-2 rounded-full",children:h.jsx(Ml,{})}),h.jsx("h2",{className:"text-xl font-bold mb-4",children:"Thm Gio Vin"}),h.jsxs("div",{className:"flex items-center gap-2 p-2 bg-yellow-50 rounded mb-4",children:[h.jsx("input",{type:"checkbox",checked:Aa,onChange:O=>jo(O.target.checked),className:"w-5 h-5 text-yellow-600"}),h.jsx("label",{className:"text-sm font-medium",children:"t lm GVCN"})]}),h.jsxs("div",{className:"relative mb-4",children:[h.jsx(o0,{className:"absolute left-3 top-3 text-gray-400"}),h.jsx("input",{className:"w-full pl-10 pr-4 py-2 border rounded dark:bg-slate-700",placeholder:"Tm kim gio vin...",value:H,onChange:O=>A(O.target.value)})]}),h.jsx("div",{className:"flex-1 overflow-y-auto pr-2 space-y-2",children:F.filter(O=>Ar(O.fullName).includes(Ar(H))||Ar(O.email).includes(Ar(H))).map(O=>h.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 dark:bg-slate-700/50 rounded-lg hover:bg-gray-100 transition",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("img",{src:O.photoURL||`https://ui-avatars.com/api/?name=${encodeURIComponent(O.fullName)}`,className:"w-10 h-10 rounded-full"}),h.jsxs("div",{children:[h.jsx("p",{className:"font-bold text-sm",children:O.fullName}),h.jsx("p",{className:"text-xs text-gray-500",children:O.email})]})]}),h.jsx("button",{onClick:()=>Rs(O.uid),disabled:V,className:"bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700 disabled:opacity-50 text-sm",children:"Thm"})]},O.uid))})]})}),_e&&$e&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:()=>De(!1),children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-5xl p-6 h-[80vh] flex flex-col relative",onClick:O=>O.stopPropagation(),children:[h.jsx("button",{onClick:()=>De(!1),className:"absolute top-4 right-4 bg-gray-100 dark:bg-slate-700 p-2 rounded-full",children:h.jsx(Ml,{})}),h.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[h.jsx(bu,{className:"text-blue-500"})," Lch s lm bi: ",h.jsx("span",{className:"text-blue-600",children:$e.fullName})]}),h.jsx("div",{className:"flex-1 overflow-y-auto",children:ie?h.jsx("div",{className:"p-10 text-center text-gray-500",children:"ang ti lch s..."}):ne.length===0?h.jsx("div",{className:"p-10 text-center text-gray-500 italic",children:"Hc vin ny cha lm bi thi no."}):h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full text-left text-sm border-collapse",children:[h.jsx("thead",{className:"bg-gray-50 dark:bg-slate-700 sticky top-0 text-gray-500 uppercase text-xs",children:h.jsxs("tr",{children:[h.jsx("th",{className:"p-4 font-semibold",children:"Loi"}),h.jsx("th",{className:"p-4 font-semibold",children:"Bi thi"}),h.jsx("th",{className:"p-4 font-semibold text-center",children:"im s"}),h.jsx("th",{className:"p-4 font-semibold",children:"Gi np"}),h.jsx("th",{className:"p-4 font-semibold",children:"Ngy np"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-slate-700",children:ne.map(O=>{const ce=cs(O);return h.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors",children:[h.jsx("td",{className:"p-4 align-middle",children:h.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-bold border ${Ut(ce)}`,children:ce})}),h.jsx("td",{className:"p-4 align-middle font-medium text-gray-900 dark:text-gray-100",children:Xt(O)}),h.jsxs("td",{className:"p-4 align-middle text-center",children:[h.jsx("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:O.score}),h.jsxs("span",{className:"text-gray-400 text-xs",children:[" / ",O.totalQuestions]})]}),h.jsx("td",{className:"p-4 align-middle text-gray-500",children:new Date(O.completedAt).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})}),h.jsx("td",{className:"p-4 align-middle text-gray-500",children:new Date(O.completedAt).toLocaleDateString("vi-VN")})]},O.id)})})]})})})]})}),Je&&Me&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:()=>nt(!1),children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-4xl p-6 relative animate-scale-up max-h-[90vh] overflow-y-auto",onClick:O=>O.stopPropagation(),children:[h.jsx("button",{onClick:()=>{nt(!1),Cn(!1)},className:"absolute top-4 right-4 bg-gray-100 dark:bg-slate-700 p-2 rounded-full hover:bg-gray-200 transition",children:h.jsx(Ml,{})}),h.jsx("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-2 text-blue-700 dark:text-blue-400",children:Ze?h.jsxs(h.Fragment,{children:[h.jsx(Cl,{className:"text-yellow-500"})," Cp Nht Thng Tin"]}):h.jsxs(h.Fragment,{children:[h.jsx(wu,{className:"text-blue-500"})," H S Hc Vin"]})}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"H v Tn"}),h.jsx("input",{className:`w-full p-2.5 border rounded-lg dark:bg-slate-700 ${Ze?"focus:ring-2 focus:ring-blue-500":"bg-gray-50 border-transparent cursor-default"}`,value:Me.fullName,readOnly:!Ze,onChange:O=>mt({...Me,fullName:O.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"Ngy sinh"}),h.jsx("input",{type:"date",className:`w-full p-2.5 border rounded-lg dark:bg-slate-700 ${Ze?"focus:ring-2 focus:ring-blue-500":"bg-gray-50 border-transparent cursor-default"}`,value:Me.birthDate||"",readOnly:!Ze,onChange:O=>mt({...Me,birthDate:O.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"Lp hc (Kha hc)"}),h.jsx("input",{className:"w-full p-2.5 border rounded-lg dark:bg-slate-700 bg-gray-50 border-transparent cursor-default",value:Me.courseName||Me.courseCode||"--",readOnly:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"Ngy cp CCCD"}),h.jsx("input",{type:Ze?"date":"text",className:`w-full p-2.5 border rounded-lg dark:bg-slate-700 ${Ze?"focus:ring-2 focus:ring-blue-500":"bg-gray-50 border-transparent cursor-default"}`,value:Me.cccdDate||"",readOnly:!Ze,onChange:O=>mt({...Me,cccdDate:O.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"a ch"}),h.jsx("input",{className:`w-full p-2.5 border rounded-lg dark:bg-slate-700 ${Ze?"focus:ring-2 focus:ring-blue-500":"bg-gray-50 border-transparent cursor-default"}`,value:Me.address||"",readOnly:!Ze,onChange:O=>mt({...Me,address:O.target.value})})]})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"S in thoi"}),h.jsx("input",{className:`w-full p-2.5 border rounded-lg dark:bg-slate-700 ${Ze?"focus:ring-2 focus:ring-blue-500":"bg-gray-50 border-transparent cursor-default"}`,value:Me.phoneNumber||"",readOnly:!Ze,onChange:O=>mt({...Me,phoneNumber:O.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"Lp hc (t in)"}),h.jsx("input",{className:`w-full p-2.5 border rounded-lg dark:bg-slate-700 ${Ze?"focus:ring-2 focus:ring-blue-500":"bg-gray-50 border-transparent cursor-default"}`,value:Me.class||"",placeholder:"V d: Th my k2",readOnly:!Ze,onChange:O=>mt({...Me,class:O.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"S CCCD"}),h.jsx("input",{className:`w-full p-2.5 border rounded-lg dark:bg-slate-700 ${Ze?"focus:ring-2 focus:ring-blue-500":"bg-gray-50 border-transparent cursor-default"}`,value:Me.cccd||"",readOnly:!Ze,onChange:O=>mt({...Me,cccd:O.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"Ni cp"}),h.jsx("input",{className:`w-full p-2.5 border rounded-lg dark:bg-slate-700 ${Ze?"focus:ring-2 focus:ring-blue-500":"bg-gray-50 border-transparent cursor-default"}`,value:Me.cccdPlace||"",readOnly:!Ze,onChange:O=>mt({...Me,cccdPlace:O.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold mb-1 text-gray-700 dark:text-gray-300",children:"Vai tr"}),h.jsxs("select",{className:`w-full p-2.5 border rounded-lg dark:bg-slate-700 ${Ze?"focus:ring-2 focus:ring-blue-500":"bg-gray-50 border-transparent cursor-default appearance-none pointer-events-none"}`,value:Me.role,disabled:!Ze,onChange:O=>mt({...Me,role:O.target.value}),children:[h.jsx("option",{value:"hoc_vien",children:"Hc vin"}),h.jsx("option",{value:"student",children:"Hc sinh"}),h.jsx("option",{value:"teacher",children:"Gio vin"})]})]})]})]}),h.jsx("div",{className:"flex justify-end gap-3 mt-8 pt-4 border-t border-gray-100 dark:border-slate-700",children:Ze?h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>Cn(!1),className:"px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 text-gray-700 font-medium",children:"Hy b"}),h.jsxs("button",{onClick:Cs,disabled:Rn,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 shadow-lg font-medium transition-transform active:scale-95",children:[h.jsx(VT,{})," ",Rn?"ang lu...":"Lu Thay i"]})]}):h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>nt(!1),className:"px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200 text-gray-700 font-medium",children:"ng"}),h.jsxs("button",{onClick:()=>Cn(!0),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 shadow-lg font-medium transition-transform active:scale-95",children:[h.jsx(Cl,{})," Chnh sa"]})]})})]})}),bn&&Hs&&h.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>As(!1),children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl p-6 w-full max-w-md animate-scale-up",onClick:O=>O.stopPropagation(),children:[h.jsxs("h2",{className:"text-2xl font-bold mb-4 flex items-center gap-2",children:[h.jsx(Cd,{className:"text-yellow-500"})," Gi Thng Bo"]}),h.jsxs("p",{className:"text-sm text-gray-500 mb-6",children:["To: ",h.jsx("span",{className:"font-bold text-blue-600",children:Hs.name})]}),h.jsxs("form",{onSubmit:qn,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loi thng bo"}),h.jsxs("select",{className:"w-full px-4 py-2 border rounded-lg dark:bg-slate-700 outline-none focus:ring-2 focus:ring-blue-500",value:Fs,onChange:O=>is(O.target.value),children:[h.jsx("option",{value:"system",children:"Bnh thng"}),["admin","lanh_dao","quan_ly"].includes(n.role)&&h.jsxs(h.Fragment,{children:[h.jsx("option",{value:"attention",children:" Ch  (Chy ch vng)"}),h.jsx("option",{value:"special",children:" C BIT (Chy ch )"})]})]})]}),(Fs==="special"||Fs==="attention")&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hiu lc chy ch n"}),h.jsx("input",{type:"datetime-local",className:"w-full px-4 py-2 border rounded-lg dark:bg-slate-700 outline-none focus:ring-2 focus:ring-blue-500",value:$t,onChange:O=>Kn(O.target.value),required:!0}),h.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Sau thi gian ny, thng bo s ngng chy ngang mn hnh."})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tiu "}),h.jsx("input",{className:"w-full px-4 py-2 border rounded-lg dark:bg-slate-700 focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Tiu ...",value:$s,onChange:O=>ko(O.target.value),required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tin nhn"}),h.jsx("textarea",{className:"w-full px-4 py-2 border rounded-lg dark:bg-slate-700 h-24 focus:ring-2 focus:ring-blue-500 outline-none resize-none",placeholder:"Ni dung...",value:Ra,onChange:O=>Ca(O.target.value),required:!0})]}),h.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[h.jsx("button",{type:"button",onClick:()=>As(!1),className:"px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Hy"}),h.jsx("button",{type:"submit",disabled:At,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 shadow-lg font-medium",children:At?"ang gi...":"Gi Ngay"})]})]})]})}),h.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[h.jsxs("div",{children:[h.jsxs("button",{onClick:()=>l(null),className:"flex items-center gap-2 text-sm text-gray-500 hover:text-blue-600 mb-2 transition-colors font-medium",children:[h.jsx(vu,{})," Quay li danh sch"]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-2 rounded-lg",children:h.jsx(ho,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-cyan-500",children:a.name}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm mt-0.5",children:a.description})]})]})]}),h.jsx("div",{className:"flex gap-4",children:h.jsxs("button",{onClick:()=>jn("class",a.name,a.name),className:"bg-gradient-to-r from-yellow-500 to-orange-500 text-white px-4 py-2 rounded-xl shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition flex items-center gap-2 font-medium",children:[h.jsx(Cd,{})," Thng bo c lp"]})})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[h.jsx("div",{className:"lg:col-span-1 space-y-6",children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200 dark:border-slate-700 p-5 sticky top-20",children:[h.jsxs("div",{className:"flex justify-between items-center border-b pb-3 border-gray-100 dark:border-slate-700 mb-4",children:[h.jsxs("h3",{className:"font-bold text-lg flex items-center gap-2 text-gray-800 dark:text-white",children:[h.jsx(wu,{className:"text-green-500"})," Gio vin"]}),Oo&&h.jsx("button",{onClick:()=>k(!0),className:"text-green-600 hover:bg-green-50 p-1.5 rounded-full transition-colors",children:h.jsx(Dl,{size:14})})]}),h.jsxs("div",{className:"space-y-3",children:[j.map(O=>h.jsxs("div",{className:"flex items-center gap-3 p-2 hover:bg-gray-50 dark:hover:bg-slate-700/50 rounded-lg transition-colors group relative cursor-pointer",children:[h.jsxs("div",{className:"relative",children:[h.jsx("img",{src:O.photoURL||`https://ui-avatars.com/api/?name=${encodeURIComponent(O.fullName)}`,className:"w-10 h-10 rounded-full border border-gray-200"}),a.headTeacherId===O.uid&&h.jsx("div",{className:"absolute -top-1 -right-1 bg-yellow-400 text-white rounded-full p-0.5 border-2 border-white",children:h.jsx(_f,{size:10})})]}),h.jsxs("div",{className:"min-w-0 flex-1",children:[h.jsx("p",{className:"font-medium text-sm truncate text-gray-900 dark:text-gray-100",children:O.fullName}),h.jsx("p",{className:"text-[11px] text-gray-400 truncate",children:oO(O.role)}),a.headTeacherId===O.uid&&h.jsx("span",{className:"text-[10px] font-bold text-yellow-600 bg-yellow-50 px-1.5 py-0.5 rounded border border-yellow-200 mt-1 inline-block",children:"GVCN"})]}),ls&&h.jsx("button",{onClick:ce=>{ce.stopPropagation(),_i(O.uid)},className:"text-gray-400 hover:text-red-500 hover:bg-red-50 p-1.5 rounded opacity-0 group-hover:opacity-100 transition-all absolute right-2",title:"Xa gio vin",children:h.jsx(fo,{size:12})})]},O.uid)),j.length===0&&h.jsx("p",{className:"text-sm text-gray-500 italic text-center py-4",children:"Cha c gio vin."})]})]})}),h.jsx("div",{className:"lg:col-span-3",children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200 dark:border-slate-700 p-6 min-h-[500px]",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-100 dark:border-slate-700",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsxs("h3",{className:"font-bold text-xl flex items-center gap-2 text-gray-800 dark:text-white",children:[h.jsx(Lu,{className:"text-blue-500"})," Hc vin (",E.length,")"]}),h.jsxs("div",{className:"flex bg-gray-100 dark:bg-slate-700 rounded-lg p-1 ml-4",children:[h.jsx("button",{onClick:()=>ja("grid"),className:`p-1.5 rounded ${ur==="grid"?"bg-white dark:bg-slate-600 shadow text-blue-600":"text-gray-500 hover:text-blue-500"}`,title:"Dng li",children:h.jsx(UT,{})}),h.jsx("button",{onClick:()=>ja("list"),className:`p-1.5 rounded ${ur==="list"?"bg-white dark:bg-slate-600 shadow text-blue-600":"text-gray-500 hover:text-blue-500"}`,title:"Dng danh sch",children:h.jsx(LT,{})})]})]}),os&&h.jsxs("button",{onClick:()=>C(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 hover:shadow-lg transition flex items-center gap-2 text-sm font-medium",children:[h.jsx(Dl,{})," Thm Hc Vin"]})]}),ur==="grid"?h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5",children:E.map(O=>{const ce=ee[O.uid]||{score:"--"};return h.jsxs("div",{className:"bg-gray-50 dark:bg-slate-700/30 rounded-xl p-4 border border-gray-100 dark:border-slate-700 hover:shadow-md hover:border-blue-200 dark:hover:border-blue-500/30 transition-all duration-300 group relative overflow-hidden",children:[h.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-gradient-to-bl from-blue-100 to-transparent -mr-8 -mt-8 rounded-full opacity-50 group-hover:scale-150 transition-transform"}),h.jsxs("div",{className:"flex items-start gap-4 relative z-10",children:[h.jsx("div",{className:"relative",children:h.jsx("img",{src:O.photoURL||`https://ui-avatars.com/api/?name=${encodeURIComponent(O.fullName)}&background=random`,alt:O.fullName,className:"w-14 h-14 rounded-full object-cover border-2 border-white dark:border-slate-600 shadow-sm group-hover:border-blue-500 transition-colors"})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("h4",{className:"font-bold text-gray-900 dark:text-gray-100 truncate group-hover:text-blue-600 transition-colors text-base",children:O.fullName}),h.jsx("p",{className:"text-xs text-gray-500 truncate",children:O.email}),h.jsx("div",{className:"mt-2 pt-2 border-t border-gray-100 dark:border-slate-600 text-xs",children:h.jsxs("div",{className:"flex justify-between text-gray-500",children:[h.jsx("span",{children:"Kt qu mi:"}),h.jsx("span",{className:"font-bold text-teal-600",children:ce.score})]})}),h.jsxs("div",{className:"flex gap-2 mt-3 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity",children:[h.jsx("button",{onClick:()=>jn("user",O.uid,O.fullName),className:"text-yellow-600 bg-yellow-50 hover:bg-yellow-100 p-1.5 rounded text-xs flex items-center gap-1",title:"Nhn tin",children:h.jsx(Cd,{})}),h.jsx("button",{onClick:()=>{mt(O),nt(!0)},className:"text-blue-600 bg-blue-50 hover:bg-blue-100 p-1.5 rounded text-xs flex items-center gap-1",title:"Sa thng tin",children:h.jsx(Cl,{})}),h.jsx("button",{onClick:()=>{z(O),De(!0)},className:"text-purple-600 bg-purple-50 hover:bg-purple-100 p-1.5 rounded text-xs flex items-center gap-1",title:"Xem lch s",children:h.jsx(bu,{})}),os&&h.jsx("button",{onClick:()=>us(O.uid),className:"text-red-600 bg-red-50 hover:bg-red-100 p-1.5 rounded text-xs flex items-center gap-1",title:"Xa",children:h.jsx(fo,{})})]})]})]})]},O.uid)})}):h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full text-left text-sm",children:[h.jsx("thead",{className:"text-xs text-gray-500 uppercase bg-gray-50 dark:bg-slate-700 dark:text-gray-300",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-4 py-3 rounded-l-lg",children:"Hc vin"}),h.jsx("th",{className:"px-4 py-3",children:"Ngy sinh"}),h.jsx("th",{className:"px-4 py-3",children:"Bi lm gn nht"}),h.jsx("th",{className:"px-4 py-3",children:"Thi gian"}),h.jsx("th",{className:"px-4 py-3",children:"im"}),h.jsx("th",{className:"px-4 py-3 text-center rounded-r-lg",children:"Hnh ng"})]})}),h.jsxs("tbody",{className:"divide-y divide-gray-100 dark:divide-slate-700",children:[E.map(O=>{const ce=ee[O.uid]||{type:"--",time:"--",score:"--"};return h.jsxs("tr",{className:"group hover:bg-gray-50 dark:hover:bg-slate-700/30 transition-colors",children:[h.jsxs("td",{className:"px-4 py-3 font-medium text-gray-900 dark:text-white flex items-center gap-3",children:[h.jsx("img",{src:O.photoURL||`https://ui-avatars.com/api/?name=${encodeURIComponent(O.fullName)}`,className:"w-8 h-8 rounded-full border border-gray-200"}),h.jsxs("div",{children:[h.jsx("p",{children:O.fullName}),h.jsx("p",{className:"text-xs text-gray-500 font-normal",children:O.email})]})]}),h.jsx("td",{className:"px-4 py-3 text-gray-500",children:O.birthDate||"--"}),h.jsx("td",{className:"px-4 py-3",children:h.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold
                                                        ${ce.type.includes("n")?"bg-blue-100 text-blue-700":ce.type.includes("Th")?"bg-purple-100 text-purple-700":ce.type==="--"?"bg-gray-100 text-gray-500":"bg-red-100 text-red-700"}`,children:ce.type})}),h.jsx("td",{className:"px-4 py-3 text-gray-500",children:ce.time}),h.jsx("td",{className:"px-4 py-3 font-bold text-teal-600",children:ce.score}),h.jsx("td",{className:"px-4 py-3 text-center",children:h.jsxs("div",{className:"flex items-center justify-center gap-2 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity",children:[h.jsx("button",{onClick:()=>jn("user",O.uid,O.fullName),className:"text-yellow-500 hover:bg-yellow-50 p-2 rounded-lg transition",title:"Gi tin nhn",children:h.jsx(Cd,{})}),h.jsx("button",{onClick:()=>{mt(O),nt(!0)},className:"text-blue-500 hover:bg-blue-50 p-2 rounded-lg transition",title:"Sa thng tin",children:h.jsx(Cl,{})}),h.jsx("button",{onClick:()=>{z(O),De(!0)},className:"text-purple-500 hover:bg-purple-50 p-2 rounded-lg transition",title:"Xem lch s thi",children:h.jsx(bu,{})}),os&&h.jsx("button",{onClick:()=>us(O.uid),className:"text-red-400 hover:text-red-600 hover:bg-red-50 p-2 rounded-lg transition",title:"Xa khi lp",children:h.jsx(fo,{})})]})})]},O.uid)}),E.length===0&&h.jsx("tr",{children:h.jsx("td",{colSpan:6,className:"text-center py-10 text-gray-400 italic",children:"Lp cha c hc vin no."})})]})]})})]})})]})]}):h.jsxs("div",{className:"w-full max-w-6xl mx-auto p-4 animate-slide-in-right relative",children:[zs&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-md p-6",children:[h.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800 dark:text-white",children:"To Lp Hc Mi"}),h.jsxs("form",{onSubmit:Ns,className:"space-y-4",children:[h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",placeholder:"Tn lp",value:fi,onChange:O=>jt(O.target.value),required:!0}),h.jsxs("div",{className:"mb-2",children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"Hng bng (Mc nh)"}),h.jsxs("select",{className:"w-full p-2 border rounded dark:bg-slate-700",value:gi,onChange:O=>pi(O.target.value),children:[h.jsx("option",{value:"",children:"-- Chn hng bng --"}),In.map(O=>h.jsx("option",{value:O.id,children:O.name},O.id))]}),h.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Hc vin s t ng c gn hng bng ny khi n tp."})]}),h.jsx("textarea",{className:"w-full p-2 border rounded dark:bg-slate-700",placeholder:"M t",value:Lt,onChange:O=>qs(O.target.value)}),h.jsxs("div",{className:"flex justify-end gap-2",children:[h.jsx("button",{type:"button",onClick:()=>cr(!1),className:"px-4 py-2 bg-gray-200 rounded",children:"Hy"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-teal-600 text-white rounded",children:"To"})]})]})]})}),Vt&&fn&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-md p-6",children:[h.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800 dark:text-white",children:"Chnh Sa Lp Hc"}),h.jsxs("form",{onSubmit:yi,className:"space-y-4",children:[h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",placeholder:"Tn lp",value:mi,onChange:O=>ka(O.target.value),required:!0}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"Hng bng mc nh"}),h.jsxs("select",{className:"w-full p-2 border rounded dark:bg-slate-700",value:dr,onChange:O=>fr(O.target.value),children:[h.jsx("option",{value:"",children:"-- Khng chn --"}),In.map(O=>h.jsx("option",{value:O.id,children:O.name},O.id))]})]}),h.jsx("textarea",{className:"w-full p-2 border rounded dark:bg-slate-700",placeholder:"M t",value:zn,onChange:O=>hr(O.target.value)}),h.jsxs("div",{className:"flex justify-end gap-2",children:[h.jsx("button",{type:"button",onClick:()=>Qn(!1),className:"px-4 py-2 bg-gray-200 rounded",children:"Hy"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Lu Thay i"})]})]})]})}),h.jsxs("div",{className:"flex justify-between items-center mb-8",children:[h.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-3 bg-clip-text text-transparent bg-gradient-to-r from-teal-600 to-emerald-600",children:[h.jsx(ho,{className:"text-teal-600"})," Qun l Lp hc"]}),h.jsx("button",{onClick:e,className:"bg-gray-200 dark:bg-slate-700 text-gray-800 dark:text-gray-200 px-4 py-2 rounded-lg hover:bg-gray-300 dark:hover:bg-slate-600 transition-colors",children:"Back Dashboard"})]}),c?h.jsx("div",{className:"p-20 text-center",children:h.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600 mx-auto"})}):t.length===0?h.jsxs("div",{className:"text-center p-12 bg-white dark:bg-slate-800 rounded-xl border border-gray-200 dark:border-slate-700 shadow-sm",children:[h.jsx(ho,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),h.jsx("h3",{className:"text-xl font-bold text-gray-700 dark:text-gray-200 mb-2",children:"Cha c lp hc no"}),mr&&h.jsx("button",{onClick:()=>cr(!0),className:"bg-teal-600 text-white px-6 py-2 rounded-lg hover:bg-teal-700 transition",children:"To Lp Ngay"})]}):h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[mr&&h.jsxs("div",{onClick:()=>cr(!0),className:"bg-gradient-to-br from-teal-500 to-emerald-500 rounded-xl shadow-lg p-6 flex flex-col justify-center items-center text-white cursor-pointer hover:shadow-xl hover:scale-[1.02] transition-all duration-300 group",children:[h.jsx("div",{className:"bg-white/20 p-4 rounded-full mb-3 group-hover:bg-white/30 transition-colors",children:h.jsx(Dl,{className:"w-8 h-8"})}),h.jsx("h3",{className:"font-bold text-lg",children:"Thm Lp Mi"})]}),t.map(O=>{var ze;const ce=["admin","quan_ly","lanh_dao"].includes(n.role)||n.role==="giao_vien"&&(O.headTeacherId===n.id||(O.teacherIds||[]).includes(n.id)),Se=["admin","quan_ly","lanh_dao"].includes(n.role);return h.jsxs("div",{onClick:()=>l(O),className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200 dark:border-slate-700 overflow-hidden cursor-pointer hover:shadow-xl hover:-translate-y-1 transition-all duration-300 group flex flex-col relative",children:[(ce||Se)&&h.jsxs("div",{className:"absolute top-2 right-2 z-10 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[ce&&h.jsx("button",{onClick:qe=>Do(O,qe),className:"p-2 bg-white/90 text-blue-600 rounded-full shadow-sm hover:bg-blue-50",title:"Sa lp",children:h.jsx(Cl,{})}),Se&&h.jsx("button",{onClick:qe=>{qe.stopPropagation(),cc(O.id)},className:"p-2 bg-white/90 text-red-600 rounded-full shadow-sm hover:bg-red-50",title:"Xa lp",children:h.jsx(fo,{})})]}),h.jsxs("div",{className:"h-32 bg-gradient-to-r from-blue-600 to-cyan-500 relative flex items-center justify-center overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 bg-black/10 group-hover:bg-transparent transition-colors"}),h.jsx(Xw,{className:"text-white/30 w-20 h-20 transform -rotate-12 group-hover:scale-110 transition-transform duration-500"}),h.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/60 to-transparent",children:[h.jsx("h3",{className:"font-bold text-xl text-white truncate",children:O.name}),O.licenseId&&h.jsx("span",{className:"text-xs text-yellow-300 font-mono bg-black/30 px-1 rounded ml-2",children:((ze=In.find(qe=>qe.id===O.licenseId))==null?void 0:ze.name)||O.licenseId})]})]}),h.jsxs("div",{className:"p-5 flex-1 flex flex-col",children:[h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 line-clamp-2 mb-4 flex-1",children:O.description||"Cha c m t kha hc."}),h.jsxs("div",{className:"flex justify-between items-center text-sm font-medium pt-4 border-t border-gray-100 dark:border-slate-700",children:[h.jsxs("span",{className:"text-gray-500 flex items-center gap-1",children:[h.jsx(wu,{})," GVCN: ",O.headTeacherId?g[O.headTeacherId]||"...":"Cha c"]}),h.jsxs("span",{className:"text-blue-600 group-hover:underline flex items-center gap-1",children:["Chi tit ",h.jsx(vu,{className:"rotate-180"})]})]})]})]},O.id)})]})]})},cO=(n,e=500,t=.8)=>new Promise((r,a)=>{const l=new FileReader;l.readAsDataURL(n),l.onload=c=>{var g;const f=new Image;f.src=(g=c.target)==null?void 0:g.result,f.onload=()=>{const y=document.createElement("canvas");let v=f.width,w=f.height;v>e&&(w=Math.round(w*e/v),v=e),y.width=v,y.height=w;const E=y.getContext("2d");if(!E){a(new Error("Canvas context not available"));return}E.drawImage(f,0,0,v,w),y.toBlob(S=>{S?r(S):a(new Error("Canvas to Blob failed"))},"image/webp",t)},f.onerror=y=>a(y)},l.onerror=c=>a(c)}),nx=[{id:"admin",name:"Qun tr vin"},{id:"lanh_dao",name:"Lnh o"},{id:"quan_ly",name:"Qun l"},{id:"giao_vien",name:"Gio vin"},{id:"hoc_vien",name:"Hc vin"}],uO=["giao_vien","lanh_dao","quan_ly"],hO=({userProfile:n,onBack:e})=>{const[t,r]=K.useState(n),[a,l]=K.useState(!1),[c,f]=K.useState(!1),g=n.role!=="hoc_vien",[y,v]=K.useState([]),[w,E]=K.useState(!1),[S,j]=K.useState([]),[D,R]=K.useState(""),[L,F]=K.useState("all");["admin","lanh_dao","quan_ly"].includes(n.role);const[B,ee]=K.useState(null),[he,ue]=K.useState(!1);K.useEffect(()=>{g&&C()},[g]),K.useEffect(()=>{if(g){let A=y;if(L==="staff"?A=A.filter(me=>uO.includes(me.role)):L==="hoc_vien"&&(A=A.filter(me=>me.role==="hoc_vien")),D.trim()){const me=D.toLowerCase();A=A.filter(xe=>xe.fullName.toLowerCase().includes(me)||xe.email.toLowerCase().includes(me)||xe.phoneNumber&&xe.phoneNumber.includes(me))}j(A)}},[y,L,D,g]);const C=async()=>{E(!0);try{const A=qt(wt(Re,"users"),Jf("createdAt","desc")),xe=(await _n(A)).docs.map(V=>{const le=V.data();return{id:V.id,...le,photoURL:le.photoURL||va(le.photoURL?void 0:le.role)}});v(xe)}catch(A){console.error("Error fetching users:",A)}finally{E(!1)}},I=async A=>{A.preventDefault(),l(!0);try{const me=xe=>xe===void 0?null:xe;await vs(ft(Re,"users",n.id),{fullName:me(t.full_name),phoneNumber:me(t.phoneNumber),birthDate:me(t.birthDate),address:me(t.address),cccd:me(t.cccd),cccdDate:me(t.cccdDate),cccdPlace:me(t.cccdPlace),class:me(t.class)}),alert("Cp nht thng tin thnh cng!")}catch(me){console.error(me),alert("Li khi lu thng tin.")}finally{l(!1)}},k=async A=>{if(confirm("Bn c chc chn mun xa ti khon ny?"))try{await fy(ft(Re,"users",A)),v(me=>me.filter(xe=>xe.id!==A))}catch(me){console.error(me),alert("Li khi xa.")}},U=async A=>{if(A.preventDefault(),!!B)try{const me=xe=>xe===void 0?null:xe;await vs(ft(Re,"users",B.id),{fullName:B.fullName,phoneNumber:me(B.phoneNumber),birthDate:me(B.birthDate),role:B.role,class:me(B.class),cccd:me(B.cccd),cccdDate:me(B.cccdDate),cccdPlace:me(B.cccdPlace),address:me(B.address)}),alert(" cp nht!"),ue(!1),C()}catch(me){console.error(me),alert("Li khi lu.")}},P=A=>{var me;return((me=nx.find(xe=>xe.id===A))==null?void 0:me.name)||A},H=async A=>{var xe;const me=(xe=A.target.files)==null?void 0:xe[0];if(me){f(!0);try{const V=await cO(me),le=jT(),_e=Fj(le,`avatars/${n.id}_${Date.now()}.webp`);await Hj(_e,V);const De=await $j(_e);await vs(ft(Re,"users",n.id),{photoURL:De}),r($e=>({...$e,photoURL:De})),alert("Cp nht nh i din thnh cng!")}catch(V){console.error("Avatar upload failed:",V),alert("Li khi ti nh ln. Vui lng th li.")}finally{f(!1)}}};return h.jsxs("div",{className:"w-full max-w-7xl mx-auto p-4 animate-slide-in-right pb-20",children:[h.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[h.jsx("button",{onClick:e,className:"p-2 bg-gray-100 dark:bg-slate-700 rounded-full hover:bg-gray-200",children:h.jsx(vu,{})}),h.jsxs("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[h.jsx(vf,{})," Ti khon ca ti"]})]}),h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-md p-6 mb-8 border border-gray-100 dark:border-slate-700",children:[h.jsx("h2",{className:"text-lg font-bold mb-4 text-blue-600 border-b pb-2",children:"Thng tin c nhn"}),h.jsx("div",{className:"flex justify-center mb-6",children:h.jsxs("div",{className:"relative group",children:[h.jsx("div",{className:"w-32 h-32 rounded-full overflow-hidden border-4 border-gray-200 dark:border-gray-600 shadow-lg",children:h.jsx("img",{src:t.photoURL||va(t.role),alt:"Avatar",className:"w-full h-full object-cover"})}),h.jsxs("label",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer rounded-full",title:"Thay i nh i din",children:[c?h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"}):h.jsx(uk,{className:"text-white text-3xl drop-shadow-md"}),h.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:H,disabled:c})]})]})}),h.jsxs("form",{onSubmit:I,className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"H v Tn"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:t.full_name,onChange:A=>r({...t,full_name:A.target.value}),required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"Email (Khng i)"}),h.jsx("input",{className:"w-full p-2 border rounded bg-gray-50 dark:bg-slate-900 text-gray-500",value:t.email||"",readOnly:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"Ngy sinh"}),h.jsx("input",{type:"date",className:"w-full p-2 border rounded dark:bg-slate-700",value:t.birthDate||"",onChange:A=>r({...t,birthDate:A.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"S in thoi"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:t.phoneNumber||"",onChange:A=>r({...t,phoneNumber:A.target.value})})]})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"S CCCD"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:t.cccd||"",onChange:A=>r({...t,cccd:A.target.value})})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"Ngy cp"}),h.jsx("input",{type:"date",className:"w-full p-2 border rounded dark:bg-slate-700",value:t.cccdDate||"",onChange:A=>r({...t,cccdDate:A.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"Ni cp"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:t.cccdPlace||"",onChange:A=>r({...t,cccdPlace:A.target.value})})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"a ch / Qu qun"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:t.address||"",onChange:A=>r({...t,address:A.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-gray-300",children:"Lp hc (t in)"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:t.class||"",onChange:A=>r({...t,class:A.target.value}),placeholder:"VD: Th my K2"})]})]}),h.jsx("div",{className:"md:col-span-2 flex justify-end mt-4",children:h.jsxs("button",{type:"submit",disabled:a,className:"flex items-center gap-2 bg-teal-600 text-white px-6 py-2 rounded-lg hover:bg-teal-700 transition shadow-md disabled:opacity-50",children:[h.jsx(VT,{})," ",a?"ang lu...":"Cp nht thng tin"]})})]})]}),g&&h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-md p-6 border border-gray-100 dark:border-slate-700 animate-fade-in-up",children:[h.jsxs("h2",{className:"text-xl font-bold mb-6 text-orange-600 border-b pb-2 flex items-center gap-2",children:[h.jsx(vf,{})," Qun l ngi dng cp di"]}),h.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6 justify-between items-center",children:[h.jsxs("div",{className:"relative flex-1 max-w-md w-full",children:[h.jsx(o0,{className:"absolute left-3 top-3 text-gray-400"}),h.jsx("input",{className:"w-full pl-10 pr-4 py-2 border rounded-lg dark:bg-slate-700",placeholder:"Tm hc vin, gio vin...",value:D,onChange:A=>R(A.target.value)})]}),h.jsxs("select",{className:"p-2 border rounded-lg dark:bg-slate-700 flex-1 md:flex-none",value:L,onChange:A=>F(A.target.value),children:[h.jsx("option",{value:"all",children:"Tt c vai tr"}),h.jsx("option",{value:"staff",children:"Gio vin/Qun l"}),h.jsx("option",{value:"hoc_vien",children:"Hc vin"})]})]}),h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full text-left border-collapse min-w-[800px]",children:[h.jsx("thead",{className:"bg-gray-50 dark:bg-slate-900 text-sm uppercase text-gray-500 font-bold",children:h.jsxs("tr",{children:[h.jsx("th",{className:"p-3 border-b dark:border-slate-700",children:"H v Tn"}),h.jsx("th",{className:"p-3 border-b dark:border-slate-700",children:"Lp hc (Kha/Tn)"}),h.jsx("th",{className:"p-3 border-b dark:border-slate-700",children:"Lin h"}),h.jsx("th",{className:"p-3 border-b dark:border-slate-700",children:"Vai tr"}),h.jsx("th",{className:"p-3 border-b dark:border-slate-700 text-center",children:"Thao tc"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-slate-700",children:w?h.jsx("tr",{children:h.jsx("td",{colSpan:5,className:"p-4 text-center",children:"ang ti..."})}):S.length===0?h.jsx("tr",{children:h.jsx("td",{colSpan:5,className:"p-4 text-center italic text-gray-500",children:"Khng tm thy ngi dng."})}):S.map(A=>h.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-700/50 transition",children:[h.jsxs("td",{className:"p-3 font-medium text-gray-900 dark:text-white",children:[A.fullName,A.role==="hoc_vien"&&A.isVerified&&h.jsx(PT,{className:"inline ml-1 text-blue-500 text-xs"})]}),h.jsx("td",{className:"p-3 text-sm",children:A.courseName||A.courseId||"--"}),h.jsxs("td",{className:"p-3 text-sm",children:[h.jsx("div",{children:A.email}),h.jsx("div",{className:"text-xs text-gray-500",children:A.phoneNumber})]}),h.jsx("td",{className:"p-3",children:h.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${A.role==="hoc_vien"?"bg-blue-100 text-blue-800":"bg-orange-100 text-orange-800"}`,children:P(A.role)})}),h.jsxs("td",{className:"p-3 flex justify-center gap-2",children:[h.jsx("button",{onClick:()=>{ee(A),ue(!0)},className:"p-2 text-blue-600 hover:bg-blue-50 rounded",children:h.jsx(Cl,{})}),n.role==="admin"&&h.jsx("button",{onClick:()=>k(A.id),className:"p-2 text-red-600 hover:bg-red-50 rounded",children:h.jsx(fo,{})})]})]},A.id))})]})})]}),he&&B&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:()=>ue(!1),children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-2xl p-6 relative max-h-[90vh] overflow-y-auto",onClick:A=>A.stopPropagation(),children:[h.jsxs("h2",{className:"text-lg font-bold mb-4",children:["Sa ti khon: ",B.fullName]}),h.jsxs("form",{onSubmit:U,className:"space-y-4",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"H tn"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:B.fullName,onChange:A=>ee({...B,fullName:A.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"ST"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:B.phoneNumber||"",onChange:A=>ee({...B,phoneNumber:A.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"Ngy sinh"}),h.jsx("input",{type:"date",className:"w-full p-2 border rounded dark:bg-slate-700",value:B.birthDate||"",onChange:A=>ee({...B,birthDate:A.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"Lp hc (t in)"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:B.class||"",onChange:A=>ee({...B,class:A.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"CCCD"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:B.cccd||"",onChange:A=>ee({...B,cccd:A.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"a ch"}),h.jsx("input",{className:"w-full p-2 border rounded dark:bg-slate-700",value:B.address||"",onChange:A=>ee({...B,address:A.target.value})})]}),h.jsxs("div",{className:"col-span-2",children:[h.jsx("label",{className:"block text-sm font-bold mb-1",children:"Vai tr"}),h.jsx("select",{className:"w-full p-2 border rounded dark:bg-slate-700",value:B.role,onChange:A=>ee({...B,role:A.target.value}),children:nx.map(A=>h.jsx("option",{value:A.id,children:A.name},A.id))})]})]}),h.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[h.jsx("button",{type:"button",onClick:()=>ue(!1),className:"px-4 py-2 bg-gray-200 rounded",children:"Hy"}),h.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Lu"})]})]})]})})]})},dO=({userProfile:n,onNavigate:e,onLogout:t})=>h.jsxs("div",{className:"fixed top-0 left-0 right-0 h-16 bg-white dark:bg-slate-900 border-b border-gray-200 dark:border-gray-800 z-40 px-4 shadow-sm flex items-center justify-between transition-colors duration-300",children:[h.jsxs("div",{className:"flex items-center gap-1 md:gap-4 overflow-x-auto no-scrollbar",children:[h.jsxs("button",{onClick:()=>e("dashboard"),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors whitespace-nowrap",children:[h.jsx(ck,{className:"text-blue-600 dark:text-blue-400"}),h.jsx("span",{className:"font-semibold text-sm md:text-base",children:"n tp"})]}),h.jsxs("a",{href:"/",className:"flex items-center gap-2 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors whitespace-nowrap decoration-0",children:[h.jsx(fk,{className:"text-teal-600 dark:text-teal-400"}),h.jsx("span",{className:"font-medium text-sm md:text-base",children:"Trang ch"})]}),h.jsxs("button",{onClick:()=>e("account"),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors whitespace-nowrap",children:[h.jsx(pk,{className:"text-orange-600 dark:text-orange-400"}),h.jsx("span",{className:"font-medium text-sm md:text-base",children:"Ti khon"})]}),n&&h.jsxs(h.Fragment,{children:[["admin","lanh_dao","quan_ly","giao_vien"].includes(n.role)?h.jsxs("button",{onClick:()=>e("class_management"),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors whitespace-nowrap",children:[h.jsx(ho,{className:"text-indigo-600 dark:text-indigo-400"}),h.jsx("span",{className:"font-medium text-sm md:text-base",children:"Qun l lp"})]}):h.jsxs("button",{onClick:()=>e("my_class"),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors whitespace-nowrap",children:[h.jsx(Jw,{className:"text-green-600 dark:text-green-400"}),h.jsx("span",{className:"font-medium text-sm md:text-base",children:"Lp ca ti"})]}),["admin","lanh_dao","quan_ly","giao_vien"].includes(n.role)&&h.jsxs("button",{onClick:()=>e("notification_mgmt"),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors whitespace-nowrap border-l border-gray-200 dark:border-gray-700 ml-2 pl-4",children:[h.jsx(rm,{className:"text-red-500 animate-pulse-slow"}),h.jsx("span",{className:"font-bold text-sm md:text-base text-red-600 dark:text-red-400",children:"Qun l TB"})]}),h.jsxs("button",{onClick:()=>e("history"),className:"flex items-center gap-2 px-3 py-2 rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-slate-800 transition-colors whitespace-nowrap",children:[h.jsx(bu,{className:"text-purple-600 dark:text-purple-400"}),h.jsx("span",{className:"font-medium text-sm md:text-base",children:"Lch s"})]})]})]}),h.jsx("div",{className:"flex items-center gap-3 md:gap-4 ml-4 flex-shrink-0",children:n?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"hidden md:flex flex-col items-end",children:[h.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Xin cho,"}),h.jsx("span",{className:"text-sm font-bold text-gray-800 dark:text-white max-w-[150px] truncate",children:n.full_name})]}),h.jsx("div",{className:"md:hidden text-gray-700 dark:text-gray-200",children:h.jsx(Jw,{})}),h.jsx("div",{className:"h-8 w-[1px] bg-gray-300 dark:bg-gray-700 mx-1"}),h.jsxs("button",{onClick:t,className:"group flex items-center gap-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 px-3 py-2 rounded-full transition-colors",title:"ng xut",children:[h.jsx(mk,{className:"group-hover:translate-x-1 transition-transform"}),h.jsx("span",{className:"hidden md:inline font-medium text-sm",children:"Thot"})]})]}):h.jsx("button",{onClick:()=>e("login"),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-semibold text-sm transition-colors shadow-md",children:"ng nhp"})})]});var l0=function(n,e){return l0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])},l0(n,e)};function BT(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");l0(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var wf=function(){return wf=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++){t=arguments[r];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},wf.apply(this,arguments)};function oc(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(n);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(n,r[a])&&(t[r[a]]=n[r[a]]);return t}function zT(n,e,t,r){var a=arguments.length,l=a<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(n,e,t,r);else for(var f=n.length-1;f>=0;f--)(c=n[f])&&(l=(a<3?c(l):a>3?c(e,t,l):c(e,t))||l);return a>3&&l&&Object.defineProperty(e,t,l),l}function qT(n,e){return function(t,r){e(t,r,n)}}function HT(n,e,t,r,a,l){function c(L){if(L!==void 0&&typeof L!="function")throw new TypeError("Function expected");return L}for(var f=r.kind,g=f==="getter"?"get":f==="setter"?"set":"value",y=!e&&n?r.static?n:n.prototype:null,v=e||(y?Object.getOwnPropertyDescriptor(y,r.name):{}),w,E=!1,S=t.length-1;S>=0;S--){var j={};for(var D in r)j[D]=D==="access"?{}:r[D];for(var D in r.access)j.access[D]=r.access[D];j.addInitializer=function(L){if(E)throw new TypeError("Cannot add initializers after decoration has completed");l.push(c(L||null))};var R=(0,t[S])(f==="accessor"?{get:v.get,set:v.set}:v[g],j);if(f==="accessor"){if(R===void 0)continue;if(R===null||typeof R!="object")throw new TypeError("Object expected");(w=c(R.get))&&(v.get=w),(w=c(R.set))&&(v.set=w),(w=c(R.init))&&a.unshift(w)}else(w=c(R))&&(f==="field"?a.unshift(w):v[g]=w)}y&&Object.defineProperty(y,r.name,v),E=!0}function $T(n,e,t){for(var r=arguments.length>2,a=0;a<e.length;a++)t=r?e[a].call(n,t):e[a].call(n);return r?t:void 0}function FT(n){return typeof n=="symbol"?n:"".concat(n)}function GT(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function KT(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function be(n,e,t,r){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(v){try{y(r.next(v))}catch(w){c(w)}}function g(v){try{y(r.throw(v))}catch(w){c(w)}}function y(v){v.done?l(v.value):a(v.value).then(f,g)}y((r=r.apply(n,e||[])).next())})}function QT(n,e){var t={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},r,a,l,c=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return c.next=f(0),c.throw=f(1),c.return=f(2),typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(y){return function(v){return g([y,v])}}function g(y){if(r)throw new TypeError("Generator is already executing.");for(;c&&(c=0,y[0]&&(t=0)),t;)try{if(r=1,a&&(l=y[0]&2?a.return:y[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,y[1])).done)return l;switch(a=0,l&&(y=[y[0]&2,l.value]),y[0]){case 0:case 1:l=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,a=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(l=t.trys,!(l=l.length>0&&l[l.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!l||y[1]>l[0]&&y[1]<l[3])){t.label=y[1];break}if(y[0]===6&&t.label<l[1]){t.label=l[1],l=y;break}if(l&&t.label<l[2]){t.label=l[2],t.ops.push(y);break}l[2]&&t.ops.pop(),t.trys.pop();continue}y=e.call(n,t)}catch(v){y=[6,v],a=0}finally{r=l=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}var im=Object.create?(function(n,e,t,r){r===void 0&&(r=t);var a=Object.getOwnPropertyDescriptor(e,t);(!a||("get"in a?!e.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,a)}):(function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]});function YT(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&im(e,n,t)}function xf(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ny(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),a,l=[],c;try{for(;(e===void 0||e-- >0)&&!(a=r.next()).done;)l.push(a.value)}catch(f){c={error:f}}finally{try{a&&!a.done&&(t=r.return)&&t.call(r)}finally{if(c)throw c.error}}return l}function XT(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Ny(arguments[e]));return n}function WT(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),a=0,e=0;e<t;e++)for(var l=arguments[e],c=0,f=l.length;c<f;c++,a++)r[a]=l[c];return r}function JT(n,e,t){if(t||arguments.length===2)for(var r=0,a=e.length,l;r<a;r++)(l||!(r in e))&&(l||(l=Array.prototype.slice.call(e,0,r)),l[r]=e[r]);return n.concat(l||Array.prototype.slice.call(e))}function Wl(n){return this instanceof Wl?(this.v=n,this):new Wl(n)}function ZT(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),a,l=[];return a=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),f("next"),f("throw"),f("return",c),a[Symbol.asyncIterator]=function(){return this},a;function c(S){return function(j){return Promise.resolve(j).then(S,w)}}function f(S,j){r[S]&&(a[S]=function(D){return new Promise(function(R,L){l.push([S,D,R,L])>1||g(S,D)})},j&&(a[S]=j(a[S])))}function g(S,j){try{y(r[S](j))}catch(D){E(l[0][3],D)}}function y(S){S.value instanceof Wl?Promise.resolve(S.value.v).then(v,w):E(l[0][2],S)}function v(S){g("next",S)}function w(S){g("throw",S)}function E(S,j){S(j),l.shift(),l.length&&g(l[0][0],l[0][1])}}function eS(n){var e,t;return e={},r("next"),r("throw",function(a){throw a}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(a,l){e[a]=n[a]?function(c){return(t=!t)?{value:Wl(n[a](c)),done:!1}:l?l(c):c}:l}}function tS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof xf=="function"?xf(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(l){t[l]=n[l]&&function(c){return new Promise(function(f,g){c=n[l](c),a(f,g,c.done,c.value)})}}function a(l,c,f,g){Promise.resolve(g).then(function(y){l({value:y,done:f})},c)}}function nS(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var fO=Object.create?(function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}):function(n,e){n.default=e},c0=function(n){return c0=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},c0(n)};function sS(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t=c0(n),r=0;r<t.length;r++)t[r]!=="default"&&im(e,n,t[r]);return fO(e,n),e}function rS(n){return n&&n.__esModule?n:{default:n}}function iS(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}function aS(n,e,t,r,a){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!a:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?a.call(n,t):a?a.value=t:e.set(n,t),t}function oS(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function lS(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,a;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],t&&(a=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");a&&(r=function(){try{a.call(this)}catch(l){return Promise.reject(l)}}),n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e}var mO=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r};function cS(n){function e(l){n.error=n.hasError?new mO(l,n.error,"An error was suppressed during disposal."):l,n.hasError=!0}var t,r=0;function a(){for(;t=n.stack.pop();)try{if(!t.async&&r===1)return r=0,n.stack.push(t),Promise.resolve().then(a);if(t.dispose){var l=t.dispose.call(t.value);if(t.async)return r|=2,Promise.resolve(l).then(a,function(c){return e(c),a()})}else r|=1}catch(c){e(c)}if(r===1)return n.hasError?Promise.reject(n.error):Promise.resolve();if(n.hasError)throw n.error}return a()}function uS(n,e){return typeof n=="string"&&/^\.\.?\//.test(n)?n.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,r,a,l,c){return r?e?".jsx":".js":a&&(!l||!c)?t:a+l+"."+c.toLowerCase()+"js"}):n}const gO={__extends:BT,__assign:wf,__rest:oc,__decorate:zT,__param:qT,__esDecorate:HT,__runInitializers:$T,__propKey:FT,__setFunctionName:GT,__metadata:KT,__awaiter:be,__generator:QT,__createBinding:im,__exportStar:YT,__values:xf,__read:Ny,__spread:XT,__spreadArrays:WT,__spreadArray:JT,__await:Wl,__asyncGenerator:ZT,__asyncDelegator:eS,__asyncValues:tS,__makeTemplateObject:nS,__importStar:sS,__importDefault:rS,__classPrivateFieldGet:iS,__classPrivateFieldSet:aS,__classPrivateFieldIn:oS,__addDisposableResource:lS,__disposeResources:cS,__rewriteRelativeImportExtension:uS},pO=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:lS,get __assign(){return wf},__asyncDelegator:eS,__asyncGenerator:ZT,__asyncValues:tS,__await:Wl,__awaiter:be,__classPrivateFieldGet:iS,__classPrivateFieldIn:oS,__classPrivateFieldSet:aS,__createBinding:im,__decorate:zT,__disposeResources:cS,__esDecorate:HT,__exportStar:YT,__extends:BT,__generator:QT,__importDefault:rS,__importStar:sS,__makeTemplateObject:nS,__metadata:KT,__param:qT,__propKey:FT,__read:Ny,__rest:oc,__rewriteRelativeImportExtension:uS,__runInitializers:$T,__setFunctionName:GT,__spread:XT,__spreadArray:JT,__spreadArrays:WT,__values:xf,default:gO},Symbol.toStringTag,{value:"Module"})),yO=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);class Ry extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class _O extends Ry{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class sx extends Ry{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class rx extends Ry{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var u0;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(u0||(u0={}));class vO{constructor(e,{headers:t={},customFetch:r,region:a=u0.Any}={}){this.url=e,this.headers=t,this.region=a,this.fetch=yO(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return be(this,arguments,void 0,function*(t,r={}){var a;let l,c;try{const{headers:f,method:g,body:y,signal:v,timeout:w}=r;let E={},{region:S}=r;S||(S=this.region);const j=new URL(`${this.url}/${t}`);S&&S!=="any"&&(E["x-region"]=S,j.searchParams.set("forceFunctionRegion",S));let D;y&&(f&&!Object.prototype.hasOwnProperty.call(f,"Content-Type")||!f)?typeof Blob<"u"&&y instanceof Blob||y instanceof ArrayBuffer?(E["Content-Type"]="application/octet-stream",D=y):typeof y=="string"?(E["Content-Type"]="text/plain",D=y):typeof FormData<"u"&&y instanceof FormData?D=y:(E["Content-Type"]="application/json",D=JSON.stringify(y)):D=y;let R=v;w&&(c=new AbortController,l=setTimeout(()=>c.abort(),w),v?(R=c.signal,v.addEventListener("abort",()=>c.abort())):R=c.signal);const L=yield this.fetch(j.toString(),{method:g||"POST",headers:Object.assign(Object.assign(Object.assign({},E),this.headers),f),body:D,signal:R}).catch(he=>{throw new _O(he)}),F=L.headers.get("x-relay-error");if(F&&F==="true")throw new sx(L);if(!L.ok)throw new rx(L);let B=((a=L.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),ee;return B==="application/json"?ee=yield L.json():B==="application/octet-stream"||B==="application/pdf"?ee=yield L.blob():B==="text/event-stream"?ee=L:B==="multipart/form-data"?ee=yield L.formData():ee=yield L.text(),{data:ee,error:null,response:L}}catch(f){return{data:null,error:f,response:f instanceof rx||f instanceof sx?f.context:void 0}}finally{l&&clearTimeout(l)}})}}var Dn={};const lc=fN(pO);var Id={},jd={},kd={},Od={},Dd={},Md={},ix;function hS(){if(ix)return Md;ix=1,Object.defineProperty(Md,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Md.default=n,Md}var ax;function dS(){if(ax)return Dd;ax=1,Object.defineProperty(Dd,"__esModule",{value:!0});const e=lc.__importDefault(hS());class t{constructor(a){var l,c;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=(l=a.shouldThrowOnError)!==null&&l!==void 0?l:!1,this.signal=a.signal,this.isMaybeSingle=(c=a.isMaybeSingle)!==null&&c!==void 0?c:!1,a.fetch?this.fetch=a.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,l){return this.headers=new Headers(this.headers),this.headers.set(a,l),this}then(a,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const c=this.fetch;let f=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async g=>{var y,v,w,E;let S=null,j=null,D=null,R=g.status,L=g.statusText;if(g.ok){if(this.method!=="HEAD"){const he=await g.text();he===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((y=this.headers.get("Accept"))===null||y===void 0)&&y.includes("application/vnd.pgrst.plan+text"))?j=he:j=JSON.parse(he))}const B=(v=this.headers.get("Prefer"))===null||v===void 0?void 0:v.match(/count=(exact|planned|estimated)/),ee=(w=g.headers.get("content-range"))===null||w===void 0?void 0:w.split("/");B&&ee&&ee.length>1&&(D=parseInt(ee[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(j)&&(j.length>1?(S={code:"PGRST116",details:`Results contain ${j.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},j=null,D=null,R=406,L="Not Acceptable"):j.length===1?j=j[0]:j=null)}else{const B=await g.text();try{S=JSON.parse(B),Array.isArray(S)&&g.status===404&&(j=[],S=null,R=200,L="OK")}catch{g.status===404&&B===""?(R=204,L="No Content"):S={message:B}}if(S&&this.isMaybeSingle&&(!((E=S==null?void 0:S.details)===null||E===void 0)&&E.includes("0 rows"))&&(S=null,R=200,L="OK"),S&&this.shouldThrowOnError)throw new e.default(S)}return{error:S,data:j,count:D,status:R,statusText:L}});return this.shouldThrowOnError||(f=f.catch(g=>{var y,v,w,E,S,j;let D="";const R=g==null?void 0:g.cause;if(R){const L=(y=R==null?void 0:R.message)!==null&&y!==void 0?y:"",F=(v=R==null?void 0:R.code)!==null&&v!==void 0?v:"";D=`${(w=g==null?void 0:g.name)!==null&&w!==void 0?w:"FetchError"}: ${g==null?void 0:g.message}`,D+=`

Caused by: ${(E=R==null?void 0:R.name)!==null&&E!==void 0?E:"Error"}: ${L}`,F&&(D+=` (${F})`),R!=null&&R.stack&&(D+=`
${R.stack}`)}else D=(S=g==null?void 0:g.stack)!==null&&S!==void 0?S:"";return{error:{message:`${(j=g==null?void 0:g.name)!==null&&j!==void 0?j:"FetchError"}: ${g==null?void 0:g.message}`,details:D,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),f.then(a,l)}returns(){return this}overrideTypes(){return this}}return Dd.default=t,Dd}var ox;function fS(){if(ox)return Od;ox=1,Object.defineProperty(Od,"__esModule",{value:!0});const e=lc.__importDefault(dS());class t extends e.default{select(a){let l=!1;const c=(a??"*").split("").map(f=>/\s/.test(f)&&!l?"":(f==='"'&&(l=!l),f)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:l=!0,nullsFirst:c,foreignTable:f,referencedTable:g=f}={}){const y=g?`${g}.order`:"order",v=this.url.searchParams.get(y);return this.url.searchParams.set(y,`${v?`${v},`:""}${a}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:l,referencedTable:c=l}={}){const f=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(f,`${a}`),this}range(a,l,{foreignTable:c,referencedTable:f=c}={}){const g=typeof f>"u"?"offset":`${f}.offset`,y=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(g,`${a}`),this.url.searchParams.set(y,`${l-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:l=!1,settings:c=!1,buffers:f=!1,wal:g=!1,format:y="text"}={}){var v;const w=[a?"analyze":null,l?"verbose":null,c?"settings":null,f?"buffers":null,g?"wal":null].filter(Boolean).join("|"),E=(v=this.headers.get("Accept"))!==null&&v!==void 0?v:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${y}; for="${E}"; options=${w};`),y==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return Od.default=t,Od}var lx;function Cy(){if(lx)return kd;lx=1,Object.defineProperty(kd,"__esModule",{value:!0});const e=lc.__importDefault(fS()),t=new RegExp("[,()]");class r extends e.default{eq(l,c){return this.url.searchParams.append(l,`eq.${c}`),this}neq(l,c){return this.url.searchParams.append(l,`neq.${c}`),this}gt(l,c){return this.url.searchParams.append(l,`gt.${c}`),this}gte(l,c){return this.url.searchParams.append(l,`gte.${c}`),this}lt(l,c){return this.url.searchParams.append(l,`lt.${c}`),this}lte(l,c){return this.url.searchParams.append(l,`lte.${c}`),this}like(l,c){return this.url.searchParams.append(l,`like.${c}`),this}likeAllOf(l,c){return this.url.searchParams.append(l,`like(all).{${c.join(",")}}`),this}likeAnyOf(l,c){return this.url.searchParams.append(l,`like(any).{${c.join(",")}}`),this}ilike(l,c){return this.url.searchParams.append(l,`ilike.${c}`),this}ilikeAllOf(l,c){return this.url.searchParams.append(l,`ilike(all).{${c.join(",")}}`),this}ilikeAnyOf(l,c){return this.url.searchParams.append(l,`ilike(any).{${c.join(",")}}`),this}regexMatch(l,c){return this.url.searchParams.append(l,`match.${c}`),this}regexIMatch(l,c){return this.url.searchParams.append(l,`imatch.${c}`),this}is(l,c){return this.url.searchParams.append(l,`is.${c}`),this}isDistinct(l,c){return this.url.searchParams.append(l,`isdistinct.${c}`),this}in(l,c){const f=Array.from(new Set(c)).map(g=>typeof g=="string"&&t.test(g)?`"${g}"`:`${g}`).join(",");return this.url.searchParams.append(l,`in.(${f})`),this}contains(l,c){return typeof c=="string"?this.url.searchParams.append(l,`cs.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cs.{${c.join(",")}}`):this.url.searchParams.append(l,`cs.${JSON.stringify(c)}`),this}containedBy(l,c){return typeof c=="string"?this.url.searchParams.append(l,`cd.${c}`):Array.isArray(c)?this.url.searchParams.append(l,`cd.{${c.join(",")}}`):this.url.searchParams.append(l,`cd.${JSON.stringify(c)}`),this}rangeGt(l,c){return this.url.searchParams.append(l,`sr.${c}`),this}rangeGte(l,c){return this.url.searchParams.append(l,`nxl.${c}`),this}rangeLt(l,c){return this.url.searchParams.append(l,`sl.${c}`),this}rangeLte(l,c){return this.url.searchParams.append(l,`nxr.${c}`),this}rangeAdjacent(l,c){return this.url.searchParams.append(l,`adj.${c}`),this}overlaps(l,c){return typeof c=="string"?this.url.searchParams.append(l,`ov.${c}`):this.url.searchParams.append(l,`ov.{${c.join(",")}}`),this}textSearch(l,c,{config:f,type:g}={}){let y="";g==="plain"?y="pl":g==="phrase"?y="ph":g==="websearch"&&(y="w");const v=f===void 0?"":`(${f})`;return this.url.searchParams.append(l,`${y}fts${v}.${c}`),this}match(l){return Object.entries(l).forEach(([c,f])=>{this.url.searchParams.append(c,`eq.${f}`)}),this}not(l,c,f){return this.url.searchParams.append(l,`not.${c}.${f}`),this}or(l,{foreignTable:c,referencedTable:f=c}={}){const g=f?`${f}.or`:"or";return this.url.searchParams.append(g,`(${l})`),this}filter(l,c,f){return this.url.searchParams.append(l,`${c}.${f}`),this}}return kd.default=r,kd}var cx;function mS(){if(cx)return jd;cx=1,Object.defineProperty(jd,"__esModule",{value:!0});const e=lc.__importDefault(Cy());class t{constructor(a,{headers:l={},schema:c,fetch:f}){this.url=a,this.headers=new Headers(l),this.schema=c,this.fetch=f}select(a,l){const{head:c=!1,count:f}=l??{},g=c?"HEAD":"GET";let y=!1;const v=(a??"*").split("").map(w=>/\s/.test(w)&&!y?"":(w==='"'&&(y=!y),w)).join("");return this.url.searchParams.set("select",v),f&&this.headers.append("Prefer",`count=${f}`),new e.default({method:g,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:l,defaultToNull:c=!0}={}){var f;const g="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const y=a.reduce((v,w)=>v.concat(Object.keys(w)),[]);if(y.length>0){const v=[...new Set(y)].map(w=>`"${w}"`);this.url.searchParams.set("columns",v.join(","))}}return new e.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}upsert(a,{onConflict:l,ignoreDuplicates:c=!1,count:f,defaultToNull:g=!0}={}){var y;const v="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),f&&this.headers.append("Prefer",`count=${f}`),g||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const w=a.reduce((E,S)=>E.concat(Object.keys(S)),[]);if(w.length>0){const E=[...new Set(w)].map(S=>`"${S}"`);this.url.searchParams.set("columns",E.join(","))}}return new e.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(y=this.fetch)!==null&&y!==void 0?y:fetch})}update(a,{count:l}={}){var c;const f="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:a}={}){var l;const c="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return jd.default=t,jd}var ux;function bO(){if(ux)return Id;ux=1,Object.defineProperty(Id,"__esModule",{value:!0});const n=lc,e=n.__importDefault(mS()),t=n.__importDefault(Cy());class r{constructor(l,{headers:c={},schema:f,fetch:g}={}){this.url=l,this.headers=new Headers(c),this.schemaName=f,this.fetch=g}from(l){if(!l||typeof l!="string"||l.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");const c=new URL(`${this.url}/${l}`);return new e.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new r(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:f=!1,get:g=!1,count:y}={}){var v;let w;const E=new URL(`${this.url}/rpc/${l}`);let S;f||g?(w=f?"HEAD":"GET",Object.entries(c).filter(([D,R])=>R!==void 0).map(([D,R])=>[D,Array.isArray(R)?`{${R.join(",")}}`:`${R}`]).forEach(([D,R])=>{E.searchParams.append(D,R)})):(w="POST",S=c);const j=new Headers(this.headers);return y&&j.set("Prefer",`count=${y}`),new t.default({method:w,url:E,headers:j,schema:this.schemaName,body:S,fetch:(v=this.fetch)!==null&&v!==void 0?v:fetch})}}return Id.default=r,Id}var hx;function wO(){if(hx)return Dn;hx=1,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.PostgrestError=Dn.PostgrestBuilder=Dn.PostgrestTransformBuilder=Dn.PostgrestFilterBuilder=Dn.PostgrestQueryBuilder=Dn.PostgrestClient=void 0;const n=lc,e=n.__importDefault(bO());Dn.PostgrestClient=e.default;const t=n.__importDefault(mS());Dn.PostgrestQueryBuilder=t.default;const r=n.__importDefault(Cy());Dn.PostgrestFilterBuilder=r.default;const a=n.__importDefault(fS());Dn.PostgrestTransformBuilder=a.default;const l=n.__importDefault(dS());Dn.PostgrestBuilder=l.default;const c=n.__importDefault(hS());return Dn.PostgrestError=c.default,Dn.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:l.default,PostgrestError:c.default},Dn}var gS=wO();const pS=w0(gS),xO=dN({__proto__:null,default:pS},[gS]),{PostgrestClient:EO,PostgrestQueryBuilder:Y8,PostgrestFilterBuilder:X8,PostgrestTransformBuilder:W8,PostgrestBuilder:J8,PostgrestError:Z8}=pS||xO;class TO{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const r=t.node,a=parseInt(r.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const SO="2.86.0",AO=`realtime-js/${SO}`,yS="1.0.0",NO="2.0.0",dx=yS,h0=1e4,RO=1e3,CO=100;var oo;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(oo||(oo={}));var un;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(un||(un={}));var nr;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(nr||(nr={}));var d0;(function(n){n.websocket="websocket"})(d0||(d0={}));var lo;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(lo||(lo={}));class IO{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,t){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(r))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,r;const a=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(e){var t,r;const a=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:{},c=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,c)}_encodeUserBroadcastPush(e,t,r){var a,l;const c=e.topic,f=(a=e.ref)!==null&&a!==void 0?a:"",g=(l=e.join_ref)!==null&&l!==void 0?l:"",y=e.payload.event,v=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},w=Object.keys(v).length===0?"":JSON.stringify(v);if(g.length>255)throw new Error(`joinRef length ${g.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`ref length ${f.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`topic length ${c.length} exceeds maximum of 255`);if(y.length>255)throw new Error(`userEvent length ${y.length} exceeds maximum of 255`);if(w.length>255)throw new Error(`metadata length ${w.length} exceeds maximum of 255`);const E=this.USER_BROADCAST_PUSH_META_LENGTH+g.length+f.length+c.length+y.length+w.length,S=new ArrayBuffer(this.HEADER_LENGTH+E);let j=new DataView(S),D=0;j.setUint8(D++,this.KINDS.userBroadcastPush),j.setUint8(D++,g.length),j.setUint8(D++,f.length),j.setUint8(D++,c.length),j.setUint8(D++,y.length),j.setUint8(D++,w.length),j.setUint8(D++,t),Array.from(g,L=>j.setUint8(D++,L.charCodeAt(0))),Array.from(f,L=>j.setUint8(D++,L.charCodeAt(0))),Array.from(c,L=>j.setUint8(D++,L.charCodeAt(0))),Array.from(y,L=>j.setUint8(D++,L.charCodeAt(0))),Array.from(w,L=>j.setUint8(D++,L.charCodeAt(0)));var R=new Uint8Array(S.byteLength+r.byteLength);return R.set(new Uint8Array(S),0),R.set(new Uint8Array(r),S.byteLength),R.buffer}decode(e,t){if(this._isArrayBuffer(e)){let r=this._binaryDecode(e);return t(r)}if(typeof e=="string"){const r=JSON.parse(e),[a,l,c,f,g]=r;return t({join_ref:a,ref:l,topic:c,event:f,payload:g})}return t({})}_binaryDecode(e){const t=new DataView(e),r=t.getUint8(0),a=new TextDecoder;switch(r){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,a)}}_decodeUserBroadcast(e,t,r){const a=t.getUint8(1),l=t.getUint8(2),c=t.getUint8(3),f=t.getUint8(4);let g=this.HEADER_LENGTH+4;const y=r.decode(e.slice(g,g+a));g=g+a;const v=r.decode(e.slice(g,g+l));g=g+l;const w=r.decode(e.slice(g,g+c));g=g+c;const E=e.slice(g,e.byteLength),S=f===this.JSON_ENCODING?JSON.parse(r.decode(E)):E,j={type:this.BROADCAST_EVENT,event:v,payload:S};return c>0&&(j.meta=JSON.parse(w)),{join_ref:null,ref:null,topic:y,event:this.BROADCAST_EVENT,payload:j}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e==null?void 0:e.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([r])=>t.includes(r)))}}class _S{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var xt;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(xt||(xt={}));const fx=(n,e,t={})=>{var r;const a=(r=t.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((l,c)=>(l[c]=jO(c,n,e,a),l),{}):{}},jO=(n,e,t,r)=>{const a=e.find(f=>f.name===n),l=a==null?void 0:a.type,c=t[n];return l&&!r.includes(l)?vS(l,c):f0(c)},vS=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return MO(e,t)}switch(n){case xt.bool:return kO(e);case xt.float4:case xt.float8:case xt.int2:case xt.int4:case xt.int8:case xt.numeric:case xt.oid:return OO(e);case xt.json:case xt.jsonb:return DO(e);case xt.timestamp:return PO(e);case xt.abstime:case xt.date:case xt.daterange:case xt.int4range:case xt.int8range:case xt.money:case xt.reltime:case xt.text:case xt.time:case xt.timestamptz:case xt.timetz:case xt.tsrange:case xt.tstzrange:return f0(e);default:return f0(e)}},f0=n=>n,kO=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},OO=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},DO=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},MO=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let l;const c=n.slice(1,t);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(f=>vS(e,f))}return n},PO=n=>typeof n=="string"?n.replace(" ","T"):n,bS=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class Ep{constructor(e,t,r={},a=h0){this.channel=e,this.event=t,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var mx;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(mx||(mx={}));class xu{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:l,onLeave:c,onSync:f}=this.caller;this.joinRef=this.channel._joinRef(),this.state=xu.syncState(this.state,a,l,c),this.pendingDiffs.forEach(g=>{this.state=xu.syncDiff(this.state,g,l,c)}),this.pendingDiffs=[],f()}),this.channel._on(r.diff,{},a=>{const{onJoin:l,onLeave:c,onSync:f}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=xu.syncDiff(this.state,a,l,c),f())}),this.onJoin((a,l,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:c})}),this.onLeave((a,l,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,a){const l=this.cloneDeep(e),c=this.transformState(t),f={},g={};return this.map(l,(y,v)=>{c[y]||(g[y]=v)}),this.map(c,(y,v)=>{const w=l[y];if(w){const E=v.map(R=>R.presence_ref),S=w.map(R=>R.presence_ref),j=v.filter(R=>S.indexOf(R.presence_ref)<0),D=w.filter(R=>E.indexOf(R.presence_ref)<0);j.length>0&&(f[y]=j),D.length>0&&(g[y]=D)}else f[y]=v}),this.syncDiff(l,{joins:f,leaves:g},r,a)}static syncDiff(e,t,r,a){const{joins:l,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(l,(f,g)=>{var y;const v=(y=e[f])!==null&&y!==void 0?y:[];if(e[f]=this.cloneDeep(g),v.length>0){const w=e[f].map(S=>S.presence_ref),E=v.filter(S=>w.indexOf(S.presence_ref)<0);e[f].unshift(...E)}r(f,v,g)}),this.map(c,(f,g)=>{let y=e[f];if(!y)return;const v=g.map(w=>w.presence_ref);y=y.filter(w=>v.indexOf(w.presence_ref)<0),e[f]=y,a(f,y,g),y.length===0&&delete e[f]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const a=e[r];return"metas"in a?t[r]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[r]=a,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var gx;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(gx||(gx={}));var Eu;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Eu||(Eu={}));var ni;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(ni||(ni={}));class Iy{constructor(e,t={config:{}},r){var a,l;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=un.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Ep(this,nr.join,this.params,this.timeout),this.rejoinTimer=new _S(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=un.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(c=>c.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=un.closed,this.socket._remove(this)}),this._onError(c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=un.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=un.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",c=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,c),this.state=un.errored,this.rejoinTimer.scheduleTimeout())}),this._on(nr.reply,{},(c,f)=>{this._trigger(this._replyEventName(f),c)}),this.presence=new xu(this),this.broadcastEndpointURL=bS(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,a,l;if(this.socket.isConnected()||this.socket.connect(),this.state==un.closed){const{config:{broadcast:c,presence:f,private:g}}=this.params,y=(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(S=>S.filter))!==null&&a!==void 0?a:[],v=!!this.bindings[Eu.PRESENCE]&&this.bindings[Eu.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,w={},E={broadcast:c,presence:Object.assign(Object.assign({},f),{enabled:v}),postgres_changes:y,private:g};this.socket.accessTokenValue&&(w.access_token=this.socket.accessTokenValue),this._onError(S=>e==null?void 0:e(ni.CHANNEL_ERROR,S)),this._onClose(()=>e==null?void 0:e(ni.CLOSED)),this.updateJoinPayload(Object.assign({config:E},w)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:S})=>{var j;if(this.socket.setAuth(),S===void 0){e==null||e(ni.SUBSCRIBED);return}else{const D=this.bindings.postgres_changes,R=(j=D==null?void 0:D.length)!==null&&j!==void 0?j:0,L=[];for(let F=0;F<R;F++){const B=D[F],{filter:{event:ee,schema:he,table:ue,filter:C}}=B,I=S&&S[F];if(I&&I.event===ee&&I.schema===he&&I.table===ue&&I.filter===C)L.push(Object.assign(Object.assign({},B),{id:I.id}));else{this.unsubscribe(),this.state=un.errored,e==null||e(ni.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=L,e&&e(ni.SUBSCRIBED);return}}).receive("error",S=>{this.state=un.errored,e==null||e(ni.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(S).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(ni.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===un.joined&&e===Eu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async httpSend(e,t,r={}){var a;const l=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(t==null)return Promise.reject("Payload is required for httpSend()");const c={method:"POST",headers:{Authorization:l,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},f=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);if(f.status===202)return{success:!0};let g=f.statusText;try{const y=await f.json();g=y.error||y.message||g}catch{}return Promise.reject(new Error(g))}async send(e,t={}){var r,a;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:c}=e,g={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const y=await this._fetchWithTimeout(this.broadcastEndpointURL,g,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=y.body)===null||a===void 0?void 0:a.cancel()),y.ok?"ok":"error"}catch(y){return y.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,f,g;const y=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((g=(f=(c=this.params)===null||c===void 0?void 0:c.config)===null||f===void 0?void 0:f.broadcast)===null||g===void 0)&&g.ack)&&l("ok"),y.receive("ok",()=>l("ok")),y.receive("error",()=>l("error")),y.receive("timeout",()=>l("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=un.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(nr.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new Ep(this,nr.leave,{},e),r.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=un.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const a=new AbortController,l=setTimeout(()=>a.abort(),r),c=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(l),c}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Ep(this,e,t,r);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>CO){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var a,l;const c=e.toLocaleLowerCase(),{close:f,error:g,leave:y,join:v}=nr;if(r&&[f,g,y,v].indexOf(c)>=0&&r!==this._joinRef())return;let E=this._onMessage(c,t,r);if(t&&!E)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(S=>{var j,D,R;return((j=S.filter)===null||j===void 0?void 0:j.event)==="*"||((R=(D=S.filter)===null||D===void 0?void 0:D.event)===null||R===void 0?void 0:R.toLocaleLowerCase())===c}).map(S=>S.callback(E,r)):(l=this.bindings[c])===null||l===void 0||l.filter(S=>{var j,D,R,L,F,B;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in S){const ee=S.id,he=(j=S.filter)===null||j===void 0?void 0:j.event;return ee&&((D=t.ids)===null||D===void 0?void 0:D.includes(ee))&&(he==="*"||(he==null?void 0:he.toLocaleLowerCase())===((R=t.data)===null||R===void 0?void 0:R.type.toLocaleLowerCase()))}else{const ee=(F=(L=S==null?void 0:S.filter)===null||L===void 0?void 0:L.event)===null||F===void 0?void 0:F.toLocaleLowerCase();return ee==="*"||ee===((B=t==null?void 0:t.event)===null||B===void 0?void 0:B.toLocaleLowerCase())}else return S.type.toLocaleLowerCase()===c}).map(S=>{if(typeof E=="object"&&"ids"in E){const j=E.data,{schema:D,table:R,commit_timestamp:L,type:F,errors:B}=j;E=Object.assign(Object.assign({},{schema:D,table:R,commit_timestamp:L,eventType:F,new:{},old:{},errors:B}),this._getPayloadRecords(j))}S.callback(E,r)})}_isClosed(){return this.state===un.closed}_isJoined(){return this.state===un.joined}_isJoining(){return this.state===un.joining}_isLeaving(){return this.state===un.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const a=e.toLocaleLowerCase(),l={type:a,filter:t,callback:r};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===r&&Iy.isEqual(a.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(nr.close,{},e)}_onError(e){this._on(nr.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=un.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=fx(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=fx(e.columns,e.old_record)),t}}const Tp=()=>{},Pd={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},LO=[1e3,2e3,5e3,1e4],VO=1e4,UO=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class BO{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=h0,this.transport=null,this.heartbeatIntervalMs=Pd.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Tp,this.ref=0,this.reconnectTimer=null,this.vsn=dx,this.logger=Tp,this.conn=null,this.sendBuffer=[],this.serializer=new IO,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>a?(...l)=>a(...l):(...l)=>fetch(...l),!(!((r=t==null?void 0:t.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${d0.websocket}`,this.httpEndpoint=bS(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=TO.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case oo.connecting:return lo.Connecting;case oo.open:return lo.Open;case oo.closing:return lo.Closing;default:return lo.Closed}}isConnected(){return this.connectionState()===lo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,a=this.getChannels().find(l=>l.topic===r);if(a)return a;{const l=new Iy(`realtime:${e}`,t,this);return this.channels.push(l),l}}push(e){const{topic:t,event:r,payload:a,ref:l}=e,c=()=>{this.encode(e,f=>{var g;(g=this.conn)===null||g===void 0||g.send(f)})};this.log("push",`${t} ${r} (${l})`,a),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(RO,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Pd.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(y){this.log("error","error in heartbeat callback",y)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:a,payload:l,ref:c}=t,f=c?`(${c})`:"",g=l.status||"";this.log("receive",`${g} ${r} ${a} ${f}`.trim(),l),this.channels.filter(y=>y._isMember(r)).forEach(y=>y._trigger(a,l,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===oo.open||this.conn.readyState===oo.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(nr.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",a=new URLSearchParams(t);return`${e}${r}${a}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([UO],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const a={access_token:t,version:AO};t&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(nr.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(a){this.log("error",`error in ${e} callback`,a)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new _S(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Pd.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,a,l,c,f,g,y,v,w,E,S;switch(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:h0,this.heartbeatIntervalMs=(a=e==null?void 0:e.heartbeatIntervalMs)!==null&&a!==void 0?a:Pd.HEARTBEAT_INTERVAL,this.worker=(l=e==null?void 0:e.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=e==null?void 0:e.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(f=e==null?void 0:e.heartbeatCallback)!==null&&f!==void 0?f:Tp,this.vsn=(g=e==null?void 0:e.vsn)!==null&&g!==void 0?g:dx,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(y=e==null?void 0:e.reconnectAfterMs)!==null&&y!==void 0?y:(j=>LO[j-1]||VO),this.vsn){case yS:this.encode=(v=e==null?void 0:e.encode)!==null&&v!==void 0?v:((j,D)=>D(JSON.stringify(j))),this.decode=(w=e==null?void 0:e.decode)!==null&&w!==void 0?w:((j,D)=>D(JSON.parse(j)));break;case NO:this.encode=(E=e==null?void 0:e.encode)!==null&&E!==void 0?E:this.serializer.encode.bind(this.serializer),this.decode=(S=e==null?void 0:e.decode)!==null&&S!==void 0?S:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class am extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Dt(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class zO extends am{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class m0 extends am{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}const jy=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),qO=()=>Response,g0=n=>{if(Array.isArray(n))return n.map(t=>g0(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const a=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));e[a]=g0(r)}),e},HO=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},$O=n=>!n||typeof n!="string"||n.length===0||n.length>100||n.trim()!==n||n.includes("/")||n.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(n),Sp=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},FO=(n,e,t)=>be(void 0,void 0,void 0,function*(){const r=yield qO();n instanceof r&&!(t!=null&&t.noResolveJson)?n.json().then(a=>{const l=n.status||500,c=(a==null?void 0:a.statusCode)||l+"";e(new zO(Sp(a),l,c))}).catch(a=>{e(new m0(Sp(a),a))}):e(new m0(Sp(n),n))}),GO=(n,e,t,r)=>{const a={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||!r?a:(HO(r)?(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),a.body=JSON.stringify(r)):a.body=r,e!=null&&e.duplex&&(a.duplex=e.duplex),Object.assign(Object.assign({},a),t))};function nh(n,e,t,r,a,l){return be(this,void 0,void 0,function*(){return new Promise((c,f)=>{n(t,GO(e,r,a,l)).then(g=>{if(!g.ok)throw g;return r!=null&&r.noResolveJson?g:g.json()}).then(g=>c(g)).catch(g=>FO(g,f,r))})})}function Vu(n,e,t,r){return be(this,void 0,void 0,function*(){return nh(n,"GET",e,t,r)})}function tr(n,e,t,r,a){return be(this,void 0,void 0,function*(){return nh(n,"POST",e,r,a,t)})}function p0(n,e,t,r,a){return be(this,void 0,void 0,function*(){return nh(n,"PUT",e,r,a,t)})}function KO(n,e,t,r){return be(this,void 0,void 0,function*(){return nh(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function ky(n,e,t,r,a){return be(this,void 0,void 0,function*(){return nh(n,"DELETE",e,r,a,t)})}class QO{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return be(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Dt(e))return{data:null,error:e};throw e}})}}var wS;class YO{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[wS]="BlobDownloadBuilder",this.promise=null}asStream(){return new QO(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return be(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Dt(e))return{data:null,error:e};throw e}})}}wS=Symbol.toStringTag;const XO={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},px={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class WO{constructor(e,t={},r,a){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=jy(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,r,a){return be(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},px),a);let f=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(c.upsert)});const g=c.metadata;typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),g&&l.append("metadata",this.encodeMetadata(g)),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.has("cacheControl")||l.append("cacheControl",c.cacheControl),g&&!l.has("metadata")&&l.append("metadata",this.encodeMetadata(g))):(l=r,f["cache-control"]=`max-age=${c.cacheControl}`,f["content-type"]=c.contentType,g&&(f["x-metadata"]=this.toBase64(this.encodeMetadata(g))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!c.duplex&&(c.duplex="half")),a!=null&&a.headers&&(f=Object.assign(Object.assign({},f),a.headers));const y=this._removeEmptyFolders(t),v=this._getFinalPath(y),w=yield(e=="PUT"?p0:tr)(this.fetch,`${this.url}/object/${v}`,l,Object.assign({headers:f},c!=null&&c.duplex?{duplex:c.duplex}:{}));return{data:{path:y,id:w.Id,fullPath:w.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Dt(l))return{data:null,error:l};throw l}})}upload(e,t,r){return be(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,a){return be(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(e),c=this._getFinalPath(l),f=new URL(this.url+`/object/upload/sign/${c}`);f.searchParams.set("token",t);try{let g;const y=Object.assign({upsert:px.upsert},a),v=Object.assign(Object.assign({},this.headers),{"x-upsert":String(y.upsert)});typeof Blob<"u"&&r instanceof Blob?(g=new FormData,g.append("cacheControl",y.cacheControl),g.append("",r)):typeof FormData<"u"&&r instanceof FormData?(g=r,g.append("cacheControl",y.cacheControl)):(g=r,v["cache-control"]=`max-age=${y.cacheControl}`,v["content-type"]=y.contentType);const w=yield p0(this.fetch,f.toString(),g,{headers:v});return{data:{path:l,fullPath:w.Key},error:null}}catch(g){if(this.shouldThrowOnError)throw g;if(Dt(g))return{data:null,error:g};throw g}})}createSignedUploadUrl(e,t){return be(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const a=Object.assign({},this.headers);t!=null&&t.upsert&&(a["x-upsert"]="true");const l=yield tr(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),c=new URL(this.url+l.url),f=c.searchParams.get("token");if(!f)throw new am("No token returned by API");return{data:{signedUrl:c.toString(),path:e,token:f},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}})}update(e,t,r){return be(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return be(this,void 0,void 0,function*(){try{return{data:yield tr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Dt(a))return{data:null,error:a};throw a}})}copy(e,t,r){return be(this,void 0,void 0,function*(){try{return{data:{path:(yield tr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Dt(a))return{data:null,error:a};throw a}})}createSignedUrl(e,t,r){return be(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),l=yield tr(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const c=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Dt(a))return{data:null,error:a};throw a}})}createSignedUrls(e,t,r){return be(this,void 0,void 0,function*(){try{const a=yield tr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Dt(a))return{data:null,error:a};throw a}})}download(e,t){const a=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),c=l?`?${l}`:"",f=this._getFinalPath(e),g=()=>Vu(this.fetch,`${this.url}/${a}/${f}${c}`,{headers:this.headers,noResolveJson:!0});return new YO(g,this.shouldThrowOnError)}info(e){return be(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield Vu(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:g0(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}})}exists(e){return be(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield KO(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r)&&r instanceof m0){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),a=[],l=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";l!==""&&a.push(l);const f=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",g=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});g!==""&&a.push(g);let y=a.join("&");return y!==""&&(y=`?${y}`),{data:{publicUrl:encodeURI(`${this.url}/${f}/public/${r}${y}`)}}}remove(e){return be(this,void 0,void 0,function*(){try{return{data:yield ky(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Dt(t))return{data:null,error:t};throw t}})}list(e,t,r){return be(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},XO),t),{prefix:e||""});return{data:yield tr(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Dt(a))return{data:null,error:a};throw a}})}listV2(e,t){return be(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield tr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const xS="2.86.0",ES={"X-Client-Info":`storage-js/${xS}`};class JO{constructor(e,t={},r,a){this.shouldThrowOnError=!1;const l=new URL(e);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ES),t),this.fetch=jy(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return be(this,void 0,void 0,function*(){try{const t=this.listBucketOptionsToQueryString(e);return{data:yield Vu(this.fetch,`${this.url}/bucket${t}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Dt(t))return{data:null,error:t};throw t}})}getBucket(e){return be(this,void 0,void 0,function*(){try{return{data:yield Vu(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Dt(t))return{data:null,error:t};throw t}})}createBucket(e){return be(this,arguments,void 0,function*(t,r={public:!1}){try{return{data:yield tr(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Dt(a))return{data:null,error:a};throw a}})}updateBucket(e,t){return be(this,void 0,void 0,function*(){try{return{data:yield p0(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Dt(r))return{data:null,error:r};throw r}})}emptyBucket(e){return be(this,void 0,void 0,function*(){try{return{data:yield tr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Dt(t))return{data:null,error:t};throw t}})}deleteBucket(e){return be(this,void 0,void 0,function*(){try{return{data:yield ky(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Dt(t))return{data:null,error:t};throw t}})}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}}var Uu=class extends Error{constructor(n,e){var t;super(n),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&((t=e.icebergType)==null?void 0:t.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function ZO(n,e,t){const r=new URL(e,n);if(t)for(const[a,l]of Object.entries(t))l!==void 0&&r.searchParams.set(a,l);return r.toString()}async function eD(n){return!n||n.type==="none"?{}:n.type==="bearer"?{Authorization:`Bearer ${n.token}`}:n.type==="header"?{[n.name]:n.value}:n.type==="custom"?await n.getHeaders():{}}function tD(n){const e=n.fetchImpl??globalThis.fetch;return{async request({method:t,path:r,query:a,body:l,headers:c}){const f=ZO(n.baseUrl,r,a),g=await eD(n.auth),y=await e(f,{method:t,headers:{...l?{"Content-Type":"application/json"}:{},...g,...c},body:l?JSON.stringify(l):void 0}),v=await y.text(),w=(y.headers.get("content-type")||"").includes("application/json"),E=w&&v?JSON.parse(v):v;if(!y.ok){const S=w?E:void 0,j=S==null?void 0:S.error;throw new Uu((j==null?void 0:j.message)??`Request failed with status ${y.status}`,{status:y.status,icebergType:j==null?void 0:j.type,icebergCode:j==null?void 0:j.code,details:S})}return{status:y.status,headers:y.headers,data:E}}}}function Ld(n){return n.join("")}var nD=class{constructor(n,e=""){this.client=n,this.prefix=e}async listNamespaces(n){const e=n?{parent:Ld(n.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(r=>({namespace:r}))}async createNamespace(n,e){const t={namespace:n.namespace,properties:e==null?void 0:e.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:t})).data}async dropNamespace(n){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ld(n.namespace)}`})}async loadNamespaceMetadata(n){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ld(n.namespace)}`})).data.properties}}async namespaceExists(n){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ld(n.namespace)}`}),!0}catch(e){if(e instanceof Uu&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(n,e){try{return await this.createNamespace(n,e)}catch(t){if(t instanceof Uu&&t.status===409)return;throw t}}};function vl(n){return n.join("")}var sD=class{constructor(n,e="",t){this.client=n,this.prefix=e,this.accessDelegation=t}async listTables(n){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${vl(n.namespace)}/tables`})).data.identifiers}async createTable(n,e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${vl(n.namespace)}/tables`,body:e,headers:t})).data.metadata}async updateTable(n,e){const t=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${vl(n.namespace)}/tables/${n.name}`,body:e});return{"metadata-location":t.data["metadata-location"],metadata:t.data.metadata}}async dropTable(n,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${vl(n.namespace)}/tables/${n.name}`,query:{purgeRequested:String((e==null?void 0:e.purge)??!1)}})}async loadTable(n){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${vl(n.namespace)}/tables/${n.name}`,headers:e})).data.metadata}async tableExists(n){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${vl(n.namespace)}/tables/${n.name}`,headers:e}),!0}catch(t){if(t instanceof Uu&&t.status===404)return!1;throw t}}async createTableIfNotExists(n,e){try{return await this.createTable(n,e)}catch(t){if(t instanceof Uu&&t.status===409)return await this.loadTable({namespace:n.namespace,name:e.name});throw t}}},rD=class{constructor(n){var r;let e="v1";n.catalogName&&(e+=`/${n.catalogName}`);const t=n.baseUrl.endsWith("/")?n.baseUrl:`${n.baseUrl}/`;this.client=tD({baseUrl:t,auth:n.auth,fetchImpl:n.fetch}),this.accessDelegation=(r=n.accessDelegation)==null?void 0:r.join(","),this.namespaceOps=new nD(this.client,e),this.tableOps=new sD(this.client,e,this.accessDelegation)}async listNamespaces(n){return this.namespaceOps.listNamespaces(n)}async createNamespace(n,e){return this.namespaceOps.createNamespace(n,e)}async dropNamespace(n){await this.namespaceOps.dropNamespace(n)}async loadNamespaceMetadata(n){return this.namespaceOps.loadNamespaceMetadata(n)}async listTables(n){return this.tableOps.listTables(n)}async createTable(n,e){return this.tableOps.createTable(n,e)}async updateTable(n,e){return this.tableOps.updateTable(n,e)}async dropTable(n,e){await this.tableOps.dropTable(n,e)}async loadTable(n){return this.tableOps.loadTable(n)}async namespaceExists(n){return this.namespaceOps.namespaceExists(n)}async tableExists(n){return this.tableOps.tableExists(n)}async createNamespaceIfNotExists(n,e){return this.namespaceOps.createNamespaceIfNotExists(n,e)}async createTableIfNotExists(n,e){return this.tableOps.createTableIfNotExists(n,e)}};class iD{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ES),t),this.fetch=jy(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return be(this,void 0,void 0,function*(){try{return{data:yield tr(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Dt(t))return{data:null,error:t};throw t}})}listBuckets(e){return be(this,void 0,void 0,function*(){try{const t=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&t.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&t.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&t.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&t.set("sortOrder",e.sortOrder),e!=null&&e.search&&t.set("search",e.search);const r=t.toString(),a=r?`${this.url}/bucket?${r}`:`${this.url}/bucket`;return{data:yield Vu(this.fetch,a,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Dt(t))return{data:null,error:t};throw t}})}deleteBucket(e){return be(this,void 0,void 0,function*(){try{return{data:yield ky(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Dt(t))return{data:null,error:t};throw t}})}from(e){if(!$O(e))throw new am("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");return new rD({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:()=>be(this,void 0,void 0,function*(){return this.headers})},fetch:this.fetch})}}const Oy={"X-Client-Info":`storage-js/${xS}`,"Content-Type":"application/json"};class TS extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function xs(n){return typeof n=="object"&&n!==null&&"__isStorageVectorsError"in n}class Ap extends TS{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class aD extends TS{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}}var yx;(function(n){n.InternalError="InternalError",n.S3VectorConflictException="S3VectorConflictException",n.S3VectorNotFoundException="S3VectorNotFoundException",n.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",n.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",n.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(yx||(yx={}));const Dy=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),oD=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},_x=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),lD=(n,e,t)=>be(void 0,void 0,void 0,function*(){if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!(t!=null&&t.noResolveJson)){const a=n.status||500,l=n;if(typeof l.json=="function")l.json().then(c=>{const f=(c==null?void 0:c.statusCode)||(c==null?void 0:c.code)||a+"";e(new Ap(_x(c),a,f))}).catch(()=>{const c=a+"",f=l.statusText||`HTTP ${a} error`;e(new Ap(f,a,c))});else{const c=a+"",f=l.statusText||`HTTP ${a} error`;e(new Ap(f,a,c))}}else e(new aD(_x(n),n))}),cD=(n,e,t,r)=>{const a={method:n,headers:(e==null?void 0:e.headers)||{}};return r?(oD(r)?(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),a.body=JSON.stringify(r)):a.body=r,Object.assign(Object.assign({},a),t)):a};function uD(n,e,t,r,a,l){return be(this,void 0,void 0,function*(){return new Promise((c,f)=>{n(t,cD(e,r,a,l)).then(g=>{if(!g.ok)throw g;if(r!=null&&r.noResolveJson)return g;const y=g.headers.get("content-type");return!y||!y.includes("application/json")?{}:g.json()}).then(g=>c(g)).catch(g=>lD(g,f,r))})})}function Es(n,e,t,r,a){return be(this,void 0,void 0,function*(){return uD(n,"POST",e,r,a,t)})}class hD{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Oy),t),this.fetch=Dy(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return be(this,void 0,void 0,function*(){try{return{data:(yield Es(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(xs(t))return{data:null,error:t};throw t}})}getIndex(e,t){return be(this,void 0,void 0,function*(){try{return{data:yield Es(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(xs(r))return{data:null,error:r};throw r}})}listIndexes(e){return be(this,void 0,void 0,function*(){try{return{data:yield Es(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(xs(t))return{data:null,error:t};throw t}})}deleteIndex(e,t){return be(this,void 0,void 0,function*(){try{return{data:(yield Es(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(xs(r))return{data:null,error:r};throw r}})}}class dD{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Oy),t),this.fetch=Dy(r)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return be(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Es(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(xs(t))return{data:null,error:t};throw t}})}getVectors(e){return be(this,void 0,void 0,function*(){try{return{data:yield Es(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(xs(t))return{data:null,error:t};throw t}})}listVectors(e){return be(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield Es(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(xs(t))return{data:null,error:t};throw t}})}queryVectors(e){return be(this,void 0,void 0,function*(){try{return{data:yield Es(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(xs(t))return{data:null,error:t};throw t}})}deleteVectors(e){return be(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Es(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(xs(t))return{data:null,error:t};throw t}})}}class fD{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Oy),t),this.fetch=Dy(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return be(this,void 0,void 0,function*(){try{return{data:(yield Es(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(xs(t))return{data:null,error:t};throw t}})}getBucket(e){return be(this,void 0,void 0,function*(){try{return{data:yield Es(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(xs(t))return{data:null,error:t};throw t}})}listBuckets(){return be(this,arguments,void 0,function*(e={}){try{return{data:yield Es(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(xs(t))return{data:null,error:t};throw t}})}deleteBucket(e){return be(this,void 0,void 0,function*(){try{return{data:(yield Es(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(xs(t))return{data:null,error:t};throw t}})}}class mD extends fD{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new gD(this.url,this.headers,e,this.fetch)}createBucket(e){const t=Object.create(null,{createBucket:{get:()=>super.createBucket}});return be(this,void 0,void 0,function*(){return t.createBucket.call(this,e)})}getBucket(e){const t=Object.create(null,{getBucket:{get:()=>super.getBucket}});return be(this,void 0,void 0,function*(){return t.getBucket.call(this,e)})}listBuckets(){const e=Object.create(null,{listBuckets:{get:()=>super.listBuckets}});return be(this,arguments,void 0,function*(t={}){return e.listBuckets.call(this,t)})}deleteBucket(e){const t=Object.create(null,{deleteBucket:{get:()=>super.deleteBucket}});return be(this,void 0,void 0,function*(){return t.deleteBucket.call(this,e)})}}class gD extends hD{constructor(e,t,r,a){super(e,t,a),this.vectorBucketName=r}createIndex(e){const t=Object.create(null,{createIndex:{get:()=>super.createIndex}});return be(this,void 0,void 0,function*(){return t.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return be(this,arguments,void 0,function*(t={}){return e.listIndexes.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const t=Object.create(null,{getIndex:{get:()=>super.getIndex}});return be(this,void 0,void 0,function*(){return t.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const t=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return be(this,void 0,void 0,function*(){return t.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new pD(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class pD extends dD{constructor(e,t,r,a,l){super(e,t,l),this.vectorBucketName=r,this.indexName=a}putVectors(e){const t=Object.create(null,{putVectors:{get:()=>super.putVectors}});return be(this,void 0,void 0,function*(){return t.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const t=Object.create(null,{getVectors:{get:()=>super.getVectors}});return be(this,void 0,void 0,function*(){return t.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return be(this,arguments,void 0,function*(t={}){return e.listVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const t=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return be(this,void 0,void 0,function*(){return t.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const t=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return be(this,void 0,void 0,function*(){return t.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class yD extends JO{constructor(e,t={},r,a){super(e,t,r,a)}from(e){return new WO(this.url,this.headers,e,this.fetch)}get vectors(){return new mD(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new iD(this.url+"/iceberg",this.headers,this.fetch)}}const _D="2.86.0";let uu="";typeof Deno<"u"?uu="deno":typeof document<"u"?uu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?uu="react-native":uu="node";const vD={"X-Client-Info":`supabase-js-${uu}/${_D}`},bD={headers:vD},wD={schema:"public"},xD={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ED={},TD=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),SD=()=>Headers,AD=(n,e,t)=>{const r=TD(t),a=SD();return async(l,c)=>{var f;const g=(f=await e())!==null&&f!==void 0?f:n;let y=new a(c==null?void 0:c.headers);return y.has("apikey")||y.set("apikey",n),y.has("Authorization")||y.set("Authorization",`Bearer ${g}`),r(l,Object.assign(Object.assign({},c),{headers:y}))}};function ND(n){return n.endsWith("/")?n:n+"/"}function RD(n,e){var t,r;const{db:a,auth:l,realtime:c,global:f}=n,{db:g,auth:y,realtime:v,global:w}=e,E={db:Object.assign(Object.assign({},g),a),auth:Object.assign(Object.assign({},y),l),realtime:Object.assign(Object.assign({},v),c),storage:{},global:Object.assign(Object.assign(Object.assign({},w),f),{headers:Object.assign(Object.assign({},(t=w==null?void 0:w.headers)!==null&&t!==void 0?t:{}),(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return n.accessToken?E.accessToken=n.accessToken:delete E.accessToken,E}function CD(n){const e=n==null?void 0:n.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(ND(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const SS="2.86.0",Il=30*1e3,y0=3,Np=y0*Il,ID="http://localhost:9999",jD="supabase.auth.token",kD={"X-Client-Info":`gotrue-js/${SS}`},_0="X-Supabase-Api-Version",AS={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},OD=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,DD=600*1e3;class Bu extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function Ee(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class MD extends Bu{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function PD(n){return Ee(n)&&n.name==="AuthApiError"}class co extends Bu{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Sa extends Bu{constructor(e,t,r,a){super(e,r,a),this.name=t,this.status=r}}class _s extends Sa{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function LD(n){return Ee(n)&&n.name==="AuthSessionMissingError"}class bl extends Sa{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Vd extends Sa{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ud extends Sa{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function VD(n){return Ee(n)&&n.name==="AuthImplicitGrantRedirectError"}class vx extends Sa{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class v0 extends Sa{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Rp(n){return Ee(n)&&n.name==="AuthRetryableFetchError"}class bx extends Sa{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class b0 extends Sa{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ef="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),wx=` 	
\r=`.split(""),UD=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<wx.length;e+=1)n[wx[e].charCodeAt(0)]=-2;for(let e=0;e<Ef.length;e+=1)n[Ef[e].charCodeAt(0)]=e;return n})();function xx(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(Ef[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(Ef[r]),e.queuedBits-=6}}function NS(n,e,t){const r=UD[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Ex(n){const e=[],t=c=>{e.push(String.fromCodePoint(c))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=c=>{qD(c,r,t)};for(let c=0;c<n.length;c+=1)NS(n.charCodeAt(c),a,l);return e.join("")}function BD(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function zD(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|a)+65536,t+=1}BD(r,e)}}function qD(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function zl(n){const e=[],t={queue:0,queuedBits:0},r=a=>{e.push(a)};for(let a=0;a<n.length;a+=1)NS(n.charCodeAt(a),t,r);return new Uint8Array(e)}function HD(n){const e=[];return zD(n,t=>e.push(t)),new Uint8Array(e)}function mo(n){const e=[],t={queue:0,queuedBits:0},r=a=>{e.push(a)};return n.forEach(a=>xx(a,t,r)),xx(null,t,r),e.join("")}function $D(n){return Math.round(Date.now()/1e3)+n}function FD(){return Symbol("auth-callback")}const An=()=>typeof window<"u"&&typeof document<"u",so={tested:!1,writable:!1},RS=()=>{if(!An())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(so.tested)return so.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),so.tested=!0,so.writable=!0}catch{so.tested=!0,so.writable=!1}return so.writable};function GD(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((a,l)=>{e[l]=a})}catch{}return t.searchParams.forEach((r,a)=>{e[a]=r}),e}const CS=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),KD=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",jl=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},ro=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Ji=async(n,e)=>{await n.removeItem(e)};class om{constructor(){this.promise=new om.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}om.promiseConstructor=Promise;function Cp(n){const e=n.split(".");if(e.length!==3)throw new b0("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!OD.test(e[r]))throw new b0("JWT not in base64url format");return{header:JSON.parse(Ex(e[0])),payload:JSON.parse(Ex(e[1])),signature:zl(e[2]),raw:{header:e[0],payload:e[1]}}}async function QD(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function YD(n,e){return new Promise((r,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await n(l);if(!e(l,null,c)){r(c);return}}catch(c){if(!e(l,c)){a(c);return}}})()})}function XD(n){return("0"+n.toString(16)).substr(-2)}function WD(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let a="";for(let l=0;l<56;l++)a+=t.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(e),Array.from(e,XD).join("")}async function JD(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(r);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function ZD(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await JD(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function wl(n,e,t=!1){const r=WD();let a=r;t&&(a+="/PASSWORD_RECOVERY"),await jl(n,`${e}-code-verifier`,a);const l=await ZD(r);return[l,r===l?"plain":"s256"]}const e8=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function t8(n){const e=n.headers.get(_0);if(!e||!e.match(e8))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function n8(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function s8(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const r8=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function xl(n){if(!r8.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ip(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function i8(n,e){return new Proxy(n,{get:(t,r,a)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const l=r.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,r,a)}return!e.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,r,a)}})}function Tx(n){return JSON.parse(JSON.stringify(n))}const ao=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),a8=[502,503,504];async function Sx(n){var e;if(!KD(n))throw new v0(ao(n),0);if(a8.includes(n.status))throw new v0(ao(n),n.status);let t;try{t=await n.json()}catch(l){throw new co(ao(l),l)}let r;const a=t8(n);if(a&&a.getTime()>=AS["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new bx(ao(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new _s}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new bx(ao(t),n.status,t.weak_password.reasons);throw new MD(ao(t),n.status||500,r)}const o8=(n,e,t,r)=>{const a={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),t))};async function je(n,e,t,r){var a;const l=Object.assign({},r==null?void 0:r.headers);l[_0]||(l[_0]=AS["2024-01-01"].name),r!=null&&r.jwt&&(l.Authorization=`Bearer ${r.jwt}`);const c=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(c.redirect_to=r.redirectTo);const f=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",g=await l8(n,e,t+f,{headers:l,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(g):{data:Object.assign({},g),error:null}}async function l8(n,e,t,r,a,l){const c=o8(e,r,a,l);let f;try{f=await n(t,Object.assign({},c))}catch(g){throw console.error(g),new v0(ao(g),0)}if(f.ok||await Sx(f),r!=null&&r.noResolveJson)return f;try{return await f.json()}catch(g){await Sx(g)}}function er(n){var e;let t=null;h8(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=$D(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function Ax(n){const e=er(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function ra(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function c8(n){return{data:n,error:null}}function u8(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:a,verification_type:l}=n,c=oc(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),f={action_link:e,email_otp:t,hashed_token:r,redirect_to:a,verification_type:l},g=Object.assign({},c);return{data:{properties:f,user:g},error:null}}function Nx(n){return n}function h8(n){return n.access_token&&n.refresh_token&&n.expires_in}const jp=["global","local","others"];class d8{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=CS(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=jp[0]){if(jp.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${jp.join(", ")}`);try{return await je(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ee(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await je(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ra})}catch(r){if(Ee(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=oc(e,["options"]),a=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await je(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:u8,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(Ee(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await je(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ra})}catch(t){if(Ee(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,a,l,c,f,g;try{const y={nextPage:null,lastPage:0,total:0},v=await je(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(l=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:Nx});if(v.error)throw v.error;const w=await v.json(),E=(c=v.headers.get("x-total-count"))!==null&&c!==void 0?c:0,S=(g=(f=v.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&g!==void 0?g:[];return S.length>0&&(S.forEach(j=>{const D=parseInt(j.split(";")[0].split("=")[1].substring(0,1)),R=JSON.parse(j.split(";")[1].split("=")[1]);y[`${R}Page`]=D}),y.total=parseInt(E)),{data:Object.assign(Object.assign({},w),y),error:null}}catch(y){if(Ee(y))return{data:{users:[]},error:y};throw y}}async getUserById(e){xl(e);try{return await je(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ra})}catch(t){if(Ee(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){xl(e);try{return await je(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:ra})}catch(r){if(Ee(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){xl(e);try{return await je(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:ra})}catch(r){if(Ee(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){xl(e.userId);try{const{data:t,error:r}=await je(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:t,error:r}}catch(t){if(Ee(t))return{data:null,error:t};throw t}}async _deleteFactor(e){xl(e.userId),xl(e.id);try{return{data:await je(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ee(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,r,a,l,c,f,g;try{const y={nextPage:null,lastPage:0,total:0},v=await je(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(l=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:Nx});if(v.error)throw v.error;const w=await v.json(),E=(c=v.headers.get("x-total-count"))!==null&&c!==void 0?c:0,S=(g=(f=v.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&g!==void 0?g:[];return S.length>0&&(S.forEach(j=>{const D=parseInt(j.split(";")[0].split("=")[1].substring(0,1)),R=JSON.parse(j.split(";")[1].split("=")[1]);y[`${R}Page`]=D}),y.total=parseInt(E)),{data:Object.assign(Object.assign({},w),y),error:null}}catch(y){if(Ee(y))return{data:{clients:[]},error:y};throw y}}async _createOAuthClient(e){try{return await je(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ee(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await je(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ee(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await je(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ee(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await je(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(Ee(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await je(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ee(t))return{data:null,error:t};throw t}}}function Rx(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const El={debug:!!(globalThis&&RS()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class IS extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class f8 extends IS{}async function m8(n,e,t){El.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),El.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){El.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,a.name);try{return await t()}finally{El.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,a.name)}}else{if(e===0)throw El.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new f8(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(El.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function g8(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function jS(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function p8(n){return parseInt(n,16)}function y8(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function _8(n){var e;const{chainId:t,domain:r,expirationTime:a,issuedAt:l=new Date,nonce:c,notBefore:f,requestId:g,resources:y,scheme:v,uri:w,version:E}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(c&&c.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${c}`);if(!w)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(E!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${E}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const S=jS(n.address),j=v?`${v}://${r}`:r,D=n.statement?`${n.statement}
`:"",R=`${j} wants you to sign in with your Ethereum account:
${S}

${D}`;let L=`URI: ${w}
Version: ${E}
Chain ID: ${t}${c?`
Nonce: ${c}`:""}
Issued At: ${l.toISOString()}`;if(a&&(L+=`
Expiration Time: ${a.toISOString()}`),f&&(L+=`
Not Before: ${f.toISOString()}`),g&&(L+=`
Request ID: ${g}`),y){let F=`
Resources:`;for(const B of y){if(!B||typeof B!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${B}`);F+=`
- ${B}`}L+=F}return`${R}
${L}`}class sn extends Error{constructor({message:e,code:t,cause:r,name:a}){var l;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(l=a??(r instanceof Error?r.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=t}}class Tf extends sn{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function v8({error:n,options:e}){var t,r,a;const{publicKey:l}=e;if(!l)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new sn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=l.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new sn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((r=l.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new sn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new sn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new sn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new sn({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return l.pubKeyCredParams.filter(f=>f.type==="public-key").length===0?new sn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new sn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const c=window.location.hostname;if(kS(c)){if(l.rp.id!==c)return new sn({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new sn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new sn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new sn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new sn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function b8({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new sn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new sn({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const r=window.location.hostname;if(kS(r)){if(t.rpId!==r)return new sn({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new sn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new sn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new sn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class w8{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const x8=new w8;function E8(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:r}=n,a=oc(n,["challenge","user","excludeCredentials"]),l=zl(e).buffer,c=Object.assign(Object.assign({},t),{id:zl(t.id).buffer}),f=Object.assign(Object.assign({},a),{challenge:l,user:c});if(r&&r.length>0){f.excludeCredentials=new Array(r.length);for(let g=0;g<r.length;g++){const y=r[g];f.excludeCredentials[g]=Object.assign(Object.assign({},y),{id:zl(y.id).buffer,type:y.type||"public-key",transports:y.transports})}}return f}function T8(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,r=oc(n,["challenge","allowCredentials"]),a=zl(e).buffer,l=Object.assign(Object.assign({},r),{challenge:a});if(t&&t.length>0){l.allowCredentials=new Array(t.length);for(let c=0;c<t.length;c++){const f=t[c];l.allowCredentials[c]=Object.assign(Object.assign({},f),{id:zl(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return l}function S8(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:mo(new Uint8Array(n.response.attestationObject)),clientDataJSON:mo(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function A8(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,r=n.getClientExtensionResults(),a=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:mo(new Uint8Array(a.authenticatorData)),clientDataJSON:mo(new Uint8Array(a.clientDataJSON)),signature:mo(new Uint8Array(a.signature)),userHandle:a.userHandle?mo(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function kS(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function Cx(){var n,e;return!!(An()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator==null?void 0:navigator.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function N8(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Tf("Browser returned unexpected credential type",e)}:{data:null,error:new Tf("Empty credential response",e)}}catch(e){return{data:null,error:v8({error:e,options:n})}}}async function R8(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Tf("Browser returned unexpected credential type",e)}:{data:null,error:new Tf("Empty credential response",e)}}catch(e){return{data:null,error:b8({error:e,options:n})}}}const C8={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},I8={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Sf(...n){const e=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),t=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),r={};for(const a of n)if(a)for(const l in a){const c=a[l];if(c!==void 0)if(Array.isArray(c))r[l]=c;else if(t(c))r[l]=c;else if(e(c)){const f=r[l];e(f)?r[l]=Sf(f,c):r[l]=Sf(c)}else r[l]=c}return r}function j8(n,e){return Sf(C8,n,e||{})}function k8(n,e){return Sf(I8,n,e||{})}class O8{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:r,signal:a},l){try{const{data:c,error:f}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!c)return{data:null,error:f};const g=a??x8.createNewAbortSignal();if(c.webauthn.type==="create"){const{user:y}=c.webauthn.credential_options.publicKey;y.name||(y.name=`${y.id}:${r}`),y.displayName||(y.displayName=y.name)}switch(c.webauthn.type){case"create":{const y=j8(c.webauthn.credential_options.publicKey,l==null?void 0:l.create),{data:v,error:w}=await N8({publicKey:y,signal:g});return v?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:v}},error:null}:{data:null,error:w}}case"request":{const y=k8(c.webauthn.credential_options.publicKey,l==null?void 0:l.request),{data:v,error:w}=await R8(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:y,signal:g}));return v?{data:{factorId:e,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:v}},error:null}:{data:null,error:w}}}}catch(c){return Ee(c)?{data:null,error:c}:{data:null,error:new co("Unexpected error in challenge",c)}}}async _verify({challengeId:e,factorId:t,webauthn:r}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},l){if(!t)return{data:null,error:new Bu("rpId is required for WebAuthn authentication")};try{if(!Cx())return{data:null,error:new co("Browser does not support WebAuthn",null)};const{data:c,error:f}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:r},signal:a},{request:l});if(!c)return{data:null,error:f};const{webauthn:g}=c;return this._verify({factorId:e,challengeId:c.challengeId,webauthn:{type:g.type,rpId:t,rpOrigins:r,credential_response:g.credential_response}})}catch(c){return Ee(c)?{data:null,error:c}:{data:null,error:new co("Unexpected error in authenticate",c)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},l){if(!t)return{data:null,error:new Bu("rpId is required for WebAuthn registration")};try{if(!Cx())return{data:null,error:new co("Browser does not support WebAuthn",null)};const{data:c,error:f}=await this._enroll({friendlyName:e});if(!c)return await this.client.mfa.listFactors().then(v=>{var w;return(w=v.data)===null||w===void 0?void 0:w.all.find(E=>E.factor_type==="webauthn"&&E.friendly_name===e&&E.status!=="unverified")}).then(v=>v?this.client.mfa.unenroll({factorId:v==null?void 0:v.id}):void 0),{data:null,error:f};const{data:g,error:y}=await this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:t,rpOrigins:r},signal:a},{create:l});return g?this._verify({factorId:c.id,challengeId:g.challengeId,webauthn:{rpId:t,rpOrigins:r,type:g.webauthn.type,credential_response:g.webauthn.credential_response}}):{data:null,error:y}}catch(c){return Ee(c)?{data:null,error:c}:{data:null,error:new co("Unexpected error in register",c)}}}}g8();const D8={url:ID,storageKey:jD,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:kD,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Ix(n,e,t){return await t()}const Tl={};class zu{get jwks(){var e,t;return(t=(e=Tl[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Tl[this.storageKey]=Object.assign(Object.assign({},Tl[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Tl[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Tl[this.storageKey]=Object.assign(Object.assign({},Tl[this.storageKey]),{cachedAt:e})}constructor(e){var t,r,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},D8),e);if(this.storageKey=l.storageKey,this.instanceID=(t=zu.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,zu.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&An()){const c=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(c),this.logDebugMessages&&console.trace(c)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new d8({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=CS(l.fetch),this.lock=l.lock||Ix,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,l.lock?this.lock=l.lock:An()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=m8:this.lock=Ix,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new O8(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:RS()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Rx(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=Rx(this.memoryStorage)),An()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${SS}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},r="none";if(An()&&(t=GD(window.location.href),this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce")),An()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:l}=await this._getSessionFromURL(t,r);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),VD(l)){const g=(e=l.details)===null||e===void 0?void 0:e.code;if(g==="identity_already_exists"||g==="identity_not_found"||g==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:f}=a;return this._debug("#_initialize()","detected session in URL",c,"redirect type",f),await this._saveSession(c),setTimeout(async()=>{f==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ee(t)?this._returnResult({error:t}):this._returnResult({error:new co("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,a;try{const l=await je(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:er}),{data:c,error:f}=l;if(f||!c)return this._returnResult({data:{user:null,session:null},error:f});const g=c.session,y=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",g)),this._returnResult({data:{user:y,session:g},error:null})}catch(l){if(Ee(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(e){var t,r,a;try{let l;if("email"in e){const{email:v,password:w,options:E}=e;let S=null,j=null;this.flowType==="pkce"&&([S,j]=await wl(this.storage,this.storageKey)),l=await je(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:E==null?void 0:E.emailRedirectTo,body:{email:v,password:w,data:(t=E==null?void 0:E.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken},code_challenge:S,code_challenge_method:j},xform:er})}else if("phone"in e){const{phone:v,password:w,options:E}=e;l=await je(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:w,data:(r=E==null?void 0:E.data)!==null&&r!==void 0?r:{},channel:(a=E==null?void 0:E.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:E==null?void 0:E.captchaToken}},xform:er})}else throw new Vd("You must provide either an email or phone number and a password");const{data:c,error:f}=l;if(f||!c)return this._returnResult({data:{user:null,session:null},error:f});const g=c.session,y=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",g)),this._returnResult({data:{user:y,session:g},error:null})}catch(l){if(Ee(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(e){try{let t;if("email"in e){const{email:l,password:c,options:f}=e;t=await je(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Ax})}else if("phone"in e){const{phone:l,password:c,options:f}=e;t=await je(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Ax})}else throw new Vd("You must provide either an email or phone number and a password");const{data:r,error:a}=t;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!r||!r.session||!r.user){const l=new bl;return this._returnResult({data:{user:null,session:null},error:l})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(t){if(Ee(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,r,a,l;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=e.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,r,a,l,c,f,g,y,v,w,E;let S,j;if("message"in e)S=e.message,j=e.signature;else{const{chain:D,wallet:R,statement:L,options:F}=e;let B;if(An())if(typeof R=="object")B=R;else{const k=window;if("ethereum"in k&&typeof k.ethereum=="object"&&"request"in k.ethereum&&typeof k.ethereum.request=="function")B=k.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof R!="object"||!(F!=null&&F.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");B=R}const ee=new URL((t=F==null?void 0:F.url)!==null&&t!==void 0?t:window.location.href),he=await B.request({method:"eth_requestAccounts"}).then(k=>k).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!he||he.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const ue=jS(he[0]);let C=(r=F==null?void 0:F.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!C){const k=await B.request({method:"eth_chainId"});C=p8(k)}const I={domain:ee.host,address:ue,statement:L,uri:ee.href,version:"1",chainId:C,nonce:(a=F==null?void 0:F.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(c=(l=F==null?void 0:F.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&c!==void 0?c:new Date,expirationTime:(f=F==null?void 0:F.signInWithEthereum)===null||f===void 0?void 0:f.expirationTime,notBefore:(g=F==null?void 0:F.signInWithEthereum)===null||g===void 0?void 0:g.notBefore,requestId:(y=F==null?void 0:F.signInWithEthereum)===null||y===void 0?void 0:y.requestId,resources:(v=F==null?void 0:F.signInWithEthereum)===null||v===void 0?void 0:v.resources};S=_8(I),j=await B.request({method:"personal_sign",params:[y8(S),ue]})}try{const{data:D,error:R}=await je(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:S,signature:j},!((w=e.options)===null||w===void 0)&&w.captchaToken?{gotrue_meta_security:{captcha_token:(E=e.options)===null||E===void 0?void 0:E.captchaToken}}:null),xform:er});if(R)throw R;if(!D||!D.session||!D.user){const L=new bl;return this._returnResult({data:{user:null,session:null},error:L})}return D.session&&(await this._saveSession(D.session),await this._notifyAllSubscribers("SIGNED_IN",D.session)),this._returnResult({data:Object.assign({},D),error:R})}catch(D){if(Ee(D))return this._returnResult({data:{user:null,session:null},error:D});throw D}}async signInWithSolana(e){var t,r,a,l,c,f,g,y,v,w,E,S;let j,D;if("message"in e)j=e.message,D=e.signature;else{const{chain:R,wallet:L,statement:F,options:B}=e;let ee;if(An())if(typeof L=="object")ee=L;else{const ue=window;if("solana"in ue&&typeof ue.solana=="object"&&("signIn"in ue.solana&&typeof ue.solana.signIn=="function"||"signMessage"in ue.solana&&typeof ue.solana.signMessage=="function"))ee=ue.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof L!="object"||!(B!=null&&B.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");ee=L}const he=new URL((t=B==null?void 0:B.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in ee&&ee.signIn){const ue=await ee.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},B==null?void 0:B.signInWithSolana),{version:"1",domain:he.host,uri:he.href}),F?{statement:F}:null));let C;if(Array.isArray(ue)&&ue[0]&&typeof ue[0]=="object")C=ue[0];else if(ue&&typeof ue=="object"&&"signedMessage"in ue&&"signature"in ue)C=ue;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)j=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),D=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in ee)||typeof ee.signMessage!="function"||!("publicKey"in ee)||typeof ee!="object"||!ee.publicKey||!("toBase58"in ee.publicKey)||typeof ee.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");j=[`${he.host} wants you to sign in with your Solana account:`,ee.publicKey.toBase58(),...F?["",F,""]:[""],"Version: 1",`URI: ${he.href}`,`Issued At: ${(a=(r=B==null?void 0:B.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((l=B==null?void 0:B.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${B.signInWithSolana.notBefore}`]:[],...!((c=B==null?void 0:B.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${B.signInWithSolana.expirationTime}`]:[],...!((f=B==null?void 0:B.signInWithSolana)===null||f===void 0)&&f.chainId?[`Chain ID: ${B.signInWithSolana.chainId}`]:[],...!((g=B==null?void 0:B.signInWithSolana)===null||g===void 0)&&g.nonce?[`Nonce: ${B.signInWithSolana.nonce}`]:[],...!((y=B==null?void 0:B.signInWithSolana)===null||y===void 0)&&y.requestId?[`Request ID: ${B.signInWithSolana.requestId}`]:[],...!((w=(v=B==null?void 0:B.signInWithSolana)===null||v===void 0?void 0:v.resources)===null||w===void 0)&&w.length?["Resources",...B.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const ue=await ee.signMessage(new TextEncoder().encode(j),"utf8");if(!ue||!(ue instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");D=ue}}try{const{data:R,error:L}=await je(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:j,signature:mo(D)},!((E=e.options)===null||E===void 0)&&E.captchaToken?{gotrue_meta_security:{captcha_token:(S=e.options)===null||S===void 0?void 0:S.captchaToken}}:null),xform:er});if(L)throw L;if(!R||!R.session||!R.user){const F=new bl;return this._returnResult({data:{user:null,session:null},error:F})}return R.session&&(await this._saveSession(R.session),await this._notifyAllSubscribers("SIGNED_IN",R.session)),this._returnResult({data:Object.assign({},R),error:L})}catch(R){if(Ee(R))return this._returnResult({data:{user:null,session:null},error:R});throw R}}async _exchangeCodeForSession(e){const t=await ro(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(t??"").split("/");try{const{data:l,error:c}=await je(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:er});if(await Ji(this.storage,`${this.storageKey}-code-verifier`),c)throw c;if(!l||!l.session||!l.user){const f=new bl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:f})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:c})}catch(l){if(Ee(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(e){try{const{options:t,provider:r,token:a,access_token:l,nonce:c}=e,f=await je(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:er}),{data:g,error:y}=f;if(y)return this._returnResult({data:{user:null,session:null},error:y});if(!g||!g.session||!g.user){const v=new bl;return this._returnResult({data:{user:null,session:null},error:v})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:g,error:y})}catch(t){if(Ee(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,r,a,l,c;try{if("email"in e){const{email:f,options:g}=e;let y=null,v=null;this.flowType==="pkce"&&([y,v]=await wl(this.storage,this.storageKey));const{error:w}=await je(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:f,data:(t=g==null?void 0:g.data)!==null&&t!==void 0?t:{},create_user:(r=g==null?void 0:g.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},code_challenge:y,code_challenge_method:v},redirectTo:g==null?void 0:g.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:w})}if("phone"in e){const{phone:f,options:g}=e,{data:y,error:v}=await je(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:f,data:(a=g==null?void 0:g.data)!==null&&a!==void 0?a:{},create_user:(l=g==null?void 0:g.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:g==null?void 0:g.captchaToken},channel:(c=g==null?void 0:g.channel)!==null&&c!==void 0?c:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:y==null?void 0:y.message_id},error:v})}throw new Vd("You must provide either an email or phone number.")}catch(f){if(Ee(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}}async verifyOtp(e){var t,r;try{let a,l;"options"in e&&(a=(t=e.options)===null||t===void 0?void 0:t.redirectTo,l=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:c,error:f}=await je(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:er});if(f)throw f;if(!c)throw new Error("An error occurred on token verification.");const g=c.session,y=c.user;return g!=null&&g.access_token&&(await this._saveSession(g),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",g)),this._returnResult({data:{user:y,session:g},error:null})}catch(a){if(Ee(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(e){var t,r,a,l,c;try{let f=null,g=null;this.flowType==="pkce"&&([f,g]=await wl(this.storage,this.storageKey));const y=await je(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:f,code_challenge_method:g}),headers:this.headers,xform:c8});return!((l=y.data)===null||l===void 0)&&l.url&&An()&&!(!((c=e.options)===null||c===void 0)&&c.skipBrowserRedirect)&&window.location.assign(y.data.url),this._returnResult(y)}catch(f){if(Ee(f))return this._returnResult({data:null,error:f});throw f}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new _s;const{error:a}=await je(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(e){if(Ee(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:a,options:l}=e,{error:c}=await je(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:c})}else if("phone"in e){const{phone:r,type:a,options:l}=e,{data:c,error:f}=await je(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:f})}throw new Vd("You must provide either an email or phone number and a type")}catch(t){if(Ee(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await ro(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Np:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const c=await ro(this.userStorage,this.storageKey+"-user");c!=null&&c.user?e.user=c.user:e.user=Ip()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const c={value:this.suppressGetSessionWarning};e.user=i8(e.user,c),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await je(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ra}):await this._useSession(async t=>{var r,a,l;const{data:c,error:f}=t;if(f)throw f;return!(!((r=c.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new _s}:await je(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=c.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:ra})})}catch(t){if(Ee(t))return LD(t)&&(await this._removeSession(),await Ji(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:a,error:l}=r;if(l)throw l;if(!a.session)throw new _s;const c=a.session;let f=null,g=null;this.flowType==="pkce"&&e.email!=null&&([f,g]=await wl(this.storage,this.storageKey));const{data:y,error:v}=await je(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:f,code_challenge_method:g}),jwt:c.access_token,xform:ra});if(v)throw v;return c.user=y.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),this._returnResult({data:{user:c.user},error:null})})}catch(r){if(Ee(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new _s;const t=Date.now()/1e3;let r=t,a=!0,l=null;const{payload:c}=Cp(e.access_token);if(c.exp&&(r=c.exp,a=r<=t),a){const{data:f,error:g}=await this._callRefreshToken(e.refresh_token);if(g)return this._returnResult({data:{user:null,session:null},error:g});if(!f)return{data:{user:null,session:null},error:null};l=f}else{const{data:f,error:g}=await this._getUser(e.access_token);if(g)throw g;l={access_token:e.access_token,refresh_token:e.refresh_token,user:f.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(t){if(Ee(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:c,error:f}=t;if(f)throw f;e=(r=c.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new _s;const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(Ee(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!An())throw new Ud("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ud(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new vx("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ud("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new vx("No code detected.");const{data:F,error:B}=await this._exchangeCodeForSession(e.code);if(B)throw B;const ee=new URL(window.location.href);return ee.searchParams.delete("code"),window.history.replaceState(window.history.state,"",ee.toString()),{data:{session:F.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:l,refresh_token:c,expires_in:f,expires_at:g,token_type:y}=e;if(!l||!f||!c||!y)throw new Ud("No session defined in URL");const v=Math.round(Date.now()/1e3),w=parseInt(f);let E=v+w;g&&(E=parseInt(g));const S=E-v;S*1e3<=Il&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${S}s, should have been closer to ${w}s`);const j=E-w;v-j>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",j,E,v):v-j<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",j,E,v);const{data:D,error:R}=await this._getUser(l);if(R)throw R;const L={provider_token:r,provider_refresh_token:a,access_token:l,expires_in:w,expires_at:E,refresh_token:c,token_type:y,user:D.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:L,redirectType:e.type},error:null})}catch(r){if(Ee(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await ro(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:a,error:l}=t;if(l)return this._returnResult({error:l});const c=(r=a.session)===null||r===void 0?void 0:r.access_token;if(c){const{error:f}=await this.admin.signOut(c,e);if(f&&!(PD(f)&&(f.status===404||f.status===401||f.status===403)))return this._returnResult({error:f})}return e!=="others"&&(await this._removeSession(),await Ji(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=FD(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,a;try{const{data:{session:l},error:c}=t;if(c)throw c;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}})}async resetPasswordForEmail(e,t={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await wl(this.storage,this.storageKey,!0));try{return await je(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(Ee(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(Ee(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:r,error:a}=await this._useSession(async l=>{var c,f,g,y,v;const{data:w,error:E}=l;if(E)throw E;const S=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(c=e.options)===null||c===void 0?void 0:c.redirectTo,scopes:(f=e.options)===null||f===void 0?void 0:f.scopes,queryParams:(g=e.options)===null||g===void 0?void 0:g.queryParams,skipBrowserRedirect:!0});return await je(this.fetch,"GET",S,{headers:this.headers,jwt:(v=(y=w.session)===null||y===void 0?void 0:y.access_token)!==null&&v!==void 0?v:void 0})});if(a)throw a;return An()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),this._returnResult({data:{provider:e.provider,url:r==null?void 0:r.url},error:null})}catch(r){if(Ee(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{const{error:a,data:{session:l}}=t;if(a)throw a;const{options:c,provider:f,token:g,access_token:y,nonce:v}=e,w=await je(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=l==null?void 0:l.access_token)!==null&&r!==void 0?r:void 0,body:{provider:f,id_token:g,access_token:y,nonce:v,link_identity:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:er}),{data:E,error:S}=w;return S?this._returnResult({data:{user:null,session:null},error:S}):!E||!E.session||!E.user?this._returnResult({data:{user:null,session:null},error:new bl}):(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("USER_UPDATED",E.session)),this._returnResult({data:E,error:S}))}catch(a){if(Ee(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,a;const{data:l,error:c}=t;if(c)throw c;return await je(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(r=l.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(t){if(Ee(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await YD(async a=>(a>0&&await QD(200*Math.pow(2,a-1)),this._debug(t,"refreshing attempt",a),await je(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:er})),(a,l)=>{const c=200*Math.pow(2,a);return l&&Rp(l)&&Date.now()+c-r<Il})}catch(r){if(this._debug(t,"error",r),Ee(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),An()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const a=await ro(this.storage,this.storageKey);if(a&&this.userStorage){let c=await ro(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:a.user},await jl(this.userStorage,this.storageKey+"-user",c)),a.user=(e=c==null?void 0:c.user)!==null&&e!==void 0?e:Ip()}else if(a&&!a.user&&!a.user){const c=await ro(this.storage,this.storageKey+"-user");c&&(c!=null&&c.user)?(a.user=c.user,await Ji(this.storage,this.storageKey+"-user"),await jl(this.storage,this.storageKey,a)):a.user=Ip()}if(this._debug(r,"session from storage",a),!this._isValidSession(a)){this._debug(r,"session is not valid"),a!==null&&await this._removeSession();return}const l=((t=a.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Np;if(this._debug(r,`session has${l?"":" not"} expired with margin of ${Np}s`),l){if(this.autoRefreshToken&&a.refresh_token){const{error:c}=await this._callRefreshToken(a.refresh_token);c&&(console.error(c),Rp(c)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:f}=await this._getUser(a.access_token);!f&&(c!=null&&c.user)?(a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(r,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(r,"error",a),console.error(a);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new _s;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new om;const{data:l,error:c}=await this._refreshAccessToken(e);if(c)throw c;if(!l.session)throw new _s;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const f={data:l.session,error:null};return this.refreshingDeferred.resolve(f),f}catch(l){if(this._debug(a,"error",l),Ee(l)){const c={data:null,error:l};return Rp(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,t,r=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async f=>{try{await f.callback(e,t)}catch(g){l.push(g)}});if(await Promise.all(c),l.length>0){for(let f=0;f<l.length;f+=1)console.error(l[f]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await jl(this.userStorage,this.storageKey+"-user",{user:t.user});const a=Object.assign({},t);delete a.user;const l=Tx(a);await jl(this.storage,this.storageKey,l)}else{const a=Tx(t);await jl(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Ji(this.storage,this.storageKey),await Ji(this.storage,this.storageKey+"-code-verifier"),await Ji(this.storage,this.storageKey+"-user"),this.userStorage&&await Ji(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&An()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Il);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-e)/Il);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Il}ms, refresh threshold is ${y0} ticks`),a<=y0&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof IS)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!An()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const a=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[l,c]=await wl(this.storage,this.storageKey),f=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});a.push(f.toString())}if(r!=null&&r.queryParams){const l=new URLSearchParams(r.queryParams);a.push(l.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:a,error:l}=t;return l?this._returnResult({data:null,error:l}):await je(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(Ee(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,a;const{data:l,error:c}=t;if(c)return this._returnResult({data:null,error:c});const f=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:g,error:y}=await je(this.fetch,"POST",`${this.url}/factors`,{body:f,headers:this.headers,jwt:(r=l==null?void 0:l.session)===null||r===void 0?void 0:r.access_token});return y?this._returnResult({data:null,error:y}):(e.factorType==="totp"&&g.type==="totp"&&(!((a=g==null?void 0:g.totp)===null||a===void 0)&&a.qr_code)&&(g.totp.qr_code=`data:image/svg+xml;utf-8,${g.totp.qr_code}`),this._returnResult({data:g,error:null}))})}catch(t){if(Ee(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:a,error:l}=t;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?S8(e.webauthn.credential_response):A8(e.webauthn.credential_response)})}:{code:e.code}),{data:f,error:g}=await je(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:c,headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return g?this._returnResult({data:null,error:g}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+f.expires_in},f)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",f),this._returnResult({data:f,error:g}))})}catch(t){if(Ee(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:a,error:l}=t;if(l)return this._returnResult({data:null,error:l});const c=await je(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});if(c.error)return c;const{data:f}=c;if(f.type!=="webauthn")return{data:f,error:null};switch(f.webauthn.type){case"create":return{data:Object.assign(Object.assign({},f),{webauthn:Object.assign(Object.assign({},f.webauthn),{credential_options:Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:E8(f.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},f),{webauthn:Object.assign(Object.assign({},f.webauthn),{credential_options:Object.assign(Object.assign({},f.webauthn.credential_options),{publicKey:T8(f.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(Ee(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const a={all:[],phone:[],totp:[],webauthn:[]};for(const l of(e=t==null?void 0:t.factors)!==null&&e!==void 0?e:[])a.all.push(l),l.status==="verified"&&a[l.factor_type].push(l);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:r},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=Cp(r.access_token);let c=null;l.aal&&(c=l.aal);let f=c;((t=(e=r.user.factors)===null||e===void 0?void 0:e.filter(v=>v.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(f="aal2");const y=l.amr||[];return{data:{currentLevel:c,nextLevel:f,currentAuthenticationMethods:y},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;return a?this._returnResult({data:null,error:a}):r?await je(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new _s})})}catch(t){if(Ee(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:a},error:l}=r;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new _s});const c=await je(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:f=>({data:f,error:null})});return c.data&&c.data.redirect_url&&An()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(c.data.redirect_url),c})}catch(r){if(Ee(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:a},error:l}=r;if(l)return this._returnResult({data:null,error:l});if(!a)return this._returnResult({data:null,error:new _s});const c=await je(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:f=>({data:f,error:null})});return c.data&&c.data.redirect_url&&An()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(c.data.redirect_url),c})}catch(r){if(Ee(r))return this._returnResult({data:null,error:r});throw r}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;return r?this._returnResult({data:null,error:r}):t?await je(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new _s})})}catch(e){if(Ee(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;return a?this._returnResult({data:null,error:a}):r?(await je(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new _s})})}catch(t){if(Ee(t))return this._returnResult({data:null,error:t});throw t}}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(f=>f.kid===e);if(r)return r;const a=Date.now();if(r=this.jwks.keys.find(f=>f.kid===e),r&&this.jwks_cached_at+DD>a)return r;const{data:l,error:c}=await je(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=a,r=l.keys.find(f=>f.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:S,error:j}=await this.getSession();if(j||!S.session)return this._returnResult({data:null,error:j});r=S.session.access_token}const{header:a,payload:l,signature:c,raw:{header:f,payload:g}}=Cp(r);t!=null&&t.allowExpired||n8(l.exp);const y=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!y){const{error:S}=await this.getUser(r);if(S)throw S;return{data:{claims:l,header:a,signature:c},error:null}}const v=s8(a.alg),w=await crypto.subtle.importKey("jwk",y,v,!0,["verify"]);if(!await crypto.subtle.verify(v,w,c,HD(`${f}.${g}`)))throw new b0("Invalid JWT signature");return{data:{claims:l,header:a,signature:c},error:null}}catch(r){if(Ee(r))return this._returnResult({data:null,error:r});throw r}}}zu.nextInstanceID={};const M8=zu;class P8 extends M8{constructor(e){super(e)}}class L8{constructor(e,t,r){var a,l,c;this.supabaseUrl=e,this.supabaseKey=t;const f=CD(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",f),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",f),this.storageUrl=new URL("storage/v1",f),this.functionsUrl=new URL("functions/v1",f);const g=`sb-${f.hostname.split(".")[0]}-auth-token`,y={db:wD,realtime:ED,auth:Object.assign(Object.assign({},xD),{storageKey:g}),global:bD},v=RD(r??{},y);this.storageKey=(a=v.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(l=v.global.headers)!==null&&l!==void 0?l:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(w,E)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(E)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=v.auth)!==null&&c!==void 0?c:{},this.headers,v.global.fetch),this.fetch=AD(t,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.accessToken&&this.accessToken().then(w=>this.realtime.setAuth(w)).catch(w=>console.warn("Failed to set initial Realtime auth token:",w)),this.rest=new EO(new URL("rest/v1",f).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),this.storage=new yD(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),v.accessToken||this._listenForAuthEvents()}get functions(){return new vO(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();const{data:r}=await this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:l,storageKey:c,flowType:f,lock:g,debug:y,throwOnError:v},w,E){const S={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new P8({url:this.authUrl.href,headers:Object.assign(Object.assign({},S),w),storageKey:c,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:l,flowType:f,lock:g,debug:y,throwOnError:v,fetch:E,hasCustomAuthorizationHeader:Object.keys(this.headers).some(j=>j.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new BO(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const V8=(n,e,t)=>new L8(n,e,t);function U8(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}U8()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const B8="https://hykypgxaegmufdothwbv.supabase.co",z8="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh5a3lwZ3hhZWdtdWZkb3Rod2J2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE1NTE3NzMsImV4cCI6MjA3NzEyNzc3M30.Euzl2vfhHrxhgN-tfg2XftMaX9hEiJOorSJq16n2CRY",q8=V8(B8,z8),H8=(n,e)=>{const t=r=>{const a=r.match(/(\d+)$/);return a?parseInt(a[1],10):0};return t(n.id)-t(e.id)},OS=async()=>{const{data:n,error:e}=await q8.from("licenses").select(`
      id,
      name,
      display_order,
      subjects (
        id,
        name,
        display_order,
        questions (
          *,
          answers (
            id,
            text
          )
        )
      )
    `).order("display_order",{ascending:!0}).order("display_order",{foreignTable:"subjects",ascending:!0});if(e)throw console.error("Error fetching data from Supabase:",e),e;return n.map(r=>({id:r.id,name:r.name,subjects:r.subjects.map(a=>({id:a.id,name:a.name,questions:a.questions.sort(H8).map(l=>({id:l.id,text:l.text,image:l.image,correctAnswerId:l.correct_answer_id,answers:l.answers.map(c=>({id:c.id,text:c.text}))}))}))}))},DS=Object.freeze(Object.defineProperty({__proto__:null,fetchLicenses:OS},Symbol.toStringTag,{value:"Module"})),pe={WELCOME:"welcome",LOGIN:"login",DASHBOARD:"dashboard",LICENSE_SELECTION:"license_selection",NAME_INPUT:"name_input",MODE_SELECTION:"mode_selection",SUBJECT_SELECTION:"subject_selection",IN_QUIZ:"in_quiz",IN_ONLINE_EXAM:"in_online_exam",RESULT:"results",EXAM_RESULT:"exam_result",HISTORY:"history",MY_CLASS:"my_class",CLASS_MANAGEMENT:"class_management",REGISTER:"register",ACCOUNT:"account",NOTIFICATION_MGMT:"notification_mgmt"},$8=()=>{const[n,e]=K.useState(pe.WELCOME),[t,r]=K.useState([]),[a,l]=K.useState(null),[c,f]=K.useState([]),[g,y]=K.useState(null),[v,w]=K.useState(null),[E,S]=K.useState({}),[j,D]=K.useState(0),[R,L]=K.useState(""),[F,B]=K.useState(null),[ee,he]=K.useState(window.innerWidth<768),[ue,C]=K.useState(!1);K.useEffect(()=>{const W=()=>{he(window.innerWidth<768)};return window.addEventListener("resize",W),()=>window.removeEventListener("resize",W)},[]),K.useEffect(()=>{(async()=>{try{const ie=await OS();r(ie)}catch(ie){console.error("Error loading licenses:",ie)}})()},[]),K.useEffect(()=>{const W=EI(Mu,async ie=>{if(ie){const de=await vk(ie.uid);B(de),L((de==null?void 0:de.full_name)||ie.displayName||""),Mn(async()=>{const{loadSession:Te,getLicensePreference:Ie}=await import("./sessionService-CxCtOUx6.js");return{loadSession:Te,getLicensePreference:Ie}},[]).then(({loadSession:Te,getLicensePreference:Ie})=>{const Je=Te(ie.uid);if(Je){console.log("Restoring session...",Je),w(Je.quiz),S(Je.userAnswers),l(Je.selectedLicense),y(Je.selectedSubject),Je.mode==="online_exam"?e(pe.IN_ONLINE_EXAM):e(pe.IN_QUIZ);return}(async()=>{if(de!=null&&de.defaultLicenseId){const mt=t.find(Rn=>Rn.id===de.defaultLicenseId);if(mt){l(mt),e(pe.MODE_SELECTION);return}}if(de!=null&&de.courseId)try{const mt=ft(Re,"courses",de.courseId),Rn=await bo(mt);if(Rn.exists()){const rs=Rn.data();if(rs.licenseId){const Ze=t.find(Cn=>Cn.id===rs.licenseId);if(Ze){l(Ze),e(pe.MODE_SELECTION),Mn(async()=>{const{updateDoc:Cn}=await Promise.resolve().then(()=>ku);return{updateDoc:Cn}},void 0).then(({updateDoc:Cn})=>{Cn(ft(Re,"users",ie.uid),{defaultLicenseId:rs.licenseId}).catch(zs=>console.error("Self-heal error:",zs))});return}}}}catch(mt){console.error("Error in auth fallback:",mt)}const Me=Ie();if(Me){const mt=t.find(Rn=>Rn.id===Me);mt&&l(mt),e(pe.DASHBOARD)}else e(pe.DASHBOARD)})()})}else B(null),L(""),e(pe.WELCOME)});return()=>{W()}},[t]);const I=K.useCallback((W,ie,de,Te,Ie)=>{!Te||!F||Mn(async()=>{const{saveSession:Je}=await import("./sessionService-CxCtOUx6.js");return{saveSession:Je}},[]).then(({saveSession:Je})=>{Je(F.id,Te,Ie,de,W,ie,a,g)})},[a,g,F]);K.useEffect(()=>{if(n===pe.IN_QUIZ||n===pe.IN_ONLINE_EXAM){C(!1);return}F&&Mn(async()=>{const{loadSession:W}=await import("./sessionService-CxCtOUx6.js");return{loadSession:W}},[]).then(({loadSession:W})=>{const ie=W(F.id);C(!!ie)})},[n,F]);const k=()=>{Mn(async()=>{const{loadSession:W}=await import("./sessionService-CxCtOUx6.js");return{loadSession:W}},[]).then(({loadSession:W})=>{if(!F)return;const ie=W(F.id);ie&&(w(ie.quiz),S(ie.userAnswers),l(ie.selectedLicense),y(ie.selectedSubject),ie.mode==="online_exam"?e(pe.IN_ONLINE_EXAM):e(pe.IN_QUIZ))})},U=async()=>{if(F){if(F.defaultLicenseId){const W=t.find(ie=>ie.id===F.defaultLicenseId);if(W){l(W),e(pe.MODE_SELECTION);return}}else if(F.courseId)try{const W=ft(Re,"courses",F.courseId),ie=await bo(W);if(ie.exists()){const de=ie.data();if(de.licenseId){const Te=t.find(Ie=>Ie.id===de.licenseId);if(Te){l(Te),e(pe.MODE_SELECTION),Mn(async()=>{const{updateDoc:Ie}=await Promise.resolve().then(()=>ku);return{updateDoc:Ie}},void 0).then(({updateDoc:Ie})=>{Ie(ft(Re,"users",F.id),{defaultLicenseId:de.licenseId}).catch(Je=>console.error("Self-heal failed:",Je))});return}}}}catch(W){console.error("Error in license fallback:",W)}Mn(async()=>{const{getLicensePreference:W}=await import("./sessionService-CxCtOUx6.js");return{getLicensePreference:W}},[]).then(({getLicensePreference:W})=>{const ie=W();ie&&t.find(de=>de.id===ie)?(l(t.find(de=>de.id===ie)),e(pe.DASHBOARD)):e(pe.LICENSE_SELECTION)})}else e(pe.LICENSE_SELECTION)},P=()=>{e(pe.LOGIN)},H=()=>{e(pe.REGISTER)},A=async W=>{l(W),Mn(async()=>{const{saveLicensePreference:ie}=await import("./sessionService-CxCtOUx6.js");return{saveLicensePreference:ie}},[]).then(({saveLicensePreference:ie})=>{ie(W.id)}),e(F?pe.MODE_SELECTION:pe.NAME_INPUT)},me=W=>{L(W),e(pe.MODE_SELECTION)},xe=async W=>{W==="practice"?a&&(f(a.subjects),e(pe.SUBJECT_SELECTION)):W==="online_exam"&&V()},V=async()=>{if(a){const de=[...a.subjects.flatMap(Ie=>Ie.questions)].sort(()=>.5-Math.random()).slice(0,30),Te={id:"exam-"+Date.now(),title:` thi th ${a.name}`,questions:de,timeLimit:1800};w(Te),S({}),e(pe.IN_ONLINE_EXAM)}},le=async W=>{y(W);const ie={id:W.id,title:W.name,questions:W.questions,timeLimit:0};w(ie),S({}),e(pe.IN_QUIZ)},_e=W=>{if(v){Mn(async()=>{const{clearSession:de}=await import("./sessionService-CxCtOUx6.js");return{clearSession:de}},[]).then(({clearSession:de})=>de()),C(!1);let ie=0;if(v.questions.forEach(de=>{W[de.id]===de.correctAnswerId&&ie++}),D(ie),S(W),n===pe.IN_ONLINE_EXAM)F&&Zw(F.id,a.id,a.name,null,"Thi th",ie,30,v.timeLimit-0),e(pe.EXAM_RESULT);else{if(F&&a){const de=g?g.name:null;Zw(F.id,a.id,a.name,de,"n tp",ie,v.questions.length,0)}e(pe.RESULT)}}},De=()=>{n===pe.EXAM_RESULT?V():g&&a&&le(g)},$e=W=>{W==="dashboard"?e(F?pe.DASHBOARD:pe.WELCOME):W==="history"?e(pe.HISTORY):W==="login"?e(pe.LOGIN):W==="my_class"?e(pe.MY_CLASS):W==="class_management"?e(pe.CLASS_MANAGEMENT):W==="account"?e(F?pe.ACCOUNT:pe.LOGIN):W==="notification_mgmt"&&e(pe.NOTIFICATION_MGMT)},z=async()=>{Mn(async()=>{const{clearSession:W}=await import("./sessionService-CxCtOUx6.js");return{clearSession:W}},[]).then(({clearSession:W})=>W()),await Mu.signOut()},ne=()=>{switch(n){case pe.WELCOME:return h.jsx(ex,{onStart:U,onLoginClick:P,onRegisterClick:H});case pe.LOGIN:return h.jsx(Tk,{onBack:()=>e(pe.WELCOME)});case pe.REGISTER:return h.jsx(Sk,{onBack:()=>e(pe.WELCOME),onSuccess:()=>e(pe.DASHBOARD)});case pe.LICENSE_SELECTION:return h.jsx(Nk,{licenses:t,onSelect:A,onBack:()=>e(pe.WELCOME)});case pe.NAME_INPUT:return h.jsx(Rk,{onNameSubmit:me,onBack:()=>e(pe.LICENSE_SELECTION)});case pe.MODE_SELECTION:return h.jsx(Ck,{onModeSelect:xe,licenseName:(a==null?void 0:a.name)||"",userName:R,onSwitchLicense:()=>e(pe.LICENSE_SELECTION)});case pe.SUBJECT_SELECTION:return h.jsx(Ik,{subjects:c,progress:{},onSelect:le,onBack:()=>e(pe.MODE_SELECTION)});case pe.IN_QUIZ:return v?h.jsx(jk,{quiz:v,onFinish:_e,onBack:()=>e(pe.SUBJECT_SELECTION),initialAnswers:E,initialIndex:(()=>{try{const W=localStorage.getItem("ontap_quiz_session");return W?JSON.parse(W).currentQuestionIndex:0}catch{return 0}})(),onProgressUpdate:(W,ie,de)=>I(W,ie,de,v,"practice")}):null;case pe.IN_ONLINE_EXAM:return v?h.jsx(Dk,{quiz:v,onFinish:_e,onBack:()=>e(pe.MODE_SELECTION),userName:R,selectedLicense:a,initialAnswers:E,initialIndex:(()=>{try{const W=localStorage.getItem("ontap_quiz_session");return W?JSON.parse(W).currentQuestionIndex:0}catch{return 0}})(),initialTime:(()=>{try{const W=localStorage.getItem("ontap_quiz_session");return W?JSON.parse(W).timeLeft:void 0}catch{return}})(),onProgressUpdate:(W,ie,de)=>I(W,ie,de,v,"online_exam")}):null;case pe.RESULT:return v?h.jsx(Pk,{quiz:v,userAnswers:E,score:j,onRetry:De,onBack:()=>e(pe.SUBJECT_SELECTION),userName:R}):null;case pe.EXAM_RESULT:return v?h.jsx(Mk,{quiz:v,userAnswers:E,score:j,onRetry:De,onBack:()=>e(pe.MODE_SELECTION),userName:R}):null;case pe.DASHBOARD:return h.jsx(sO,{userProfile:F,onStart:()=>e(pe.LICENSE_SELECTION),onHistoryClick:()=>e(pe.HISTORY),onClassClick:()=>$e(F.role==="hoc_vien"?"my_class":"class_management")});case pe.HISTORY:return h.jsx(rO,{userProfile:F,onBack:()=>e(pe.DASHBOARD)});case pe.MY_CLASS:return h.jsx(aO,{userProfile:F,onBack:()=>e(pe.DASHBOARD)});case pe.CLASS_MANAGEMENT:return h.jsx(lO,{userProfile:F,onBack:()=>e(pe.DASHBOARD)});case pe.ACCOUNT:return h.jsx(hO,{userProfile:F,onBack:()=>e(pe.DASHBOARD)});case pe.NOTIFICATION_MGMT:return F?h.jsx(xk,{userProfile:F}):null;default:return h.jsx(ex,{onStart:U,onLoginClick:P,onRegisterClick:H})}};return h.jsxs("div",{className:"min-h-screen bg-background text-foreground font-sans transition-colors duration-300 pt-16",children:[h.jsx(yk,{}),h.jsx(_k,{}),ue&&h.jsxs("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-yellow-400 text-black px-6 py-3 rounded-full shadow-xl z-50 animate-bounce cursor-pointer hover:bg-yellow-500 font-bold flex items-center gap-2",onClick:k,children:[h.jsx("span",{children:" Bn ang c bi thi lm d!"}),h.jsx("span",{className:"underline",children:"Lm tip ngay"})]}),h.jsx(dO,{userProfile:F,onNavigate:$e,onLogout:z}),ne()]})},F8=()=>h.jsxs(kx,{children:[h.jsx(PN,{}),h.jsx($8,{}),h.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:h.jsx(MN,{})})]}),MS=document.getElementById("root");if(!MS)throw new Error("Could not find root element to mount to");const G8=TN.createRoot(MS);G8.render(h.jsx(aa.StrictMode,{children:h.jsx(kx,{children:h.jsx(F8,{})})}));
